# SPLICE

AI-powered Premiere Pro UXP plugin for detecting takes, removing silences, and accelerating video editing workflows.

## Current Focus
**Auto-Cutting v3.0** - Phase 2 complete (Frontend credit display)

## Quick Reference

### Pricing Tiers (80%+ Margins)
| Tier | Price | Hours | Stripe Price ID |
|------|-------|-------|-----------------|
| Starter | $19/mo | 15 hrs | price_1SgH4m2L5BseYEbCih347qfr |
| Pro | $49/mo | 50 hrs | price_1SgH4o2L5BseYEbCIoR19lhQ |
| Team | $149/mo | 150 hrs | price_1SgH4q2L5BseYEbCYTlimb5M |
| Overage | $1/hr | - | price_1SgH4y2L5BseYEbClZuxNRu8 |

### Key Constraints
- UXP requires Premiere Pro 25.6+
- Use `127.0.0.1` not `localhost` in fetch URLs
- Backend (local): https://127.0.0.1:3847
- Backend (prod): https://splice-api-production.up.railway.app
- Railway project: `splice-backend` with PostgreSQL

## Key Files

### Backend (v3.0)
| File | Purpose |
|------|---------|
| `splice-backend/server.js` | Express HTTP/HTTPS + all endpoints + webhook handler |
| `splice-backend/services/usageTracking.js` | Credit balance, usage logging, idempotency |
| `splice-backend/middleware/rateLimiter.js` | Credit check middleware |

### Frontend (v3.0)
| File | Purpose |
|------|---------|
| `splice-plugin/js/credits.js` | Fetch/display credit balance from backend |
| `splice-plugin/js/settings.js` | User settings including customerId |
| `splice-plugin/index.html` | Credit badge in header UI |

### Endpoints
| Endpoint | Purpose |
|----------|---------|
| `GET /credits` | User's hour balance (x-stripe-customer-id header) |
| `GET /usage-history` | Usage log |
| `POST /webhooks/stripe` | Subscription events (idempotent) |

## Implementation Phases

### Phase 1: Usage & Billing System (Backend) ✅ COMPLETE
- [x] usageTracking.js, rateLimiter.js, /credits endpoint
- [x] Railway + PostgreSQL deployment
- [x] Stripe products + webhook integration

### Phase 2: UI Simplification (Frontend) ✅ COMPLETE
- [x] Update `index.html` - credit badge in header
- [x] Create `credits.js` - fetch/display balance from /credits endpoint
- [x] Add customerId to settings, auto-refresh after processing

### Phase 3-6: Preview Mode, Smart Filtering, Automation, Polish
- [ ] Remaining phases

## Last Session (2025-12-19)

**Completed Phase 2 - Frontend credit display:**
- Created `credits.js` module - fetches balance from production backend
- Added credit badge to header UI (shows "X.X hrs" with color coding)
- Low credits (<1hr) pulse red with animation
- Added customerId to settings.js for Stripe customer tracking
- Auto-refresh credits every 5 minutes + after each processing operation
- Updated plugin version to v3.0

**Previous session - Phase 1:**
- Deployed `splice-api` service to Railway (https://splice-api-production.up.railway.app)
- Stripe webhook integration with idempotency

**Stopped at:** Phase 2 complete, credit display UI ready

## Next Steps
1. Start Phase 3: Preview Mode - show detected changes before applying
2. Add customer ID input in settings modal (or link to Stripe checkout)
3. Consider adding usage history display

---
*Last updated: 2025-12-19*
