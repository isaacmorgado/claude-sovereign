#!/bin/bash
# Install Claude Model Switcher
# Adds 'm' command to shell configuration

set -e

echo "Installing Claude Model Switcher..."
echo ""

# Determine shell config file
if [ -n "$ZSH_VERSION" ]; then
    SHELL_CONFIG="$HOME/.zshrc"
elif [ -n "$BASH_VERSION" ]; then
    SHELL_CONFIG="$HOME/.bashrc"
else
    echo "⚠ Unknown shell. Please add alias manually:"
    echo "  alias m='~/.claude/scripts/claude-model-switcher.sh'"
    exit 1
fi

# Check if already installed
if grep -q "claude-model-switcher.sh" "$SHELL_CONFIG" 2>/dev/null; then
    echo "✓ Model switcher already installed in $SHELL_CONFIG"
    echo ""
    echo "To use immediately: source $SHELL_CONFIG"
    echo "Or open a new terminal"
    exit 0
fi

# Add alias to shell config
echo "" >> "$SHELL_CONFIG"
echo "# Claude Model Switcher (added $(date))" >> "$SHELL_CONFIG"
echo "alias m='~/.claude/scripts/claude-model-switcher.sh'" >> "$SHELL_CONFIG"

echo "✓ Added 'm' command to $SHELL_CONFIG"
echo ""
echo "To use immediately, run:"
echo "  source $SHELL_CONFIG"
echo ""
echo "Or open a new terminal and run:"
echo "  m list        # See all models"
echo "  m glm         # Start with GLM-4.7"
echo "  m dolphin     # Start with Dolphin"
echo "  m 2           # Start with model #2 (Sonnet)"
echo ""
