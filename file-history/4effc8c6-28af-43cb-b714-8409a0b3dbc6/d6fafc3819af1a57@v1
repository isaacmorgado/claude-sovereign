const fs = require('fs');

// Read both files
const scoringFile = fs.readFileSync('./src/lib/faceiq-scoring.ts', 'utf8');
const extractedFile = fs.readFileSync('./extracted-curves.ts', 'utf8');

// Find where METRIC_CUSTOM_CURVES starts and ends in scoring file
const curvesStartPattern = /export const METRIC_CUSTOM_CURVES: Record<string, CurvePoint\[\]> = \{[\s\S]*?\n\};/;

// Extract just the METRIC_CUSTOM_CURVES section from extracted file (lines 4 to the closing };)
const extractedCurvesMatch = extractedFile.match(/export const METRIC_CUSTOM_CURVES: Record<string, CurvePoint\[\]> = \{[\s\S]*?\n\};/);

if (!extractedCurvesMatch) {
  console.error('Could not find METRIC_CUSTOM_CURVES in extracted file');
  process.exit(1);
}

const newCurves = extractedCurvesMatch[0];

// Replace in scoring file
const newScoringFile = scoringFile.replace(curvesStartPattern, newCurves);

// Write back
fs.writeFileSync('./src/lib/faceiq-scoring.ts', newScoringFile);
console.log('Successfully replaced METRIC_CUSTOM_CURVES with 66 curves');
console.log('New file size:', newScoringFile.length, 'characters');
