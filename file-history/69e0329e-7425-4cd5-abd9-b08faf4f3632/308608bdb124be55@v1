# SPLICE

AI-powered Premiere Pro plugin for detecting takes, removing silences, and accelerating video editing workflows. Available in both **CEP** (legacy, Premiere Pro 14.0+) and **UXP** (modern, Premiere Pro 25.6+) versions.

## Current Status
**v5.5.0 - Mood Timeline Release** | 10-100x faster | Production ready | **786 new music tests**

### Phase 8.4 Features (v5.5.0 - Mood Timeline)

#### Mood Timeline (53 tests)
- **Per-Chapter Mood Assignment** - AI-powered chapter detection + mood analysis
  - Uses chapterDetection.js to segment video into logical chapters
  - Uses sceneAnalysis.js to detect mood/energy for each chapter
  - Mood mapping from 11 scene moods to Mureka-compatible music moods
  - Keyword extraction for content theme integration
- **Parallel Music Generation** - Generate music for all chapters with rate limiting
  - MAX_CONCURRENT_GENERATIONS: 2 parallel API calls
  - Per-chapter progress tracking
  - Builds custom prompts based on chapter title, mood, energy, keywords
  - Minimum segment duration: 15 seconds
- **FFmpeg Crossfade Assembly** - Smooth transitions between segments
  - Default crossfade: 2 seconds (configurable 0.5-5s)
  - Triangular (c1=tri, c2=tri) fade curves
  - Chain crossfades for 3+ segments
  - Automatic temp file cleanup
- **Billing** - 3 credits per timeline job (multiple generations + assembly)
  - Starter overage: $1.50/timeline
  - Pro overage: $0.90/timeline
  - Team overage: $0.60/timeline
- **API Endpoints**:
  - `POST /music/generate-timeline` - Generate per-chapter mood-matched music
  - `GET /music/timeline-options` - Get timeline generation options and presets
  - `POST /music/timeline-estimate` - Estimate generation time
- **Plugin UI**:
  - Generate Timeline button with transcript availability check
  - Timeline modal with chapter/duration estimates
  - Max chapters, min length, crossfade duration controls
  - Instrument style and custom prompt options
  - Progress panel with step indicators
  - Result panel with chapter breakdown and import/download

### Phase 8.3 Features (v5.4.0 - Music-to-Cut Alignment)

#### Music-to-Cut Alignment (100 tests)
- **Beat Detection** - FFmpeg aubio-based beat detection
  - Uses FFmpeg aubio filter for accurate beat detection
  - Fallback to silence-based detection when aubio unavailable
  - Synthetic beat generation as last resort (120 BPM assumed)
  - BPM estimation from beat intervals
- **Audio Trimming** - Trim music at nearest beat boundary
  - Target duration input with sequence duration auto-detection
  - Beat search window: +/- 3 seconds (configurable 0.5-10s)
  - Prefers beats before target to avoid cutting mid-phrase
  - Minimum output duration: 5 seconds
- **Fade Out Generation** - Smooth ending with configurable fade
  - Default fade duration: 2 seconds
  - Configurable range: 0.5-5 seconds
  - Applied at cut point for natural ending
- **Sequence Integration** - Auto-detect video duration
  - Gets current sequence duration from Premiere Pro
  - "Match Sequence" button for one-click alignment
  - Displays sequence duration in modal
- **API Endpoints**:
  - `POST /music/align` - Align music to target duration with beat-matching
  - `POST /music/analyze-beats` - Analyze beats without trimming
  - `GET /music/alignment-options` - Get alignment configuration
- **Plugin UI**:
  - Align button (âš¡) in music library items
  - Alignment modal with BPM, beat count, duration info
  - Target duration input with sequence matching
  - Fade duration slider
  - Beat align toggle checkbox
  - Download/import aligned music notification

### Phase 8.2 Features (v5.3.0 - Scene-Aware Music)

#### Scene-Aware Music Generation (68 tests)
- **Transcript Analysis** - GPT-4o-mini sentiment analysis on transcript segments
  - 30-second scene chunking for granular analysis
  - Mood detection (11 moods: happy, sad, angry, fearful, surprised, neutral, excited, calm, tense, inspirational, humorous)
  - Energy timeline extraction (0-100 scale per segment)
  - Keyword extraction for content themes
  - Confidence scoring for AI predictions
- **Enhanced Prompt Building** - Scene context enriches music generation
  - Dominant mood mapping to Mureka-compatible descriptions
  - Energy arc detection (building, declining, climactic)
  - Content theme integration from keywords
  - User preference layering on top of detected mood
- **Fallback Analysis** - Works even without API for basic sentiment
  - Keyword-based mood estimation
  - Punctuation-based energy detection (exclamation marks, questions)
  - Stop word filtering for keyword extraction
- **Billing** - 1.5 credits per scene-aware job (75% margin)
  - Starter overage: $0.75/scene-aware
  - Pro overage: $0.45/scene-aware
  - Team overage: $0.30/scene-aware
- **API Endpoints**:
  - `POST /music/generate-scene-aware` - Generate music with transcript analysis
- **Plugin UI**:
  - Scene-aware toggle checkbox
  - Transcript availability indicator
  - Scene-aware job indicator emoji (ðŸŽ¬)
- **Job Queue Updates**:
  - `ANALYZING` status for scene analysis phase
  - `isSceneAware` flag in job data
  - `sceneContext` stored in job metadata

### Phase 8.1 Features (v5.2.0 - Song Variations)

#### 3 Song Variations (100 tests)
- **Parallel Generation** - Generate 3 variations simultaneously via Mureka API
  - Version A: Original interpretation with balanced arrangement
  - Version B: More dynamic with increased energy and variation
  - Version C: More subtle and minimalist approach
- **Variation Queue Management** - BullMQ with per-variation progress tracking
  - `variationProgress: [0, 0, 0]` for individual tracking
  - `GENERATING_VARIATIONS` and `SELECTING` statuses
  - Higher priority (1) than regular jobs
- **User Selection Flow** - Interactive 3-card UI with audio previews
  - Play/pause controls for each variation
  - Side-by-side comparison
  - One-click selection to finalize
- **Billing** - 2.5 credits per variations job (79% margin)
  - Starter overage: $1.25/variations
  - Pro overage: $0.75/variations
  - Team overage: $0.50/variations
  - Partial credits + overage hybrid support
- **API Endpoints**:
  - `POST /music/generate-variations` - Start 3 variations job
  - `GET /music/variations/status/:jobId` - Get variations job status with per-variation progress
  - `POST /music/variations/:jobId/select` - Select and finalize a variation
- **Plugin UI**:
  - Generate Variations button
  - Progress panel with 3 progress bars
  - Selection UI with 3 audio previews
  - Play/pause controls per variation

### Phase 8 Features (v5.1.0 - AI Music Generation)

#### AI Music Generation (465 tests)
- **Song Identification** - ACRCloud fingerprint identification from YouTube URLs
  - Extract audio from YouTube using yt-dlp
  - Identify songs via ACRCloud API
  - Return artist, title, album, release date, genres
- **Music Generation** - AI-powered background music via Mureka API
  - 10 mood presets: upbeat, dramatic, chill, energetic, mysterious, romantic, epic, playful, melancholic, peaceful
  - 8 instrument presets: full-band, acoustic, electronic, orchestral, piano-only, guitar-only, ambient, minimal
  - 30-180 second duration range
  - Custom prompt support for fine-tuned generation
- **Job Queue System** - BullMQ + Upstash Redis for background processing
  - 6-step progress tracking: pending â†’ extracting â†’ identifying â†’ generating â†’ uploading â†’ completed
  - Retry with exponential backoff (3 attempts, 30s/60s/120s delays)
  - Automatic cleanup of jobs older than 24 hours
  - Concurrency control (2 concurrent jobs)
- **Cloud Storage** - Cloudflare R2 for generated music
  - Zero egress fees for cost efficiency
  - Signed URLs (1 hour expiry) for secure access
  - Organized storage: `{customerId}/{jobId}/master.wav`
- **Billing Integration** - Per-tier music credits
  - Starter: 5 songs/month, $0.50/overage
  - Pro: 20 songs/month, $0.30/overage
  - Team: 100 songs/month, $0.20/overage
  - Usage logging in `music_usage_log` table
- **Plugin Integration** - Full UI in music.js module
  - Song identification from YouTube URL
  - Generation request with mood/instrument/duration options
  - Music library with download/delete
  - Audio preview with timeline import
- **API Endpoints**:
  - `POST /music/identify` - Identify song from YouTube URL
  - `POST /music/generate` - Start music generation job
  - `GET /music/status/:jobId` - Get job status and progress
  - `GET /music/library` - Get user's music library
  - `GET /music/:jobId` - Get music with signed download URL
  - `DELETE /music/:jobId` - Delete music from library
  - `GET /music/credits` - Get music credit balance
  - `GET /music/moods` - Get mood presets
  - `GET /music/instruments` - Get instrument presets
  - `GET /music/queue-stats` - Get queue statistics

### Phase 7 Features (v5.0.0 - Three Major Features)

#### Animated Captions (84 tests)
- **Template System** - 5 built-in styles with word-by-word animation
  - MrBeast: Bold uppercase, shake-scale animation, color pop keywords
  - Hormozi: Clean yellow highlight bar, slide-in animation
  - Gaming: Neon glow, glitch effects, chromatic aberration
  - Corporate: Subtle fade, professional styling
  - Karaoke: Progressive word-by-word highlight fill
- **Keyword Detection** - AI-powered (GPT-4o-mini) impactful word highlighting
- **Emoji Insertion** - Context-aware emoji suggestions (low/medium/high frequency)
- **Export Formats** - MOGRT data, ASS subtitles, SRT with timing
- **API Endpoints**:
  - `POST /captions/animate` - Generate animated captions from transcript
  - `GET /captions/templates` - List available templates
  - `GET /captions/template/:id` - Get specific template details
  - `POST /captions/detect-keywords` - AI keyword detection
  - `POST /captions/insert-emojis` - Context-aware emoji insertion
  - `POST /captions/apply-template` - Apply template to existing captions
  - `POST /captions/export/mogrt` - Export MOGRT-compatible data
  - `POST /captions/export/burned` - Export for FFmpeg burn-in

#### Text-Based Editing (77 tests)
- **Editable Transcript** - Each word has unique ID linked to video timecode
- **Diff Algorithm** - LCS-based detection of deletions, insertions, reorderings
- **Delete Text = Delete Video** - Remove text to cut corresponding video
- **Search/Replace** - Find phrases with timestamps, bulk delete matches
- **Preview Changes** - See edit impact before applying
- **Undo/Redo Stack** - Full state history (50 levels)
- **Cut List Generation** - Converts text edits to v3.5 format segments
- **API Endpoints**:
  - `POST /text-edit/prepare` - Create editable transcript with word IDs
  - `POST /text-edit/apply` - Apply text edits, get operations
  - `POST /text-edit/search` - Search transcript with timestamps
  - `POST /text-edit/replace` - Search and replace (generates cuts)
  - `POST /text-edit/preview` - Preview edits without applying
  - `POST /text-edit/cut-list` - Generate cut list from operations

#### Social Reframe (76 tests)
- **Face Detection & Tracking** - Smooth position tracking with configurable smoothing
- **Aspect Ratio Presets**:
  - Portrait (9:16): TikTok, Reels, Shorts
  - Square (1:1): Instagram Feed, LinkedIn
  - Portrait (4:5): Instagram Portrait
  - Landscape (16:9): YouTube, Twitter
- **Platform Presets** - TikTok, Reels, Shorts, Instagram Feed with safe zones
- **Motion Path Generation** - Smooth interpolation with easing
- **Safe Zone Visualization** - Platform-specific UI overlay regions
- **Batch Export** - Generate all formats at once with FFmpeg filters
- **API Endpoints**:
  - `POST /reframe/analyze` - Analyze video with face tracking
  - `POST /reframe/calculate` - Calculate crop positions for aspect ratio
  - `POST /reframe/motion-path` - Generate smooth motion path
  - `POST /reframe/export` - Batch export all formats
  - `GET /reframe/platforms` - Get available platforms
  - `GET /reframe/safe-zones/:platform` - Get platform safe zones
  - `POST /faces/detect` - Detect faces in video
  - `POST /faces/track` - Track faces throughout video
  - `POST /faces/identify-speaker` - Identify primary speaker

### Phase 6 Features (v4.0.0 - CEP Migration)
- **Dual Plugin Architecture** - Both CEP and UXP versions available
  - CEP version: Premiere Pro 14.0-25.9 (wider compatibility)
  - UXP version: Premiere Pro 25.6+ (modern architecture)
- **JSX Host Script** - 800+ LOC ExtendScript for Premiere Pro integration
  - Razor operations via `qe.project` QuickEdit API
  - Sequence building with `app.project.createNewSequence()`
  - Timeline markers with `seq.markers.createMarker()`
  - Project item management with caching
- **CEP Panel** - Full-featured UI matching UXP version
  - CSInterface bridge with `jsx.evalScript()` communication
  - Same presets, options, and workflow as UXP
  - Login/license activation via modal
- **Waveform Canvas Visualization** - Real-time audio waveform display
  - `POST /waveform` endpoint with RMS analysis
  - Canvas rendering with zoom/pan controls (400x80 pixels)
  - Silence overlay visualization (red regions)
  - Click-to-seek functionality
- **Bleep Audio Synthesis** - Full profanity audio replacement
  - `POST /profanity/generate-bleeps` endpoint
  - 5 bleep types: standard (1kHz), tv, radio, duck, mute
  - WAV synthesis with sine wave generation and fade in/out
  - Parallel bleep generation for multiple segments
  - Timeline insertion via `insertBleepAudio()` builder function
- **Chapter Dividers** - Visual chapter separator generation
  - `POST /chapters/dividers` endpoint for divider data
  - 5 color schemes: blue, purple, green, orange, red
  - 3 positions: center, lower-third, top
  - Customizable duration, fade in/out, fonts
  - Builder integration: `applyChapterDividers()`, `insertChapterDividers()`
- **YouTube Content Generator** - Full metadata generation
  - `POST /youtube/description` - SEO-optimized descriptions with timestamps
  - `POST /youtube/title` - Multiple title options (engaging, SEO, professional)
  - `POST /youtube/shorts` - Shorts/TikTok/Reels metadata
  - `GET /youtube/options` - Available styles and platforms
- **E2E Test Suite** - 212 new tests added
  - cep-e2e.test.js (88), chapter-dividers.test.js (33), youtube-generator.test.js (41)

### Phase 5 Features (Implemented)
- **Performance Optimizations** - 8 key bottlenecks fixed
  - Batch processing parallelization (3x faster with 3 concurrent files)
  - Project item caching for O(1) lookups (10-50x faster for large projects)
  - Async file I/O in vocalIsolation and captionExporter (non-blocking)
  - Parallel bleep audio generation (10-50x faster profanity processing)
  - **PERF-005**: `getOrCreateUser` upsert (50% fewer DB queries for new users)
  - **PERF-008**: Auto-balance level caching (90% faster, 50sâ†’5s for 3-speaker)
- **Silence Detection RMS** - Advanced audio analysis
  - Plugin now uses `/silences-rms` endpoint (was `/silences-audio`)
  - Advanced RMS-based audio analysis with auto-threshold detection
  - 30-second chunked processing for long files (memory efficient)
  - Sensitivity 0-100 slider mapped to proper detection parameters
- **Security Fixes** - Auth issues resolved
  - `/process-xml` endpoint now requires authentication
  - Plugin uses `getAuthHeaders()` for XML processing requests
- **Test Improvements** - Fixed stale version test, 780+ tests passing
- **License Key Flow** - Complete email-based license lookup
  - POST `/license/lookup` endpoint for email-based key retrieval
  - Plugin login modal with email lookup UI
  - Stripe customer lookup integration

### Phase 4 Features (Implemented)
- **Workflow Integration** - Auto Zoom and Chapter Detection now run automatically in GO workflow
  - Zoom/chapter generation triggers after transcription if enabled
  - Parallel execution for performance
  - Graceful error handling (doesn't break workflow if one fails)
- **E2E Test Suite** - 64 comprehensive integration tests for Phase 3 features
  - Validates workflow integration, UI wiring, builder integration
  - Tests state management, API endpoints, error handling
- **UI Polish** - Chapter count display, consistent styling with zoom panel
- **Code Quality** - Removed unnecessary promise padding, optimized Phase 3 promise handling

### Phase 3 Features (Implemented)
- **Auto Zoom** - Automatic zoom animations at emphasis points (sentence starts, keywords)
  - Frequency settings: Low (~1/min), Medium (~2/min), High (~4/min)
  - Intensity presets: Subtle (110%), Medium (120%), Dramatic (140%)
  - Placement strategies: Sentence starts, Keywords, Random
  - Creates markers for manual MOGRT application
- **Chapter Detection** - AI-powered topic segmentation using GPT-4o-mini
  - YouTube timestamp format export (copy to clipboard)
  - Timeline marker creation with color coding
  - Configurable max chapters and minimum length
  - Fallback gap-based detection (no AI required)

### Phase 2 Features (Implemented)
- **Multitrack UI Panel** - Collapsible section with speaker configuration, track mapping, parameter sliders
- **Speaker Configuration** - Add/remove speakers (2-4), name editing, video track assignment per speaker
- **Distribution Chart** - Visual speaker time distribution bar with percentages, color-coded by speaker
- **Decision List** - Scrollable list of switching decisions with seek-to-time functionality
- **Auto-Balance** - One-click speaker screentime balancing with deviation display
- **Wide Shot Support** - Configurable wide shot track and target percentage

### Phase 1 Features (Implemented)
- **Takes Labeling & Color Coding** - Take numbering (Take 1, Take 2, etc.), short labels from transcript, color hints
- **J-Cut Basic Support** - Enable/disable toggle, lead-in/lead-out sliders, API integration
- **UI Infrastructure** - Presets include J-Cut settings, Podcast/Interview/Tutorial enable J-Cut by default

## Codebase Overview
| Component | Lines of Code | Files |
|-----------|--------------|-------|
| Backend Server | 3,700 | server.js |
| Backend Services | 12,150 | 30 service files |
| Backend Workers | 250 | 1 worker file |
| Backend Migrations | 100 | 1 migration file |
| UXP Plugin | 8,100 | 22 files |
| CEP Plugin | 2,400 | 8 files |
| Tests | 11,550+ | 49 test files |
| **Total** | **~38,200** | **109+ files** |

## Quick Reference

### Pricing Tiers
| Tier | Price | Hours | Isolation | Music Credits | Stripe Price ID |
|------|-------|-------|-----------|---------------|-----------------|
| Starter | $19/mo | 12 hrs | None | 5 songs | price_1SgH4m2L5BseYEbCih347qfr |
| Pro | $49/mo | 30 hrs | 45 min included | 20 songs | price_1SgH4o2L5BseYEbCIoR19lhQ |
| Team | $149/mo | 100 hrs | 3 hrs included | 100 songs | price_1SgH4q2L5BseYEbCYTlimb5M |
| Overage | $1/hr | - | $0.10/min | $0.50-0.20/song | price_1SgH4y2L5BseYEbClZuxNRu8 |

### Key Constraints
- **CEP version**: Premiere Pro 14.0-25.9 (wider compatibility)
- **UXP version**: Premiere Pro 25.6+ (modern architecture)
- Use `127.0.0.1` not `localhost` in fetch URLs
- Backend (prod): https://splice-api-production.up.railway.app
- Backend (dev): https://127.0.0.1:3847

---

## Architecture Overview

### Backend Services (25 files, 10,450+ LOC)

| File | Lines | Purpose |
|------|-------|---------|
| `transcription.js` | 210 | Unified Whisper (words+segments in 1 call), LRU cache, retry |
| `cutListGenerator.js` | 421 | v3.5 JSON cut list with frame alignment |
| `usageTracking.js` | 850+ | PostgreSQL billing, credits, webhooks, atomic reservation, music credits |
| `rmsSilenceDetection.js` | 555 | RMS audio analysis, auto-threshold |
| `profanityDetection.js` | 562 | Multi-language (en/es/fr/de), blocklist |
| `repetitionDetection.js` | 625 | Phrase + stutter detection |
| `multitrackAnalysis.js` | 725 | Multicam speaker analysis + balancing |
| `captionExporter.js` | 273 | SRT/VTT/TXT/JSON export |
| `vocalIsolation.js` | 260 | Replicate Demucs integration |
| `licenseService.js` | 330+ | License key generation, activation with row locking, validation |
| `takeDetection.js` | 106 | GPT-4o-mini take detection |
| `silenceDetection.js` | 46 | Whisper gap-based detection |
| `ffprobeSilence.js` | 149 | FFprobe audio silence detection |
| `xmlProcessor.js` | 513 | FCP XML processing (legacy) |
| `zoomGenerator.js` | 280 | Auto-zoom emphasis points, keyframe generation (Phase 3) |
| `chapterDetection.js` | 420 | AI chapter detection, YouTube timestamps, dividers (Phase 3+6) |
| `youtubeGenerator.js` | 450 | Video description, title, shorts metadata (Phase 6) |
| `animatedCaptions.js` | 550+ | Template system, keyword detection, emoji insertion (Phase 7) |
| `textBasedEditing.js` | 600+ | LCS diff, editable transcript, cut list generation (Phase 7) |
| `faceDetection.js` | 450+ | Face detection/tracking, speaker identification (Phase 7) |
| `socialReframe.js` | 450+ | Social reframe, platform presets, motion path (Phase 7) |
| `r2Storage.js` | 180+ | Cloudflare R2 storage, signed URLs, lazy S3 client (Phase 8) |
| `musicQueue.js` | 220+ | BullMQ job queue, status tracking, progress mapping (Phase 8) |
| `songIdentification.js` | 250+ | ACRCloud integration, yt-dlp extraction, YouTube URL validation (Phase 8) |
| `musicGeneration.js` | 350+ | Mureka API, mood/instrument presets, polling, audio processing (Phase 8) |
| `sceneAnalysis.js` | 400+ | GPT-4o-mini scene analysis, energy timeline, mood detection (Phase 8.2) |
| `musicAlignment.js` | 450+ | Beat detection, audio trimming, fade out, crossfade (Phase 8.3) |
| `musicTimeline.js` | 450+ | Per-chapter mood music, FFmpeg crossfade assembly (Phase 8.4) |

### UXP Plugin Modules (19 files, 6,100+ LOC)

| File | Lines | Purpose |
|------|-------|---------|
| `main.js` | 1,500+ | Workflow orchestration, preview, markers, presets UI |
| `builder.js` | 503 | v3.5 Direct DOM sequence building |
| `multitrack.js` | 500+ | Multitrack UI, speaker config, distribution chart, decision list |
| `settings.js` | 700+ | Custom presets CRUD, duplicate, export/import, localStorage |
| `credits.js` | 198 | Credit balance, tier display |
| `slice8-silence.js` | 153 | Silence removal from timeline |
| `slice9-razor.js` | 260 | XML razor workflow (legacy) |
| `slice7-apply.js` | 204 | Apply takes to timeline |
| `slice6-analyze.js` | 51 | Takes data storage |
| `config.js` | 200+ | Constants, getBackendUrl(), fetchWithTimeout(), parseErrorResponse(), offline detection |
| `utils.js` | 40 | Shared utilities (formatTime, setStatus, getActiveSequence) |
| `animatedCaptions.js` | 500+ | Caption template UI, preview, export, timeline apply (Phase 7) |
| `textEditor.js` | 550+ | Text-based editing UI, undo/redo, search, preview (Phase 7) |
| `socialReframe.js` | 550+ | Social reframe UI, platform presets, safe zone overlay (Phase 7) |
| `music.js` | 500+ | Music generation UI, song ID, library, audio preview, timeline import (Phase 8) |

### CEP Plugin Modules (8 files, 2,400+ LOC)

| File | Lines | Purpose |
|------|-------|---------|
| `jsx/hostScript.jsx` | 800+ | ExtendScript host with all Premiere Pro APIs |
| `panel/js/main.js` | 700+ | Workflow orchestration, preview, modals |
| `panel/js/builder.js` | 450+ | Cut list processing, markers, razor via JSX |
| `panel/js/config.js` | 300+ | JSX bridge, backend config, auth headers |
| `panel/js/CSInterface.js` | 100 | CEP interface wrapper |
| `panel/index.html` | 255 | Panel UI with options, preview, modals |
| `panel/css/style.css` | 685 | Dark theme matching Premiere Pro |
| `CSXS/manifest.xml` | 40 | CEP extension manifest |

---

## Complete API Endpoints (30+)

### Core Endpoints
| Method | Endpoint | Purpose |
|--------|----------|---------|
| GET | `/` | API metadata |
| GET | `/health` | Health check |
| GET | `/ffprobe-check` | FFprobe availability |
| GET | `/replicate-check` | Replicate API status |

### Audio Analysis
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/analyze` | Transcription + take detection |
| POST | `/silences` | Silence detection (transcript gaps) |
| POST | `/silences-audio` | Silence detection (FFprobe) |
| POST | `/silences-rms` | Silence detection (RMS analysis) |
| POST | `/isolate-vocals` | Vocal isolation (Replicate) |

### Detection Endpoints
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/profanity` | Profanity detection |
| POST | `/profanity/generate-bleeps` | Generate bleep audio WAV files |
| GET | `/profanity/languages` | Supported languages |
| GET | `/profanity/bleeps` | Available bleep sounds |
| GET | `/profanity/list/:lang` | Language profanity list |
| POST | `/repetitions` | Phrase repetition detection |
| POST | `/stutters` | Single-word stutter detection |
| POST | `/fillers` | Filler word detection |
| POST | `/waveform` | Get waveform data for canvas visualization |

### Export Endpoints
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/export/captions` | Export SRT/VTT/TXT/JSON |
| GET | `/export/formats` | List export formats |
| POST | `/cut-list` | Generate v3.5 cut list |
| POST | `/cut-list/takes` | Generate takes-only cut list |

### Zoom & Chapters (Phase 3)
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/zoom` | Generate zoom points from transcript |
| GET | `/zoom/presets` | Get available zoom presets and frequencies |
| POST | `/chapters` | Detect chapters using AI (GPT-4o-mini) |
| POST | `/chapters/fallback` | Detect chapters without AI (gap-based) |
| POST | `/chapters/dividers` | Generate chapter divider data for timeline |
| GET | `/chapters/dividers/presets` | Get divider styles and color schemes |

### YouTube Content (Phase 6)
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/youtube/description` | Generate SEO-optimized video description |
| POST | `/youtube/title` | Generate multiple title options |
| POST | `/youtube/shorts` | Generate Shorts/TikTok/Reels metadata |
| GET | `/youtube/options` | Get available styles and platforms |

### Multitrack/Multicam
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/multitrack` | Multi-speaker analysis |
| POST | `/multitrack/auto-balance` | Auto-balance screentime |

### AI Music Generation (Phase 8)
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/music/identify` | Identify song from YouTube URL |
| POST | `/music/generate` | Start music generation job |
| POST | `/music/generate-scene-aware` | Generate with transcript analysis |
| GET | `/music/status/:jobId` | Get job status and progress |
| GET | `/music/library` | Get user's music library |
| GET | `/music/:jobId` | Get music with signed download URL |
| DELETE | `/music/:jobId` | Delete music from library |
| GET | `/music/credits` | Get music credit balance |
| GET | `/music/moods` | Get mood presets |
| GET | `/music/instruments` | Get instrument presets |
| GET | `/music/queue-stats` | Get queue statistics (admin)
| POST | `/music/align` | Align music to target duration with beat-matching |
| POST | `/music/analyze-beats` | Analyze beats in audio without trimming |
| GET | `/music/alignment-options` | Get alignment configuration options |
| POST | `/music/generate-timeline` | Generate per-chapter mood-matched music |
| GET | `/music/timeline-options` | Get timeline generation options |
| POST | `/music/timeline-estimate` | Estimate timeline generation time |

### Batch Processing
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/batch/silences` | Batch silence detection |
| GET | `/batch/status/:id` | Job status |
| GET | `/batch/results/:id` | Job results |
| GET | `/batch/jobs` | List all jobs |
| DELETE | `/batch/:jobId` | Delete job |

### Billing
| Method | Endpoint | Purpose |
|--------|----------|---------|
| GET | `/credits` | Credit balance |
| GET | `/usage-history` | Usage history |
| POST | `/webhooks/stripe` | Stripe webhooks |

### License Key
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/license/activate` | Activate license key |
| GET | `/license/key` | Get license key for customer |
| POST | `/license/resend` | Resend license key to customer email |
| POST | `/license/lookup` | Look up license key by email address |

### Legacy
| Method | Endpoint | Purpose |
|--------|----------|---------|
| POST | `/process-xml` | FCP XML processing (deprecated) |

---

## v3.5 Architecture (Zero-Manual-Step Workflow)

### Pipeline
1. User clicks GO â†’ Detect silences + takes
2. Backend generates JSON cut list via `/cut-list`
3. Plugin builds sequence via `builder.js` using DOM APIs
4. New sequence created with `_SPLICE` suffix

### Key UXP APIs Used
```javascript
// Sequence Building
TickTime.createWithSeconds(seconds)          // Time conversion
SequenceEditor.getEditor(sequence)           // Editor instance
editor.createInsertProjectItemAction()       // Insert clips
sequence.createCloneAction()                 // Clone sequence
sequence.createSetNameAction(name)           // Rename

// Track Item Manipulation
TrackItem.createSetInPointAction(time)       // Set in-point
TrackItem.createSetOutPointAction(time)      // Set out-point
ProjectItem.createSetColorLabelAction(idx)   // Color coding

// Transaction
project.executeTransaction(callback)         // Atomic batch

// File Access
uxpFs.createPersistentToken(folder)          // Silent access
uxpFs.getEntryForPersistentToken(token)      // Restore folder
```

### Key CEP/JSX APIs Used
```javascript
// CEP-JSX Communication
csInterface.evalScript(script, callback)     // Execute JSX from panel
jsx.call('funcName', arg1, arg2)             // Promise-based wrapper

// JSX Host Script - Sequence Operations
app.project.activeSequence                   // Get active sequence
app.project.createNewSequence(name, id)      // Create sequence
seq.clone()                                  // Clone sequence
qe.project.getActiveSequence().razor(frames) // Razor at frames

// JSX Host Script - Timeline Manipulation
seq.videoTracks[i].clips[j]                  // Access clip
clip.start = new Time()                      // Set in-point (ticks)
clip.end = new Time()                        // Set out-point (ticks)
clip.setColorLabel(colorIndex)               // Color coding (0-16)

// JSX Host Script - Markers
seq.markers.createMarker(timeSeconds)        // Create marker
marker.name = 'SPLICE: Silence'              // Set name
marker.comments = 'Duration: 2.5s'           // Set comments

// JSX Host Script - Project Items
app.project.rootItem.children                // Get project items
item.getMediaPath()                          // Get file path
item.treePath                                // Get project bin path

// Time Conversion
var TICKS_PER_SECOND = 254016000000;         // Premiere Pro time unit
var ticks = seconds * TICKS_PER_SECOND;      // Convert to ticks
```

### Cut List Format (v3.6)
```json
{
  "version": "3.5",
  "source": { "name": "...", "path": "...", "duration": 300 },
  "segments": [
    {
      "type": "speech|silence|best_take|take",
      "sourceName": "...",
      "sourcePath": "...",
      "inPoint": 0.0,
      "outPoint": 10.5,
      "takeNumber": 1,
      "takeLabel": "Take 1: Hello world...",
      "colorHint": "cerulean",
      "audioInOffset": -0.3,
      "audioOutOffset": 0.2
    }
  ],
  "metadata": {
    "silencesRemoved": 10,
    "takesDetected": 3,
    "takesLabeled": true,
    "colorCoded": true,
    "frameRate": 30,
    "frameAligned": true,
    "jCutOffset": -0.3,
    "lCutOffset": 0.2,
    "hasAudioOffsets": true
  }
}
```

---

## Performance Benchmarks

| Operation | Time | Notes |
|-----------|------|-------|
| 10 cuts | ~50ms | DOM API batch transactions |
| 100 cuts | ~200ms | 25x faster than legacy JSX |
| 1000 cuts | ~2s | Scales linearly |
| Stutter detection (1000 words) | <1ms | Optimized Levenshtein |
| Batch processing (10 files) | ~3s | 3 concurrent files |
| Project item lookup (100 items) | O(1) | Cached after first build |
| Auto-balance (3 speakers) | ~5s | Level caching enabled |

**Why fast:** DOM API batch transactions, project item caching, parallel processing

### Phase 5 Performance Optimizations (v3.9.1)
- **Batch parallelism** - Process 3 files concurrently (3x faster batch jobs)
- **Project item cache** - O(1) lookups after initial cache build
- **Async file I/O** - Non-blocking reads/writes in vocalIsolation & captionExporter
- **Parallel bleep generation** - All profanity bleeps generated simultaneously
- **PERF-005: getOrCreateUser upsert** - Single INSERT...ON CONFLICT instead of SELECT+INSERT (50% fewer queries)
- **PERF-008: Auto-balance level caching** - Extract audio levels once, reuse in optimization loop (90% faster)

---

## Preset Profiles (v3.6)

| Preset | Sensitivity | Min Silence | J-Cut | Use Case |
|--------|-------------|-------------|-------|----------|
| `podcast` | 35 | 0.8s | âœ“ (0.3s/0.2s) | Natural pauses, conversational |
| `interview` | 50 | 0.5s | âœ“ (0.25s/0.15s) | Balanced Q&A rhythm, smooth transitions |
| `reaction` | 70 | 0.3s | âœ— | Fast-paced, tight cuts |
| `tutorial` | 30 | 1.0s | âœ“ (0.35s/0.25s) | Preserve teaching pace |
| `vlog` | 65 | 0.35s | âœ— | Punchy YouTube edits |
| `custom` | - | - | - | User-defined settings |

---

## Test Coverage

**Status: 2114+ tests, 85% coverage, 100% pass rate**

| File | Tests | Coverage |
|------|-------|----------|
| `music-variations-e2e.test.js` | 100 | Parallel variations, selection UI, billing integration (Phase 8.1) |
| `music-phase0-e2e.test.js` | 67 | R2 storage, BullMQ queue, database schema (Phase 8) |
| `music-phase1-e2e.test.js` | 71 | ACRCloud integration, YouTube extraction (Phase 8) |
| `music-phase2-e2e.test.js` | 83 | Mureka API, mood/instrument presets (Phase 8) |
| `music-phase3-e2e.test.js` | 101 | Plugin integration, music UI module (Phase 8) |
| `music-phase4-e2e.test.js` | 62 | Billing integration, music credits (Phase 8) |
| `music-final-e2e.test.js` | 81 | Comprehensive music feature integration (Phase 8) |
| `scene-aware-music.test.js` | 68 | Scene analysis, energy timeline, mood detection, billing (Phase 8.2) |
| `music-alignment-e2e.test.js` | 100 | Beat detection, audio trimming, fade out, crossfade (Phase 8.3) |
| `music-timeline-e2e.test.js` | 53 | Per-chapter mood music, FFmpeg crossfade, timeline API (Phase 8.4) |
| `animated-captions.test.js` | 84 | Caption templates, animations, keywords, emojis, export (Phase 7) |
| `text-based-editing.test.js` | 77 | LCS diff, word IDs, search/replace, cut list generation (Phase 7) |
| `social-reframe.test.js` | 76 | Face detection, tracking, platform presets, safe zones (Phase 7) |
| `cep-e2e.test.js` | 88 | CEP plugin structure, JSX host, panel JS, HTML, CSS, builder |
| `chapter-dividers.test.js` | 33 | Divider generation, API endpoints, builder integration |
| `youtube-generator.test.js` | 41 | Description, title, shorts generation, text extraction |
| `waveform.test.js` | 41 | Waveform UI, canvas rendering, zoom/pan, silence overlay |
| `bleep-insertion.test.js` | 20 | WAV synthesis, parallel generation, timeline insertion |
| `custom-presets.test.js` | 83 | CRUD, duplicate, settings, export/import |
| `ui-e2e-comprehensive.test.js` | 33 | UI wiring, workflows, edge cases, performance |
| `phase4-production.test.js` | 42 | Auth, headers, rate limiting, usage deduction, error messages |
| `phase4-e2e-integration.test.js` | 64 | Zoom/chapter workflow integration, UI wiring, builder, state (Phase 4 v3.8.1) |
| `phase5-e2e.test.js` | 9 | Captions, batch, presets, retry, cache |
| `phase6-license.test.js` | 44 | License key generation, activation, validation, API |
| `phase1-concurrency.test.js` | 14 | Atomic credit reservation, license delivery, row locking |
| `phase1-e2e.test.js` | 25 | UXP compatibility: confirm modal, file API, event delegation |
| `phase2-code-quality.test.js` | 36 | Static: URL config, duplicate functions, fetch timeout, error parsing |
| `phase2-runtime.test.js` | 14 | Runtime: API calls, timeouts, error handling, concurrency |
| `phase2-multitrack.test.js` | 71 | Multitrack UI, speaker config, distribution chart, API integration (Phase 2 v3.7) |
| `phase3-performance.test.js` | 28 | Levenshtein optimization, array spread fix, DB RETURNING, cache TTL, PERF-005/008 |
| `phase3-zoom-chapters.test.js` | 44 | Zoom generator, chapter detection, UI/builder integration (Phase 3 v3.8) |
| `stutter-detection.test.js` | 36 | Stutter detection service, runtime tests, options, filler words |
| `profanity-custom-lists.test.js` | 30 | Custom blocklist/allowlist UI, bleep types, settings |
| `repetition-highlighting.test.js` | 39 | Color-coded phrase highlighting, seek handlers, legend |
| `transcription-e2e.test.js` | 5 | Transcription, profanity, repetition |
| `batch-auth.test.js` | 11 | Batch endpoint customer ownership verification |
| `cut-list-auth.test.js` | 8 | Cut-list endpoint auth middleware |
| `credits-badge-error.test.js` | 12 | Credits badge error/login states, retry UI |
| `offline-detection.test.js` | 19 | Offline detection, UI updates, GO button blocking |
| `credits-cache-logout.test.js` | 9 | Credits cache clearing on logout |
| `builder-uxp-runtime.test.js` | 31 | Builder UXP API usage, fallbacks, transactions |
| `final-e2e.test.js` | 45 | Comprehensive all-features verification, RMS silence detection wiring |
| `phase1-takes-labeling.test.js` | 36 | Take numbering, short labels, color hints (Phase 1 v3.6) |
| `phase1-jcut.test.js` | 37 | J-Cut UI, API integration, builder audio offsets (Phase 1 v3.6) |
| `phase1-ui-infrastructure.test.js` | 25 | Preset J-Cut settings, UI state management (Phase 1 v3.6) |
| `phase1-complete.test.js` | - | Runs all Phase 1 tests + integration tests (188 total) |

**Gaps:** No unit tests for services, no CI/CD integration

---

## Implementation Status

### E2E Fixes (SPLICE_E2E_FIXES.md)

| Phase | Status | Notes |
|-------|--------|-------|
| Phase 1 (UI Critical) | âœ… DONE | confirm modal, UXP file API, event delegation, file picker |
| Phase 2 (Code Quality) | âœ… DONE | getBackendUrl(), no duplicates, fetchWithTimeout(), parseErrorResponse() |
| Phase 3 (Performance) | âœ… DONE | Levenshtein O(n), array spread fix, DB RETURNING, cache TTL |
| Phase 4.1 (Hardcoded Paths) | âœ… DONE | `config.js:43-84` dynamic paths; `slice9-razor.js` hardcoded is intentional for legacy XML |
| Phase 4.2 (ARIA Labels) | âœ… DONE | 20+ aria-labels, role="dialog", aria-live implemented |
| Phase 4.3 (ProjectItemType) | âœ… DONE | Fallback in `builder.js:19-32` |
| Phase 5 (Final Verify) | âŒ NOT DONE | Manual Premiere Pro 25.6+ testing required |

### Security/Revenue Phases (phases.md)

| Phase | Status | Critical Gaps |
|-------|--------|---------------|
| Phase 1 (Concurrency) | âœ… DONE | Atomic credit reservation, license delivery, row locking |
| Phase 2 (API Auth) | âœ… DONE | Batch endpoints customer verification, `/cut-list` protected |
| Phase 3 (Profit Margin) | âœ… DONE | Using Whisper-1 (correct for audio transcription) |
| Phase 4 (UX) | âœ… DONE | Error messages, offline detection, credits badge error state |
| Phase 5 (E2E Wiring) | âœ… DONE | Webhook idempotency, credits cache on logout |
| Phase 6 (Final Test) | âœ… DONE | 40 E2E tests pass, all phases verified |

### Completed Features

| Feature | Status | Evidence |
|---------|--------|----------|
| Webhook signature validation | DONE | `server.js:126-143` - Rejects unsigned webhooks in production |
| Frame alignment | DONE | `cutListGenerator.js:21-48` - Floor/ceil/round variants |
| Batch job cleanup | DONE | `server.js:1460-1498` - Auto-cleanup every hour, 24hr expiry |
| Build Sequence button | DONE | `index.html:805`, `main.js:793-843` - Wired with basic error handling |
| Preset definitions | DONE | `settings.js:31-207` - 6 presets with apply/get functions |
| Atomic credit reservation | DONE | `usageTracking.js:198-424` - SELECT...FOR UPDATE prevents race conditions |
| License key delivery | DONE | `server.js:184-241` - Retry mechanism, Stripe metadata storage |
| License activation row locking | DONE | `licenseService.js:179-259` - Transaction with FOR UPDATE |
| License key resend endpoint | DONE | `server.js:2193-2265` - POST `/license/resend` for support |
| UXP confirm() replacement | DONE | `main.js:110-208` - Custom modal replaces browser confirm() |
| UXP file import API | DONE | `main.js:2365-2406` - Uses getFileForOpening() instead of FileReader |
| Batch event delegation | DONE | `main.js:1695-1707` - No inline onclick, uses data-index |
| Hidden file input removed | DONE | `index.html` - Uses UXP file picker directly |
| Centralized URL config | DONE | `config.js:14-26` - getBackendUrl() used across all files |
| Fetch timeout support | DONE | `config.js:51-69` - fetchWithTimeout() with AbortController |
| Standardized error parsing | DONE | `config.js:77-84` - parseErrorResponse() handles all formats |
| No duplicate functions | DONE | formatTime in utils.js, showRazorSection in slice9-razor.js |
| ARIA accessibility | DONE | `index.html` - 20+ aria-labels, role="dialog", aria-live |
| ProjectItemType fallback | DONE | `builder.js:19-32` - Safe fallback when Constants undefined |

### Production Blockers (COMPLETE)

| Issue | Status | Evidence |
|-------|--------|----------|
| Rate limiting | DONE | All 8 endpoints have `requireCredits()` middleware |
| Auth headers | DONE | `getAuthHeaders()` in `main.js:1371-1378`, used in all fetch calls |
| Build Sequence errors | DONE | `formatBuildError()` in `main.js:1110-1136` - user-friendly messages |
| Login/Auth UI | DONE | `initLoginModal()` in `settings.js:1180-1251` - wired to credit badge |
| Usage deduction | DONE | All 11 audio endpoints + batch call `req.deductUsage()` after processing |

### Remaining Work (Priority Order)

| Feature | Status | Effort | Notes |
|---------|--------|--------|-------|
| Premiere Pro 25.6+ runtime testing | âš ï¸ PARTIAL | 2 hrs | Static tests done; needs manual runtime verification |

### Recently Completed (v3.5.1 Security & UX Release)

| Feature | Status | Evidence |
|---------|--------|----------|
| Batch endpoints auth | âœ… DONE | `server.js:1831-1962` - Customer ownership verification on all 4 batch endpoints |
| `/cut-list` auth | âœ… DONE | `server.js:1389,1450` - `requireCredits()` middleware on both endpoints |
| Offline detection | âœ… DONE | `config.js:215-332` - `isOnline()`, `initOfflineDetection()`, `updateOfflineUI()` |
| Credits badge error state | âœ… DONE | `credits.js:68-122` - Error/login states with retry UI, CSS in `index.html:77-94` |
| Credits cache on logout | âœ… DONE | `credits.js:68-77` - `clearCreditsCache()` called from `settings.js:1346` |
| Builder UXP runtime tests | âœ… DONE | `tests/builder-uxp-runtime.test.js` - 31 static tests verify API usage |
| Batch processing UI | âœ… DONE | `index.html:942-965`, `main.js:1645-1875` - Full queue, progress, polling |
| Builder static tests | âœ… DONE | `tests/builder-uxp-runtime.test.js` - ProjectItemType/TrackItemType fallbacks |
| J-cut/L-cut support | âœ… DONE | `builder.js:244-253` - Audio offset handling in segment processing |

### Remaining Enhancements (Medium Priority)

| Feature | Status | Effort | Notes |
|---------|--------|--------|-------|
| Frame alignment | DONE | - | Fully implemented |
| Chunked audio (30s) | DONE | - | RMS detection handles automatically |
| Bleep sound insertion | PARTIAL | 4 hrs | Metadata only, no audio synthesis |
| Wide shot randomization | PARTIAL | 2 hrs | Deterministic only, no random insertion |

---

## Key Features

1. **Caption Export** - SRT/VTT/TXT/JSON
2. **Batch Processing** - Multi-file queue with progress
3. **Custom Presets** - Create, duplicate, edit settings, export/import JSON
4. **API Retry Logic** - Exponential backoff
5. **Filler Word Detection** - Fully featured
6. **Multiple Silence Detection** - RMS, FFprobe, Whisper methods
7. **Vocal Isolation** - AI-powered (Pro+ tier)
8. **DOM API Builder** - Fast sequence building

### Custom Presets API (settings.js)
```javascript
// CRUD operations
createCustomPreset({ name, description?, icon?, settings? }) â†’ { success, id }
updateCustomPreset(id, { name?, description?, icon?, settings? }) â†’ { success }
deleteCustomPreset(id) â†’ { success }

// Duplicate (copies settings, adds "(Copy)" suffix)
duplicatePreset(id) â†’ { success, id }

// Query
getPresetById(id) â†’ preset object with isBuiltIn flag
getAllPresets() â†’ array of built-in + custom presets
isBuiltInPreset(id) â†’ boolean

// Export/Import
exportPresets() â†’ { success, data: JSON string, count }
importPresets(jsonString, merge = true) â†’ { success, imported, skipped }
```

---

## Key Files Reference

| Category | Path |
|----------|------|
| Backend entry | `splice-backend/server.js` |
| Services | `splice-backend/services/` |
| Tests | `splice-backend/tests/` |
| **UXP Plugin** | |
| Plugin entry | `splice-plugin/index.html` |
| Plugin JS | `splice-plugin/js/` |
| Manifest | `splice-plugin/manifest.json` |
| **CEP Plugin** | |
| Panel entry | `splice-cep/panel/index.html` |
| Panel JS | `splice-cep/panel/js/` |
| Panel CSS | `splice-cep/panel/css/style.css` |
| JSX Host | `splice-cep/jsx/hostScript.jsx` |
| Manifest | `splice-cep/CSXS/manifest.xml` |
| CEP Tests | `splice-cep/tests/cep-e2e.test.js` |

---

## Quick Commands
```bash
# Start server
cd /Users/imorgado/SPLICE/splice-backend && node server.js

# Health check
curl -sk https://127.0.0.1:3847/health

# Run backend tests
node tests/phase5-e2e.test.js

# Run CEP E2E tests
node splice-cep/tests/cep-e2e.test.js

# Check logs
tail -f /tmp/splice-server.log

# Install CEP extension (macOS)
ln -s /Users/imorgado/SPLICE/splice-cep ~/Library/Application\ Support/Adobe/CEP/extensions/com.splice.panel
```

---

## Environment Variables

| Variable | Purpose |
|----------|---------|
| `OPENAI_API_KEY` | GPT-4o-mini + Whisper |
| `REPLICATE_API_TOKEN` | Vocal isolation |
| `STRIPE_SECRET_KEY` | Billing |
| `STRIPE_WEBHOOK_SECRET` | Webhook verification |
| `STRIPE_PRICE_STARTER` | Starter tier price ID |
| `STRIPE_PRICE_PRO` | Pro tier price ID |
| `STRIPE_PRICE_TEAM` | Team tier price ID |
| `DATABASE_URL` | PostgreSQL connection |
| `PORT` | Server port (default: 3847) |
| `NODE_ENV` | production/development |
| `R2_ACCOUNT_ID` | Cloudflare R2 account ID |
| `R2_ACCESS_KEY_ID` | Cloudflare R2 access key |
| `R2_SECRET_ACCESS_KEY` | Cloudflare R2 secret key |
| `R2_BUCKET_NAME` | Cloudflare R2 bucket name |
| `UPSTASH_REDIS_URL` | Upstash Redis connection URL |
| `ACRCLOUD_ACCESS_KEY` | ACRCloud API access key |
| `ACRCLOUD_ACCESS_SECRET` | ACRCloud API secret |
| `ACRCLOUD_HOST` | ACRCloud API host |
| `MUREKA_API_KEY` | Mureka AI music generation API key |

---

*Last updated: 2025-12-26 (v5.5.0 Mood Timeline Release - Per-chapter mood music, FFmpeg crossfade assembly, chapter detection integration, 2114+ tests, 100% pass rate)*
