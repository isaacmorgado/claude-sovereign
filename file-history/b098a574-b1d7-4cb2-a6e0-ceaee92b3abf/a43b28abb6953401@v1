"use client";

import { motion } from "framer-motion";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import {
  ArrowLeft,
  ArrowRight,
  HelpCircle,
  AlertTriangle,
  CheckCircle,
  Download,
  Key,
  CreditCard,
  Volume2,
  Settings,
  Monitor,
  Zap,
  Mail,
  MessageCircle,
} from "lucide-react";
import Link from "next/link";
import { Header } from "@/components/landing/Header";
import { Footer } from "@/components/landing/Footer";

interface FAQItem {
  question: string;
  answer: string;
}

interface FAQCategory {
  title: string;
  icon: React.ComponentType<{ className?: string }>;
  items: FAQItem[];
}

const faqCategories: FAQCategory[] = [
  {
    title: "Getting Started",
    icon: Download,
    items: [
      {
        question: "Which version should I download: UXP or CEP?",
        answer: "If you have Premiere Pro 25.6 or newer, download the UXP version (recommended). It offers better performance and stability. For Premiere Pro 14.0-25.9, use the CEP version. Both versions have identical features.",
      },
      {
        question: "Do I need to enable anything special for the plugin to work?",
        answer: "For UXP, you need Adobe's UXP Developer Tool to load the plugin. For CEP, you need to enable unsigned extensions by running 'defaults write com.adobe.CSXS.11 PlayerDebugMode 1' in Terminal (Mac) or adding a registry key (Windows). Restart Premiere Pro after making changes.",
      },
      {
        question: "The plugin doesn't appear in Window > Extensions. What do I do?",
        answer: "First, ensure you've restarted Premiere Pro completely (not just the project). For CEP, verify you've enabled PlayerDebugMode and copied files to the correct extensions folder. For UXP, ensure the plugin is loaded via UXP Developer Tool.",
      },
      {
        question: "How do I update to a new version?",
        answer: "Download the latest version from the download page. For UXP, reload the plugin in UXP Developer Tool. For CEP, replace the files in your extensions folder and restart Premiere Pro.",
      },
    ],
  },
  {
    title: "License & Billing",
    icon: Key,
    items: [
      {
        question: "How do I activate my license?",
        answer: "Open SPLICE from Window > Extensions > SPLICE. Click the settings icon (gear) in the top right, then click 'Activate License'. Enter your license key and click Activate. Your license is activated instantly.",
      },
      {
        question: "Can I use my license on multiple computers?",
        answer: "Yes! Your license can be activated on up to 2 computers simultaneously. To deactivate a computer, contact support@splice.app.",
      },
      {
        question: "What happens if I exceed my monthly hours?",
        answer: "You can continue using SPLICE with overage charges at $1/hour. Overages are billed at the end of your billing cycle. You'll see a warning when you're approaching your limit.",
      },
      {
        question: "How do I cancel my subscription?",
        answer: "Log in to your account at splice.app/account and click 'Cancel Subscription'. Your access continues until the end of your billing period. Contact support if you need assistance.",
      },
      {
        question: "I lost my license key. How do I recover it?",
        answer: "Visit splice.app/recover or use the 'Forgot License Key' option in the plugin. Enter the email you used to purchase, and we'll send your key immediately.",
      },
    ],
  },
  {
    title: "Silence Detection",
    icon: Volume2,
    items: [
      {
        question: "SPLICE is removing too much. How do I adjust?",
        answer: "Lower the sensitivity slider (30-40 is good for podcasts). Also increase the 'Minimum Silence Duration' to only remove longer pauses. Try the 'Podcast' or 'Tutorial' presets for more conservative removal.",
      },
      {
        question: "SPLICE isn't removing enough silence. What should I do?",
        answer: "Increase sensitivity to 60-70 and reduce minimum silence duration. The 'Vlog' or 'Reaction' presets are more aggressive. Make sure your audio levels are consistent.",
      },
      {
        question: "Why are some silences not being detected?",
        answer: "If there's background noise, hum, or music, those won't be detected as silence. Try using Vocal Isolation first (Pro tier) to clean the audio. Also check that your audio isn't too quiet overall.",
      },
      {
        question: "Can I preview before applying changes?",
        answer: "Yes! After clicking GO, review the waveform visualization where green = speech and red = silence. You can adjust settings and re-analyze before clicking 'Build Sequence'.",
      },
    ],
  },
  {
    title: "Performance",
    icon: Zap,
    items: [
      {
        question: "SPLICE is running slowly. How can I speed it up?",
        answer: "SPLICE processes audio in 30-second chunks for efficiency. For very long videos (1+ hours), processing may take a few minutes. Ensure you have a stable internet connection as analysis happens in the cloud.",
      },
      {
        question: "How long does analysis take?",
        answer: "Typically 10-30 seconds for a 10-minute video. Longer videos take proportionally longer. AI music generation takes 2-5 minutes. Progress is shown in the panel.",
      },
      {
        question: "SPLICE crashed Premiere Pro. What happened?",
        answer: "This is rare but can happen with very large projects. Try closing other panels, saving your project, and restarting Premiere Pro. If it persists, please report the issue with your system specs.",
      },
    ],
  },
  {
    title: "Features",
    icon: Settings,
    items: [
      {
        question: "How do I use J-Cuts?",
        answer: "Enable J-Cut in your preset settings. Set 'Lead-in' (audio starts before video) and 'Lead-out' (audio ends after video). The 'Podcast' and 'Interview' presets have J-Cut enabled by default.",
      },
      {
        question: "Can I use SPLICE with multicam sequences?",
        answer: "Yes! Use the Multitrack feature for multi-speaker recordings. Configure speakers, assign video tracks, and SPLICE will automatically switch based on who's talking.",
      },
      {
        question: "How accurate is the AI take detection?",
        answer: "Very accurate for typical recording patterns. For best results, pause clearly between takes (2+ seconds) or say 'Take 1, Take 2' before each take.",
      },
      {
        question: "Is the AI-generated music royalty-free?",
        answer: "Yes! All music generated by SPLICE is royalty-free for commercial use. You own the output and can use it in monetized videos without additional licensing.",
      },
      {
        question: "Can I customize the animated caption templates?",
        answer: "Yes! You can adjust colors, font sizes, animation timing, and more. You can also modify the template CSS directly for advanced customization.",
      },
    ],
  },
  {
    title: "Compatibility",
    icon: Monitor,
    items: [
      {
        question: "Which versions of Premiere Pro are supported?",
        answer: "CEP version: Premiere Pro 14.0-25.9 (2020-2025). UXP version: Premiere Pro 25.6+ (2025+). We recommend using the latest Premiere Pro for best compatibility.",
      },
      {
        question: "Does SPLICE work on Mac and Windows?",
        answer: "Yes! SPLICE works on both macOS and Windows. Installation steps differ slightly - see the Installation guide for details.",
      },
      {
        question: "Does SPLICE work offline?",
        answer: "No, SPLICE requires an internet connection for AI processing (transcription, music generation, etc.). The plugin will show an offline indicator if connection is lost.",
      },
      {
        question: "Will SPLICE work with my project settings?",
        answer: "SPLICE works with any project settings and frame rates. It automatically handles frame alignment to ensure cuts land on frame boundaries.",
      },
    ],
  },
];

interface TroubleshootItem {
  issue: string;
  solution: string;
  steps: string[];
}

const troubleshootingItems: TroubleshootItem[] = [
  {
    issue: "Plugin panel is blank or shows loading forever",
    solution: "Reset the panel and check your internet connection",
    steps: [
      "Close Premiere Pro completely",
      "Check your internet connection",
      "Restart Premiere Pro",
      "Reopen the SPLICE panel",
      "If still blank, try reinstalling the plugin",
    ],
  },
  {
    issue: "Error: 'Unauthorized' or 'Invalid license key'",
    solution: "Re-enter your license key or check your subscription status",
    steps: [
      "Click the settings icon in SPLICE",
      "Click 'Logout' if you're logged in",
      "Re-enter your license key",
      "If key doesn't work, check splice.app/account for subscription status",
      "Contact support if your subscription is active but key doesn't work",
    ],
  },
  {
    issue: "Build Sequence button does nothing",
    solution: "Ensure you have an active sequence and analysis results",
    steps: [
      "Make sure a sequence is open and active in Premiere Pro",
      "Run analysis by clicking GO first",
      "Wait for analysis to complete (check progress)",
      "Then click Build Sequence",
      "Check the console for any error messages",
    ],
  },
  {
    issue: "CEP extension not appearing after installation",
    solution: "Verify PlayerDebugMode is enabled correctly",
    steps: [
      "Open Terminal (Mac) or Command Prompt as Admin (Windows)",
      "Run: defaults write com.adobe.CSXS.11 PlayerDebugMode 1 (Mac)",
      "Or add registry key HKEY_CURRENT_USER\\Software\\Adobe\\CSXS.11\\PlayerDebugMode = 1 (Windows)",
      "Completely quit Premiere Pro (check Activity Monitor/Task Manager)",
      "Reopen Premiere Pro and check Window > Extensions",
    ],
  },
  {
    issue: "Audio analysis fails or times out",
    solution: "Check audio format and file size",
    steps: [
      "Ensure audio file is in a supported format (WAV, MP3, AAC)",
      "For very long files (2+ hours), try splitting into sections",
      "Check your internet speed - uploads require stable connection",
      "Try re-analyzing with a smaller section first",
      "If persistent, contact support with the error message",
    ],
  },
  {
    issue: "Generated music sounds different than expected",
    solution: "Adjust generation parameters and try variations",
    steps: [
      "Use specific mood and instrument presets",
      "Add detailed custom prompts (e.g., 'upbeat tech startup vibe')",
      "Generate 3 variations to get more options",
      "Enable 'Scene-Aware' mode for better mood matching",
      "Try different duration - shorter tracks are often better",
    ],
  },
];

export default function FAQPage() {
  return (
    <div className="min-h-screen bg-[#060b14] dark">
      <Header />
      <main className="pt-24 pb-16">
        <div className="container mx-auto px-4">
          {/* Back link */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.3 }}
          >
            <Link href="/docs" className="inline-flex items-center text-gray-400 hover:text-[#00D4FF] mb-8">
              <ArrowLeft className="w-4 h-4 mr-2" />
              Back to Documentation
            </Link>
          </motion.div>

          {/* Hero */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5 }}
            className="mb-12"
          >
            <Badge className="mb-4 bg-[#00D4FF]/10 text-[#00D4FF] border-[#00D4FF]/30">
              <HelpCircle className="w-3 h-3 mr-1" />
              Help Center
            </Badge>
            <h1 className="text-4xl md:text-5xl font-bold mb-4 text-white">
              FAQ & Troubleshooting
            </h1>
            <p className="text-lg text-gray-400 max-w-2xl">
              Find answers to common questions and solutions to known issues.
              Can&apos;t find what you need? Contact our support team.
            </p>
          </motion.div>

          {/* FAQ Categories */}
          <div className="grid lg:grid-cols-2 gap-8 mb-16">
            {faqCategories.map((category, categoryIndex) => (
              <motion.div
                key={category.title}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ duration: 0.5, delay: categoryIndex * 0.05 }}
              >
                <Card className="bg-[#0d1420] border-gray-800">
                  <CardContent className="p-6">
                    <div className="flex items-center gap-3 mb-4">
                      <div className="w-8 h-8 rounded-lg bg-[#00D4FF]/10 flex items-center justify-center">
                        <category.icon className="w-4 h-4 text-[#00D4FF]" />
                      </div>
                      <h2 className="text-lg font-semibold text-white">{category.title}</h2>
                    </div>
                    <Accordion type="single" collapsible className="w-full">
                      {category.items.map((item, itemIndex) => (
                        <AccordionItem
                          key={itemIndex}
                          value={`${category.title}-${itemIndex}`}
                          className="border-gray-800"
                        >
                          <AccordionTrigger className="text-left text-sm text-gray-300 hover:text-white">
                            {item.question}
                          </AccordionTrigger>
                          <AccordionContent className="text-sm text-gray-400">
                            {item.answer}
                          </AccordionContent>
                        </AccordionItem>
                      ))}
                    </Accordion>
                  </CardContent>
                </Card>
              </motion.div>
            ))}
          </div>

          {/* Troubleshooting Section */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.3 }}
            className="mb-16"
          >
            <div className="flex items-center gap-3 mb-6">
              <div className="w-10 h-10 rounded-lg bg-yellow-500/10 flex items-center justify-center">
                <AlertTriangle className="w-5 h-5 text-yellow-500" />
              </div>
              <h2 className="text-2xl font-bold text-white">Troubleshooting</h2>
            </div>

            <div className="space-y-4">
              {troubleshootingItems.map((item, index) => (
                <motion.div
                  key={index}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.5, delay: 0.3 + index * 0.05 }}
                >
                  <Card className="bg-[#0d1420] border-gray-800">
                    <CardContent className="p-6">
                      <div className="flex items-start gap-4">
                        <div className="w-8 h-8 rounded-full bg-red-500/10 flex items-center justify-center shrink-0">
                          <AlertTriangle className="w-4 h-4 text-red-400" />
                        </div>
                        <div className="flex-1">
                          <h3 className="font-semibold text-white mb-1">{item.issue}</h3>
                          <p className="text-sm text-gray-400 mb-4">{item.solution}</p>
                          <div className="bg-[#0a0f1a] rounded-lg p-4">
                            <h4 className="text-xs font-semibold text-gray-400 uppercase mb-3">Steps to resolve:</h4>
                            <ol className="space-y-2">
                              {item.steps.map((step, stepIndex) => (
                                <li key={stepIndex} className="flex items-start gap-3 text-sm">
                                  <span className="w-5 h-5 rounded-full bg-[#00D4FF]/10 flex items-center justify-center text-[#00D4FF] text-xs font-bold shrink-0">
                                    {stepIndex + 1}
                                  </span>
                                  <span className="text-gray-300">{step}</span>
                                </li>
                              ))}
                            </ol>
                          </div>
                        </div>
                      </div>
                    </CardContent>
                  </Card>
                </motion.div>
              ))}
            </div>
          </motion.div>

          {/* Contact Support */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.5 }}
            className="mb-12"
          >
            <Card className="bg-gradient-to-r from-[#00D4FF]/10 to-purple-500/10 border-[#00D4FF]/20">
              <CardContent className="p-8">
                <div className="text-center">
                  <div className="w-16 h-16 rounded-full bg-[#00D4FF]/20 flex items-center justify-center mx-auto mb-4">
                    <MessageCircle className="w-8 h-8 text-[#00D4FF]" />
                  </div>
                  <h2 className="text-2xl font-bold text-white mb-3">
                    Still Need Help?
                  </h2>
                  <p className="text-gray-400 mb-6 max-w-lg mx-auto">
                    Our support team is here to help. We typically respond within 24 hours.
                  </p>
                  <div className="flex flex-col sm:flex-row gap-4 justify-center">
                    <Button
                      className="bg-[#00D4FF] hover:bg-[#00B8E6] text-black font-semibold"
                      asChild
                    >
                      <a href="mailto:support@splice.app">
                        <Mail className="w-4 h-4 mr-2" />
                        Email Support
                      </a>
                    </Button>
                    <Button
                      variant="outline"
                      className="border-gray-700 text-white hover:bg-white/10"
                      asChild
                    >
                      <a href="https://discord.gg/splice" target="_blank" rel="noopener noreferrer">
                        <MessageCircle className="w-4 h-4 mr-2" />
                        Join Discord
                      </a>
                    </Button>
                  </div>
                </div>
              </CardContent>
            </Card>
          </motion.div>

          {/* Quick Links */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.55 }}
            className="mb-12"
          >
            <h2 className="text-xl font-bold text-white mb-4">Helpful Resources</h2>
            <div className="grid md:grid-cols-4 gap-4">
              {[
                { title: "Installation Guide", href: "/docs/installation", icon: Download },
                { title: "Feature Overview", href: "/docs/features", icon: Settings },
                { title: "Video Tutorials", href: "/docs/tutorials", icon: Monitor },
                { title: "API Reference", href: "/docs/api", icon: Zap },
              ].map((link) => (
                <Link key={link.href} href={link.href}>
                  <Card className="bg-[#0d1420] border-gray-800 hover:border-[#00D4FF]/30 transition-colors cursor-pointer">
                    <CardContent className="p-4 flex items-center gap-3">
                      <div className="w-8 h-8 rounded-lg bg-[#00D4FF]/10 flex items-center justify-center">
                        <link.icon className="w-4 h-4 text-[#00D4FF]" />
                      </div>
                      <span className="text-sm text-gray-300">{link.title}</span>
                    </CardContent>
                  </Card>
                </Link>
              ))}
            </div>
          </motion.div>

          {/* Navigation */}
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.6 }}
            className="flex justify-between items-center"
          >
            <Link href="/docs/tutorials" className="text-gray-400 hover:text-[#00D4FF]">
              <ArrowLeft className="w-4 h-4 inline mr-2" />
              Tutorials
            </Link>
            <Link href="/docs" className="text-[#00D4FF] hover:underline">
              Back to Docs
              <ArrowRight className="w-4 h-4 inline ml-2" />
            </Link>
          </motion.div>
        </div>
      </main>
      <Footer />
    </div>
  );
}
