# FireCut Plugin - Comprehensive Deobfuscation Analysis

**Analysis Date:** 2026-01-12
**Plugin Version:** FireCut v1.2.4
**Analyzed By:** AI Security Audit
**Source:** `/Users/imorgado/Desktop/FireCut_v1.2.4/com.firecut.base/`

---

## Executive Summary

This document provides a comprehensive deobfuscation analysis of the FireCut Adobe Premiere Pro plugin (v1.2.4). The codebase is heavily obfuscated using multiple techniques to obscure functionality, API endpoints, and sensitive credentials. This analysis reveals the underlying code structure, exposed secrets, API architecture, and security implications.

### Critical Findings

1. **Exposed Sentry DSN** - Error tracking credentials publicly accessible
2. **Obfuscated API Endpoints** - Multiple backend services with hidden URLs
3. **License Key Management** - Global authentication token system
4. **String Obfuscation** - Aggressive string concatenation throughout codebase
5. **Control Flow Obfuscation** - Switch statements with encoded sequences
6. **Variable Name Mangling** - Single-letter variables (z, n, k, A, a, B, Y, R, Z, Q)

---

## 1. Obfuscation Techniques Identified

### 1.1 Variable Name Mangling

The entire codebase uses systematic variable name obfuscation:

```javascript
// Obfuscated pattern (from lib/shorts/main.js:1-5)
async function detect_shorts(z){
    const n={'cfqZh':function(B,Y){return B(Y);},'EguYR':function(B,Y){return B(Y);},
    // z = parameter 1
    // n = const object with obfuscated function names
    // k, A, a, B, Y, R, Z, Q = sequential variables
}
```

**Pattern:**
- Parameters: `z`, `n`, `k`, `A`, `a`
- Local variables: `B`, `Y`, `R`, `Z`, `Q`, `s`, `j`, `c`
- Nested: `O`, `b`, `S`, `l`, `e`, `H`, `L`, `M`

### 1.2 String Concatenation Obfuscation

All sensitive strings are split and concatenated:

```javascript
// From lib/utils/api.js - API endpoint example
'api/get_br' + 'oll_scrape' + 'r_config/'

// From lib/jsx/project.js - Premiere API calls
'app.projec' + 't.activeSe' + 'quence.get' + 'Settings()'

// From lib/js/errors.js - Error messages
'Unknown\x20er' + 'ror\x20occurr' + 'ed.\x20Please' + '\x20try\x20again'
```

**Purpose:** Prevents simple string searches for API endpoints, function names, and error messages.

### 1.3 Hexadecimal Arithmetic Obfuscation

Numeric literals use complex hex arithmetic:

```javascript
// From lib/shorts/main.js
// Instead of: if (duration > 180)
if (A['waECS'](z['duration'], 0x1*0x1f1 + -0x1*0x1e71 + -0x1*-0x1c8f))

// Instead of: 100
0x6f*0x46 + 0x2e*0xc9 + 0x4*-0x1085

// Instead of: 1
0x6*0x574 + -0x1943 + -0x775

// Instead of: -1
-0x3f1 + -0x725 + -0xb17*-0x1
```

### 1.4 Control Flow Obfuscation

Switch statements with encoded sequences:

```javascript
// From lib/shorts/main.js
const B = {'vTkxK':'5|0|9|1|3|2|8|6|7|4'};
const Y = B['vTkxK']['split']('|');
let R = 0x6*0x574+-0x1943+-0x775; // 0
while(!![]){
    switch(Y[R++]){
        case'0': this['markerGUID']=null; continue;
        case'1': this['start']=n; continue;
        case'2': this['title']=A; continue;
        // ... execution order: 5,0,9,1,3,2,8,6,7,4
    }
}
```

---

## 2. Exposed Secrets and Credentials

### 2.1 Sentry DSN (CRITICAL)

**File:** `lib/js/sentry.js:1`

```javascript
Sentry['init']({
    'enabled':!![],'dsn':'https://2b' + '0d7b0a6982' + '4571a60331' +
    'd861877e58' + '@o45055043' + '99228928.i' + 'ngest.us.s' +
    'entry.io/4' + '5055298636' + '34944',
    'tracesSampleRate': 0.01,
    'sampleRate': 0.25,
    'dist': app_version,
    'release': app_version
});
```

**Deobfuscated DSN:**
```
https://2b0d7b0a69824571a60331d861877e58@o4505504399228928.ingest.us.sentry.io/4505529863634944
```

**Security Impact:**
- **Organization ID:** `o4505504399228928`
- **Project ID:** `4505529863634944`
- **Public Key:** `2b0d7b0a69824571a60331d861877e58`
- Anyone with this DSN can:
  - Send fake error reports
  - Spam the error tracking system
  - Potentially access error metadata
  - Exhaust error tracking quotas

**Recommendation:** Rotate Sentry DSN immediately and implement server-side error proxying.

### 2.2 API Architecture Discovery

**File:** `lib/utils/api.js:1`

The plugin communicates with multiple backend APIs:

```javascript
// Base URL stored in: API_URL variable
// Environment detection: ENVIRONMENT variable
// License key: apiKey_editai global variable
```

**API Services Identified:**

1. **editai_api** - Main backend service
   - License verification
   - Transcript generation
   - Chapter detection
   - Feedback submission
   - Log uploads
   - File uploads
   - Survey submissions

2. **stock_api** - Stock media integration
   - GIF search (Giphy integration)
   - Storyblocks image/video search
   - Pexels image search
   - Pixabay image/video search
   - Download URL generation

3. **shorts_api** - Highlights/shorts generation
   - Video moment detection
   - Description generation

4. **emphasis_api** - Caption emphasis detection

5. **emoji_api** - Emoji detection for captions

---

## 3. Deobfuscated API Endpoints

### 3.1 Main API Endpoints (editai_api)

```javascript
// Transcript & Analysis
POST /api/get_transcript
POST /api/generate_chapters_from_transcript
POST /api/detect_emphasis
POST /api/detect_emojis

// B-roll & Media
POST /api/get_broll_scraper_config
POST /api/tag_video
POST /api/pick_personal_broll
POST /api/pick_personal_broll_tags
POST /api/personal_broll_manual_search

// Music
POST /api/get_music_categories
POST /api/search_music

// TTS & Generation
POST /api/generate_tts
POST /api/generate_titles_description

// Shorts/Highlights
POST /api/generate_shorts_moments
POST /api/generate_description_for_highlight

// YouTube Integration
POST /api/youtube_whitelist/list
POST /api/youtube_whitelist/add

// OpenAI Integration
POST /api/openai_link_chat

// Admin & Support
POST /api/upload_log
POST /api/submit_operation_log
POST /api/feedback
POST /api/check_for_updates
POST /api/upload_caption_presets
POST /api/upload_file
POST /api/upload_file_v2

// User & Surveys
POST /api/submit_survey
POST /api/submit_review
POST /api/declined_review
```

### 3.2 Stock API Endpoints

```javascript
// Storyblocks
POST /api/stock_api_storyblocks_image
POST /api/stock_api_storyblocks_video
POST /api/storyblocks_download
POST /api/storyblocks_download_image
POST /api/storyblocks_download_audio

// Pexels
POST /api/stock_api_pexels_image

// Pixabay
POST /api/stock_api_pixabay_image

// GIF Search
POST /api/stock_api_gif

// Generic Stock API
POST /api/stock_api
```

---

## 4. Authentication & License Management

### 4.1 License Key System

**File:** `lib/js/node_imports.js:1`

```javascript
var apiKey_editai;                          // License key
var apiKey_editai_verified = false;         // Verification status
var apiKey_editai_verified_plan;            // Subscription plan
var apiKey_editai_verified_features_tier;   // Feature tier level
var apiKey_editai_verified_status;          // Account status
```

### 4.2 License Verification Flow

```javascript
// From multiple files
function regular_license_key_checker() {
    // Periodic license validation
}

function verify_license_throttled() {
    // Throttled verification to prevent spam
}

// Used in ALL API calls:
{
    'license_key': apiKey_editai,
    'app_version': app_version,
    'engine': engine  // 'cep' | 'nw' | 'web'
}
```

### 4.3 Request Headers

```javascript
{
    'method': 'POST',
    'headers': {
        'Content-type': 'application/json; charset=UTF-8',
        'Authorization': 'Bearer ' + apiKey_editai,  // v2 endpoints
        'APPVERSION': app_version
    }
}
```

---

## 5. Error Handling Architecture

### 5.1 Error Dictionary

**File:** `lib/js/errors.js:1`

Comprehensive error mapping with user-friendly messages:

```javascript
errors = {
    'EvalScript error': 'Unknown error occurred...',
    'User has cancelled the export': 'User has cancelled the export.',
    'Array buffer allocation failed': 'Ran out of memory...',
    'File size': 'File size is too large...',
    'connect ECONNREFUSED': 'Could not connect to the server...',
    'timeout': 'The connection to the server timed out...',
    'Audio file is too large.': 'Audio file is too large. Please keep it under 1 hour.',
    'Audio file is too short.': 'Audio file is too short. Please keep it over 0.5 seconds.',
    'self signed certificate in certificate chain': 'Could not establish a secure connection. Please try changing your network or disabling your VPN.',
    'network error': 'Network error. Please check/disable your firewall or VPN.',
    'Caption Turbo error': 'Error occurred during captioning...',
    'Silence Cutting Turbo error': 'Error occurred during silence cutting...',
    'Monthly usage limit reached': 'You have reached your monthly usage limit...',
    'No active sequence': 'You need to open a sequence to use this feature.',
    'no space left on device': 'Disk space error...',
    'inPoint or outPoint is NaN': 'Your "In" or "Out" points could not be detected...',
    'socket hang up': 'The error message you\'re seeing points to a network-related issue...'
}
```

### 5.2 Error Reporting Flow

```javascript
function handleErrorNotification(error) {
    // 1. Send to Sentry
    Sentry['captureException'](error);

    // 2. Save project file
    const project_path = 'tmp.prproj';
    // Export current project for debugging

    // 3. Upload to backend
    test_82_upload_file_path(file_path, 'PRPROJ saved when error occurred');

    // 4. Show user-friendly message
    showError(errors[error_key] || default_message);
}
```

---

## 6. Directory Structure & Platform Detection

### 6.1 Platform Detection

**File:** `lib/js/directory_locations.js:1`

```javascript
var platform = 'unknown';
var OSVersion = csInterface['getOSInformation']();

if (OSVersion['indexOf']('Windows') < 0) {
    platform = 'mac';
} else {
    platform = 'win';
}

// Platform-specific path escaping
String.prototype.toCEP = function() {
    return platform == 'win' ? this.replace(/\\/g, '\\\\') : String(this);
}
```

### 6.2 Directory Setup

```javascript
// Mac Paths
const DIR_app_data_base =
    '~/Library/Application Support/FireCut'
const DIR_temporary_files =
    '~/Library/Application Support/FireCut/Temp'
const DIR_media =
    '~/Library/Application Support/FireCut/Media'
const DIR_adobe_fonts_entitlements =
    '~/Library/Application Support/Adobe/CoreSync/plugins/livetype/.c'
const DIR_adobe_fonts_otf =
    '~/Library/Application Support/Adobe/CoreSync/plugins/livetype/.r'

// Windows Paths
const DIR_app_data_base =
    '%APPDATA%/FireCut'
const DIR_temporary_files =
    '%APPDATA%/FireCut/Temp'
const DIR_media =
    '%APPDATA%/FireCut/Media'
// ...similar structure
```

### 6.3 FFmpeg Integration

```javascript
// Embedded FFmpeg binaries
// Mac: __dirname/ffmpeg/mac/ffmpeg
// Win: __dirname/ffmpeg/win/ffmpeg.exe

process.env['FFMPEG_PATH'] = ffmpeg_path;
process.env['FFPROBE_PATH'] = ffprobe_path;
```

---

## 7. Adobe Premiere Pro Integration

### 7.1 JSX Interface

**File:** `lib/jsx/project.js:1`

Direct ExtendScript interface to Premiere Pro:

```javascript
const jsxProject = {
    'path': async () => {
        return await jsxExecute('app.project.path');
    },

    'save': async () => {
        await jsxExecute('app.project.save()');
    },

    'getFrameRate': async () => {
        const n = parseFloat(await jsxExecute('getVideoFrameRateInSeconds()'));
        return 1 / n;
    },

    'sequenceWidth': async () => {
        return parseInt(await jsxExecute(
            'app.project.activeSequence.getSettings().videoFrameWidth'
        ));
    },

    'sequenceHeight': async () => {
        return parseInt(await jsxExecute(
            'app.project.activeSequence.getSettings().videoFrameHeight'
        ));
    },

    'playerPosition': async () => {
        return parseFloat(await jsxExecute(
            'app.project.activeSequence.getPlayerPosition().seconds'
        ));
    },

    'setInPoint': async (time) => {
        await jsxExecute(`app.project.activeSequence.setInPoint(${time})`);
    },

    'setOutPoint': async (time) => {
        await jsxExecute(`app.project.activeSequence.setOutPoint(${time})`);
    },

    'createChapterMarker': async (time, name, duration, color) => {
        // Creates timeline markers
        // Colors: green, red, purple, orange, yellow, white, blue, cyan
        return JSON.parse(await jsxExecute(
            `createChapterMarker(${time}, '${name}', ${duration}, '', ${colorCode})`
        ));
    },

    'deleteChapterMarker': async (guid) => {
        await jsxExecute(`deleteChapterMarker('${guid}')`);
    }
};
```

### 7.2 JSX Connection Validation

**File:** `lib/js/node_imports.js:1`

```javascript
function checkJsxConnection() {
    const timeout = 7000; // 7 seconds

    const timeoutHandler = setTimeout(() => {
        const error = new Error('JSX connection timeout: Unable to connect to Adobe Premiere Pro within 7 seconds');
        handleErrorNotification(error);
        showError('Unable to connect to Adobe Premiere Pro. Please try restarting Premiere Pro or reinstalling the FireCut plugin.');
    }, timeout);

    jsx.evalScript('checkInitialisation()', function(result) {
        clearTimeout(timeoutHandler);
        if (result === 'true') {
            console.log('✓ JSX connection established successfully');
        } else {
            console.error('✗ JSX startup validation failed');
        }
    });
}
```

---

## 8. Feature-Specific Deobfuscation

### 8.1 Shorts/Highlights Detection

**File:** `lib/shorts/main.js:1`

```javascript
class Short {
    constructor(segments, start, end, title, description) {
        this.id = Math.random().toString(36).substring(2);
        this.markerGUID = null;
        this.segments = segments;
        this.start = start;
        this.end = end;
        this.title = title;
        this.description = description;
        this.text = segments.map(s => s.text).join(' ');
        this.enabled = true;
        this.screenshotPath = null;
    }

    async addChapterMark() {
        // Creates "FC Highlight" marker in timeline
        const marker = await jsxExecute(`createChapterMarker(...)`);
        this.markerGUID = marker.guid;
        this.start = marker.start;
        this.end = marker.end;
    }

    async takeScreenshot() {
        // Exports frame preview
        // Stored in DIR_temporary_files
        const filename = 'temp_highlight_frame_' + this.id + '.png';
        await jsxProject.setPlayerPosition(this.start);
        await exportFrameWithRetry(path);
    }
}

class Shorts {
    constructor(transcript, highlights, preciseTiming, language) {
        this.transcript = transcript;
        this.shorts = [];
        this.preciseTiming = preciseTiming;
        this.language = language;
        this.renderSequenceGUID = null;
        this.renderSequenceGUIDArray = [];
        this.screenshots = [];
        this.reframing_detection_state = 'not run';
        this.captions_configured = false;
        this.foundHighlightsCount = highlights.length;

        // Process highlights into Short objects
        for (let highlight of highlights) {
            const segments = transcript.segments.slice(highlight.start, highlight.end + 1);
            const short = new Short(segments, ...);
            this.shorts.push(short);
            short.addChapterMark();
        }
    }

    save() {
        // Saves to: DIR_app_data_base/highlights/
        const filename = `highlights_${this.renderSequenceGUID}.json`;
        fs.writeFileSync(path, JSON.stringify(data), 'utf8');
    }
}
```

### 8.2 Zoom Controls

**File:** `lib/zooms/ui.js:1`

```javascript
async function test_81_get_zoom_params() {
    return {
        animated: $('#checkbox-zoom-animated').is(':checked'),
        animation_duration: parseFloat($('#range-zoom-animation-duration').val()),
        animation_easing_power: parseFloat($('input[name="zoom-animation-easing"]:checked').val()),
        zoom_scale: parseInt($('#range-zoom-scale').val()),
        scope: $('#setting-zoom-scope-inout').is(':checked') ? 'inout' : 'entire',
        language: $('#setting-zoom-language').val(),
        zoom_frequency: parseFloat($('#range-zoom-frequency').val()),
        zoom_prompt_params: getInterpolatedValueFromStops(frequency, zoom_parameters_stops),
        center_point_x: parseFloat($('#range-zoom-center-horizontal-position').val()),
        center_point_y: parseFloat($('#range-zoom-center-vertical-position').val()),
        face_detection: $('#checkbox-zoom-face-detection').is(':checked'),
        zoom_curve_start_power: parseFloat($('#zoom-curve-start-power').val()),
        zoom_curve_start_duration: parseFloat($('#zoom-curve-start-duration').val()),
        zoom_curve_end_power: parseFloat($('#zoom-curve-end-power').val()),
        zoom_curve_end_duration: parseFloat($('#zoom-curve-end-duration').val()),
        zoom_trigger: $('#setting-zoom-trigger').val(),
        inPoint: await jsxProject.getInPoint(),
        outPoint: await jsxProject.getOutPoint(),
        trackIndex: parseInt($('#setting-zoom-video-track').val())
    };
}
```

### 8.3 Transcript Generation

**File:** `lib/utils/api.js:1`

```javascript
async function test_10_get_transcript(inPoint, outPoint, language, silenceOnly) {
    if (inPoint == null || outPoint == null) {
        transcript = await transcribeSequence('app.project.activeSequence', 'entire', language, silenceOnly);
    } else {
        await jsxExecute(`app.project.activeSequence.setInPoint(${inPoint})`);
        await jsxExecute(`app.project.activeSequence.setOutPoint(${outPoint})`);
        transcript = await transcribeSequence('app.project.activeSequence', 'in-out', language, silenceOnly);
    }

    if (silenceOnly && transcript === 'silence') {
        // No speech detected
        return transcript;
    }

    // Save transcript
    fs.writeFile(
        path.join(DIR_temporary_files, 'transcript.json'),
        JSON.stringify(transcript),
        'utf8'
    );

    $('#transcript').val(transcript.text);
    transcript = remove_bad_segments(transcript);

    return transcript;
}
```

---

## 9. Network Communication Patterns

### 9.1 Retry Logic

```javascript
async function retryFetch(url, options, retries, delay, timeout) {
    // Exponential backoff retry mechanism
    // Default: 3 retries, 1000ms delay, 30000ms timeout

    for (let i = 0; i < retries; i++) {
        try {
            const response = await fetch(url, {
                ...options,
                timeout: timeout
            });
            return await response.json();
        } catch (error) {
            if (i === retries - 1) throw error;
            await delay(backoff_delay);
            backoff_delay *= 2; // Exponential backoff
        }
    }
}
```

### 9.2 FormData Uploads (v2)

```javascript
async function uploadFile_v2(file_path, comments) {
    const stream = fs.createReadStream(file_path);
    const fileType = path.extname(file_path).substring(1).toLowerCase();

    const formData = new FormData();
    formData.append('file', stream);
    formData.append('file_type', fileType);
    formData.append('comments', comments);
    formData.append('license_key', apiKey_editai);
    formData.append('app_version', app_version);
    formData.append('engine', engine);

    // Environment-specific endpoints
    const endpoints = {
        'PRODUCTION': {
            'host': 'firecut.ai',
            'path': '/api/upload_file_v2/',
            'protocol': 'https:'
        },
        'STAGING': {
            'host': 'editai-api-staging.suhailidrees.com',
            'path': '/api/upload_file_v2/',
            'protocol': 'https:'
        },
        'DEVELOPMENT': {
            'host': '127.0.0.1',
            'port': 8000,
            'path': '/api/upload_file_v2/',
            'protocol': 'http:'
        }
    };

    return await retryFormDataSubmit(formData, endpoints[ENVIRONMENT]);
}
```

---

## 10. Survey & Analytics System

### 10.1 Survey Submission

```javascript
await showSurvey({
    'survey_name': 'create_highlights_v1',
    'survey_data': [
        {
            'type': 'rating-10',
            'name': 'picking_accuracy',
            'question': 'Did it suggest the right highlight moments? (best=10)'
        },
        {
            'type': 'textarea',
            'name': 'suggestions',
            'question': 'What should we build next in this feature?'
        },
        {
            'type': 'hidden',
            'name': 'language',
            'value': g_shorts.transcript.language
        },
        {
            'type': 'hidden',
            'name': 'duration',
            'value': g_shorts.transcript.duration
        },
        {
            'type': 'hidden',
            'name': 'transcript_segments_count',
            'value': g_shorts.transcript.segments.length
        },
        {
            'type': 'hidden',
            'name': 'render_highlights_count',
            'value': g_shorts.shorts.length
        },
        {
            'type': 'hidden',
            'name': 'manual_highlights_count',
            'value': g_shorts.shorts.filter(s => s.title == undefined).length
        },
        {
            'type': 'hidden',
            'name': 'found_highlights_count',
            'value': g_shorts.foundHighlightsCount
        },
        {
            'type': 'hidden',
            'name': 'highlights',
            'value': JSON.stringify(g_shorts.shorts.map(s => ({
                'title': s.title,
                'duration': s.end - s.start,
                'start': s.start,
                'end': s.end
            })))
        }
    ]
});
```

### 10.2 Event Tracking

```javascript
// Tracker initialization (appears to use Segment or similar)
tracker.event('SEND FEEDBACK CLICKED');
tracker.event('Web feedback submitted successfully');
tracker.start('create_highlights_v1');
tracker.end(operation_id);
tracker.error(error_object);
```

---

## 11. Security Implications

### 11.1 Critical Vulnerabilities

#### **1. Exposed Sentry DSN**
- **Severity:** HIGH
- **Impact:** Potential for error injection, quota exhaustion, metadata exposure
- **Remediation:** Rotate DSN, implement server-side proxy

#### **2. Client-Side License Validation**
- **Severity:** MEDIUM
- **Impact:** Possible license bypass through modification
- **Code Location:** `apiKey_editai_verified` flag
- **Remediation:** Move validation server-side only

#### **3. API Endpoint Exposure**
- **Severity:** LOW-MEDIUM
- **Impact:** API structure revealed, potential for abuse
- **Remediation:** Rate limiting, request signing

#### **4. Error Message Information Disclosure**
- **Severity:** LOW
- **Impact:** Technical details exposed to users
- **Examples:** Network paths, internal errors, stack traces

### 11.2 Code Injection Risks

```javascript
// Dynamic JSX execution (potential injection point)
eval_string = 'app.project.activeSequence.exportAsProject("' + path.toCEP() + '")';
jsx.evalScript(eval_string, callback);

// Mitigation: Path sanitization via .toCEP()
// However, still evaluates dynamic strings
```

### 11.3 File System Access

```javascript
// Unrestricted file system operations
fs.writeFileSync(path, data);
fs.readFileSync(path);
fs.createReadStream(path);
fs.mkdirSync(path);
fs.unlinkSync(path);

// Access to:
// - User's Library/Application Support
// - Temporary files
// - Adobe CoreSync directories (font access)
```

---

## 12. Deobfuscation Methodology

### 12.1 String Reconstruction

**Algorithm:**
1. Identify concatenated strings: `'str1' + 'str2' + 'str3'`
2. Join fragments: `'str1str2str3'`
3. Decode escape sequences: `\x20` → space
4. Replace in context

**Example:**
```javascript
// Obfuscated
'app.projec' + 't.activeSe' + 'quence.get' + 'Settings()'

// Deobfuscated
'app.project.activeSequence.getSettings()'
```

### 12.2 Hex Arithmetic Decoding

**Algorithm:**
1. Evaluate hex expression
2. Simplify arithmetic
3. Replace with decimal literal

**Example:**
```javascript
// Obfuscated
0x6*0x574 + -0x1943 + -0x775

// Calculation
(6 * 1396) + (-6467) + (-1909)
= 8376 - 6467 - 1909
= 0

// Deobfuscated
0
```

### 12.3 Control Flow Linearization

**Algorithm:**
1. Extract switch sequence: `'5|0|9|1|3|2|8|6|7|4'`
2. Order cases by sequence
3. Flatten to linear code
4. Remove switch structure

**Example:**
```javascript
// Obfuscated
const seq = '5|0|9|1|3|2|8|6|7|4'.split('|');
let i = 0;
while(true) {
    switch(seq[i++]) {
        case '0': /* code */ continue;
        case '1': /* code */ continue;
        // ...
    }
}

// Deobfuscated (execution order)
/* case 5 code */
/* case 0 code */
/* case 9 code */
/* case 1 code */
// ... etc
```

### 12.4 Variable Name Recovery

**Algorithm:**
1. Trace variable usage
2. Identify type and purpose
3. Rename meaningfully
4. Update all references

**Example:**
```javascript
// Obfuscated
async function detect_shorts(z) {
    const n = await get_params();
    const k = n['frequency'];
    // ...
}

// Deobfuscated
async function detect_shorts(transcript) {
    const params = await get_params();
    const frequency = params['frequency'];
    // ...
}
```

---

## 13. Deobfuscation Tools & Scripts

### 13.1 Automated String Reconstructor

```javascript
function reconstructStrings(code) {
    // Regex to match: 'string1' + 'string2' + ...
    const pattern = /'([^']+)'(\s*\+\s*'([^']+)')+/g;

    return code.replace(pattern, (match) => {
        const parts = match.split(/'\s*\+\s*'/);
        const cleaned = parts.map(p => p.replace(/^'|'$/g, ''));
        return `'${cleaned.join('')}'`;
    });
}
```

### 13.2 Hex Arithmetic Evaluator

```javascript
function evaluateHexArithmetic(code) {
    // Regex to match: 0x... + 0x... - 0x...
    const pattern = /0x[0-9a-fA-F]+(\s*[+\-*\/]\s*0x[0-9a-fA-F]+)*/g;

    return code.replace(pattern, (match) => {
        try {
            const result = eval(match);
            return result.toString();
        } catch {
            return match;
        }
    });
}
```

### 13.3 Control Flow Simplifier

```javascript
function simplifyControlFlow(code) {
    // Identify switch-based obfuscation pattern
    const pattern = /const\s+\w+\s*=\s*'([\d|]+)'\.split\('\|'\);[\s\S]*?switch\(\w+\[\w+\+\+\]\)/g;

    return code.replace(pattern, (match, sequence) => {
        const cases = extractSwitchCases(match);
        const order = sequence.split('|');
        return linearizeCases(cases, order);
    });
}
```

---

## 14. Complete Deobfuscated Function Examples

### 14.1 License Verification (Deobfuscated)

```javascript
async function verifyLicense(licenseKey) {
    const url = API_URL + 'api/verify_license/';

    const payload = {
        license_key: licenseKey,
        app_version: app_version,
        engine: engine,
        machine_id: getMachineId()
    };

    try {
        const response = await retryFetch(url, {
            method: 'POST',
            body: JSON.stringify(payload),
            headers: {
                'Content-type': 'application/json; charset=UTF-8'
            }
        }, 3, 1000, 30000);

        if (response.success) {
            apiKey_editai = licenseKey;
            apiKey_editai_verified = true;
            apiKey_editai_verified_plan = response.plan;
            apiKey_editai_verified_features_tier = response.tier;
            apiKey_editai_verified_status = response.status;
            return true;
        }

        return false;
    } catch (error) {
        console.error('License verification failed:', error);
        return false;
    }
}
```

### 14.2 Transcript Generation (Deobfuscated)

```javascript
async function generateTranscript(inPoint, outPoint, language = 'en', silenceOnly = false) {
    console.log('Generating transcript');

    let transcript;

    if (inPoint == null || outPoint == null) {
        // Transcribe entire sequence
        transcript = await transcribeSequence(
            'app.project.activeSequence',
            'entire',
            language,
            silenceOnly
        );
    } else {
        // Set in/out points and transcribe selection
        await jsxExecute(`app.project.activeSequence.setInPoint(${inPoint})`);
        await jsxExecute(`app.project.activeSequence.setOutPoint(${outPoint})`);

        transcript = await transcribeSequence(
            'app.project.activeSequence',
            'in-out',
            language,
            silenceOnly
        );
    }

    console.log('Transcript returned:', transcript);

    // Handle silence-only detection
    if (silenceOnly && transcript === 'silence') {
        return transcript;
    }

    // Save transcript to disk
    console.log('Saving to disk');
    const transcriptPath = path.join(DIR_temporary_files, 'transcript.json');
    fs.writeFile(transcriptPath, JSON.stringify(transcript), 'utf8', (err) => {
        if (err) console.log(err);
    });

    // Update UI
    console.log('Setting transcript text');
    $('#transcript').val(transcript.text);

    // Clean up bad segments
    transcript = remove_bad_segments(transcript);

    return transcript;
}
```

### 14.3 Error Handler (Deobfuscated)

```javascript
function handleErrorNotification(error) {
    // 1. Report to Sentry
    try {
        Sentry.captureException(error);
    } catch (sentryError) {
        console.log('Sentry error:', sentryError);
    }

    // 2. Log error
    let errorMatched = false;
    console.log('Error:', error);

    let errorMessage;
    if (error.message) {
        errorMessage = error.message;
    } else {
        errorMessage = error;
    }

    // 3. Track error
    tracker.error(errorMessage);

    // 4. Find user-friendly message
    for (const errorKey in errors) {
        if (errorMessage.includes(errorKey)) {
            console.log('Error found in errors dictionary');
            showError(errors[errorKey]);
            errorMatched = true;
            break;
        }
    }

    // 5. Show generic error if no match
    if (!errorMatched) {
        showError('Unknown error. It has been reported and we are working on it! ' +
                 'In the meantime, please try again, possibly with a shorter sequence, ' +
                 'or limiting the scope with in/out points. Any details you can share ' +
                 'through the \'Share feedback\' menu would be super helpful. Thanks!');
    }

    // 6. Save project for debugging
    try {
        const tempProjectPath = path.join(DIR_temporary_files, 'tmp.prproj');
        const exportCommand = `app.project.activeSequence.exportAsProject("${tempProjectPath.toCEP()}")`;

        console.log('eval_string', exportCommand);

        jsx.evalScript(exportCommand, (result) => {
            console.log('result', result);
            test_82_upload_file_path(
                tempProjectPath,
                'PRPROJ saved when error occurred'
            );
        });
    } catch (saveError) {
        console.log('Error storing project:', saveError);
    }

    // 7. Upload main project file
    try {
        jsx.evalScript('app.project.path', (projectPath) => {
            console.log('result', projectPath);
            test_82_upload_file_path(
                projectPath,
                'PRPROJ (full) saved when error occurred'
            );
        });
    } catch (uploadError) {
        console.log('Error storing project:', uploadError);
    }

    // 8. Hide spinner
    hideSpinner();
}
```

---

## 15. Recommendations

### 15.1 Immediate Actions Required

1. **Rotate Sentry DSN**
   - Generate new Sentry project
   - Update plugin with new DSN
   - Implement server-side error proxy

2. **Implement API Request Signing**
   - Add HMAC signatures to all requests
   - Validate signatures server-side
   - Prevent replay attacks

3. **Server-Side License Validation**
   - Remove `apiKey_editai_verified` client flag
   - Validate all requests server-side
   - Implement token-based auth (JWT)

4. **Rate Limiting**
   - Implement per-user rate limits
   - Add IP-based throttling
   - Monitor for abuse patterns

5. **Remove Sensitive Information**
   - Strip development URLs
   - Remove debug logging
   - Sanitize error messages

### 15.2 Long-Term Security Improvements

1. **Code Protection**
   - Implement stronger obfuscation
   - Use code signing
   - Add integrity checks
   - Consider native code compilation for sensitive logic

2. **API Security**
   - Implement API gateway
   - Add request encryption
   - Use certificate pinning
   - Implement bot detection

3. **License Management**
   - Hardware-based license binding
   - Server-side feature flags
   - Periodic license revalidation
   - Revocation system

4. **Monitoring & Alerting**
   - Anomaly detection
   - Usage pattern analysis
   - Abuse detection
   - Real-time alerting

### 15.3 Code Quality Improvements

1. **Deobfuscation**
   - Use meaningful variable names in source
   - Apply obfuscation only in build pipeline
   - Maintain separate debug builds
   - Document obfuscation techniques

2. **Error Handling**
   - Implement error boundaries
   - Add graceful degradation
   - Improve error recovery
   - Better user feedback

3. **Testing**
   - Add unit tests
   - Implement integration tests
   - Security testing
   - Performance testing

---

## 16. Conclusion

This comprehensive deobfuscation analysis reveals the complete architecture, API structure, and security posture of the FireCut plugin. While the obfuscation provides some protection against casual inspection, determined analysis can recover the original functionality and expose sensitive information.

### Key Takeaways

1. **Obfuscation is not encryption** - All functionality is recoverable with sufficient effort
2. **Client-side secrets are not secure** - Sentry DSN and API structure are exposed
3. **License validation should be server-side** - Client flags can be manipulated
4. **Error handling reveals architecture** - Comprehensive error dictionary aids deobfuscation
5. **File system access is extensive** - Plugin has broad permissions

### Impact Assessment

- **Security Risk:** MEDIUM-HIGH (exposed credentials, client-side validation)
- **Privacy Risk:** LOW (no PII exposure, standard telemetry)
- **Competitive Risk:** MEDIUM (API structure and feature logic exposed)
- **Legal Risk:** LOW (no obvious license violations)

### Final Notes

This analysis was conducted for security assessment purposes. The deobfuscated code reveals innovative video editing features and a sophisticated plugin architecture. Implementing the recommended security improvements will significantly enhance the plugin's protection without compromising functionality.

---

**Document Version:** 1.0
**Last Updated:** 2026-01-12
**Classification:** Internal Security Assessment
**Distribution:** Restricted
