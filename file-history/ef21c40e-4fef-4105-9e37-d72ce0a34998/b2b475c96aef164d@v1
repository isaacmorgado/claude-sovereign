# FireCut v1.2.4 - Complete Deobfuscation Analysis
## Adobe Premiere Pro CEP Plugin Forensic Analysis

**Analysis Date**: 2026-01-12
**FireCut Version**: v1.2.4
**Location**: `/Users/imorgado/Desktop/FireCut_v1.2.4/com.firecut.base/lib/`
**Total Files Analyzed**: 40 JavaScript files
**Total Code Size**: ~500KB minified/obfuscated JavaScript

---

## Executive Summary

This document provides a complete deobfuscation and forensic analysis of the FireCut v1.2.4 Adobe Premiere Pro plugin. FireCut is a professional video editing automation tool that uses AI-powered features for:

- **Silence Cutting** - RMS-based audio analysis
- **Filler Word Removal** - OpenAI Whisper transcription + detection
- **Auto B-roll** - Stock footage search and insertion
- **Caption Generation** - Transcription + styling + animations
- **Auto Zoom** - Transcript-synchronized zoom animations
- **Auto Chapters** - AI chapter detection and markers
- **Workflow Automation** - Multi-step editing pipelines
- **TTS (Text-to-Speech)** - ElevenLabs integration
- **Music Generation** - AI music scoring

### Key Findings

✅ **Architecture**: Adobe CEP (Common Extensibility Platform) with Electron-based UI
✅ **Backend**: Node.js with ExtendScript/JSX bridge to Premiere Pro
✅ **AI Services**: OpenAI Whisper, Google Cloud Speech, GPT-4, ElevenLabs
✅ **Stock APIs**: Storyblocks, Pixabay, Pexels, Giphy, Freepik, Artlist, Envato
✅ **Analytics**: PostHog session recording, Sentry error tracking
✅ **Obfuscation**: Heavy string concatenation, hex arithmetic, variable mapping
⚠️ **Security**: License verification is client-side, API keys exposed in code
⚠️ **Credentials**: Sentry DSN, PostHog key, staging API URLs exposed

---

## Table of Contents

1. [Obfuscation Patterns](#1-obfuscation-patterns)
2. [Architecture Overview](#2-architecture-overview)
3. [Feature Module Analysis](#3-feature-module-analysis)
4. [API Endpoints & Backend](#4-api-endpoints--backend)
5. [License & Authentication](#5-license--authentication)
6. [AI Service Integrations](#6-ai-service-integrations)
7. [Stock Media Integrations](#7-stock-media-integrations)
8. [Core Algorithms](#8-core-algorithms)
9. [UI & Event System](#9-ui--event-system)
10. [Security Analysis](#10-security-analysis)
11. [SPLICE Parity Comparison](#11-splice-parity-comparison)
12. [Recommendations](#12-recommendations)

---

## 1. Obfuscation Patterns

FireCut uses multiple overlapping obfuscation techniques to protect its code:

### Pattern A: String Concatenation
Breaks readable strings into fragments:

```javascript
// OBFUSCATED
'#colour-ca' + 'ptions-gra' + 'phics-font' + '-colour-tr' + 'igger'
'app.projec' + 't.activeSe' + 'quence.nam' + 'e'
'https://fi' + 'recut.ai/'

// DEOBFUSCATED
'#colour-captions-graphics-font-colour-trigger'
'app.project.activeSequence.name'
'https://firecut.ai/'
```

### Pattern B: Hex Arithmetic
Hides numeric constants using mathematical expressions:

```javascript
// OBFUSCATED (keyboard key codes)
-0x17c0 - 0x3*0xb2e + 0x1cb5*0x2  // = 32 (spacebar)
-0x1c27 - 0x14bf*-0x1 + 0x78d     // = 37 (left arrow)
0x11d2 + 0x4d1*0x2 - 0x1b4d*0x1  // = 39 (right arrow)

// DEOBFUSCATED
32  // spacebar
37  // left arrow
39  // right arrow
```

### Pattern C: Variable Mapping Objects
Creates lookup tables to hide string/function references:

```javascript
// OBFUSCATED
const z = {
  'mLQzy': 'Untitled workflow',
  'oNCUz': '&quot;',
  'DEcKA': '#workflows-list',
  'Shjfy': function(n,k){ return n(k); }
};
z['Shjfy']($, z['DEcKA'])  // Usage

// DEOBFUSCATED
const CONFIG = {
  'UNTITLED_WORKFLOW': 'Untitled workflow',
  'HTML_QUOTE': '&quot;',
  'WORKFLOW_LIST_SELECTOR': '#workflows-list',
  'callFunction': function(func, arg){ return func(arg); }
};
CONFIG.callFunction($, CONFIG.WORKFLOW_LIST_SELECTOR)
```

### Pattern D: Array Index Shuffling
Randomizes execution order in switch statements:

```javascript
// OBFUSCATED
const a = z['ruLjf'].split('|');  // "7|3|4|1|6|2|5|8|0"
let B = 0;
while(true){
  switch(a[B++]){
    case '0': colour_picker.show(); continue;
    case '1': /* different step */ continue;
    // Order is scrambled
  }
}

// DEOBFUSCATED (linear execution)
colour_picker.show();
// step 1
// step 2
// etc.
```

### Pattern E: Boolean Encoding
Obscures true/false with array syntax:

```javascript
!![]      // true
![]       // false
[]===![]  // false
```

### Pattern F: Unicode Escapes
Hides characters using escape sequences:

```javascript
'\x20'  // space
'\x22'  // double quote
'\x0a'  // newline
```

---

## 2. Architecture Overview

### Technology Stack

```
┌─────────────────────────────────────────────────────────┐
│                  FireCut Architecture                   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌──────────────┐                                      │
│  │   Electron   │  (UI Layer - HTML/CSS/JavaScript)    │
│  │   Frontend   │  - jQuery for DOM manipulation       │
│  └──────┬───────┘  - Pickr for color pickers (15x)     │
│         │          - Select2 for dropdowns              │
│         │                                               │
│  ┌──────▼───────┐                                      │
│  │  CSInterface │  (CEP Bridge)                        │
│  │   (CEP 12)   │  - jsx.evalScript() for host calls  │
│  └──────┬───────┘                                       │
│         │                                               │
│  ┌──────▼───────┐                                      │
│  │ ExtendScript │  (Host Layer - Adobe Premiere Pro)   │
│  │     (JSX)    │  - Sequence manipulation             │
│  └──────────────┘  - Clip operations                   │
│                    - Export/rendering                   │
│                                                         │
│  ┌──────────────┐                                      │
│  │   Node.js    │  (Backend Services)                  │
│  │   Modules    │  - fs, path, os                      │
│  └──────────────┘  - FormData, node-machine-id         │
│                    - FFmpeg integration                 │
│                                                         │
│  ┌──────────────┐                                      │
│  │  External    │                                      │
│  │    APIs      │  - OpenAI Whisper (transcription)    │
│  └──────────────┘  - Stock media (7 providers)         │
│                    - ElevenLabs (TTS)                   │
│                    - firecut.ai backend                 │
└─────────────────────────────────────────────────────────┘
```

### File Structure

```
lib/
├── broll/
│   ├── main.js           - B-roll search and insertion
│   ├── helpers.js        - Stock API integrations (30+ functions)
│   └── listeners.js      - B-roll UI event handlers
├── captions/
│   ├── main.js           - Caption generation (Captions class)
│   ├── helpers.js        - Caption utilities
│   └── listeners.js      - Caption UI events
├── chapters/
│   ├── main.js           - Chapter detection
│   ├── helpers.js        - Chapter utilities
│   └── listeners.js      - Chapter UI
├── filler_words/
│   ├── main.js           - Filler word detection
│   ├── helpers.js        - Word filtering
│   └── listeners.js      - Filler word UI
├── js/
│   ├── index.js          - Main initialization
│   ├── turbo.js          - XML timeline manipulation
│   ├── turbo_captions.js - Caption XML generation
│   ├── pr_turbo.js       - PRPROJ file handling
│   ├── fonts_adobe.js    - Font loading
│   ├── timing.js         - Performance tracking
│   ├── abort_control.js  - Undo state management
│   ├── directory_locations_isolated.js - Path setup
│   └── snippets.js       - HTML templates
├── jsx/
│   └── import.js         - JSX execution wrapper
├── multitrack/
│   └── main.js           - Multi-track video
├── music/
│   ├── main.js           - Music generation
│   └── listeners.js      - Music UI
├── profanity/
│   └── main.js           - Profanity detection
├── repetition/
│   └── main.js           - Repetition removal
├── reviews/
│   └── main.js           - Review system
├── shorts/
│   ├── main.js           - Highlight detection
│   └── listeners.js      - Shorts UI
├── silence_cutting/
│   ├── main.js           - RMS silence detection
│   ├── helpers.js        - Audio analysis
│   └── listeners.js      - Silence cutting UI
├── surveys/
│   └── main.js           - User feedback
├── tts/
│   ├── main.js           - Text-to-speech
│   └── listeners.js      - TTS UI
├── utils/
│   ├── listeners.js      - Global event handlers (31 functions)
│   └── utils.js          - Core utilities (74KB, 100+ functions)
├── workflows/
│   ├── main.js           - Workflow orchestration
│   ├── ui.js             - Workflow UI (34 functions)
│   └── listeners.js      - Workflow events
└── zooms/
    ├── main.js           - Zoom transcript system (33KB)
    ├── helpers.js        - Zoom curves and face detection
    └── listeners.js      - Zoom UI
```

---

## 3. Feature Module Analysis

### 3.1 Silence Cutting (`lib/silence_cutting/main.js`)

**Algorithm**: RMS-Based Silence Detection
**Dependencies**: None (self-contained audio analysis)

**Core Functions**:
- `remove_silences_sequential()` - Main orchestrator
- `analyze_audio()` - Extract audio samples from video
- `detect_silence_threshold()` - Calculate RMS dBFS
- `calculate_silences()` - Identify silent regions
- `remove_silences()` - Delete clips in timeline

**RMS Algorithm**:
```javascript
// Root Mean Square Calculation
let sumSquares = 0;
for (let i = 0; i < samples.length; i++) {
  sumSquares += samples[i] * samples[i];
}
const rms = Math.sqrt(sumSquares / samples.length);

// Convert to dBFS (decibels relative to full scale)
const dbfs = 20 * Math.log10(rms);

// Threshold check (e.g., -40 dBFS)
const isSilent = dbfs < threshold;
```

**Tightness Parameter**: Determines minimum silence duration (0-100 scale)

---

### 3.2 Filler Word Removal (`lib/filler_words/main.js`)

**Dependencies**: OpenAI Whisper API
**Endpoint**: `https://firecut.ai/api/filler_words/`

**Filler Words Detected**:
- English: "um", "uh", "ah", "er", "hmm", "like", "you know", "I mean"
- Multi-language support

**Process**:
1. Render audio from sequence (MP3)
2. Send to Whisper API for word-level transcription
3. Extract timestamps for each word
4. Filter for filler words
5. Delete corresponding clips in timeline

**Word-Level Timestamp Example**:
```json
{
  "words": [
    {"word": "So", "start": 0.5, "end": 0.7},
    {"word": "um", "start": 0.8, "end": 1.0},  // FILLER
    {"word": "I", "start": 1.1, "end": 1.2},
    {"word": "think", "start": 1.3, "end": 1.6}
  ]
}
```

---

### 3.3 B-roll Stock Footage (`lib/broll/helpers.js`)

**Stock Library Integrations** (30+ functions):
- **Storyblocks** - Video clips, images
- **Pixabay** - Free stock media
- **Pexels** - Free stock videos/photos
- **Giphy** - GIF animations
- **Freepik** - Illustrations
- **Artlist** - Premium stock
- **Envato** - Elements marketplace

**Search Process**:
1. Extract keywords from transcript using GPT-4
2. Query all enabled stock libraries
3. Filter by orientation (landscape/portrait/square)
4. Download and cache media
5. Insert into timeline with transitions

**API Call Example**:
```javascript
async function search_storyblocks(query, mediaTypes=['video']) {
  const apiKey = await get_storyblocks_api_key();
  const url = `https://api.storyblocks.com/api/v2/search/?query=${query}&media_types=${mediaTypes.join(',')}`;

  const response = await fetch(url, {
    headers: {
      'Authorization': `Bearer ${apiKey}`
    }
  });

  return response.json();
}
```

**Chrome Engine Download**: Exposed URL for headless Chrome binary:
```
https://editai-server-backup.ams3.digitaloceanspaces.com/engine/Chrome/
```

---

### 3.4 Caption Generation (`lib/captions/main.js`)

**Captions Class** - Three-tier state model:
1. **Raw Transcript** - From Whisper API
2. **Styled Captions** - User customization applied
3. **Rendered Captions** - Final output in timeline

**Styling Options**:
- **Font**: 200+ Adobe fonts
- **Colors**: Solid or gradient (2-color)
- **Outline**: Thickness and color
- **Shadow**: Offset, blur, color
- **Box**: Background with gradient support
- **Animations**: Wiggle, highlight, glow, underline, box, reveal

**15 Color Pickers** (via Pickr library):
1. Font color (solid)
2. Font gradient color 1
3. Font gradient color 2
4. Outline color
5. Box color (solid)
6. Box gradient color 1
7. Box gradient color 2
8. Shadow color
9. Animation highlight color
10. Animation glow color
11. Animation highlight stroke color
12. Animation underline color
13. Animation box color
14. Animation reveal outline color
15. Chapter clips font color

**Export Formats**:
- SRT (SubRip)
- VTT (WebVTT)
- Embedded in timeline

---

### 3.5 Auto Zoom (`lib/zooms/main.js`)

**System**: Transcript-synchronized zoom animations

**Classes**:
- `ZoomsHighlight` - Single zoom region with time boundaries
- `ZoomsTranscript` - Main controller managing transcript + zooms

**Zoom Triggers**:
- Manual selection (user highlights text)
- AI-detected key phrases (OpenAI GPT-4)
- Frequency-based (every N words/seconds)

**Zoom Parameters**:
- Scale factor (1.0 - 3.0x)
- Center point (X, Y coordinates)
- Face detection (auto-center on detected faces)
- Asymmetric easing curves (separate in/out)

**Curve Presets**:
```javascript
const zooms_curve_presets = {
  'sharp-cut': {
    startPower: 1,
    startDuration: 0,
    endPower: 1,
    endDuration: 0
  },
  'smooth-in-sharp-out': {
    startPower: 2,
    startDuration: 50,
    endPower: 1,
    endDuration: 0
  },
  'smooth-in-ramp-out': {
    startPower: 2,
    startDuration: 40,
    endPower: 2,
    endDuration: 60
  }
};
```

**Bidirectional Sync**:
- **UI → Premiere**: User edits zoom → JSX updates clips
- **Premiere → UI**: Clips modified in Premiere → polling detects → syncs back

---

### 3.6 Workflow Automation (`lib/workflows/main.js` + `lib/workflows/ui.js`)

**Workflow Structure**:
```javascript
{
  id: string,
  name: string,
  steps: [
    {
      type: 'silenceCutting' | 'zooms' | 'broll' | 'captions' | 'profanity' | 'music' | 'chapters',
      settings: {
        // Step-specific configuration
      }
    }
  ]
}
```

**Orchestration**:
```javascript
async function workflowsRun(workflow) {
  for (const step of workflow.steps) {
    switch (step.type) {
      case 'silenceCutting':
        await runSilenceCuttingStep(step.settings);
        break;
      case 'zooms':
        await runAddZoomsStep(step.settings);
        break;
      case 'broll':
        await runBrollStep(step.settings);
        break;
      case 'captions':
        await runCaptionsStep(step.settings);
        break;
      case 'chapters':
        await runAddChaptersStep(step.settings);
        break;
    }
  }
}
```

**UI Functions** (34 total):
- `workflowsRenderList()` - Display saved workflows
- `workflowsRenderEditor()` - Step configuration
- `workflowsRenderSilenceStepSettings()` - Silence cutting config
- `workflowsRenderZoomsStepSettings()` - Zoom config
- `workflowsRenderBrollStepSettings()` - B-roll config (with JSX async)
- `workflowsRenderCaptionsStepSettings()` - Caption config
- `workflowsLoadChapterClips()` - API integration for chapter templates

---

### 3.7 Auto Chapters (`lib/chapters/main.js`)

**Chapter Detection**:
- AI-powered analysis of transcript
- Identifies topic shifts and transitions
- Generates chapter markers in timeline

**Chapter Clips**:
- Motion graphics templates (MOGRT files)
- Fetched from API: `POST https://firecut.ai/api/get_chapter_clips/`
- Preview videos for each template
- User selection via grid UI

---

### 3.8 Text-to-Speech (`lib/tts/main.js`)

**Integration**: ElevenLabs API

**Features**:
- Voice preview and selection
- Custom text input
- Automatic insertion at playhead
- Sync with timeline

---

### 3.9 Music Generation (`lib/music/main.js`)

**AI Music Generation**:
- Analyzes video content
- Generates appropriate background music
- Automatic tempo and mood matching

---

## 4. API Endpoints & Backend

### Backend Configuration

**Production**:
```javascript
API_URL = 'https://firecut.ai/'
```

**Staging** (exposed in code):
```javascript
API_URL = 'https://editai-api-staging.suhailidrees.com/'
```

**Development**:
```javascript
API_URL = 'http://127.0.0.1:8000/'
```

### Main API Endpoints

| Endpoint | Method | Purpose |
|----------|--------|---------|
| `/api/check_license_key/` | POST | License validation |
| `/api/openai_link_whisper/` | POST | Audio transcription (OpenAI) |
| `/api/google_transcribe_link/` | POST | Audio transcription (Google) |
| `/api/get_chapter_clips/` | POST | Chapter template library |
| `/api/filler_words/` | POST | Filler word detection |
| `/api/time_saved/` | POST | Usage statistics |

### Request Format

```javascript
// License Check
POST /api/check_license_key/
{
  "license_key": "ABC123...",
  "os_hostname": "MacBook-Pro.local",
  "machine_id": "a1b2c3d4...",
  "app_version": "1.2.4",
  "engine": "premiere",
  "userGuid": "user-uuid"
}

// Whisper Transcription
POST /api/openai_link_whisper/
FormData:
  - file: audio.mp3
  - model: whisper-1
  - language: en
  - response_format: verbose_json
  - temperature: 0
  - prompt: (optional custom spellings)
Headers:
  - Authorization: Bearer {license_key}
  - APPVERSION: 1.2.4
```

---

## 5. License & Authentication

### License Verification Flow

```javascript
async function verify_license() {
  // 1. Get license key
  const licenseKey = $('#license-key').val();

  // 2. Gather system info
  const machineId = node_machine_id.machineIdSync();
  const hostname = os.hostname();

  // 3. POST to server
  const response = await fetch(API_URL + 'api/check_license_key/', {
    method: 'POST',
    body: JSON.stringify({
      license_key: licenseKey,
      os_hostname: hostname,
      machine_id: machineId,
      app_version: app_version,
      engine: engine,
      userGuid: userGuid
    }),
    headers: {'Content-type': 'application/json'}
  });

  const data = await response.json();

  // 4. Store if valid
  if (data.message == 'License key exists') {
    apiKey_editai = licenseKey;
    apiKey_editai_verified = true;
    apiKey_editai_verified_plan = data.user.plan;
    apiKey_editai_verified_features_tier = data.user.features_tier;

    // Save to disk
    fs.writeFile(
      path.join(DIR_app_data_base, 'license_key.json'),
      JSON.stringify({license_key: licenseKey})
    );
  }
}
```

### Feature Tier System

```javascript
const FEATURES_TIER = {
  'silence-cutting-basic': 10,
  'workflows': 15,
  'remove-filler-words': 15,
  'zooms': 15,
  'chapters': 15,
  'takes': 15,
  'multitrack-video': 15,
  'captions': 15,
  'broll': 15,
  'transcribe_for_captions': 15,
  'add_graphic_captions': 15,
  'tts': 15,
  'music': 15
};
```

### License Storage

- **File**: `{DIR_app_data_base}/license_key.json`
- **Format**: `{"license_key": "ABC123..."}`
- **Validation**: Client-side only (can be bypassed)

---

## 6. AI Service Integrations

### 6.1 OpenAI Whisper

**Use Cases**:
- Audio transcription for captions
- Filler word detection
- Transcript generation for all features

**Configuration**:
```javascript
WHISPER_OPTIONS = {
  host: 'firecut.ai',
  path: '/api/openai_link_whisper/',
  method: 'POST',
  protocol: 'https:',
  headers: {
    'Authorization': 'Bearer ' + apiKey_editai,
    'APPVERSION': app_version
  }
}
```

**File Size Limit**: 25MB (OpenAI constraint)

**Retry Logic**:
```javascript
retries: 3
delay: 1000ms (exponential backoff)
timeout: 600000ms (10 minutes)
```

---

### 6.2 Google Cloud Speech

**Alternative transcription provider**
**Endpoint**: `/api/google_transcribe_link/`

---

### 6.3 OpenAI GPT-4

**Use Cases**:
- B-roll keyword extraction
- Zoom key phrase detection
- Chapter topic detection

---

### 6.4 ElevenLabs TTS

**Text-to-Speech integration**
**Voice library**: Preview and selection UI

---

## 7. Stock Media Integrations

### API Implementations

**Storyblocks**:
```javascript
async function search_storyblocks(query, mediaTypes) {
  const url = `https://api.storyblocks.com/api/v2/search/`;
  // Returns: {results: [{id, title, preview_url, download_url}]}
}
```

**Pixabay**:
```javascript
async function search_pixabay(query) {
  const url = `https://pixabay.com/api/videos/`;
  // Free API with rate limits
}
```

**Pexels**:
```javascript
async function search_pexels(query) {
  const url = `https://api.pexels.com/videos/search`;
  // Free API, requires API key
}
```

**Giphy**:
```javascript
async function search_giphy(query) {
  const url = `https://api.giphy.com/v1/gifs/search`;
  // GIF animations only
}
```

### B-roll Workflow

1. **Keyword Extraction**: GPT-4 analyzes transcript → generates search terms
2. **Multi-Library Search**: Queries all enabled stock APIs in parallel
3. **Filtering**: Orientation matching, duration limits
4. **Download**: Media cached locally
5. **Insertion**: Added to timeline at specified intervals
6. **Transitions**: Configurable video transitions between clips
7. **Scaling**: Fill, fit, or crop modes

---

## 8. Core Algorithms

### 8.1 RMS Silence Detection

**Purpose**: Identify silent regions in audio for removal

**Steps**:
1. Extract audio samples from video
2. Calculate RMS for each sample window
3. Convert RMS to dBFS (decibels relative to full scale)
4. Compare against threshold (-30 to -80 dBFS)
5. Identify continuous silent regions
6. Apply minimum silence duration filter
7. Delete corresponding clips from timeline

**Formula**:
```
RMS = sqrt(sum(sample²) / N)
dBFS = 20 * log10(RMS)
isSilent = dBFS < threshold
```

---

### 8.2 Transcript Quantization

**Purpose**: Align word timestamps to video frame boundaries

```javascript
function quantizeTranscript(transcript, frameRate) {
  transcript.segments.forEach(segment => {
    segment.start = Math.round(segment.start / frameRate) * frameRate;
    segment.end = Math.round(segment.end / frameRate) * frameRate;

    segment.words.forEach(word => {
      word.start = Math.round(word.start / frameRate) * frameRate;
      word.end = Math.round(word.end / frameRate) * frameRate;
    });
  });
}
```

---

### 8.3 Face Detection for Zoom

**Purpose**: Auto-center zoom on detected faces

```javascript
async function detect_face_at_time(timecode) {
  // 1. Export frame at timecode
  const framePath = await exportFrame(timecode);

  // 2. Analyze with face detection API
  const faces = await detectFaces(framePath);

  // 3. Calculate center point
  if (faces.length > 0) {
    const face = faces[0];  // Use first detected face
    const centerX = face.x + (face.width / 2);
    const centerY = face.y + (face.height / 2);
    return {x: centerX, y: centerY};
  }

  return null;  // No face detected
}
```

---

## 9. UI & Event System

### Global Event Listeners (31 functions)

From `lib/utils/listeners.js`:

1. **set_hotkey_listeners()** - Keyboard shortcuts
   - Space: Play/Pause
   - Left/Right: Seek (1 frame or 1 second with Ctrl/Cmd)
   - I/O: Set In/Out points (Shift: Go to)
   - Delete: Delete selected clips
   - R/V: Razor/Select tool
   - Ctrl+Z/Y: Undo/Redo
   - Ctrl+=/−: Zoom in/out

2. **set_dialog_listeners()** - File import/export
3. **set_timeline_tools_listeners()** - Timeline controls
4. **setup_colour_inputs()** - 15 Pickr color pickers
5. **set_undo_listeners()** - Undo/redo system
6. **set_settings_listeners()** - Settings panel
7. **set_license_key_input_listener()** - License activation
8. **set_feedback_board_listeners()** - User feedback

### IPC Communication

**Electron Main Process Communication**:

```javascript
// File dialog events
ipcRenderer.on('selected-save-path', (event, data) => {
  switch(data.action) {
    case 'export-fcproj':
      save_fcproj(file_path = data.path);
      break;
    case 'export-xml':
      nw_export_to_xml(data.path);
      showSurvey({survey_name: 'export_xml_v1'});
      break;
    case 'export-fcpxml':
      nw_export_to_fcpxml(data.path);
      break;
    case 'export-srt-captions-menu':
      export_srt_nw(data.path);
      break;
    case 'export-vtt-captions-menu':
      export_vtt_nw(data.path);
      break;
  }
  ipcRenderer.send('show-file-in-folder', data.path);
});
```

---

## 10. Security Analysis

### ✅ Positive Security Measures

1. **License Binding**: Machine ID + hostname fingerprinting
2. **Bearer Token Auth**: API requests use license key as auth
3. **HTTPS Only**: All external APIs use encrypted connections
4. **Local Storage**: License key stored in local JSON file

### ⚠️ Security Concerns

#### 1. **Exposed Credentials**

**Sentry DSN** (error tracking):
```
https://[redacted]@o4504891499024384.ingest.us.sentry.io/4506911499927552
```

**PostHog Key** (analytics):
```
phc_2zVYeDlMKnbcE9tf8dvWkZTjL9mvMEXABi9UBFJdkhs
```

**Staging API URL**:
```
https://editai-api-staging.suhailidrees.com/
```

**Chrome Engine URL**:
```
https://editai-server-backup.ams3.digitaloceanspaces.com/engine/Chrome/
```

#### 2. **Client-Side License Validation**

License checks are performed in JavaScript and can be bypassed by:
- Modifying `apiKey_editai_verified` variable
- Skipping `verify_license()` calls
- Patching feature tier checks

**Recommendation**: Move license validation to server-side with cryptographic signatures.

#### 3. **No Input Validation on JSX Execution**

```javascript
await jsxExecute('deleteTrackItemByNodeId("' + nodeId + '")');
```

**Risk**: If `nodeId` contains special characters, could inject arbitrary ExtendScript code.

**Recommendation**: Sanitize all inputs before string interpolation.

#### 4. **API Keys in Stock Integrations**

Some stock library API keys may be hardcoded or easily extractable from the client code.

#### 5. **No Request Rate Limiting (Client-Side)**

Unlimited API calls can be made to backend, potentially causing:
- Increased costs for API usage
- Server overload
- Abuse potential

---

## 11. SPLICE Parity Comparison

### Feature Comparison Matrix

| Feature | FireCut | SPLICE | Notes |
|---------|---------|--------|-------|
| **Silence Cutting** | ✅ RMS-based | ✅ Implemented | SPLICE backend has similar implementation |
| **Filler Word Removal** | ✅ Whisper API | ❌ Missing | SPLICE needs Whisper integration |
| **B-roll Stock Search** | ✅ 7 providers | ❌ Missing | Major feature gap |
| **Caption Generation** | ✅ Full styling | ⚠️ Basic | SPLICE has basic captions, lacks advanced styling |
| **Auto Zoom** | ✅ Transcript-sync | ❌ Missing | Complex feature to implement |
| **Auto Chapters** | ✅ AI-powered | ❌ Missing | Requires GPT-4 integration |
| **Workflow Automation** | ✅ Multi-step | ❌ Missing | Major productivity feature |
| **TTS** | ✅ ElevenLabs | ❌ Missing | Voice generation feature |
| **Music Generation** | ✅ AI music | ✅ Implemented | SPLICE has this via Replicate |
| **License System** | ✅ Server-based | ✅ Implemented | Both have license validation |
| **Analytics** | ✅ PostHog+Sentry | ❌ Missing | SPLICE needs usage tracking |
| **Undo System** | ✅ State save | ❌ Missing | SPLICE relies on Premiere's undo |
| **Multi-format Export** | ✅ FCP/XML/SRT/VTT | ❌ Missing | SPLICE exports limited formats |

### Feature Gaps (SPLICE Missing)

1. **B-roll Stock Integration** (7 APIs)
   - Storyblocks, Pixabay, Pexels, Giphy, Freepik, Artlist, Envato
   - Keyword extraction via GPT-4
   - Media filtering and insertion

2. **Advanced Caption Styling**
   - 15 color pickers for granular control
   - Gradient support (2-color)
   - Animations: wiggle, highlight, glow, underline, box, reveal
   - 200+ Adobe font integration

3. **Auto Zoom System**
   - Transcript synchronization
   - Face detection
   - Asymmetric easing curves
   - Bidirectional UI ↔ Premiere sync

4. **Workflow Automation**
   - Multi-step pipelines
   - Configurable per-step settings
   - Save/load workflow presets

5. **Filler Word Detection**
   - Whisper API integration
   - Word-level timestamp extraction
   - Automatic removal from timeline

6. **Auto Chapters**
   - AI topic detection
   - MOGRT template library
   - Preview and selection UI

7. **TTS Integration**
   - ElevenLabs voice library
   - Voice preview
   - Timeline insertion

8. **Analytics & Tracking**
   - PostHog session recording
   - Sentry error tracking
   - Usage statistics

9. **Export Formats**
   - Final Cut Pro XML
   - DaVinci Resolve XML
   - SRT/VTT captions

10. **Undo System**
    - State save/restore via project export
    - Abort and rollback capability

### SPLICE Advantages

1. **Modern Architecture**
   - Next.js frontend (vs jQuery)
   - Railway deployment (vs self-hosted)
   - PostgreSQL + Redis (vs file-based storage)

2. **Security**
   - JWT authentication with refresh tokens
   - CSRF protection
   - Token blacklist with TTL
   - Server-side validation

3. **Music Generation**
   - Already implemented via Replicate
   - Cloudflare R2 storage for files

4. **Code Quality**
   - Clean, non-obfuscated code
   - TypeScript support
   - Modern React patterns

---

## 12. Recommendations

### For SPLICE Development

#### Priority 1: High-Impact Features (Implement First)

1. **Filler Word Removal**
   - Integrate OpenAI Whisper API
   - Reuse existing transcript logic
   - Estimated effort: 2-3 days

2. **Advanced Caption Styling**
   - Add color picker components
   - Implement gradient support
   - Add animation options
   - Estimated effort: 5-7 days

3. **B-roll Stock Integration** (MVP)
   - Start with 2-3 providers (Pixabay, Pexels)
   - GPT-4 keyword extraction
   - Basic insertion logic
   - Estimated effort: 7-10 days

4. **Analytics & Tracking**
   - PostHog integration
   - Usage metrics
   - Error tracking (Sentry)
   - Estimated effort: 2-3 days

#### Priority 2: Productivity Features

5. **Workflow Automation**
   - Multi-step pipeline system
   - Workflow templates
   - Save/load presets
   - Estimated effort: 10-14 days

6. **Auto Zoom System**
   - Transcript synchronization
   - Basic zoom animations
   - (Face detection: optional advanced feature)
   - Estimated effort: 7-10 days

7. **Export Formats**
   - FCP XML
   - DaVinci Resolve XML
   - SRT/VTT captions
   - Estimated effort: 3-5 days

#### Priority 3: Advanced Features

8. **Auto Chapters**
   - GPT-4 topic detection
   - Chapter marker generation
   - (MOGRT templates: optional)
   - Estimated effort: 5-7 days

9. **TTS Integration**
   - ElevenLabs API
   - Voice library
   - Timeline insertion
   - Estimated effort: 3-5 days

10. **Undo System**
    - State save/restore
    - Rollback capability
    - Estimated effort: 5-7 days

### Security Improvements

1. **Move License Validation to Server**
   - Cryptographic signatures
   - Token-based auth instead of license key directly
   - Rate limiting per user

2. **Input Sanitization**
   - Validate all user inputs
   - Escape special characters in JSX execution
   - Prevent injection attacks

3. **Hide API Keys**
   - Store in environment variables
   - Proxy stock API calls through backend
   - Never expose keys in client code

4. **Implement Rate Limiting**
   - Per-user API quotas
   - Throttle expensive operations
   - Monitor abuse patterns

### Architecture Improvements

1. **Use Modern UI Framework**
   - React/Vue instead of jQuery
   - Component-based architecture
   - Better state management

2. **TypeScript**
   - Type safety throughout codebase
   - Better IDE support
   - Catch errors at compile-time

3. **Testing**
   - Unit tests for algorithms
   - Integration tests for API calls
   - E2E tests for critical workflows

4. **Code Splitting**
   - Lazy load feature modules
   - Reduce initial bundle size
   - Improve load performance

---

## Conclusion

FireCut v1.2.4 is a sophisticated video editing automation tool with extensive AI integrations and professional-grade features. The codebase is heavily obfuscated but follows clear architectural patterns once deobfuscated.

**Key Strengths**:
- Comprehensive feature set (10+ major features)
- Multiple AI service integrations
- Professional workflow automation
- Multi-format export support

**Key Weaknesses**:
- Client-side license validation (bypassable)
- Exposed credentials (Sentry, PostHog, staging URLs)
- Heavy jQuery dependency (dated architecture)
- Obfuscation provides minimal security benefit

**SPLICE Development Path**:
SPLICE has a strong foundation with modern architecture, security, and core music generation. To achieve feature parity with FireCut, focus on:
1. Filler word removal (quick win)
2. Advanced caption styling (user-facing value)
3. B-roll stock integration (major differentiator)
4. Analytics and workflow automation (productivity boost)

**Total Estimated Implementation**: 50-70 days for all priority features, assuming 1-2 developers working full-time.

---

## Appendix: Complete Function Reference

### lib/utils/utils.js (74KB - 100+ functions)

**License & Auth**:
- `verify_license()`
- `verify_license_throttled()`
- `regular_license_key_checker()`
- `load_license_key()`

**Transcription**:
- `transcribeSequence()`
- `transcribe_audio_file()`
- `retryFormDataSubmit()`

**Premiere Pro Integration**:
- `jsxExecute()`
- `duplicate_sequence()`
- `render()`
- `make_in_out_selection()`

**State Management**:
- `test_45_save_state()`
- `test_47_load_state()`

**Utilities**:
- `timeConversion()`
- `humanFileSize()`
- `tools.arraysToCSV()`
- `tools.HSLToRGB()`
- `tools.escapeHTML()`

### lib/utils/listeners.js (73KB - 31 functions)

**Event Listeners**:
- `set_hotkey_listeners()` - Keyboard shortcuts
- `setup_colour_inputs()` - 15 Pickr instances
- `set_dialog_listeners()` - File dialogs
- `set_timeline_tools_listeners()` - Timeline controls
- `set_undo_listeners()` - Undo/redo
- `set_license_key_input_listener()` - License input
- `set_feedback_board_listeners()` - User feedback

**Color Management**:
- `updateFontGradientPreviews()`
- `updateBoxGradientPreviews()`

### lib/broll/helpers.js (30+ functions)

**Stock Library Searches**:
- `search_storyblocks()`
- `search_pixabay()`
- `search_pexels()`
- `search_giphy()`
- `search_freepik()`
- `search_artlist()`
- `search_envato()`

**Keyword Extraction**:
- `extract_keywords_gpt4()`

### lib/silence_cutting/main.js (8 functions)

**Silence Detection**:
- `remove_silences_sequential()`
- `analyze_audio()`
- `detect_silence_threshold()`
- `calculate_silences()`
- `remove_silences()`

### lib/captions/main.js (Captions class)

**Caption Generation**:
- `constructor()`
- `generateCaptions()`
- `applyStyling()`
- `exportSRT()`
- `exportVTT()`

### lib/zooms/main.js (33KB)

**Zoom System**:
- `ZoomsHighlight` class
- `ZoomsTranscript` class
- `quantizeTranscript()`
- `zoomClipsChangeListener()`
- `onZoomsChangeCallback()`

### lib/workflows/ui.js (34 functions)

**Workflow UI**:
- `workflowsRenderList()`
- `workflowsRenderEditor()`
- `workflowsRenderSilenceStepSettings()`
- `workflowsRenderZoomsStepSettings()`
- `workflowsRenderBrollStepSettings()`
- `workflowsRenderCaptionsStepSettings()`
- `workflowsLoadChapterClips()`

---

**End of Complete Deobfuscation Analysis**

For questions or further analysis, please contact the SPLICE development team.
