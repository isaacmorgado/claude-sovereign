#!/bin/bash
#
# SPLICE CEP Quick Fix Script
# Enables CEP debug mode for all Adobe versions
#

echo "=========================================="
echo "SPLICE CEP Quick Fix"
echo "=========================================="
echo ""

# Enable debug mode for all CSXS versions
echo "Enabling CEP debug mode..."
defaults write com.adobe.CSXS.9 PlayerDebugMode 1
defaults write com.adobe.CSXS.10 PlayerDebugMode 1
defaults write com.adobe.CSXS.11 PlayerDebugMode 1
defaults write com.adobe.CSXS.12 PlayerDebugMode 1
defaults write com.adobe.CSXS.13 PlayerDebugMode 1

echo "✓ Debug mode enabled for CSXS 9-13"
echo ""

# Clear CEP cache
echo "Clearing CEP cache..."
if [ -d ~/Library/Caches/Adobe/CEP ]; then
    rm -rf ~/Library/Caches/Adobe/CEP
    echo "✓ CEP cache cleared"
else
    echo "✓ No CEP cache to clear"
fi
echo ""

# Check if Premiere Pro is running
if pgrep -x "Adobe Premiere Pro" > /dev/null; then
    echo "⚠️  Premiere Pro is running!"
    echo "   Please QUIT Premiere Pro completely (Cmd+Q)"
    echo "   Then restart it for changes to take effect."
else
    echo "✓ Premiere Pro is not running"
    echo "  You can now start Premiere Pro"
fi

echo ""
echo "=========================================="
echo "Setup Complete!"
echo "=========================================="
echo ""
echo "Next steps:"
echo "1. Start (or restart) Adobe Premiere Pro"
echo "2. Go to: Window → Extensions → SPLICE - AI Video Editor"
echo "3. The panel should now open"
echo ""
echo "If you still get errors, open Chrome and go to:"
echo "http://localhost:8092"
echo "Then click on SPLICE to see debug logs"
echo ""
