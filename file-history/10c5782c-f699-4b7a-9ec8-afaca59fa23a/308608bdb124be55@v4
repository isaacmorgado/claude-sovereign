# SPLICE

AI-powered Premiere Pro UXP plugin for detecting takes, removing silences, and accelerating video editing workflows.

## Current Focus
**Auto-Cutting v3.5** - Direct DOM Reconstruction (Zero Manual Steps)

## Quick Reference

### Pricing Tiers
| Tier | Price | Hours | Isolation | Stripe Price ID |
|------|-------|-------|-----------|-----------------|
| Starter | $19/mo | 15 hrs | ❌ None | price_1SgH4m2L5BseYEbCih347qfr |
| Pro | $49/mo | 50 hrs | 45 min included | price_1SgH4o2L5BseYEbCIoR19lhQ |
| Team | $149/mo | 150 hrs | 3 hrs included | price_1SgH4q2L5BseYEbCYTlimb5M |
| Overage | $1/hr | - | $0.10/min | price_1SgH4y2L5BseYEbClZuxNRu8 |

### Isolation Pricing (v3.4)
- **Starter**: No access (upgrade required)
- **Pro**: 45 min included, then $0.10/min overage
- **Team**: 3 hrs included, then $0.10/min overage
- **Our cost**: $0.015/min → **85% margin on overage**
- **Worst-case margin**: 80%+ (sized to maintain margins at full utilization)

### Key Constraints
- UXP requires Premiere Pro 25.6+
- Use `127.0.0.1` not `localhost` in fetch URLs
- Backend (prod): https://splice-api-production.up.railway.app

## Key Files

| File | Purpose |
|------|---------|
| `splice-backend/server.js` | Express + all endpoints + webhook handler |
| `splice-backend/services/usageTracking.js` | Credit balance, usage logging |
| `splice-plugin/js/credits.js` | Fetch/display credit balance |
| `splice-plugin/js/main.js` | Plugin initialization + workflows |
| `splice-plugin/index.html` | UI with credit badge in header |

## Implementation Phases

- Phase 1: Backend billing ✅
- Phase 2: Frontend credits ✅
- Phase 3: Preview Mode ✅
- Phase 4-6: Smart Filtering, Automation, Polish

## Last Session (2025-12-20)

**v3.5 - Direct DOM Reconstruction Architecture**

Designed new zero-manual-step architecture. Key discovery: UXP CAN build sequences directly without XML export/import.

**Core UXP APIs (Verified):**
- `SequenceEditor.createInsertProjectItemAction()` - Insert clips at timecode
- `ProjectItem.createSetColorLabelAction(index)` - Color clips (set BEFORE insert)
- `TrackItem.createSetInPointAction/OutPointAction()` - Set in/out points
- `project.executeTransaction(actions)` - Batch execute atomically
- `fs.createPersistentToken(folder)` - Silent file access (Persistent Token pattern)

**Architecture Decision:**
- Skip XML entirely → Backend returns JSON cut list
- Analyze source clips in Bin (no audio export needed)
- Plugin builds sequence directly using DOM APIs
- Color-coding works by setting ProjectItem color before each insert

**New Files Planned:**
- `splice-plugin/js/builder.js` - Direct DOM sequence builder
- `splice-backend/services/cutListGenerator.js` - JSON cut list generator

**Deprecating:**
- `splice-plugin/js/slice9-razor.js` - Old XML workflow
- `splice-backend/services/xmlProcessor.js` - Old XML processor

**Stopped at:** Plan approved, implementation not started. Read plan at `.claude/plans/idempotent-purring-hedgehog.md`

## Next Steps
1. Create `splice-plugin/js/builder.js` - Direct DOM sequence builder
2. Create `splice-backend/services/cutListGenerator.js` - JSON cut list generator
3. Add `setupMediaFolder()` to settings.js for Persistent Token
4. Add "Set Media Folder" button to index.html
5. Add `/cut-list` endpoint to server.js
6. Integrate `buildSequenceFromCutList()` in main.js

---
*Last updated: 2025-12-20*
