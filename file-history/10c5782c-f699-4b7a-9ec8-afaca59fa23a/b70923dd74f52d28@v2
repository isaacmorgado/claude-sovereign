# SPLICE Auto-Cutting: Approach Comparison & Recommendation

## Executive Summary

**Decision Point: CEP (Expires 2026) vs Pure UXP (Future-Proof)**

The "Ghost Import" code you shared uses **CEP's evalScript**, which calls ExtendScript. This works TODAY but will break in September 2026. Pure UXP cannot call ExtendScript and has no equivalent import API.

### The Trade-off
| Approach | Automation | Longevity | Risk |
|----------|------------|-----------|------|
| CEP + evalScript | Full (no clicks) | Until Sept 2026 | Breaks in ~9 months |
| Pure UXP | 2-click manual | Indefinite | No automation |

### Recommendation
**Option C: Hybrid Architecture** - Build both, let users choose based on their timeline needs.

---

## The Code You Shared: CEP Analysis

```javascript
// This line reveals it's CEP, not UXP:
const { evalScript } = require("application");

// This calls ExtendScript:
evalScript(`injectXMLToTimeline("${safePath}")`);
```

**The Ghost Import pattern is clever:**
1. `app.project.importFiles()` silently imports XML
2. Opens temp sequence, copies all clips
3. Pastes into original timeline
4. Deletes temp sequence

**But it requires ExtendScript** which ends September 2026.

---

## Three Approaches Compared

### Approach A: CEP + ExtendScript (Your Code)
**Status: WORKS NOW, EXPIRES SEPT 2026**

| Feature | Support |
|---------|---------|
| Silent XML import | ✅ `app.project.importFiles()` |
| Ghost sequence copy/paste | ✅ `app.executeCommand()` |
| Color codes in XML | ✅ `<label2>` tag |
| Ripple delete by marker | ✅ `cmd_Extract` |
| **Future-proof** | ❌ Ends Sept 2026 |

### Approach B: Pure UXP (Current SPLICE)
**Status: WORKS INDEFINITELY, MANUAL STEPS**

| Feature | Support |
|---------|---------|
| Export XML | ❌ Manual (File > Export) |
| Import XML | ❌ Manual (File > Import) |
| Color labels after import | ✅ `createSetColorLabelAction()` |
| Markers preview | ✅ Full API |
| **Future-proof** | ✅ Indefinite |

### Approach C: Hybrid (RECOMMENDED)
**Status: BEST OF BOTH WORLDS**

Build both:
1. **CEP version** for full automation until Sept 2026
2. **UXP version** for long-term support
3. **Shared backend** for XML processing

---

## Hybrid Architecture Implementation

### Project Structure
```
SPLICE/
├── splice-plugin/          # UXP Panel (Premiere 25.6+)
│   └── js/
│       ├── main.js         # Current UXP implementation
│       └── slice9-razor.js # XML workflow
│
├── splice-cep/             # NEW: CEP Panel (Premiere 24-25.5)
│   ├── client/
│   │   ├── index.js        # CEP frontend (evalScript)
│   │   └── xmlGenerator.js # Shared XML generation
│   └── host/
│       └── script.jsx      # ExtendScript (Ghost Import)
│
└── splice-backend/         # Shared backend (unchanged)
    └── services/
        └── xmlProcessor.js
```

### Phase 1: CEP Panel (Full Automation)
**Goal:** Implement Ghost Import for users who need automation now

1. Create `splice-cep/` folder
2. Implement `host/script.jsx`:
   - `injectXMLToTimeline()` - Ghost Import pattern
   - `safeRippleDelete()` - Marker-based delete
3. Implement `client/index.js`:
   - `evalScript()` bridge to JSX
   - UI buttons for workflow
4. Color heatmap via `<label2>` in XML

### Phase 2: UXP Enhancements
**Goal:** Add color labeling to existing UXP workflow

1. After user imports XML, call `colorCodeClipsByTake()`
2. Use `createSetColorLabelAction()` for take colors
3. Improve modal UX for export/import steps

### Phase 3: Shared Components
**Goal:** Avoid code duplication

- XML generation logic shared between CEP and UXP
- Backend unchanged (both panels call same endpoints)
- Color scheme consistent across both

---

## Files to Create/Modify

### New Files (CEP)
| File | Purpose |
|------|---------|
| `splice-cep/host/script.jsx` | ExtendScript: Ghost Import, Ripple Delete |
| `splice-cep/client/index.js` | CEP UI + evalScript bridge |
| `splice-cep/client/xmlGenerator.js` | XML with color codes |
| `splice-cep/manifest.xml` | CEP manifest |

### Modified Files (UXP)
| File | Changes |
|------|---------|
| `splice-plugin/js/main.js` | Add `colorCodeClipsByTake()` |
| `splice-plugin/js/slice9-razor.js` | Call color-coding after import |

---

## Recommendation (Based on Your Requirements)

**You said: "No we need it to work past September 2026"**

This eliminates CEP as a viable option. The only path forward is:

### **Option 2: Enhanced UXP (RECOMMENDED)**

**Implementation:**
1. Keep current 2-click workflow (export/import)
2. Add `colorCodeClipsByTake()` after import
3. Improve modal UX to minimize friction
4. Monitor Adobe for future UXP API additions

**What We CAN Do (UXP):**
- Color-code clips by take count (heatmap)
- Rename clips with take names
- Preview with adjustable markers
- Backend processes XML silently

**What We CANNOT Automate (Yet):**
- Export (File > Export > FCP XML) - 1 click
- Import (File > Import) - 1 click

**The 2-click trade-off is worth it for indefinite support.**

---

## Sources

- [UXP Arrives in Premiere](https://blog.developer.adobe.com/en/publish/2025/12/uxp-arrives-in-premiere-a-new-era-for-plugin-development)
- [Adobe Developer: Premiere UXP API](https://developer.adobe.com/premiere-pro/uxp/)
- [ExtendScript to UXP Migration](https://developer.adobe.com/indesign/uxp/resources/migration-guides/extendscript/)
- [Running JSX Programmatically](https://community.adobe.com/t5/premiere-pro-discussions/how-can-i-run-jsx-programmatically/m-p/15382813)
