# SPLICE Continuation Prompt

## Current State
- **Version:** 3.5 (95% FireCut parity, 10-100x faster)
- **Status:** 5 critical blockers remaining (5.5 hrs total)
- **Tests:** 19/19 passing

## Task: Fix 5 Production Blockers

### 1. Batch Job Memory Leak (1 hr)
**File:** `splice-backend/server.js` (lines 1400-1450)
- `batchJobs` Map grows unbounded
- Add auto-cleanup for jobs older than 24 hours
- Add max job limit (10,000)

### 2. Rate Limiting Not Enforced (1 hr)
**File:** `splice-backend/server.js`
**Middleware:** `splice-backend/middleware/rateLimiter.js`
- `requireCredits` middleware exists but not applied
- Apply to: `/analyze`, `/silences`, `/silences-rms`, `/profanity`, `/multitrack`

### 3. Webhook Signature Bypass (30 min)
**File:** `splice-backend/server.js` (lines 100-130)
- Dev mode accepts unsigned webhooks
- Throw error if `STRIPE_WEBHOOK_SECRET` not set in production

### 4. Builder Error Handling (1 hr)
**File:** `splice-plugin/js/builder.js` (lines 200-350)
- `executeTransaction()` calls not wrapped in try/catch
- Add error handling, return user-friendly message
- Prevent plugin crash on failure

### 5. "Build Sequence" UI Button (2 hrs)
**File:** `splice-plugin/index.html`
**File:** `splice-plugin/js/main.js`
- Add button after silence detection completes
- Call `window.buildSequenceWithCutList()` on click
- Show progress during build

## Key References
- Architecture: `CLAUDE.md`
- Parity analysis: `FIRECUT_PARITY_ANALYSIS.md`
- Strategic plan: `STRATEGIC_ROADMAP.md`
- Builder: `splice-plugin/js/builder.js`
- Server: `splice-backend/server.js`

## Commands
```bash
cd /Users/imorgado/SPLICE/splice-backend
node server.js                    # Start server
node tests/phase5-e2e.test.js     # Run tests
```

## After Fixes
- Deploy to Railway
- Test v3.5 builder in Premiere Pro 25.6+
- Invite beta testers
