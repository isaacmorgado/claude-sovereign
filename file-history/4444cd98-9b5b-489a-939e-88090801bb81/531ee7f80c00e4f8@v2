# üîß SPLICE Master Guide for Danny Isakov

**Last Updated:** 2026-01-11
**Status:** Issues Identified & Partially Fixed
**Your License Key:** `SPLICE-Y2Q9-6G9G-MFQE`

---

## üìä Current Status Summary

| Component | Status | Notes |
|-----------|--------|-------|
| **Backend API** | ‚úÖ Working | Railway production is healthy |
| **CEP Plugin** | ‚úÖ Fixed | Backend URL bug resolved (commit 5e47942) |
| **UXP Plugin** | ‚úÖ Working | Always used correct URL |
| **Website Login** | ‚ö†Ô∏è Broken | Missing environment variables in Vercel |
| **Your Account** | ‚úÖ Active | Team tier, unlimited credits |

---

## üêõ What Was Broken (Root Cause Analysis)

### Primary Issue: CEP Panel Connection Error ‚úÖ FIXED

**Symptom:** "Connection Error: Check server is running"

**Root Cause:** The CEP panel was incorrectly detecting `file://` protocol as "development mode" and trying to connect to `localhost:3847` instead of the production Railway backend.

**Fixed In:** Commit 5e47942 (2026-01-11)

**Solution:** Changed `getBackendUrl()` to default to production URL for all CEP panels.

---

### Secondary Issue: Website Login Not Working ‚ö†Ô∏è NOT FIXED YET

**Symptom:** Website login at `https://spliceclips.com/login` fails

**Root Causes:**
1. ‚ùå Wrong backend URL default (`api.spliceclips.com` doesn't exist)
2. ‚ùå Missing environment variable `BACKEND_API_URL` in Vercel
3. ‚ùå Missing `splice.video` domain in backend CORS whitelist
4. ‚ùå Inconsistent cookie settings (`sameSite: lax` vs `strict`)

**Status:** Requires Vercel configuration update

---

### Potential Issue: Customer ID Format ‚ö†Ô∏è NEEDS VERIFICATION

**Your Customer ID should be:** `cus_beta_danny_isakov`
**Setup script used:** `beta_danny_isakov` (missing `cus_` prefix)

**Impact:** JWT token generation requires `cus_` prefix. If database has wrong format, login will fail.

**Action Needed:** Database check (see Troubleshooting section)

---

## üöÄ Quick Start - What You Should Do Now

### Option 1: Install Fixed CEP Plugin (Recommended)

**This should work now - the connection error is fixed!**

1. **Download the fixed version:**
   ```
   https://spliceclips.com/downloads/splice-v6.0.3-dev.zip
   ```

2. **Install with ZXPInstaller:**
   - Get ZXPInstaller: https://aescripts.com/learn/zxp-installer/
   - Drag the `.zxp` file into ZXPInstaller
   - Wait for "Installation successful"

3. **Restart Premiere Pro**

4. **Open SPLICE panel:**
   - Go to `Window ‚Üí Extensions ‚Üí SPLICE`

5. **Login with your license key:**
   - Click "Login" button
   - Enter: `SPLICE-Y2Q9-6G9G-MFQE`
   - Click "Activate"

6. **If login succeeds:**
   - ‚úÖ You're all set! Proceed to feature testing
   - See full testing guide: [DANNY_TESTING_INSTRUCTIONS.md](DANNY_TESTING_INSTRUCTIONS.md)

7. **If login still fails:**
   - Continue to Troubleshooting section below

---

### Option 2: Force Production Backend (Quick Fix)

If the fixed version still has issues, manually force the production URL:

1. **Open Chrome debugger:**
   - Open Chrome browser
   - Navigate to: `http://localhost:8092`
   - Find "SPLICE" in the list and click it

2. **Run this command in the console:**
   ```javascript
   localStorage.setItem('spliceBackendUrl', 'https://splice-api-production.up.railway.app');
   location.reload();
   ```

3. **Try logging in again** with your license key

---

## üîç Troubleshooting

### Check 1: Is the Backend Healthy?

Run this diagnostic script:
```bash
cd /Users/imorgado/SPLICE
./diagnose-connection.sh
```

**Expected output:**
- ‚úÖ DNS resolution successful
- ‚úÖ Network connectivity: OK
- ‚úÖ HTTPS endpoint accessible
- ‚úÖ SSL certificate valid
- ‚úÖ Health check: Healthy
- ‚úÖ Backend response time: ~0.2s

**If any check fails:**
- You may have a firewall blocking `*.railway.app`
- Try from a different network (mobile hotspot vs WiFi)
- Check with your IT department about network restrictions

---

### Check 2: Verify Your Customer ID Format

Ask the developer to run this database query:
```sql
SELECT
  key,
  stripe_customer_id,
  activated_at,
  is_active,
  tier
FROM license_keys
WHERE key = 'SPLICE-Y2Q9-6G9G-MFQE';
```

**Expected result:**
```
key: SPLICE-Y2Q9-6G9G-MFQE
stripe_customer_id: cus_beta_danny_isakov  ‚Üê Must start with "cus_"
activated_at: [timestamp]
is_active: true
tier: Team
```

**If `stripe_customer_id` is missing `cus_` prefix:**

The developer needs to run this fix:
```sql
UPDATE license_keys
SET stripe_customer_id = 'cus_beta_danny_isakov'
WHERE stripe_customer_id = 'beta_danny_isakov';
```

---

### Check 3: Collect Debug Logs

If login still fails after the above checks:

1. **Open Chrome debugger** at `http://localhost:8092`
2. **Click on "SPLICE"** in the list
3. **Open the Console tab**
4. **Try to login** in the SPLICE panel
5. **Look for these log entries:**
   - `[SPLICE FETCH]` - Shows network requests
   - `[SPLICE DEBUG]` - Shows detailed error info
   - `[SPLICE]` - Shows backend URL being used

6. **Take screenshots** of:
   - All error messages in console
   - Network tab showing failed requests
   - The SPLICE panel showing the error

7. **Send logs to:** isaacfmor@gmail.com

---

## üåê Website Login (Currently Broken)

**Do NOT try to login via the website** (`https://spliceclips.com/login`) - it will not work.

**Why it's broken:**
1. Missing Vercel environment variable: `BACKEND_API_URL`
2. Code defaults to non-existent URL: `https://api.spliceclips.com`
3. CORS whitelist missing `splice.video` domain

**Developer needs to fix:**

### Step 1: Set Vercel Environment Variables

In Vercel project settings, add:
```bash
BACKEND_API_URL=https://splice-api-production.up.railway.app
NEXT_PUBLIC_BACKEND_API_URL=https://splice-api-production.up.railway.app
```

### Step 2: Update Backend CORS Whitelist

File: `/Users/imorgado/SPLICE/splice-backend/server.js` (around line 310)

Add these domains:
```javascript
const CORS_WHITELIST = [
  'https://spliceclips.com',
  'https://www.spliceclips.com',
  'https://splice.video',           // ‚Üê ADD THIS
  'https://www.splice.video',        // ‚Üê ADD THIS
  'https://splice-api-production.up.railway.app',
  'https://splice-website.vercel.app',
  'file://',
  'bolt://'
];
```

### Step 3: Fix Cookie Settings Consistency

All auth routes should use `sameSite: "lax"` (not `"strict"`)

Files to update:
- `/Users/imorgado/SPLICE/splice-website/src/app/api/auth/me/route.ts`
- `/Users/imorgado/SPLICE/splice-website/src/app/api/auth/logout/route.ts`
- `/Users/imorgado/SPLICE/splice-website/src/app/api/auth/refresh/route.ts`

Change:
```typescript
sameSite: "strict"  // ‚Üê Change this
```

To:
```typescript
sameSite: "lax"     // ‚Üê To this
```

### Step 4: Change Default Backend URL Fallback

In all files that reference backend API, change:
```typescript
const BACKEND_API_URL = process.env.BACKEND_API_URL || "https://api.spliceclips.com";
```

To:
```typescript
const BACKEND_API_URL = process.env.BACKEND_API_URL || "https://splice-api-production.up.railway.app";
```

**Files affected:**
- `splice-website/src/lib/csrf.ts` (line 14)
- `splice-website/src/app/api/auth/login/route.ts` (line 6)
- `splice-website/src/app/api/auth/me/route.ts` (line 6)
- `splice-website/src/app/api/auth/logout/route.ts` (line 7)
- `splice-website/src/app/api/auth/refresh/route.ts` (line 7)
- `splice-website/src/app/api/usage/route.ts` (line 6)
- `splice-website/src/app/api/webhook/route.ts` (line 20)

### Step 5: Redeploy Website

After making changes:
```bash
git add .
git commit -m "Fix website authentication: correct backend URLs and CORS"
git push origin main
```

Vercel will auto-deploy.

---

## ‚úÖ Your Account Details

```
License Key:   SPLICE-Y2Q9-6G9G-MFQE
Customer ID:   cus_beta_danny_isakov (verify format!)
Email:         danny@splice-beta.test
Tier:          Team (Full Access)
Music Credits: 999,999 (unlimited)
Hours:         999,999 (unlimited)
Status:        Pre-Activated
Backend:       https://splice-api-production.up.railway.app
```

---

## üìö Additional Documentation

- **Full Testing Guide:** [DANNY_TESTING_INSTRUCTIONS.md](DANNY_TESTING_INSTRUCTIONS.md)
- **Quick Fix:** [DANNY_QUICK_FIX.md](DANNY_QUICK_FIX.md)
- **Debug Instructions:** [DANNY_DEBUG_INSTRUCTIONS.md](splice-website/public/downloads/DANNY_DEBUG_INSTRUCTIONS.md)
- **Technical Deep Dive:** [FIX_DANNY_LOGIN_ISSUE.md](FIX_DANNY_LOGIN_ISSUE.md)

---

## üìû Contact & Support

**Developer Email:** isaacfmor@gmail.com

**When reporting issues, include:**
1. Which component you're using (CEP plugin, UXP plugin, or website)
2. Screenshot of error message
3. Console logs from Chrome debugger (`http://localhost:8092`)
4. Network tab showing failed requests
5. What network you're on (corporate WiFi, home, mobile hotspot, etc.)

---

## üéØ Next Steps

### For Danny:
1. ‚úÖ Install the fixed CEP plugin (v6.0.3-dev)
2. ‚úÖ Try to login with your license key
3. ‚úÖ If it works, proceed to feature testing
4. ‚ùå If it fails, collect debug logs and send to developer
5. ‚è∏Ô∏è Don't try website login - it's broken (dev needs to fix)

### For Developer:
1. ‚ùå Verify Danny's customer ID format in database
2. ‚ùå Fix website environment variables in Vercel
3. ‚ùå Update backend CORS whitelist
4. ‚ùå Fix cookie sameSite inconsistency
5. ‚ùå Change default backend URL fallbacks
6. ‚ùå Redeploy website

---

**üîê Bottom Line:** The CEP plugin should work now. If it doesn't, we need to check your customer ID format in the database and verify there are no network restrictions blocking Railway.
