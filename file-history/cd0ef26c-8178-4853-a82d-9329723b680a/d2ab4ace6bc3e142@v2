# RunPod VS Code Integration Guide
**Control RunPod GPU endpoints effortlessly from VS Code**

---

## Overview

This guide shows you how to:
1. ‚úÖ Control RunPod endpoints from VS Code (no website needed)
2. ‚úÖ Add status bar buttons for one-click control
3. ‚úÖ Auto-scale to zero to save money
4. ‚úÖ Check endpoint status at a glance

---

## Understanding RunPod Serverless Billing

### **IMPORTANT: You're Already Auto-Saving Money!**

RunPod serverless endpoints with `workersMin: 0` (the default) **automatically scale to zero**:

- ‚úÖ No requests for ~5 minutes ‚Üí Workers shut down ‚Üí **$0/hour cost**
- ‚úÖ New request comes in ‚Üí Worker starts (2-5 sec cold start) ‚Üí Processes ‚Üí Shuts down
- ‚úÖ You only pay for actual compute time + ~2-5 seconds per request

**Example cost (optimized GPUs):**
- 10 requests/day √ó 30 seconds each = 5 minutes compute time
- 5 minutes on A40 ($0.79/hr) = **$0.066/day = $2/month**
- 5 minutes on RTX 3090 ($0.34/hr) = **$0.028/day = $0.85/month**

**When to manually pause:**
- üü¢ End of work day (ensure nothing runs overnight)
- üü¢ Going on vacation (zero chance of accidental usage)
- üü¢ Testing/debugging (prevent cold starts during rapid iteration)

---

## Setup Instructions

### Step 1: Install Dependencies

```bash
# Install RunPod Python SDK
pip install runpod requests

# Set your RunPod API key as environment variable
export RUNPOD_API_KEY="your_runpod_api_key_here"

# Or add to ~/.zshrc or ~/.bashrc for persistence
echo 'export RUNPOD_API_KEY="your_api_key"' >> ~/.zshrc
```

### Step 2: Configure Control Script

1. Copy `runpod-control.py` to your project root
2. Edit the `ENDPOINTS` dictionary with your actual endpoint IDs:

```python
ENDPOINTS = {
    "architect": {
        "id": "abc123xyz456",  # Your actual endpoint ID
        "name": "DeepSeek-R1 Architect",
        "default_min": 0,
        "default_max": 3
    },
    # ... rest of endpoints
}
```

3. Test it:

```bash
python3 runpod-control.py list
```

You should see your endpoints!

### Step 3: Add VS Code Tasks

1. Create `.vscode/tasks.json` in your project
2. Copy contents from `vscode-tasks.json`
3. Adjust the path to `runpod-control.py` if needed

### Step 4: Install VS Code Status Bar Extension (Optional)

For one-click buttons in your status bar:

1. Install **"VSCode Action Buttons"** extension:
   - Open VS Code
   - Extensions ‚Üí Search "VSCode Action Buttons"
   - Install by "SeyyedKhandon"

2. Add to your `.vscode/settings.json`:

```json
{
  "actionButtons": {
    "defaultColor": "#ffffff",
    "loadNpmCommands": false,
    "reloadButton": "üîÑ",
    "commands": [
      {
        "cwd": "${workspaceFolder}",
        "name": "üìã List Endpoints",
        "color": "#00FF00",
        "singleInstance": true,
        "command": "python3 runpod-control.py list"
      },
      {
        "cwd": "${workspaceFolder}",
        "name": "‚è∏Ô∏è Pause All",
        "color": "#FFA500",
        "singleInstance": true,
        "command": "python3 runpod-control.py pause-all"
      },
      {
        "cwd": "${workspaceFolder}",
        "name": "‚ñ∂Ô∏è Resume All",
        "color": "#00FF00",
        "singleInstance": true,
        "command": "python3 runpod-control.py resume-all"
      }
    ]
  }
}
```

You'll now see buttons in your status bar!

---

## Usage Guide

### Command Line Usage

```bash
# List all endpoints with status
python3 runpod-control.py list

# Pause specific endpoint
python3 runpod-control.py pause architect
python3 runpod-control.py pause code

# Resume specific endpoint
python3 runpod-control.py resume architect
python3 runpod-control.py resume research

# Pause all endpoints
python3 runpod-control.py pause-all

# Resume all endpoints
python3 runpod-control.py resume-all

# Check status of specific endpoint
python3 runpod-control.py status architect
```

### VS Code Command Palette Usage

1. Press `Cmd+Shift+P` (Mac) or `Ctrl+Shift+P` (Windows/Linux)
2. Type "Tasks: Run Task"
3. Select your task:
   - üü¢ List RunPod Endpoints
   - ‚è∏Ô∏è  Pause All Endpoints
   - ‚ñ∂Ô∏è  Resume All Endpoints
   - ‚è∏Ô∏è  Pause Architect
   - Etc.

### Status Bar Button Usage (If Installed)

Click the buttons at the bottom of VS Code:
- üìã List Endpoints
- ‚è∏Ô∏è  Pause All
- ‚ñ∂Ô∏è  Resume All

---

## Workflow Examples

### Example 1: Daily Work Session

**Morning (start work):**
```bash
# Check status (should be paused from yesterday)
python3 runpod-control.py list

# Resume only what you need today
python3 runpod-control.py resume architect
python3 runpod-control.py resume code
```

**Evening (end work):**
```bash
# Pause everything to ensure zero cost overnight
python3 runpod-control.py pause-all
```

**Cost savings (worst case):** Prevents 16 hours/day √ó $1.14/hr (A100) = $18/day = **$540/month saved!**
**With optimized GPUs:** Prevents 16 hours/day √ó $0.79/hr (A40) = $12.64/day = **$380/month saved!**

### Example 2: Deep Coding Session

**Before coding:**
```bash
# Resume code writer only
python3 runpod-control.py resume code
```

Use Roo Code with `/code` mode...

**After coding:**
```bash
# Pause when done
python3 runpod-control.py pause code
```

### Example 3: Research Session

**Before research:**
```bash
# Resume researcher
python3 runpod-control.py resume research
```

Use Roo Code with `/research` mode...

**After research:**
```bash
# Pause when done
python3 runpod-control.py pause research
```

---

## Advanced: Automatic Pause/Resume

### Option 1: Pause on VS Code Close (Shell Hook)

Add to your shell profile (`~/.zshrc` or `~/.bashrc`):

```bash
# Function to pause RunPod when closing terminal/VS Code
runpod_pause_on_exit() {
    if [ -f "$PWD/runpod-control.py" ]; then
        python3 "$PWD/runpod-control.py" pause-all
        echo "‚úÖ Paused all RunPod endpoints"
    fi
}

# Run on shell exit
trap runpod_pause_on_exit EXIT
```

### Option 2: Scheduled Pauses (Cron Job)

```bash
# Edit crontab
crontab -e

# Add this line to pause every day at 6 PM
0 18 * * * cd /path/to/your/project && python3 runpod-control.py pause-all

# Resume every weekday at 9 AM
0 9 * * 1-5 cd /path/to/your/project && python3 runpod-control.py resume-all
```

### Option 3: VS Code Workspace Events

Create `.vscode/settings.json`:

```json
{
  "runOnSave.commands": [
    {
      "match": ".*",
      "command": "workbench.action.tasks.runTask",
      "args": {
        "task": "‚è∏Ô∏è  Pause All Endpoints"
      },
      "runIn": "backend",
      "runningStatusMessage": "Pausing endpoints...",
      "finishStatusMessage": "Endpoints paused"
    }
  ]
}
```

---

## Cost Optimization Strategies

### Strategy 1: Optimized GPUs + Auto-Scale (Best Value)

- **Deploy on right-sized GPUs** (see GPU selection guide)
- Keep `workersMin: 0` (default)
- Let RunPod auto-scale
- **Estimated cost:** ~$10-35/month (moderate use)
- **Savings:** 40-60% vs using A100 80GB for everything

### Strategy 2: Manual Control (Maximum Savings)

- **Resume** only when actively using
- **Pause** immediately after use
- Combine with optimized GPUs
- **Estimated cost:** ~$5-20/month
- **Savings:** Additional 20-30% on top of Strategy 1

### Strategy 3: Keep Warm (Fastest, Expensive)

- Set `workersMin: 1` for frequently used models
- No cold starts (instant responses)
- **Estimated cost:** ~$550-1,100/month (A40/A100)
- ‚ö†Ô∏è Only for production/business use

**GPU Cost Comparison:**
```
All on A100 80GB auto-scale:  $50-60/month (100 requests)
Optimized GPUs auto-scale:    $25-35/month (100 requests) ‚úÖ
Optimized GPUs + manual:      $15-25/month (100 requests) ‚úÖ‚úÖ
```

**Recommendation:** Start with Strategy 1 (optimized GPUs + auto-scale), add manual pausing overnight.

---

## Monitoring Costs

### Check RunPod Dashboard

1. Go to https://www.runpod.io/console/billing
2. View "Usage" tab
3. See per-endpoint costs

### Script to Check Costs (Coming Soon)

```bash
# Future feature
python3 runpod-control.py costs --this-month
```

---

## Troubleshooting

### Issue: "Authentication failed"

**Solution:**
- Check `RUNPOD_API_KEY` environment variable
- Verify API key at https://www.runpod.io/console/user/settings

### Issue: "Endpoint not found"

**Solution:**
- Verify endpoint IDs in `runpod-control.py`
- Run `python3 runpod-control.py list` to check

### Issue: Cold starts taking too long

**Solutions:**
- Accept 2-5 sec cold start (normal)
- Set `workersMin: 1` to keep warm (costs more)
- Use Budget model for quick questions (faster cold start)

### Issue: Still getting charged when paused

**Check:**
- Verify workers are actually 0: `python3 runpod-control.py list`
- Check RunPod dashboard for orphaned workers
- Ensure you paused ALL endpoints

---

## Integration with Roo Code Custom Modes

**Perfect workflow:**

1. **Use custom modes** (from earlier setup)
2. **Use slash commands** to switch models
3. **Roo Code connects** to RunPod endpoints
4. **Endpoints auto-scale** to save money
5. **Manually pause** at end of day for safety

**Example full workflow:**

```bash
# Morning: Check status
python3 runpod-control.py list

# In Roo Code: Use models
/architect Design a REST API
/code Implement the endpoints

# Evening: Pause everything
python3 runpod-control.py pause-all
```

---

## Quick Reference

### Command Cheat Sheet

| Command | What It Does |
|---------|-------------|
| `list` | Show all endpoints and status |
| `pause <key>` | Pause specific endpoint (workers ‚Üí 0) |
| `resume <key>` | Resume endpoint (workers ‚Üí 0-3) |
| `pause-all` | Pause all endpoints |
| `resume-all` | Resume all endpoints |
| `status <key>` | Get detailed status JSON |

### Endpoint Keys

| Key | Model | Use For |
|-----|-------|---------|
| `architect` | DeepSeek-R1-32B | Architecture, debugging, reverse engineering |
| `code` | Qwen3-Coder-30B | Code implementation |
| `research` | Qwen3-Next-80B | Deep research, analysis |
| `quick` | Qwen3-4B | Quick questions |

---

## Next Steps

1. ‚úÖ Set up the control script
2. ‚úÖ Configure VS Code tasks
3. ‚úÖ Test pausing/resuming
4. ‚úÖ Install status bar buttons (optional)
5. ‚úÖ Create end-of-day pause habit
6. ‚úÖ Monitor costs for first week

---

## Resources

- **RunPod API Docs:** https://docs.runpod.io/
- **GraphQL API Spec:** https://graphql-spec.runpod.io/
- **VS Code Tasks:** https://code.visualstudio.com/docs/editor/tasks
- **Action Buttons Extension:** https://marketplace.visualstudio.com/items?itemName=SeyyedKhandon.vscode-action-buttons

---

**You now have complete control over your RunPod endpoints from VS Code!**
