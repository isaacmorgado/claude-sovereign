# SPLICE Phase 2 Continuation - Custom Presets UI

## Context
Phase 1 completed successfully with **51 tests passing** in 36ms.

## Completed in Phase 1: Custom Presets Foundation
- `loadCustomPresets()` / `saveCustomPresets()` - localStorage schema with version tracking
- `createCustomPreset(preset)` - Create with slugified ID, validation, default settings
- `updateCustomPreset(id, updates)` - Partial updates with field merging
- `deleteCustomPreset(id)` - Safe removal from presets and order array
- `isBuiltInPreset(id)` - Check if preset is built-in (locked)
- `getAllPresets()` - Merge built-in + custom with `isBuiltIn` flag
- `getAllPresetIds()` / `getPresetById(id)` - Lookup helpers

## Key Files Modified in Phase 1
- `splice-plugin/js/settings.js` - Lines 10-414 (custom presets CRUD functions)
- `splice-backend/tests/custom-presets.test.js` - 51 comprehensive tests

---

## Phase 2 Tasks: Custom Presets UI

### Feature 2.1: Add Save Preset Button to Preset Selector
**File:** `splice-plugin/index.html`
- Add "+" button next to preset dropdown
- When clicked, opens save preset modal
- Captures current settings as preset values
- **E2E Test**: Button renders, opens modal on click

### Feature 2.2: Create Preset Modal (Create/Edit Form)
**File:** `splice-plugin/index.html`
- Modal with: Name input, Description input, Icon picker
- Icon options: mic, people, bolt, school, videocam, settings
- Settings preview showing current values
- Save/Cancel buttons
- **E2E Test**: Modal opens, form submission creates preset

### Feature 2.3: Add Manage Presets Button
**File:** `splice-plugin/index.html`
- Add "..." button for managing custom presets
- Opens manage view showing list of custom presets
- Each preset shows: name, icon, edit/delete buttons
- Built-in presets show lock icon (cannot edit/delete)
- **E2E Test**: Manage button works, list renders correctly

### Feature 2.4: Wire Up Create/Edit/Delete Handlers
**File:** `splice-plugin/js/main.js`
- Initialize preset modal handlers
- Handle save button - call `createCustomPreset()` or `updateCustomPreset()`
- Handle delete button - call `deleteCustomPreset()` with confirmation
- Refresh preset dropdown after changes
- **E2E Test**: Full create/edit/delete workflow via UI

### Feature 2.5: Update Preset Dropdown to Show Custom Presets
**File:** `splice-plugin/js/settings.js` (initPresetSelector)
- Call `getAllPresets()` to populate dropdown
- Group: Built-in (with lock icon) and Custom
- Selecting custom preset applies its settings
- **E2E Test**: Dropdown shows all presets, selection applies settings

---

## Testing Protocol
After each feature:
1. Implement the code
2. Run E2E test on that specific feature
3. Look for bottlenecks, errors, edge cases
4. Fix any issues found
5. Retest to verify fix
6. Proceed to next feature

At phase end: Run comprehensive E2E test for all Phase 2 features.

---

## Key Patterns from Phase 1

**Preset Data Structure:**
```javascript
{
  id: 'my-podcast-tight',
  name: 'My Podcast (Tight)',
  description: 'Tighter cuts',
  icon: 'mic',
  createdAt: '2025-01-15T10:30:00Z',
  settings: { sensitivity: 45, ... },
  isBuiltIn: false
}
```

**API Usage:**
```javascript
// Create
const result = createCustomPreset({ name: 'My Preset', settings: {...} });
if (result.success) { /* result.id available */ }

// Update
updateCustomPreset(id, { name: 'New Name', settings: { sensitivity: 80 } });

// Delete
deleteCustomPreset(id);

// Get all (for dropdown)
const presets = getAllPresets(); // Returns array with isBuiltIn flag
```

---

## Prompt for Claude

```
Continue implementing SPLICE custom presets. Phase 1 (foundation) is complete with 51 tests passing.

Now implement Phase 2: Custom Presets UI

Tasks:
1. Feature 2.1: Add "+" save button to preset selector in index.html
2. Feature 2.2: Create preset modal (name, description, icon picker, save/cancel)
3. Feature 2.3: Add "..." manage button with preset list view
4. Feature 2.4: Wire up handlers in main.js (create/edit/delete)
5. Feature 2.5: Update preset dropdown to show custom presets

After each feature: run E2E test, fix bottlenecks, retest, proceed.
After Phase 2: run comprehensive test, then write Phase 3 continuation prompt.

Key files:
- splice-plugin/index.html (UI components)
- splice-plugin/js/main.js (event handlers)
- splice-plugin/js/settings.js (already has: createCustomPreset, updateCustomPreset, deleteCustomPreset, getAllPresets, isBuiltInPreset)

Test file: splice-backend/tests/custom-presets.test.js (51 tests passing)
```
