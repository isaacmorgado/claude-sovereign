import type { GenderSpecificIdeal, IdealRange } from '../types/measurements.js';

/**
 * Gender-specific ideal values for all measurements
 */
export const IDEAL_VALUES: Record<string, GenderSpecificIdeal> = {
  // FWHR (Facial Width-to-Height Ratio)
  fwhr: {
    male: { ideal: 1.9, min: 1.8, max: 2.1 },
    female: { ideal: 1.75, min: 1.6, max: 1.9 },
  },

  // Canthal Tilt (degrees)
  canthalTilt: {
    male: { ideal: 4, min: 2, max: 7 },
    female: { ideal: 6, min: 4, max: 10 },
  },

  // Nasolabial Angle (degrees)
  nasolabialAngle: {
    male: { ideal: 95, min: 90, max: 100 },
    female: { ideal: 105, min: 100, max: 115 },
  },

  // Gonial Angle (degrees)
  gonialAngle: {
    male: { ideal: 125, min: 120, max: 130 },
    female: { ideal: 128, min: 125, max: 135 },
  },

  // Nasal Index (width/height)
  nasalIndex: {
    male: { ideal: 0.7, min: 0.65, max: 0.75 },
    female: { ideal: 0.65, min: 0.6, max: 0.7 },
  },

  // Lip Ratio (upper/lower)
  lipRatio: {
    male: { ideal: 0.5, min: 0.4, max: 0.6 },
    female: { ideal: 0.5, min: 0.45, max: 0.55 },
  },

  // Facial Convexity (degrees)
  facialConvexity: {
    male: { ideal: 170, min: 165, max: 175 },
    female: { ideal: 168, min: 163, max: 173 },
  },

  // Chin Projection (mm from reference line)
  chinProjection: {
    male: { ideal: 0, min: -3, max: 3 },
    female: { ideal: -2, min: -5, max: 1 },
  },

  // Nose Projection (Goode ratio)
  noseProjection: {
    male: { ideal: 0.67, min: 0.55, max: 0.70 },
    female: { ideal: 0.67, min: 0.55, max: 0.70 },
  },

  // Nasofrontal Angle (degrees)
  nasofrontalAngle: {
    male: { ideal: 130, min: 120, max: 140 },
    female: { ideal: 134, min: 125, max: 140 },
  },

  // Nasofacial Angle (degrees)
  nasofacialAngle: {
    male: { ideal: 36, min: 30, max: 40 },
    female: { ideal: 34, min: 30, max: 38 },
  },

  // Nasomental Angle (degrees)
  nasomentaAngle: {
    male: { ideal: 125, min: 120, max: 132 },
    female: { ideal: 127, min: 122, max: 132 },
  },

  // Mentocervical Angle (degrees)
  mentocervicalAngle: {
    male: { ideal: 100, min: 85, max: 105 },
    female: { ideal: 95, min: 85, max: 100 },
  },

  // Mandibular Plane Angle (degrees)
  mandibularPlaneAngle: {
    male: { ideal: 25, min: 20, max: 30 },
    female: { ideal: 27, min: 22, max: 32 },
  },

  // Nasal Tip Rotation (degrees)
  nasalTipRotation: {
    male: { ideal: 95, min: 90, max: 100 },
    female: { ideal: 105, min: 100, max: 110 },
  },

  // Columella-Lobular Ratio
  columellaLobularRatio: {
    male: { ideal: 2.0, min: 1.5, max: 2.5 },
    female: { ideal: 2.0, min: 1.5, max: 2.5 },
  },
};

/**
 * Facial thirds ideal (universal - same for both genders)
 */
export const FACIAL_THIRDS_IDEAL: IdealRange = {
  ideal: 33.33,
  min: 30,
  max: 36.67,
};

/**
 * Facial fifths ideal (universal)
 */
export const FACIAL_FIFTHS_IDEAL: IdealRange = {
  ideal: 20,
  min: 17,
  max: 23,
};

/**
 * Golden Ratio (Phi)
 */
export const PHI = 1.618033988749895;

/**
 * Golden ratio measurement pairs
 */
export const GOLDEN_RATIO_PAIRS = {
  faceHeightWidth: {
    description: 'Face height to face width',
    idealRatio: PHI,
  },
  noseMouth: {
    description: 'Nose-to-lip height vs lip-to-chin height',
    idealRatio: PHI,
  },
  eyeSpacing: {
    description: 'Interpupillary distance to eye width',
    idealRatio: PHI,
  },
  lipChin: {
    description: 'Upper face to lower face',
    idealRatio: PHI,
  },
  noseWidth: {
    description: 'Mouth width to nose width',
    idealRatio: PHI,
  },
} as const;

/**
 * Symmetry thresholds (percentage difference)
 */
export const SYMMETRY_THRESHOLDS = {
  excellent: 2,    // <2% difference = excellent symmetry
  good: 5,         // <5% difference = good symmetry
  average: 10,     // <10% difference = average symmetry
  poor: 15,        // <15% difference = below average
  // >15% = poor
} as const;

/**
 * Profile type angle thresholds (facial convexity)
 */
export const PROFILE_TYPE_THRESHOLDS = {
  convex: { min: 0, max: 165 },      // <165 degrees
  straight: { min: 165, max: 175 },  // 165-175 degrees
  concave: { min: 175, max: 180 },   // >175 degrees
} as const;

/**
 * Get ideal value for a measurement based on gender
 */
export function getIdealValue(
  measurement: string,
  gender: 'male' | 'female'
): IdealRange | null {
  const values = IDEAL_VALUES[measurement];
  if (!values) return null;
  return values[gender];
}
