# LOOKSMAXX

A facial metrics analysis and visualization system with Next.js frontend and MediaPipe-based facial landmark detection. Now with FaceIQ-compatible scoring and results UI.

## Current Focus
Section: FaceIQ Parity - Results UI Enhancement
Files: `looksmaxx-app/src/contexts/ResultsContext.tsx`, `looksmaxx-app/src/components/results/cards/EnhancedRecommendationCard.tsx`

## Tech Stack

- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **Animation**: Framer Motion
- **Face Detection**: MediaPipe Tasks Vision (client, 478 landmarks) + InsightFace (server, 106 landmarks)
- **Scoring**: FaceIQ-compatible exponential decay with 70+ measurements
- **Backend**: FastAPI on Railway with PostgreSQL

## API URL
- **Production**: https://api-production-6148.up.railway.app

## Code Quality

```bash
cd looksmaxx-app && npm run lint && npx tsc --noEmit
```

## Last Session (2025-12-20 Evening)

### Completed
- **Fixed RatioDetailModal.tsx syntax error** - Added proper `mounted` state pattern for SSR, replaced complex ternary with switch statement
- **Implemented multiple contributing ratios for strengths/flaws** - Added `STRENGTH_GROUPINGS` (8 groups) and `FLAW_GROUPINGS` (7 groups) in ResultsContext.tsx to group related metrics
- **Added research citations to Plan section** - Created `RESEARCH_CITATIONS` database (16 citations) with gender/ethnicity filtering in EnhancedRecommendationCard.tsx
- **Fixed ethnicity type values** - Changed 'caucasian' to 'white', 'african' to 'black', 'asian' to 'east_asian' to match Ethnicity type

### Issue
- Results page showing blank with "untitled" - needs debugging (likely client-side error)

### Dev Server
- Running on port 3002 (ports 3000-3001 were in use)

## FaceIQ Parity Status (2025-12-23)

### âœ… Fully Completed
| Feature | Implementation | Details |
|---------|----------------|---------|
| **Bezier Curves** | `src/lib/faceiq-bezier-curves.ts` | All 66/66 curves from FaceIQ |
| **Procedure Impact Tables** | `src/lib/advice-engine.ts` | 30 procedures with quantitative metric impacts |
| **Potential Score Prediction** | `src/lib/recommendations/severity.ts` | `estimatePotentialPSL()` with diminishing returns |
| **Treatment Plan Generation** | `src/lib/recommendations/engine.ts` | Multi-procedure optimization, 5-phase ordering |
| **Ethnicity Overrides** | `src/lib/insights-engine.ts` | 8 male + 8 female demographic configs |
| **Scoring Engine** | `src/lib/faceiq-scoring.ts` | 70+ metrics with exponential decay |

### ðŸ”² Remaining
1. Debug blank results page issue - check browser console for errors
2. Test full analysis flow end-to-end (upload -> analysis -> results)
3. Implement supplement/product e-commerce layer (see `supplement_implementation.md`)
