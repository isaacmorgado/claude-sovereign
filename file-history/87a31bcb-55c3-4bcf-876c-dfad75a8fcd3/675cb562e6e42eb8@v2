/**
 * Guides Data Index
 * Central export for all guide-related data
 * 58+ Guides across 13 categories
 */

import { Guide, GuideCategory } from '@/types/guides';

// Product Registry
export {
  GUIDE_PRODUCTS,
  getGuideProductById,
  getGuideProductsByCategory,
  getBaseStackProducts,
  getGuideProductsByPriority,
  getProductCategories,
  getGuideProductsByIds,
  searchGuideProducts,
  getTotalProductCount,
  getCategoryDisplayInfo,
} from './products-registry';

// ============================================
// GUIDE IMPORTS
// ============================================

// Fundamentals (4)
import { mindsetGuide } from './mindset';
import { maintenanceGuide } from './maintenance';
import { bodyFatGuide } from './body-fat';

// Sleep & Recovery (7) - NEW
import { circadianRhythmGuide } from './circadian-rhythm';
import { sleepDriversGuide } from './sleep-drivers';
import { sleepEnvironmentGuide } from './sleep-environment';
import { sleepApneaGuide } from './sleep-apnea';
import { recoveryProtocolsGuide } from './recovery-protocols';
import { recoveryModalitiesGuide } from './recovery-modalities';
import { lifestyleRecoveryGuide } from './lifestyle-recovery';

// Hormonal Optimization (6) - NEW
import { testosteroneLifestyleGuide } from './testosterone-lifestyle';
import { testosteroneNutritionGuide } from './testosterone-nutrition';
import { cortisolManagementGuide } from './cortisol-management';
import { estrogenBalanceGuide } from './estrogen-balance';
import { stressSupplementsGuide } from './stress-supplements';
import { hormoneKillersGuide } from './hormone-killers';

// Toxin Avoidance (3) - NEW
import { toxinsAestheticsGuide } from './toxins-aesthetics';
import { toxicSwapsGuide } from './toxic-swaps';
import { environmentalStressGuide } from './environmental-stress';

// Blood Work & Health (5) - NEW
import { bloodMarkersGuide } from './blood-markers';
import { hormonePanelsGuide } from './hormone-panels';
import { metabolicMarkersGuide } from './metabolic-markers';
import { organFunctionGuide } from './organ-function';
import { cardiovascularMarkersGuide } from './cardiovascular-markers';

// Mental Performance (4) - NEW
import { dopamineOptimizationGuide } from './dopamine-optimization';
import { environmentalEngineeringGuide } from './environmental-engineering';
import { brainFuelGuide } from './brain-fuel';
import { cognitiveEnhancersGuide } from './cognitive-enhancers';

// Diet & Nutrition (6) - NEW SPLITS
import { nutritionBasicsGuide } from './nutrition-basics';
import { cuttingGuideGuide } from './cutting-guide';
import { bulkingGuideGuide } from './bulking-guide';
import { ketoLowcarbGuide } from './keto-lowcarb';
import { carbTimingGuide } from './carb-timing';
import { debloatingProtocolGuide } from './debloating-protocol';

// Physique & Training (6) - EXPANDED
import { vTaperGuide } from './v-taper';
import { trainingFundamentalsGuide } from './training-fundamentals';
import { fullBodySplitGuide } from './full-body-split';
import { upperLowerSplitGuide } from './upper-lower-split';
import { pplSplitGuide } from './ppl-split';
import { coreNeckGuide } from './core-neck';
import { cardioGuide } from './cardio';

// Skincare & Appearance (4)
import { skincareGuide } from './skincare';
import { teethSmileGuide } from './teeth-smile';
import { accutaneGuide } from './accutane';

// Male-Specific (5)
import { hairLossGuide } from './hair-loss';
import { beardGrowthGuide } from './beard-growth';
import { mewingJawlineGuide } from './mewing-jawline';
import { gynecomastiaGuide } from './gynecomastia';
import { neckTrainingGuide } from './neck-training';

// Female-Specific (6)
import { antiAgingWomenGuide } from './anti-aging-women';
import { glassSkinGuide } from './glass-skin';
import { hormonalSkinGuide } from './hormonal-skin';
import { bodyContouringWomenGuide } from './body-contouring-women';
import { postpartumRecoveryGuide } from './postpartum-recovery';
import { feminineFeaturesGuide } from './feminine-features';

// Non-Surgical (1)
import { fillerBotoxGuide } from './filler-botox';

// Surgery (4)
import { rhinoplastyGuide } from './rhinoplasty';
import { jawSurgeryGuide } from './jaw-surgery';
import { facialProceduresGuide } from './facial-procedures';
import { bodySurgeryGuide } from './body-surgery';

// Legacy guides still exported for backwards compatibility
// (but not imported here - they're re-exported below)

// ============================================
// GUIDE EXPORTS
// ============================================

// Fundamentals
export { mindsetGuide } from './mindset';
export { maintenanceGuide } from './maintenance';
export { bodyFatGuide } from './body-fat';

// Sleep & Recovery
export { circadianRhythmGuide } from './circadian-rhythm';
export { sleepDriversGuide } from './sleep-drivers';
export { sleepEnvironmentGuide } from './sleep-environment';
export { sleepApneaGuide } from './sleep-apnea';
export { recoveryProtocolsGuide } from './recovery-protocols';
export { recoveryModalitiesGuide } from './recovery-modalities';
export { lifestyleRecoveryGuide } from './lifestyle-recovery';

// Hormonal Optimization
export { testosteroneLifestyleGuide } from './testosterone-lifestyle';
export { testosteroneNutritionGuide } from './testosterone-nutrition';
export { cortisolManagementGuide } from './cortisol-management';
export { estrogenBalanceGuide } from './estrogen-balance';
export { stressSupplementsGuide } from './stress-supplements';
export { hormoneKillersGuide } from './hormone-killers';

// Toxin Avoidance
export { toxinsAestheticsGuide } from './toxins-aesthetics';
export { toxicSwapsGuide } from './toxic-swaps';
export { environmentalStressGuide } from './environmental-stress';

// Blood Work & Health
export { bloodMarkersGuide } from './blood-markers';
export { hormonePanelsGuide } from './hormone-panels';
export { metabolicMarkersGuide } from './metabolic-markers';
export { organFunctionGuide } from './organ-function';
export { cardiovascularMarkersGuide } from './cardiovascular-markers';

// Mental Performance
export { dopamineOptimizationGuide } from './dopamine-optimization';
export { environmentalEngineeringGuide } from './environmental-engineering';
export { brainFuelGuide } from './brain-fuel';
export { cognitiveEnhancersGuide } from './cognitive-enhancers';

// Diet & Nutrition
export { nutritionBasicsGuide } from './nutrition-basics';
export { cuttingGuideGuide } from './cutting-guide';
export { bulkingGuideGuide } from './bulking-guide';
export { ketoLowcarbGuide } from './keto-lowcarb';
export { carbTimingGuide } from './carb-timing';
export { debloatingProtocolGuide } from './debloating-protocol';

// Physique & Training
export { vTaperGuide } from './v-taper';
export { trainingFundamentalsGuide } from './training-fundamentals';
export { fullBodySplitGuide } from './full-body-split';
export { upperLowerSplitGuide } from './upper-lower-split';
export { pplSplitGuide } from './ppl-split';
export { coreNeckGuide } from './core-neck';
export { cardioGuide } from './cardio';

// Skincare & Appearance
export { skincareGuide } from './skincare';
export { teethSmileGuide } from './teeth-smile';
export { accutaneGuide } from './accutane';

// Male-Specific
export { hairLossGuide } from './hair-loss';
export { beardGrowthGuide } from './beard-growth';
export { mewingJawlineGuide } from './mewing-jawline';
export { gynecomastiaGuide } from './gynecomastia';
export { neckTrainingGuide } from './neck-training';

// Female-Specific
export { antiAgingWomenGuide } from './anti-aging-women';
export { glassSkinGuide } from './glass-skin';
export { hormonalSkinGuide } from './hormonal-skin';
export { bodyContouringWomenGuide } from './body-contouring-women';
export { postpartumRecoveryGuide } from './postpartum-recovery';
export { feminineFeaturesGuide } from './feminine-features';

// Non-Surgical
export { fillerBotoxGuide } from './filler-botox';

// Surgery
export { rhinoplastyGuide } from './rhinoplasty';
export { jawSurgeryGuide } from './jaw-surgery';
export { facialProceduresGuide } from './facial-procedures';
export { bodySurgeryGuide } from './body-surgery';

// Legacy exports
export { trainingGuide } from './training';
export { dietGuide } from './diet';

// ============================================
// GUIDE REGISTRY
// ============================================

/**
 * All guides in display order
 */
export const ALL_GUIDES: Guide[] = [
  // Fundamentals
  mindsetGuide,
  maintenanceGuide,
  bodyFatGuide,

  // Sleep & Recovery
  circadianRhythmGuide,
  sleepDriversGuide,
  sleepEnvironmentGuide,
  sleepApneaGuide,
  recoveryProtocolsGuide,
  recoveryModalitiesGuide,
  lifestyleRecoveryGuide,

  // Hormonal Optimization
  testosteroneLifestyleGuide,
  testosteroneNutritionGuide,
  cortisolManagementGuide,
  estrogenBalanceGuide,
  stressSupplementsGuide,
  hormoneKillersGuide,

  // Toxin Avoidance
  toxinsAestheticsGuide,
  toxicSwapsGuide,
  environmentalStressGuide,

  // Blood Work & Health
  bloodMarkersGuide,
  hormonePanelsGuide,
  metabolicMarkersGuide,
  organFunctionGuide,
  cardiovascularMarkersGuide,

  // Mental Performance
  dopamineOptimizationGuide,
  environmentalEngineeringGuide,
  brainFuelGuide,
  cognitiveEnhancersGuide,

  // Diet & Nutrition
  nutritionBasicsGuide,
  cuttingGuideGuide,
  bulkingGuideGuide,
  ketoLowcarbGuide,
  carbTimingGuide,
  debloatingProtocolGuide,

  // Physique & Training
  vTaperGuide,
  trainingFundamentalsGuide,
  fullBodySplitGuide,
  upperLowerSplitGuide,
  pplSplitGuide,
  coreNeckGuide,
  cardioGuide,

  // Skincare & Appearance
  skincareGuide,
  teethSmileGuide,
  accutaneGuide,

  // Male-Specific
  hairLossGuide,
  beardGrowthGuide,
  mewingJawlineGuide,
  gynecomastiaGuide,
  neckTrainingGuide,

  // Female-Specific
  antiAgingWomenGuide,
  glassSkinGuide,
  hormonalSkinGuide,
  bodyContouringWomenGuide,
  postpartumRecoveryGuide,
  feminineFeaturesGuide,

  // Non-Surgical
  fillerBotoxGuide,

  // Surgery
  rhinoplastyGuide,
  jawSurgeryGuide,
  facialProceduresGuide,
  bodySurgeryGuide,
].sort((a, b) => a.order - b.order);

/**
 * Guide lookup by ID
 */
export const GUIDES_BY_ID: Record<string, Guide> = ALL_GUIDES.reduce(
  (acc, guide) => {
    acc[guide.id] = guide;
    return acc;
  },
  {} as Record<string, Guide>
);

/**
 * Guide lookup by slug
 */
export const GUIDES_BY_SLUG: Record<string, Guide> = ALL_GUIDES.reduce(
  (acc, guide) => {
    acc[guide.slug] = guide;
    return acc;
  },
  {} as Record<string, Guide>
);

// ============================================
// GUIDE CATEGORIES (13 total)
// ============================================

export const GUIDE_CATEGORIES: GuideCategory[] = [
  {
    id: 'fundamentals',
    name: 'Fundamentals',
    description: 'Start here. The basics everyone needs.',
    icon: 'BookOpen',
    color: 'blue',
    guideIds: ['mindset', 'maintenance', 'body-fat'],
  },
  {
    id: 'sleep-recovery',
    name: 'Sleep & Recovery',
    description: 'The foundation most guys skip.',
    icon: 'Moon',
    color: 'indigo',
    guideIds: ['circadian-rhythm', 'sleep-drivers', 'sleep-environment', 'sleep-apnea', 'recovery-protocols', 'recovery-modalities', 'lifestyle-recovery'],
  },
  {
    id: 'hormones',
    name: 'Hormonal Optimization',
    description: 'Your hormones control everything.',
    icon: 'Zap',
    color: 'yellow',
    guideIds: ['testosterone-lifestyle', 'testosterone-nutrition', 'cortisol-management', 'estrogen-balance', 'stress-supplements', 'hormone-killers'],
  },
  {
    id: 'toxins',
    name: 'Toxin Avoidance',
    description: "What's silently ruining your looks.",
    icon: 'AlertTriangle',
    color: 'orange',
    guideIds: ['toxins-aesthetics', 'toxic-swaps', 'environmental-stress'],
  },
  {
    id: 'blood-work',
    name: 'Blood Work & Health',
    description: 'Know your numbers.',
    icon: 'Droplet',
    color: 'red',
    guideIds: ['blood-markers', 'hormone-panels', 'metabolic-markers', 'organ-function', 'cardiovascular-markers'],
  },
  {
    id: 'mental',
    name: 'Mental Performance',
    description: 'Optimize your brain.',
    icon: 'Brain',
    color: 'violet',
    guideIds: ['dopamine-optimization', 'environmental-engineering', 'brain-fuel', 'cognitive-enhancers'],
  },
  {
    id: 'nutrition',
    name: 'Diet & Nutrition',
    description: 'Fuel for aesthetics.',
    icon: 'Apple',
    color: 'green',
    guideIds: ['nutrition-basics', 'cutting-guide', 'bulking-guide', 'keto-lowcarb', 'carb-timing', 'debloating-protocol'],
  },
  {
    id: 'physique',
    name: 'Physique',
    description: 'Build the body that commands respect.',
    icon: 'Dumbbell',
    color: 'purple',
    guideIds: ['training-fundamentals', 'full-body-split', 'upper-lower-split', 'ppl-split', 'v-taper', 'core-neck', 'cardio'],
  },
  {
    id: 'appearance',
    name: 'Skincare & Appearance',
    description: 'Dial in the details that matter.',
    icon: 'Sparkles',
    color: 'amber',
    guideIds: ['skincare', 'teeth-smile', 'accutane'],
  },
  {
    id: 'male',
    name: 'Male-Specific',
    description: 'Guides tailored for men.',
    icon: 'User',
    color: 'cyan',
    guideIds: ['hair-loss', 'beard-growth', 'mewing-jawline', 'gynecomastia', 'neck-training'],
  },
  {
    id: 'female',
    name: 'Female-Specific',
    description: 'Guides tailored for women.',
    icon: 'Heart',
    color: 'pink',
    guideIds: ['anti-aging-women', 'glass-skin', 'hormonal-skin', 'body-contouring-women', 'postpartum-recovery', 'feminine-features'],
  },
  {
    id: 'procedures',
    name: 'Non-Surgical',
    description: 'Injectables, lasers, and non-invasive procedures.',
    icon: 'Syringe',
    color: 'emerald',
    guideIds: ['filler-botox'],
  },
  {
    id: 'surgery',
    name: 'Surgery',
    description: 'When you want permanent change.',
    icon: 'Stethoscope',
    color: 'rose',
    guideIds: ['rhinoplasty', 'jaw-surgery', 'facial-procedures', 'body-surgery'],
  },
];

// ============================================
// HELPER FUNCTIONS
// ============================================

/**
 * Get guide by ID
 */
export function getGuideById(id: string): Guide | undefined {
  return GUIDES_BY_ID[id];
}

/**
 * Get guide by slug
 */
export function getGuideBySlug(slug: string): Guide | undefined {
  return GUIDES_BY_SLUG[slug];
}

/**
 * Get all guides in a category
 */
export function getGuidesByCategory(categoryId: string): Guide[] {
  const category = GUIDE_CATEGORIES.find(c => c.id === categoryId);
  if (!category) return [];
  return category.guideIds
    .map(id => GUIDES_BY_ID[id])
    .filter((g): g is Guide => g !== undefined);
}

/**
 * Get related guides for a given guide
 */
export function getRelatedGuides(guideId: string): Guide[] {
  const guide = GUIDES_BY_ID[guideId];
  if (!guide || !guide.relatedGuides) return [];
  return guide.relatedGuides
    .map(id => GUIDES_BY_ID[id])
    .filter((g): g is Guide => g !== undefined);
}

/**
 * Search guides by title or description
 */
export function searchGuides(query: string): Guide[] {
  const lowered = query.toLowerCase();
  return ALL_GUIDES.filter(
    g =>
      g.title.toLowerCase().includes(lowered) ||
      g.description.toLowerCase().includes(lowered) ||
      (g.subtitle && g.subtitle.toLowerCase().includes(lowered)) ||
      (g.tags && g.tags.some(tag => tag.toLowerCase().includes(lowered)))
  );
}

/**
 * Get total guide count
 */
export function getTotalGuideCount(): number {
  return ALL_GUIDES.length;
}

/**
 * Get total estimated reading time
 */
export function getTotalReadTime(): number {
  return ALL_GUIDES.reduce((sum, guide) => sum + guide.estimatedReadTime, 0);
}

/**
 * Get all unique product IDs across all guides
 */
export function getAllGuideProductIds(): string[] {
  const ids = new Set<string>();
  ALL_GUIDES.forEach(guide => {
    guide.productIds?.forEach(id => ids.add(id));
    guide.sections.forEach(section => {
      section.products?.forEach(id => ids.add(id));
    });
  });
  return Array.from(ids);
}

/**
 * Get guides by gender filter
 */
export function getGuidesByGender(gender: 'male' | 'female' | 'all'): Guide[] {
  if (gender === 'all') return ALL_GUIDES;

  const maleGuideIds = ['hair-loss', 'beard-growth', 'mewing-jawline', 'gynecomastia', 'neck-training'];
  const femaleGuideIds = ['anti-aging-women', 'glass-skin', 'hormonal-skin', 'body-contouring-women', 'postpartum-recovery', 'feminine-features'];

  if (gender === 'male') {
    return ALL_GUIDES.filter(g => !femaleGuideIds.includes(g.id));
  } else {
    return ALL_GUIDES.filter(g => !maleGuideIds.includes(g.id));
  }
}

/**
 * Get category by ID
 */
export function getCategoryById(categoryId: string): GuideCategory | undefined {
  return GUIDE_CATEGORIES.find(c => c.id === categoryId);
}

/**
 * Get all category IDs
 */
export function getAllCategoryIds(): string[] {
  return GUIDE_CATEGORIES.map(c => c.id);
}
