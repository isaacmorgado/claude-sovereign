import { calculateFaceIQScore, FACEIQ_METRICS } from './src/lib/faceiq-scoring';

const newlyWiredCurves = [
  'gonialAngle', 'nasolabialAngle', 'nasofacialAngle', 'nasomentalAngle',
  'nasalTipAngle', 'nasalProjection', 'nasalWToHRatio', 'noseTipRotationAngle',
  'frankfortTipAngle', 'mentolabialAngle', 'zAngle', 'submentalCervicalAngle',
  'facialConvexityGlabella', 'totalFacialConvexity', 'anteriorFacialDepth',
  'interiorMidfaceProjectionAngle', 'mandibularPlaneAngle', 'ramusToMandibleRatio',
  'eLineUpperLip', 'eLineLowerLip', 'sLineUpperLip', 'sLineLowerLip',
  'burstoneUpperLip', 'browridgeInclinationAngle', 'upperForeheadSlope',
  'orbitalVector', 'browLengthRatio', 'noseBridgeWidth', 'mouthWidthToNoseRatio',
  'lowerToUpperLipRatio', 'totalFacialWidthToHeight', 'lowerThirdProportionAlt'
];

let passed = 0;
let failed = 0;

console.log('Testing 32 newly wired Bezier curves:\n');

for (const metricId of newlyWiredCurves) {
  const metric = FACEIQ_METRICS[metricId];
  if (!metric) {
    console.log(`❌ ${metricId}: Metric not found`);
    failed++;
    continue;
  }

  const hasCurve = metric.customCurve && metric.customCurve.mode === 'custom';
  if (!hasCurve) {
    console.log(`❌ ${metricId}: No Bezier curve attached`);
    failed++;
    continue;
  }

  // Test at ideal value
  const idealMid = (metric.idealMin + metric.idealMax) / 2;
  const scoreAtIdeal = calculateFaceIQScore(metricId, idealMid, 'male', 'white');

  // Test at extremes
  const scoreAtMin = calculateFaceIQScore(metricId, metric.rangeMin, 'male', 'white');
  const scoreAtMax = calculateFaceIQScore(metricId, metric.rangeMax, 'male', 'white');

  const isValid = scoreAtIdeal >= 8 && scoreAtMin < scoreAtIdeal && scoreAtMax < scoreAtIdeal;

  if (isValid) {
    console.log(`✅ ${metricId}: ideal=${idealMid.toFixed(1)} → ${scoreAtIdeal.toFixed(1)}, min=${scoreAtMin.toFixed(1)}, max=${scoreAtMax.toFixed(1)}`);
    passed++;
  } else {
    console.log(`❌ ${metricId}: ideal=${idealMid.toFixed(1)} → ${scoreAtIdeal.toFixed(1)}, min=${scoreAtMin.toFixed(1)}, max=${scoreAtMax.toFixed(1)}`);
    failed++;
  }
}

console.log(`\n=== RESULTS: ${passed}/${passed + failed} passed ===`);
