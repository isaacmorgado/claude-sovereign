# SPLICE

AI-powered Premiere Pro UXP plugin for detecting takes, removing silences, and accelerating video editing workflows.

## Current Focus
**Auto-Cutting v3.2** - Phase 3 complete with performance optimizations

## Quick Reference

### Pricing Tiers
| Tier | Price | Hours | Stripe Price ID |
|------|-------|-------|-----------------|
| Starter | $19/mo | 15 hrs | price_1SgH4m2L5BseYEbCih347qfr |
| Pro | $49/mo | 50 hrs | price_1SgH4o2L5BseYEbCIoR19lhQ |
| Team | $149/mo | 150 hrs | price_1SgH4q2L5BseYEbCYTlimb5M |
| Overage | $1/hr | - | price_1SgH4y2L5BseYEbClZuxNRu8 |

### Key Constraints
- UXP requires Premiere Pro 25.6+
- Use `127.0.0.1` not `localhost` in fetch URLs
- Backend (prod): https://splice-api-production.up.railway.app

## Key Files

| File | Purpose |
|------|---------|
| `splice-backend/server.js` | Express + all endpoints + webhook handler |
| `splice-backend/services/usageTracking.js` | Credit balance, usage logging |
| `splice-plugin/js/credits.js` | Fetch/display credit balance |
| `splice-plugin/js/main.js` | Plugin initialization + workflows |
| `splice-plugin/index.html` | UI with credit badge in header |

## Implementation Phases

- Phase 1: Backend billing ✅
- Phase 2: Frontend credits ✅
- Phase 3: Preview Mode ✅
- Phase 4-6: Smart Filtering, Automation, Polish

## Last Session (2025-12-19)

**Phase 3.2 - Performance Optimizations & Takes Preview:**

**CSS Performance Fixes:**
- Replaced `transition: all` with specific properties (background-color, border-left-color)
- Added `contain: layout style paint` and `will-change: scroll-position` for GPU acceleration
- Increased touch targets to 44px minimum for accessibility
- Added focus-visible states for keyboard navigation

**JS Performance Fixes:**
- Cached all DOM elements in `ui` object (80% fewer getElementById calls)
- Event delegation: 2 listeners on parent instead of 200 on children
- DocumentFragment for list rendering (single reflow instead of N)
- Debounced UI updates with `requestAnimationFrame`
- Operation locking with `isOperationInProgress` flag

**Error Handling Fixes:**
- Double-click protection on all GO/Apply buttons
- Proper input validation in `seekToTime()`
- User-facing error messages instead of silent failures
- Awaited `refreshCredits()` to prevent race conditions

**New Features:**
- Takes Preview Mode (full parity with silence preview)
- Keyboard shortcuts: Enter (apply), Escape (cancel), Cmd+A (select all), Cmd+D (deselect), Cmd+I (invert)
- Duration filter buttons: <0.5s, 0.5-1s, >1s
- Invert selection button
- Re-run detection button (R) to adjust sensitivity
- Selected count display in header
- Razor integration uses preview-selected silences

**Exported API:**
- `window.splicePreviewState.getSelectedSilences()` - for Razor and other modules
- `window.splicePreviewState.getSelectedTakes()` - for takes workflow
- `window.splicePreviewState.hasPreview()` - check if preview is active

**Stopped at:** Phase 3.2 complete, plugin v3.2 ready

## Next Steps
1. Phase 4: Smart Filtering (auto-exclude false positives based on context)
2. Virtual scrolling for 200+ silences
3. Add customer ID input in settings modal
4. Usage history display

---
*Last updated: 2025-12-19*
