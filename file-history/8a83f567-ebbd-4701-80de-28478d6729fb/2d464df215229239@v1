# FaceIQ Labs Reverse Engineering Capture Guide

## Pre-Capture Setup

### 1. Browser Extensions to Install
- React Developer Tools (Chrome/Firefox)
- Redux DevTools (if they use Redux)
- JSON Formatter

### 2. Chrome DevTools Setup
1. Open DevTools (Cmd+Option+I)
2. Go to Network tab
3. Check "Preserve log" ✓
4. Check "Disable cache" ✓
5. Set throttling to "No throttling"

### 3. Start Recording
- QuickTime: File → New Screen Recording
- Or use OBS for more control

---

## Capture Flow Checklist

### Step 1: Login Flow
- [ ] Clear cookies first (fresh session)
- [ ] Navigate to beta.faceiqlabs.com
- [ ] Screenshot the login page
- [ ] Complete Google OAuth
- [ ] Screenshot dashboard after login

### Step 2: Dashboard Overview
- [ ] Screenshot the main dashboard
- [ ] Note any existing analyses listed
- [ ] Inspect React components (React DevTools → Components tab)
- [ ] Screenshot component tree

### Step 3: Start New Front Face Analysis
- [ ] Click "New Analysis" or equivalent
- [ ] Screenshot upload UI
- [ ] Upload a front-facing photo
- [ ] **PAUSE HERE** - This is critical:

#### Capture Auto-Detection
- [ ] Watch the Network tab for API calls during detection
- [ ] Look for calls to `/api/faces` or similar
- [ ] Screenshot the detected landmarks overlay
- [ ] Note which landmarks are shown (dots on face)

#### Capture Manual Adjustment UI
- [ ] Screenshot the landmark editor
- [ ] Try dragging a landmark point
- [ ] Watch Network tab - does it send updates?
- [ ] Note the UI controls (zoom, pan, reset, etc.)
- [ ] Count how many landmark points are editable
- [ ] Screenshot the confirmation/save button

### Step 4: Side Profile Analysis
- [ ] Navigate to side profile section
- [ ] Screenshot upload UI
- [ ] Upload a side profile photo
- [ ] Watch for `/api/side-landmarks` call in Network tab
- [ ] Screenshot the detected landmarks
- [ ] Note differences from front face (fewer points?)
- [ ] Test manual adjustment on side profile

### Step 5: Calculations & Results
- [ ] Navigate to results/analysis view
- [ ] Screenshot ALL calculation displays
- [ ] Look for terms like:
  - Facial thirds
  - Golden ratio
  - FWHR (Face Width-Height Ratio)
  - Symmetry scores
  - Canthal tilt
  - Jaw angle
  - Nose angle
- [ ] Hover over each metric - capture tooltips
- [ ] Screenshot any charts/visualizations

### Step 6: Premium Features
- [ ] Try to access "Harmony Analysis" or premium features
- [ ] Screenshot the paywall/unlock modal
- [ ] Note what's locked vs free

---

## Technical Capture Details

### Network Tab - Key Requests to Capture

```
POST /api/faces              → Creates new analysis, returns face ID
POST /api/side-landmarks     → Processes side profile
GET  /api/faces/:id          → Retrieves analysis data
POST /api/analysis/unlock    → Premium feature unlock
GET  /api/subscription       → User's plan/quota
```

For each request, right-click → "Copy as cURL" to save the exact request format.

### React DevTools - What to Look For

1. **Component Names** - Look for:
   - `FaceLandmarker` or `LandmarkEditor`
   - `FaceCanvas` or `LandmarkCanvas`
   - `PointDragger` or `DraggablePoint`
   - `AnalysisResults` or `Measurements`

2. **Props to Note**:
   - `landmarks` array structure
   - `onLandmarkChange` callback pattern
   - `selectedLandmark` state
   - `zoom`, `pan`, `scale` values

3. **State Management**:
   - Look for Context providers
   - Check for Zustand/Redux stores
   - Note how landmark positions are stored

### Console Tab - Useful Commands

```javascript
// Find React fiber (internal React state)
const root = document.getElementById('__next');
const fiber = root._reactRootContainer?._internalRoot?.current;

// Log current state
console.log(fiber);

// Find specific components
const findComponents = (fiber, name, results = []) => {
  if (fiber.type?.name === name) results.push(fiber);
  if (fiber.child) findComponents(fiber.child, name, results);
  if (fiber.sibling) findComponents(fiber.sibling, name, results);
  return results;
};

// Example: Find all Canvas components
findComponents(fiber, 'Canvas');
```

---

## Post-Capture: What to Extract

### From HAR File
```bash
# Extract all API responses
python3 << 'EOF'
import json
with open('faceiq.har', 'r') as f:
    har = json.load(f)

for entry in har['log']['entries']:
    url = entry['request']['url']
    if 'faceiqlabs.com/api/' in url:
        print(f"\n=== {entry['request']['method']} {url} ===")
        if 'response' in entry and 'content' in entry['response']:
            content = entry['response']['content']
            if 'text' in content:
                try:
                    print(json.dumps(json.loads(content['text']), indent=2)[:2000])
                except:
                    print(content['text'][:500])
EOF
```

### From Screen Recording
1. Note exact timing of each step
2. Document all UI states
3. Capture any animations/transitions
4. Note loading states and spinners

### From Screenshots
1. Annotate landmark positions
2. Document color schemes
3. Note typography and spacing
4. Capture all icons/assets

---

## Landmark Mapping

### Front Face - MediaPipe 478 Points
Key landmarks to identify in their UI:

| Feature | Likely MediaPipe Index |
|---------|----------------------|
| Left eye outer | 33 |
| Left eye inner | 133 |
| Right eye inner | 362 |
| Right eye outer | 263 |
| Nose tip | 4 |
| Nose bridge | 6 |
| Upper lip center | 13 |
| Lower lip center | 14 |
| Chin | 152 |
| Left cheekbone | 234 |
| Right cheekbone | 454 |
| Left eyebrow | 70 |
| Right eyebrow | 300 |
| Left jaw | 172 |
| Right jaw | 397 |

### Side Profile - 106 Points
From your HAR, they return 106 landmarks for side view. Key ones:

| Feature | Approximate Index |
|---------|------------------|
| Forehead | 0-10 |
| Nose bridge | 15-25 |
| Nose tip | 30-35 |
| Upper lip | 40-50 |
| Chin | 60-70 |
| Jaw line | 80-100 |

---

## Files to Save

After capture, organize like this:

```
faceiq-capture/
├── har/
│   └── full-session.har
├── screenshots/
│   ├── 01-login.png
│   ├── 02-dashboard.png
│   ├── 03-upload-front.png
│   ├── 04-auto-detect.png
│   ├── 05-manual-adjust.png
│   ├── 06-upload-side.png
│   ├── 07-side-detect.png
│   ├── 08-results.png
│   └── 09-premium.png
├── recordings/
│   └── full-flow.mp4
├── api-responses/
│   ├── faces-list.json
│   ├── face-create.json
│   ├── side-landmarks.json
│   └── subscription.json
├── components/
│   └── react-tree.txt
└── notes/
    ├── measurements-list.md
    └── ui-patterns.md
```
