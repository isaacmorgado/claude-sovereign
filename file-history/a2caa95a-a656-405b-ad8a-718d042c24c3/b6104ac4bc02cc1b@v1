# EMERGENCY FIX - debugLog Not Defined

## The Problem

config.js exports `window.debugLog` at line 1786, but when main.js runs, `debugLog` is not available.

This suggests **config.js is not fully executing** or there's an error preventing it from reaching the export line.

---

## Danny - Run This Diagnostic NOW

In DevTools Console (on SPLICE panel page), run:

```javascript
// Check what's defined
console.log('=== CONFIG.JS DIAGNOSTIC ===');
console.log('1. window.debugLog:', typeof window.debugLog);
console.log('2. window.SPLICE_CONFIG:', typeof window.SPLICE_CONFIG);
console.log('3. window.SPLICE_DEBUG:', typeof window.SPLICE_DEBUG);
console.log('4. window.getBackendUrl:', typeof window.getBackendUrl);
console.log('5. window.setStatus:', typeof window.setStatus);
console.log('6. window.jsx:', typeof window.jsx);
console.log('===========================');
```

**Send me the EXACT output!**

---

## Immediate Workaround

If all the above return `"undefined"`, then **config.js completely failed to load**. Run this fix:

```javascript
// Emergency debugLog definition
if (typeof debugLog === 'undefined') {
    window.debugLog = function(...args) {
        console.log('[SPLICE]', ...args);
    };
    console.log('âœ… Emergency debugLog created');
}

// Force reload
location.reload();
```

---

## Check Network Tab for config.js

1. Click **Network** tab in DevTools
2. Filter for **"config.js"**
3. Look at the entry

**Questions:**
- Status code? (should be 200)
- Size? (should be ~50KB+)
- If red **(failed)** = file not loading
- If 200 but small size = wrong file loaded

**Take screenshot of Network tab showing config.js**

---

## Check Console for config.js Errors

In Console tab, **scroll to the VERY TOP** (before the debugLog error).

**Look for errors like:**
```
Uncaught SyntaxError: config.js:XXX
Uncaught ReferenceError: config.js:XXX
Uncaught TypeError: config.js:XXX
```

**Any red error messages from config.js?**

If YES: **Screenshot the error** - that's the root cause!

---

## Check Sources Tab

1. Click **Sources** tab
2. Look for `js/config.js` in the file tree
3. **Click on config.js** to open it

**Questions:**
- Does config.js appear in the file tree?
- If you click it, does it show code?
- **Scroll to line 1786** (use Cmd+G or Ctrl+G)
- Does line 1786 say: `window.debugLog = debugLog;`?

**Take screenshot showing line 1786**

---

## The Real Issue

Based on the error pattern, one of these is true:

### Option A: config.js Syntax Error
- config.js has a syntax error before line 1786
- Code never reaches the export line
- **Fix:** Find and fix the syntax error

### Option B: Script Load Race Condition
- main.js DOMContentLoaded fires before config.js finishes
- **Fix:** Add `defer` attribute to scripts

### Option C: Scope Issue
- debugLog is defined but not on the right scope
- **Fix:** Always use `window.debugLog`

### Option D: CSInterface Override
- CSInterface or browser-simulation.js is overriding window
- **Fix:** Check browser-simulation.js

---

## Quick Test - Manual Load

In Console, try manually loading the exports:

```javascript
// Check if function is defined locally
eval(await (await fetch('js/config.js')).text());

// Now check if it worked
typeof window.debugLog
// Should return "function"
```

---

## Nuclear Option - Patch index.html

If nothing else works, we can add debugLog directly in index.html BEFORE any scripts load:

```html
<script>
// CRITICAL: Define debugLog FIRST
window.debugLog = function(...args) {
    if (localStorage.getItem('spliceDebugMode') === 'true') {
        console.log('[SPLICE DEBUG]', ...args);
    } else {
        console.log('[SPLICE]', ...args);
    }
};
window.debugFetch = function(...args) {
    if (localStorage.getItem('spliceDebugMode') === 'true') {
        console.log('[SPLICE FETCH]', ...args);
    }
};
console.log('[SPLICE] Emergency debugLog/debugFetch defined');
</script>
<script src="js/browser-simulation.js"></script>
<script src="js/CSInterface.js"></script>
<script src="js/config.js"></script>
...
```

---

## What I Need From You

**Run these 4 things and send results:**

1. **Diagnostic script output** (the first code block above)
2. **Screenshot of Network tab** (showing config.js)
3. **Screenshot of Console** (any errors from config.js?)
4. **Screenshot of Sources tab** (line 1786 of config.js)

Then I can give you the EXACT fix!

---

**THIS IS THE BLOCKING ISSUE - Once we fix debugLog, the entire UI will work!**
