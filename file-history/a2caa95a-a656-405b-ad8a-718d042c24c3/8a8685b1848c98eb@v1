# Fix: debugLog is not defined

## Quick Diagnostic

Danny, in the Chrome DevTools Console (for the SPLICE panel), run this:

```javascript
// Check if debugLog exists
typeof debugLog
```

**Expected:** Should return `"function"`
**If you get:** `"undefined"` = config.js didn't load or errored

```javascript
// Check if it's on window
typeof window.debugLog
```

**Expected:** Should return `"function"`

```javascript
// Check if config.js loaded
typeof SPLICE_CONFIG
```

**Expected:** Should return `"object"`
**If you get:** `"undefined"` = config.js failed to load

---

## Temporary Workaround

Paste this into Console to fix it immediately:

```javascript
// Define debugLog if missing
if (typeof debugLog === 'undefined') {
    window.debugLog = function(...args) {
        console.log('[SPLICE]', ...args);
    };
    console.log('✅ debugLog function created');
}

// Reload the page to reinitialize
location.reload();
```

---

## Root Cause

The error "debugLog is not defined at main.js:180" means:
1. **config.js** didn't load completely
2. OR config.js threw an error before line 1707
3. OR there's a race condition

---

## Check for config.js Errors

In DevTools **Console tab**, look for errors from `config.js` BEFORE the debugLog error.

**Common errors to look for:**
```
Uncaught SyntaxError: config.js:XXX
Uncaught ReferenceError: config.js:XXX
Uncaught TypeError: config.js:XXX
```

**Take a screenshot** of the Console showing ALL errors (scroll to top)

---

## Check Network Tab

1. Click **Network** tab
2. Filter for **"JS"**
3. Look for `config.js`

**Check:**
- Status: Should be **200** (green)
- Size: Should be **~50KB**
- If **(failed)** or **404** = file not loading

**Take a screenshot** of Network tab

---

## The Fix (If config.js Loaded But debugLog Missing)

This is a scoping issue. We need to ensure `debugLog` is defined BEFORE main.js runs.

### Option 1: Define it inline in index.html

Add this BEFORE the config.js script tag:

```html
<script>
// Emergency debugLog definition (fallback)
window.debugLog = window.debugLog || function(...args) {
    if (localStorage.getItem('spliceDebugMode') === 'true') {
        console.log('[SPLICE DEBUG]', ...args);
    }
};
</script>
<script src="js/config.js"></script>
```

### Option 2: Move exports outside DOMContentLoaded in config.js

The exports at line 1703-1719 are already outside DOMContentLoaded, so this should work. But if it's not, we need to check if there's an error thrown before line 1707.

---

## Debug Script - Run This

Copy/paste this entire block into Console:

```javascript
console.log('=== CONFIG.JS DEBUG ===');

// 1. Check if config.js variables exist
console.log('1. SPLICE_CONFIG:', typeof SPLICE_CONFIG !== 'undefined' ? '✅ Loaded' : '❌ Missing');
console.log('2. SPLICE_DEBUG:', typeof SPLICE_DEBUG !== 'undefined' ? '✅ Loaded' : '❌ Missing');
console.log('3. debugLog:', typeof debugLog !== 'undefined' ? '✅ Loaded' : '❌ Missing');
console.log('4. jsx:', typeof jsx !== 'undefined' ? '✅ Loaded' : '❌ Missing');
console.log('5. CSInterface:', typeof CSInterface !== 'undefined' ? '✅ Loaded' : '❌ Missing');

// 2. Check window exports
console.log('\nWindow Exports:');
console.log('window.debugLog:', typeof window.debugLog);
console.log('window.SPLICE_CONFIG:', typeof window.SPLICE_CONFIG);
console.log('window.getBackendUrl:', typeof window.getBackendUrl);
console.log('window.setStatus:', typeof window.setStatus);

// 3. List all scripts loaded
console.log('\nLoaded Scripts:');
Array.from(document.querySelectorAll('script')).forEach((s, i) => {
    const src = s.src || '(inline)';
    console.log(`  ${i + 1}. ${src.split('/').pop()}`);
});

// 4. Check for errors
console.log('\n======================');
console.log('Look above for any ❌ Missing items');
console.log('======================');
```

**Copy the ENTIRE output** and send it to me!

---

## Most Likely Cause

Based on the error "(in promise)", it's happening inside an async function in main.js DOMContentLoaded handler.

The issue is probably:
1. **config.js loaded successfully**
2. **debugLog was exported to window**
3. **BUT** main.js is calling `debugLog()` instead of `window.debugLog()` or it's using a strict mode that doesn't allow implicit globals

---

## The Real Fix

Need to check main.js line 180 in the actual installed version:

```bash
# In Terminal:
cat "$HOME/Library/Application Support/Adobe/CEP/extensions/com.splice.cep/panel/js/main.js" | sed -n '175,185p'
```

Send me the output - I need to see exactly what line 180 is doing.

---

## Quick Check - Which File Has the Error?

In Console, click on **main.js:180** in the error message. It should open the Sources tab and show you line 180.

**What does line 180 say?**

Take a screenshot showing:
1. Line 180 highlighted
2. The surrounding lines (175-185)

---

## Interim Solution

Until we fix the root cause, you can manually define debugLog:

1. Open DevTools Console (on SPLICE panel page)
2. Paste this:
```javascript
window.debugLog = function(...args) {
    console.log('[SPLICE]', ...args);
};
console.log('debugLog manually defined');
```
3. Close and reopen SPLICE panel in Premiere Pro
4. Check if UI works now

---

Send me:
1. Output of the debug script above
2. Screenshot of line 180 in Sources tab
3. Result of `typeof window.debugLog` in Console

Then I can give you the exact fix!
