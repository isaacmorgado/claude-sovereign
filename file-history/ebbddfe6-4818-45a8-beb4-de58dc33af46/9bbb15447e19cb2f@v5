---
description: Collect research and documentation into buildguide.md
---

# Collect Command

Consolidate all research, documentation, and plans into `buildguide.md` - a comprehensive build guide that understands your architecture and creates actionable implementation plans.

## Instructions

### 1. Check if buildguide.md Exists

Check for `buildguide.md` in the project root.

**If it exists:** Skip to Step 4 (Add to existing guide).

**If it does NOT exist:** Proceed to Step 2 (Full initialization).

---

## First-Time Setup (Steps 2-3)

### 2. Gather All Project Knowledge

#### 2a. Launch 3 Explore Agents in Parallel

Use the Task tool to spawn 3 explore agents simultaneously (single message, 3 Task calls):

**Agent 1 - Architecture & Structure:**
```
Explore the codebase thoroughly. Document:
- Project type and main entry points
- Directory structure and file organization
- Frameworks and libraries in use
- Database/data layer (ORM, schemas, migrations)
- API structure (routes, endpoints, middleware)
- Frontend structure (components, pages, routing)
- Build system and tooling
Return a detailed technical architecture summary.
```

**Agent 2 - Patterns, Style & Limitations:**
```
Explore the codebase for patterns and constraints. Document:
- Code style and naming conventions
- Component/module patterns
- State management approach
- Error handling patterns
- Authentication/authorization patterns
- Current technical limitations or debt
- Areas that need improvement
Return patterns to follow AND limitations to be aware of.
```

**Agent 3 - Dependencies & External Services:**
```
Explore all project dependencies and integrations. Document:
- All dependencies (package.json, requirements.txt, go.mod, etc.)
- External services (auth, payments, email, storage, etc.)
- API integrations (third-party APIs in use)
- Environment variables and configuration
- Deployment setup (hosting, CI/CD)
Return a complete dependency and integration map.
```

#### 2b. Scan for ALL Existing Documentation

Search the entire project for documentation and research:

```
Locations to check:
- .claude/plans/*.md
- .claude/docs/*.md
- docs/**/*.md
- *.md in project root (README, CONTRIBUTING, etc.)
- .github/*.md
- Any research/ or notes/ directories
- CLAUDE.md if it exists
- Comments in config files with important context
```

Read and extract key information from each document found:
- What decisions were made and why
- Implementation details documented
- Research findings
- API documentation
- Architecture decisions
- Meeting notes or requirements

#### 2c. Scan Current Conversation

Review the current conversation for:
- Research that was just completed
- Decisions discussed
- URLs visited and information gathered
- User requirements stated

### 3. Create buildguide.md with Plan Agent

Launch a Plan agent (subagent_type=Plan) with ALL gathered information:

```
You have the following information about this project:

ARCHITECTURE:
[Output from Agent 1]

PATTERNS & LIMITATIONS:
[Output from Agent 2]

DEPENDENCIES & INTEGRATIONS:
[Output from Agent 3]

EXISTING DOCUMENTATION:
[Summaries from all .md files found]

CURRENT RESEARCH:
[Any research from this conversation]

USER'S GOAL:
[What the user said they want to build, or ask them]

---

Create a comprehensive buildguide.md that:

1. Synthesizes all architecture knowledge into a clear overview
2. Documents current limitations and how they affect implementation
3. Creates a logical section breakdown for the build
4. For each section, outlines:
   - What needs to be built
   - How it fits with existing architecture
   - Dependencies on other sections
   - Key implementation considerations
5. Incorporates all existing research and documentation
6. Identifies gaps where more research is needed

Structure the buildguide.md as:

# Build Guide

> Project: [name]
> Created: [date]
> Last Updated: [date]

## Project Overview
[What this project is and does]

## Current Architecture
[How the codebase is structured now]

## Technical Stack
[Frameworks, libraries, services in use]

## Known Limitations
[Technical debt, constraints, things to work around]

## Build Sections
- [ ] Section 1
- [ ] Section 2
...

---

## Section: [Name]
### Overview
[What this section accomplishes]

### Architecture Fit
[How it integrates with existing code]

### Implementation Approach
[Key steps and considerations]

### Research & References
[Any relevant documentation/research]

---

[Repeat for each section]

---

## Imported Documentation
[Key excerpts from existing docs that are relevant]

---

## Completed Sections
[Filled in by /checkpoint as sections complete]
```

The Plan agent should ask clarifying questions if the user's goals are unclear.

---

## Adding to Existing Guide (Step 4+)

### 4. Identify What to Collect

If buildguide.md already exists, identify new content to add:

- New research from this conversation
- New plans created in .claude/plans/
- New documentation added anywhere
- Decisions made during implementation
- Lessons learned

Also re-scan .claude/plans/ and docs/ for any new files.

### 5. Integrate New Content

Ask the user:

1. **"What section does this belong to?"**
   - Existing section
   - New section (will be created)
   - General reference

2. **"Should this update the implementation approach?"**
   - Yes - modify the section's approach based on new info
   - No - just add as reference material

### 6. Update with Plan Agent (if significant)

For significant new information that affects architecture or approach, spawn a Plan agent:

```
Current buildguide.md:
[contents]

New information to integrate:
[new research/docs]

Update the buildguide.md to incorporate this new information.
- Update affected sections' implementation approaches if needed
- Add new research under appropriate sections
- Flag any new limitations discovered
- Suggest new sections if the scope has expanded
```

For simple additions (just reference material), directly add to the appropriate section.

### 7. Show Summary

```
Updated buildguide.md:
- Added: [what was added]
- Sections affected: [list]
- New files imported: [list]
- Implementation changes: [any approach updates]
- Next suggested action: [what to research or build next]
```

---

## Integration with /checkpoint

When `/checkpoint` runs after completing a section:
1. Section marked `[x]` complete in Build Sections
2. Implementation notes added to that section
3. Content condensed and moved to Completed Sections
4. Next uncompleted section highlighted

---

## Example First Run

```
User: /collect

Claude: No buildguide.md found. Initializing full project analysis...

[Spawns 3 explore agents in parallel]

Scanning for existing documentation...
Found:
- README.md (project overview)
- .claude/plans/auth-migration.md (auth system redesign)
- .claude/plans/api-v2.md (API redesign notes)
- docs/database-schema.md (current schema docs)

[Spawns Plan agent with all gathered info]

Plan agent: I've analyzed your Next.js e-commerce project. I see you have:
- Partial Clerk auth implementation
- PostgreSQL with Prisma
- No payment system yet
- Plans for auth migration and API v2

What features are you building? I'll create a comprehensive build guide with implementation details for each section.

User: I need to finish auth, add Stripe payments, and build an admin dashboard

Plan agent: Creating buildguide.md with 3 main sections...
[Creates detailed buildguide.md with architecture-aware implementation plans]
```

---

## Guidelines

- **First run = full analysis** - 3 explore agents + Plan agent for comprehensive setup
- **Scan everywhere** - Not just plans folder, ALL documentation in the project
- **Plan agent synthesizes** - Don't just dump info, create actionable implementation plans
- **Architecture-aware** - Every section considers how it fits with existing code
- **Limitations documented** - Know what constraints affect implementation
- **Living document** - Updates as you research and build
