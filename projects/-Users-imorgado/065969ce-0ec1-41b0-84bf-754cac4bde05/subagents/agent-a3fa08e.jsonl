{"parentUuid":null,"isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":"Search GitHub for the best Puppeteer stealth libraries and implementations. Look for:\n1. puppeteer-extra-plugin-stealth usage patterns\n2. Modern stealth detection bypass techniques\n3. Popular repositories with high stars\n4. Real-world implementation examples\n\nUse mcp__grep__searchGitHub to find actual code patterns. Focus on finding the most popular and actively maintained solutions."},"uuid":"41bda587-3c07-4f60-885b-81b3ba13d45a","timestamp":"2026-01-12T23:30:40.953Z"}
{"parentUuid":"41bda587-3c07-4f60-885b-81b3ba13d45a","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"text","text":"I'll search GitHub for the best Puppeteer stealth libraries and implementations using real code patterns."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"9438d470-c562-4700-bb6a-271ee40cfcf2","timestamp":"2026-01-12T23:30:44.322Z"}
{"parentUuid":"9438d470-c562-4700-bb6a-271ee40cfcf2","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011UCcpyGJDFuCE2tKa7gq3n","name":"mcp__grep__searchGitHub","input":{"query":"puppeteer-extra-plugin-stealth","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"c262f62d-34e6-4f81-97d3-548f3da51382","timestamp":"2026-01-12T23:30:44.987Z"}
{"parentUuid":"c262f62d-34e6-4f81-97d3-548f3da51382","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Y6c9x6ZHaw26yLVz8jwijA","name":"mcp__grep__searchGitHub","input":{"query":"import { addExtra } from 'puppeteer-extra'","language":["TypeScript","JavaScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"3c85392f-3415-46f1-85cc-30a9b58b802a","timestamp":"2026-01-12T23:30:46.037Z"}
{"parentUuid":"3c85392f-3415-46f1-85cc-30a9b58b802a","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0132gUWBrVVLDhWjMY3FkEdv","name":"mcp__grep__searchGitHub","input":{"query":"puppeteer.use(StealthPlugin","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"52dcefd6-a2ca-408c-a262-8358f428313a","timestamp":"2026-01-12T23:30:46.838Z"}
{"parentUuid":"52dcefd6-a2ca-408c-a262-8358f428313a","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Lxv2tJiNdYQpMh4gtPQPnw","name":"mcp__grep__searchGitHub","input":{"query":"page.evaluateOnNewDocument","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"dd98cecc-5ec1-4a14-a6df-3a5ca528f576","timestamp":"2026-01-12T23:30:47.401Z"}
{"parentUuid":"dd98cecc-5ec1-4a14-a6df-3a5ca528f576","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01LfFfaPEGoxXkT8scFhevBv","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01MZpEKiGGQzbvCfWyZYbakQ","name":"mcp__grep__searchGitHub","input":{"query":"navigator.webdriver","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":20378,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":20378,"ephemeral_1h_input_tokens":0},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CX4MXV3kkj78NHezNscPU","type":"assistant","uuid":"2a7e494a-1da4-4ec6-ba8d-a06fc9ac29a4","timestamp":"2026-01-12T23:30:47.869Z"}
{"parentUuid":"c262f62d-34e6-4f81-97d3-548f3da51382","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011UCcpyGJDFuCE2tKa7gq3n","type":"tool_result","content":[{"type":"text","text":"Repository: JimLiu/gpt-api\nPath: utils/puppeteer.ts\nURL: https://github.com/JimLiu/gpt-api/blob/main/utils/puppeteer.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 2) ---\nimport type { Browser } from \"puppeteer\";\nimport puppeteer from \"puppeteer-extra\";\nimport StealthPlugin from \"puppeteer-extra-plugin-stealth\";\n\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.app\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.csi\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.runtime\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/media.codecs\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.languages\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.permissions\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.plugins\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.vendor\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.webdriver\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/sourceurl\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/user-agent-override\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/webgl.vendor\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/window.outerdimensions\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/defaultArgs\");\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 23) ---\n * automatically and comes with defaults. You could also bypass the main module and require\n * specific evasion plugins yourself, if you whish to do so (as they're standalone `puppeteer-extra` plugins):\n *\n * ```es6\n * // bypass main module and require a specific stealth plugin directly:\n * puppeteer.use(require('puppeteer-extra-plugin-stealth/evasions/console.debug')())\n * ```\n *\n * ### Contributing\n * PRs are welcome, if you want to add a new evasion technique I suggest you\n * look at the [template](./evasions/_template) to kickstart things.\n\n\n--- Snippet 2 (Line 42) ---\n * - dynamic whitelist based on function evaluation\n *\n * @example\n * const puppeteer = require('puppeteer-extra')\n * // Enable stealth plugin with all evasions\n * puppeteer.use(require('puppeteer-extra-plugin-stealth')())\n *\n *\n * ;(async () => {\n"},{"type":"text","text":"Repository: cool-dev-guy/rabbitthunder\nPath: api/upcloud.ts\nURL: https://github.com/cool-dev-guy/rabbitthunder/blob/main/api/upcloud.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 6) ---\nrequire('puppeteer-extra-plugin-user-data-dir')\nrequire('puppeteer-extra-plugin-user-preferences')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.app')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.csi')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.runtime')\nrequire('puppeteer-extra-plugin-stealth/evasions/defaultArgs') // pkg warned me this one was missing\nrequire('puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow')\nrequire('puppeteer-extra-plugin-stealth/evasions/media.codecs')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.languages')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.permissions')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.plugins')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.webdriver')\nrequire('puppeteer-extra-plugin-stealth/evasions/sourceurl')\nrequire('puppeteer-extra-plugin-stealth/evasions/user-agent-override')\nrequire('puppeteer-extra-plugin-stealth/evasions/webgl.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/window.outerdimensions')\n\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\n"},{"type":"text","text":"Repository: cool-dev-guy/rabbitthunder\nPath: api/vidcloud.ts\nURL: https://github.com/cool-dev-guy/rabbitthunder/blob/main/api/vidcloud.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\nrequire('puppeteer-extra-plugin-user-data-dir')\nrequire('puppeteer-extra-plugin-user-preferences')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.app')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.csi')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.runtime')\nrequire('puppeteer-extra-plugin-stealth/evasions/defaultArgs') // pkg warned me this one was missing\nrequire('puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow')\nrequire('puppeteer-extra-plugin-stealth/evasions/media.codecs')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.languages')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.permissions')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.plugins')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.webdriver')\nrequire('puppeteer-extra-plugin-stealth/evasions/sourceurl')\nrequire('puppeteer-extra-plugin-stealth/evasions/user-agent-override')\nrequire('puppeteer-extra-plugin-stealth/evasions/webgl.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/window.outerdimensions')\n\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/user-agent-override/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/user-agent-override/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 19) ---\n * as it will reset the language and platform values you set with this plugin.\n *\n * @example\n * const puppeteer = require(\"puppeteer-extra\")\n *\n * const StealthPlugin = require(\"puppeteer-extra-plugin-stealth\")\n * const stealth = StealthPlugin()\n * // Remove this specific stealth plugin from the default set\n * stealth.enabledEvasions.delete(\"user-agent-override\")\n * puppeteer.use(stealth)\n *\n * // Stealth plugins are just regular `puppeteer-extra` plugins and can be added as such\n * const UserAgentOverride = require(\"puppeteer-extra-plugin-stealth/evasions/user-agent-override\")\n * // Define custom UA and locale\n * const ua = UserAgentOverride({ userAgent: \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\", locale: \"de-DE,de\" })\n * puppeteer.use(ua)\n *\n * @param {Object} [opts] - Options\n"},{"type":"text","text":"Repository: promptfoo/promptfoo\nPath: src/providers/browser.ts\nURL: https://github.com/promptfoo/promptfoo/blob/main/src/providers/browser.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 156) ---\n    this.isFirstCall = false;\n\n    let chromium, stealth;\n    try {\n      ({ chromium } = await import('playwright-extra'));\n      ({ default: stealth } = await import('puppeteer-extra-plugin-stealth'));\n    } catch (error) {\n      return {\n        error: `Failed to import required modules. Please ensure the following packages are installed:\\n\\tplaywright @playwright/browser-chromium playwright-extra puppeteer-extra-plugin-stealth\\n\\nError: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      };\n    }\n\n    chromium.use(stealth());\n\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 354) ---\n      // We follow a plugin naming convention, but let's rather enforce it <3\n      name = name.startsWith('puppeteer-extra-plugin')\n        ? name\n        : `puppeteer-extra-plugin-${name}`\n      // In case a module sub resource is requested print out the main package name\n      // e.g. puppeteer-extra-plugin-stealth/evasions/console.debug => puppeteer-extra-plugin-stealth\n      const packageName = name.split('/')[0]\n      let dep = null\n      try {\n        // Try to require and instantiate the stated dependency\n        dep = require(name)()\n"},{"type":"text","text":"Repository: vogler/free-games-claimer\nPath: src/util.js\nURL: https://github.com/vogler/free-games-claimer/blob/main/src/util.js\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 49) ---\n  return context;\n};\n\nexport const stealth = async context => {\n  // stealth with playwright: https://github.com/berstend/puppeteer-extra/issues/454#issuecomment-917437212\n  // https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth/evasions\n  const enabledEvasions = [\n    'chrome.app',\n    'chrome.csi',\n    'chrome.loadTimes',\n    'chrome.runtime',\n\n\n--- Snippet 2 (Line 76) ---\n    async evaluateOnNewDocument(...args) {\n      this.callbacks.push({ cb: args[0], a: args[1] });\n    },\n  };\n  for (const e of enabledEvasions) {\n    const evasion = await import(`puppeteer-extra-plugin-stealth/evasions/${e}/index.js`);\n    evasion.default().onPageCreated(stealth);\n  }\n  for (const evasion of stealth.callbacks) {\n"},{"type":"text","text":"Repository: samuelscheit/puppeteer-stream\nPath: examples/puppeteer-extra.js\nURL: https://github.com/samuelscheit/puppeteer-stream/blob/main/examples/puppeteer-extra.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst { launch, getStream } = require(\"../dist/PuppeteerStream\");\nconst fs = require(\"fs\");\nconst utils = require(\"../tests/_utils\");\n\n// make sure to install puppeteer-extra & puppeteer-extra-plugin-stealth to use this example\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\n\npuppeteer.use(StealthPlugin());\n\nconst file = fs.createWriteStream(__dirname + \"/test.webm\");\n\n"},{"type":"text","text":"Repository: BetaHuhn/vercel-pdf-converter\nPath: service/convert.js\nURL: https://github.com/BetaHuhn/vercel-pdf-converter/blob/master/service/convert.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport chrome from 'chrome-aws-lambda'\nimport { addExtra } from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\n\n// Workaround, see https://github.com/berstend/puppeteer-extra/issues/93#issuecomment-712364816\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport ChromeAppPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.app'\nimport ChromeCsiPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.csi'\nimport ChromeLoadTimes from 'puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes'\nimport ChromeRuntimePlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.runtime'\nimport IFrameContentWindowPlugin from 'puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow'\nimport MediaCodecsPlugin from 'puppeteer-extra-plugin-stealth/evasions/media.codecs'\nimport NavigatorLanguagesPlugin from 'puppeteer-extra-plugin-stealth/evasions/navigator.languages'\nimport NavigatorPermissionsPlugin from 'puppeteer-extra-plugin-stealth/evasions/navigator.permissions'\nimport NavigatorPlugins from 'puppeteer-extra-plugin-stealth/evasions/navigator.plugins'\nimport NavigatorVendor from 'puppeteer-extra-plugin-stealth/evasions/navigator.vendor'\nimport NavigatorWebdriver from 'puppeteer-extra-plugin-stealth/evasions/navigator.webdriver'\nimport SourceUrlPlugin from 'puppeteer-extra-plugin-stealth/evasions/sourceurl'\nimport UserAgentOverridePlugin from 'puppeteer-extra-plugin-stealth/evasions/user-agent-override'\nimport WebglVendorPlugin from 'puppeteer-extra-plugin-stealth/evasions/webgl.vendor'\nimport WindowOuterDimensionsPlugin from 'puppeteer-extra-plugin-stealth/evasions/window.outerdimensions'\n"}]}]},"uuid":"936c4c38-8763-408a-883f-1a4e3b67b2a5","timestamp":"2026-01-12T23:30:48.262Z","toolUseResult":[{"type":"text","text":"Repository: JimLiu/gpt-api\nPath: utils/puppeteer.ts\nURL: https://github.com/JimLiu/gpt-api/blob/main/utils/puppeteer.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 2) ---\nimport type { Browser } from \"puppeteer\";\nimport puppeteer from \"puppeteer-extra\";\nimport StealthPlugin from \"puppeteer-extra-plugin-stealth\";\n\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.app\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.csi\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/chrome.runtime\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/media.codecs\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.languages\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.permissions\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.plugins\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.vendor\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/navigator.webdriver\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/sourceurl\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/user-agent-override\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/webgl.vendor\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/window.outerdimensions\");\nrequire(\"puppeteer-extra-plugin-stealth/evasions/defaultArgs\");\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 23) ---\n * automatically and comes with defaults. You could also bypass the main module and require\n * specific evasion plugins yourself, if you whish to do so (as they're standalone `puppeteer-extra` plugins):\n *\n * ```es6\n * // bypass main module and require a specific stealth plugin directly:\n * puppeteer.use(require('puppeteer-extra-plugin-stealth/evasions/console.debug')())\n * ```\n *\n * ### Contributing\n * PRs are welcome, if you want to add a new evasion technique I suggest you\n * look at the [template](./evasions/_template) to kickstart things.\n\n\n--- Snippet 2 (Line 42) ---\n * - dynamic whitelist based on function evaluation\n *\n * @example\n * const puppeteer = require('puppeteer-extra')\n * // Enable stealth plugin with all evasions\n * puppeteer.use(require('puppeteer-extra-plugin-stealth')())\n *\n *\n * ;(async () => {\n"},{"type":"text","text":"Repository: cool-dev-guy/rabbitthunder\nPath: api/upcloud.ts\nURL: https://github.com/cool-dev-guy/rabbitthunder/blob/main/api/upcloud.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 6) ---\nrequire('puppeteer-extra-plugin-user-data-dir')\nrequire('puppeteer-extra-plugin-user-preferences')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.app')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.csi')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.runtime')\nrequire('puppeteer-extra-plugin-stealth/evasions/defaultArgs') // pkg warned me this one was missing\nrequire('puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow')\nrequire('puppeteer-extra-plugin-stealth/evasions/media.codecs')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.languages')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.permissions')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.plugins')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.webdriver')\nrequire('puppeteer-extra-plugin-stealth/evasions/sourceurl')\nrequire('puppeteer-extra-plugin-stealth/evasions/user-agent-override')\nrequire('puppeteer-extra-plugin-stealth/evasions/webgl.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/window.outerdimensions')\n\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\n"},{"type":"text","text":"Repository: cool-dev-guy/rabbitthunder\nPath: api/vidcloud.ts\nURL: https://github.com/cool-dev-guy/rabbitthunder/blob/main/api/vidcloud.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\nrequire('puppeteer-extra-plugin-user-data-dir')\nrequire('puppeteer-extra-plugin-user-preferences')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.app')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.csi')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes')\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.runtime')\nrequire('puppeteer-extra-plugin-stealth/evasions/defaultArgs') // pkg warned me this one was missing\nrequire('puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow')\nrequire('puppeteer-extra-plugin-stealth/evasions/media.codecs')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.languages')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.permissions')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.plugins')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.webdriver')\nrequire('puppeteer-extra-plugin-stealth/evasions/sourceurl')\nrequire('puppeteer-extra-plugin-stealth/evasions/user-agent-override')\nrequire('puppeteer-extra-plugin-stealth/evasions/webgl.vendor')\nrequire('puppeteer-extra-plugin-stealth/evasions/window.outerdimensions')\n\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/user-agent-override/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/user-agent-override/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 19) ---\n * as it will reset the language and platform values you set with this plugin.\n *\n * @example\n * const puppeteer = require(\"puppeteer-extra\")\n *\n * const StealthPlugin = require(\"puppeteer-extra-plugin-stealth\")\n * const stealth = StealthPlugin()\n * // Remove this specific stealth plugin from the default set\n * stealth.enabledEvasions.delete(\"user-agent-override\")\n * puppeteer.use(stealth)\n *\n * // Stealth plugins are just regular `puppeteer-extra` plugins and can be added as such\n * const UserAgentOverride = require(\"puppeteer-extra-plugin-stealth/evasions/user-agent-override\")\n * // Define custom UA and locale\n * const ua = UserAgentOverride({ userAgent: \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\", locale: \"de-DE,de\" })\n * puppeteer.use(ua)\n *\n * @param {Object} [opts] - Options\n"},{"type":"text","text":"Repository: promptfoo/promptfoo\nPath: src/providers/browser.ts\nURL: https://github.com/promptfoo/promptfoo/blob/main/src/providers/browser.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 156) ---\n    this.isFirstCall = false;\n\n    let chromium, stealth;\n    try {\n      ({ chromium } = await import('playwright-extra'));\n      ({ default: stealth } = await import('puppeteer-extra-plugin-stealth'));\n    } catch (error) {\n      return {\n        error: `Failed to import required modules. Please ensure the following packages are installed:\\n\\tplaywright @playwright/browser-chromium playwright-extra puppeteer-extra-plugin-stealth\\n\\nError: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      };\n    }\n\n    chromium.use(stealth());\n\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 354) ---\n      // We follow a plugin naming convention, but let's rather enforce it <3\n      name = name.startsWith('puppeteer-extra-plugin')\n        ? name\n        : `puppeteer-extra-plugin-${name}`\n      // In case a module sub resource is requested print out the main package name\n      // e.g. puppeteer-extra-plugin-stealth/evasions/console.debug => puppeteer-extra-plugin-stealth\n      const packageName = name.split('/')[0]\n      let dep = null\n      try {\n        // Try to require and instantiate the stated dependency\n        dep = require(name)()\n"},{"type":"text","text":"Repository: vogler/free-games-claimer\nPath: src/util.js\nURL: https://github.com/vogler/free-games-claimer/blob/main/src/util.js\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 49) ---\n  return context;\n};\n\nexport const stealth = async context => {\n  // stealth with playwright: https://github.com/berstend/puppeteer-extra/issues/454#issuecomment-917437212\n  // https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth/evasions\n  const enabledEvasions = [\n    'chrome.app',\n    'chrome.csi',\n    'chrome.loadTimes',\n    'chrome.runtime',\n\n\n--- Snippet 2 (Line 76) ---\n    async evaluateOnNewDocument(...args) {\n      this.callbacks.push({ cb: args[0], a: args[1] });\n    },\n  };\n  for (const e of enabledEvasions) {\n    const evasion = await import(`puppeteer-extra-plugin-stealth/evasions/${e}/index.js`);\n    evasion.default().onPageCreated(stealth);\n  }\n  for (const evasion of stealth.callbacks) {\n"},{"type":"text","text":"Repository: samuelscheit/puppeteer-stream\nPath: examples/puppeteer-extra.js\nURL: https://github.com/samuelscheit/puppeteer-stream/blob/main/examples/puppeteer-extra.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst { launch, getStream } = require(\"../dist/PuppeteerStream\");\nconst fs = require(\"fs\");\nconst utils = require(\"../tests/_utils\");\n\n// make sure to install puppeteer-extra & puppeteer-extra-plugin-stealth to use this example\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\n\npuppeteer.use(StealthPlugin());\n\nconst file = fs.createWriteStream(__dirname + \"/test.webm\");\n\n"},{"type":"text","text":"Repository: BetaHuhn/vercel-pdf-converter\nPath: service/convert.js\nURL: https://github.com/BetaHuhn/vercel-pdf-converter/blob/master/service/convert.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport chrome from 'chrome-aws-lambda'\nimport { addExtra } from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\n\n// Workaround, see https://github.com/berstend/puppeteer-extra/issues/93#issuecomment-712364816\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport ChromeAppPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.app'\nimport ChromeCsiPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.csi'\nimport ChromeLoadTimes from 'puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes'\nimport ChromeRuntimePlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.runtime'\nimport IFrameContentWindowPlugin from 'puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow'\nimport MediaCodecsPlugin from 'puppeteer-extra-plugin-stealth/evasions/media.codecs'\nimport NavigatorLanguagesPlugin from 'puppeteer-extra-plugin-stealth/evasions/navigator.languages'\nimport NavigatorPermissionsPlugin from 'puppeteer-extra-plugin-stealth/evasions/navigator.permissions'\nimport NavigatorPlugins from 'puppeteer-extra-plugin-stealth/evasions/navigator.plugins'\nimport NavigatorVendor from 'puppeteer-extra-plugin-stealth/evasions/navigator.vendor'\nimport NavigatorWebdriver from 'puppeteer-extra-plugin-stealth/evasions/navigator.webdriver'\nimport SourceUrlPlugin from 'puppeteer-extra-plugin-stealth/evasions/sourceurl'\nimport UserAgentOverridePlugin from 'puppeteer-extra-plugin-stealth/evasions/user-agent-override'\nimport WebglVendorPlugin from 'puppeteer-extra-plugin-stealth/evasions/webgl.vendor'\nimport WindowOuterDimensionsPlugin from 'puppeteer-extra-plugin-stealth/evasions/window.outerdimensions'\n"}],"sourceToolAssistantUUID":"c262f62d-34e6-4f81-97d3-548f3da51382"}
{"parentUuid":"3c85392f-3415-46f1-85cc-30a9b58b802a","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Y6c9x6ZHaw26yLVz8jwijA","type":"tool_result","content":[{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 504) ---\n * @example\n * // js import\n * const { addExtra } = require('puppeteer-extra')\n *\n * // ts/es6 import\n * import { addExtra } from 'puppeteer-extra'\n *\n * // Patch e.g. puppeteer-firefox and add plugins\n * const puppeteer = addExtra(require('puppeteer-firefox'))\n * puppeteer.use(...)\n *\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/index.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/index.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 3) ---\nimport RecaptchaPlugin from './index'\n// import * as types from './types'\n\n// import { Puppeteer } from './puppeteer-mods'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\ntest('will detect reCAPTCHAs', async t => {\n  const puppeteer = addExtra(require('puppeteer'))\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/solve.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/solve.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport test from 'ava'\n\nimport RecaptchaPlugin from './index'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\ntest('will solve reCAPTCHAs', async t => {\n  if (!process.env.TWOCAPTCHA_TOKEN) {\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/detection.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/detection.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport test from 'ava'\n\nimport RecaptchaPlugin from './index'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\nconst getBrowser = async (url = '', opts = {}) => {\n  const puppeteer = addExtra(require('puppeteer'))\n"},{"type":"text","text":"Repository: 3846masa/upload-gphotos\nPath: src/puppeteer.ts\nURL: https://github.com/3846masa/upload-gphotos/blob/master/src/puppeteer.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport originalPuppeteer from 'puppeteer-core';\nimport { addExtra } from 'puppeteer-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\n\nconst puppeteer = addExtra(originalPuppeteer);\npuppeteer.use(StealthPlugin());\n\n"},{"type":"text","text":"Repository: BetaHuhn/vercel-pdf-converter\nPath: service/convert.js\nURL: https://github.com/BetaHuhn/vercel-pdf-converter/blob/master/service/convert.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport chrome from 'chrome-aws-lambda'\nimport { addExtra } from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\n\n// Workaround, see https://github.com/berstend/puppeteer-extra/issues/93#issuecomment-712364816\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport ChromeAppPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.app'\n"},{"type":"text","text":"Repository: whale4113/weread-downloader\nPath: src/index.ts\nURL: https://github.com/whale4113/weread-downloader/blob/main/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport puppeteerVanilla from 'puppeteer'\nimport { addExtra } from 'puppeteer-extra'\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport prompts from 'prompts'\nimport { chunk } from 'es-toolkit'\nimport url from 'node:url'\nimport { SECOND } from './utils/datetime'\n"},{"type":"text","text":"Repository: Shelex/free-otp-api\nPath: src/browser/cluster.ts\nURL: https://github.com/Shelex/free-otp-api/blob/master/src/browser/cluster.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { Cluster } from 'puppeteer-cluster';\nimport vanillaPuppeteer, { Page } from 'puppeteer';\nimport { addExtra } from 'puppeteer-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { consola } from 'consola';\nimport { createLock } from './lock.js';\nimport { waitFor } from '../time/utils.js';\n\n"},{"type":"text","text":"Repository: chrisstiles/PublishDateBot\nPath: src/worker.js\nURL: https://github.com/chrisstiles/PublishDateBot/blob/master/src/worker.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 15) ---\nimport { Worker } from 'bullmq';\nimport connection from './redis.js';\nimport throng from 'throng';\nimport basePuppeteer from 'puppeteer';\nimport { Cluster } from 'puppeteer-cluster';\nimport { addExtra } from 'puppeteer-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker';\nimport cache from 'memory-cache';\nimport dotenv from 'dotenv';\n\n"},{"type":"text","text":"Repository: claabs/puppeteer-extra-plugin-portal\nPath: src/index.test.ts\nURL: https://github.com/claabs/puppeteer-extra-plugin-portal/blob/master/src/index.test.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n/* eslint-disable jest/no-disabled-tests */\n/* eslint-disable no-console */\nimport { addExtra } from 'puppeteer-extra';\nimport open from 'open';\nimport express from 'express';\nimport { Page, Target } from 'puppeteer';\nimport WebSocket from 'ws';\nimport PortalPlugin from './index';\n"}]}]},"uuid":"48865014-5c38-4fba-8fd5-50c796ea308f","timestamp":"2026-01-12T23:30:48.506Z","toolUseResult":[{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 504) ---\n * @example\n * // js import\n * const { addExtra } = require('puppeteer-extra')\n *\n * // ts/es6 import\n * import { addExtra } from 'puppeteer-extra'\n *\n * // Patch e.g. puppeteer-firefox and add plugins\n * const puppeteer = addExtra(require('puppeteer-firefox'))\n * puppeteer.use(...)\n *\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/index.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/index.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 3) ---\nimport RecaptchaPlugin from './index'\n// import * as types from './types'\n\n// import { Puppeteer } from './puppeteer-mods'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\ntest('will detect reCAPTCHAs', async t => {\n  const puppeteer = addExtra(require('puppeteer'))\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/solve.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/solve.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport test from 'ava'\n\nimport RecaptchaPlugin from './index'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\ntest('will solve reCAPTCHAs', async t => {\n  if (!process.env.TWOCAPTCHA_TOKEN) {\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-recaptcha/src/detection.test.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-recaptcha/src/detection.test.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport test from 'ava'\n\nimport RecaptchaPlugin from './index'\n\nimport { addExtra } from 'puppeteer-extra'\n\nconst PUPPETEER_ARGS = ['--no-sandbox', '--disable-setuid-sandbox']\n\nconst getBrowser = async (url = '', opts = {}) => {\n  const puppeteer = addExtra(require('puppeteer'))\n"},{"type":"text","text":"Repository: 3846masa/upload-gphotos\nPath: src/puppeteer.ts\nURL: https://github.com/3846masa/upload-gphotos/blob/master/src/puppeteer.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport originalPuppeteer from 'puppeteer-core';\nimport { addExtra } from 'puppeteer-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\n\nconst puppeteer = addExtra(originalPuppeteer);\npuppeteer.use(StealthPlugin());\n\n"},{"type":"text","text":"Repository: BetaHuhn/vercel-pdf-converter\nPath: service/convert.js\nURL: https://github.com/BetaHuhn/vercel-pdf-converter/blob/master/service/convert.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport chrome from 'chrome-aws-lambda'\nimport { addExtra } from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\n\n// Workaround, see https://github.com/berstend/puppeteer-extra/issues/93#issuecomment-712364816\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport ChromeAppPlugin from 'puppeteer-extra-plugin-stealth/evasions/chrome.app'\n"},{"type":"text","text":"Repository: whale4113/weread-downloader\nPath: src/index.ts\nURL: https://github.com/whale4113/weread-downloader/blob/main/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport puppeteerVanilla from 'puppeteer'\nimport { addExtra } from 'puppeteer-extra'\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nimport prompts from 'prompts'\nimport { chunk } from 'es-toolkit'\nimport url from 'node:url'\nimport { SECOND } from './utils/datetime'\n"},{"type":"text","text":"Repository: Shelex/free-otp-api\nPath: src/browser/cluster.ts\nURL: https://github.com/Shelex/free-otp-api/blob/master/src/browser/cluster.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { Cluster } from 'puppeteer-cluster';\nimport vanillaPuppeteer, { Page } from 'puppeteer';\nimport { addExtra } from 'puppeteer-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { consola } from 'consola';\nimport { createLock } from './lock.js';\nimport { waitFor } from '../time/utils.js';\n\n"},{"type":"text","text":"Repository: chrisstiles/PublishDateBot\nPath: src/worker.js\nURL: https://github.com/chrisstiles/PublishDateBot/blob/master/src/worker.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 15) ---\nimport { Worker } from 'bullmq';\nimport connection from './redis.js';\nimport throng from 'throng';\nimport basePuppeteer from 'puppeteer';\nimport { Cluster } from 'puppeteer-cluster';\nimport { addExtra } from 'puppeteer-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker';\nimport cache from 'memory-cache';\nimport dotenv from 'dotenv';\n\n"},{"type":"text","text":"Repository: claabs/puppeteer-extra-plugin-portal\nPath: src/index.test.ts\nURL: https://github.com/claabs/puppeteer-extra-plugin-portal/blob/master/src/index.test.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n/* eslint-disable jest/no-disabled-tests */\n/* eslint-disable no-console */\nimport { addExtra } from 'puppeteer-extra';\nimport open from 'open';\nimport express from 'express';\nimport { Page, Target } from 'puppeteer';\nimport WebSocket from 'ws';\nimport PortalPlugin from './index';\n"}],"sourceToolAssistantUUID":"3c85392f-3415-46f1-85cc-30a9b58b802a"}
{"parentUuid":"52dcefd6-a2ca-408c-a262-8358f428313a","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0132gUWBrVVLDhWjMY3FkEdv","type":"tool_result","content":[{"type":"text","text":"Repository: omnivore-app/omnivore\nPath: packages/puppeteer-parse/src/browser.ts\nURL: https://github.com/omnivore-app/omnivore/blob/main/packages/puppeteer-parse/src/browser.ts\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 2) ---\nimport puppeteer from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\n\nif (process.env['USE_FIREFOX'] != 'true') {\n  puppeteer.use(StealthPlugin())\n  puppeteer.use(AdblockerPlugin({ blockTrackers: true }))\n}\n\nlet browserInstance: Browser | null = null\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/google/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/google/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 4) ---\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { CreateNewBrowser } from '../../utils/proxyAgent';\nimport { Browser } from 'puppeteer';\nimport { simplifyPageAll } from '../../utils/puppeteer';\n\npuppeteer.use(StealthPlugin());\n\nexport class Google extends Chat {\n  private browser?: Browser;\n  constructor(options?: ChatOptions) {\n    super(options);\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/bing/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/bing/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 4) ---\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { CreateNewBrowser } from '../../utils/proxyAgent';\nimport { Browser } from 'puppeteer';\nimport { simplifyPageAll } from '../../utils/puppeteer';\n\npuppeteer.use(StealthPlugin());\n\nexport class Bing extends Chat {\n  private browser?: Browser;\n  constructor(options?: ChatOptions) {\n    super(options);\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/www/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/www/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 16) ---\nimport { Config } from '../../utils/config';\nimport fs from 'fs';\nimport pdfParse from 'pdf-parse';\nimport { AwsLambda } from 'elastic-apm-node/types/aws-lambda';\n\npuppeteer.use(StealthPlugin());\n\ninterface WWWChatRequest extends ChatRequest {\n  max_tokens?: number;\n}\n\n"},{"type":"text","text":"Repository: codeSTACKr/minter-dapp\nPath: backend/utils/functions/refreshOpensea.js\nURL: https://github.com/codeSTACKr/minter-dapp/blob/main/backend/utils/functions/refreshOpensea.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst basePath = process.cwd();\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\nlet [START, END] = process.argv.slice(2);\nconst { CONTRACT_ADDRESS, CHAIN } = require(`${basePath}/src/config.js`);\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/ddg/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/ddg/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 19) ---\n} from '../../utils/pool';\nimport { Config } from '../../utils/config';\nimport es from 'event-stream';\nimport { ModelMap } from './define';\n\npuppeteer.use(StealthPlugin());\n\ninterface Account extends ComInfo {}\n\nclass Child extends ComChild<Account> {\n  public page!: Page;\n"},{"type":"text","text":"Repository: codeSTACKr/create-10k-nft-collection\nPath: utils/functions/txnCheck.js\nURL: https://github.com/codeSTACKr/create-10k-nft-collection/blob/main/utils/functions/txnCheck.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\n\nasync function txnCheck(url) {\n  return new Promise(async (resolve, reject) => {\n"},{"type":"text","text":"Repository: astrada/google-drive-ocamlfuse\nPath: login_puppet.js\nURL: https://github.com/astrada/google-drive-ocamlfuse/blob/beta/login_puppet.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst puppeteer = require('puppeteer-extra')\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\npuppeteer.use(StealthPlugin())\n\n/* \n\n  Author: Peter Herz (peter at tachy0n.com)\n  \n"},{"type":"text","text":"Repository: codeSTACKr/create-10k-nft-collection\nPath: utils/functions/refreshOpensea.js\nURL: https://github.com/codeSTACKr/create-10k-nft-collection/blob/main/utils/functions/refreshOpensea.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst basePath = process.cwd();\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\nlet [START, END] = process.argv.slice(2);\nconst { CONTRACT_ADDRESS, CHAIN } = require(`${basePath}/src/config.js`);\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: utils/puppeteer.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/utils/puppeteer.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 22) ---\nimport { GoogleMailAccount } from './config';\n\nconst puppeteer = require('puppeteer-extra');\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth');\n\npuppeteer.use(StealthPlugin());\n\nexport interface PageInfo<T> {\n  id: string;\n  ready: boolean;\n  page?: Page;\n"}]}]},"uuid":"63127165-3991-4ade-9b7f-2a052a8de36a","timestamp":"2026-01-12T23:30:48.724Z","toolUseResult":[{"type":"text","text":"Repository: omnivore-app/omnivore\nPath: packages/puppeteer-parse/src/browser.ts\nURL: https://github.com/omnivore-app/omnivore/blob/main/packages/puppeteer-parse/src/browser.ts\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 2) ---\nimport puppeteer from 'puppeteer-extra'\nimport AdblockerPlugin from 'puppeteer-extra-plugin-adblocker'\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\n\nif (process.env['USE_FIREFOX'] != 'true') {\n  puppeteer.use(StealthPlugin())\n  puppeteer.use(AdblockerPlugin({ blockTrackers: true }))\n}\n\nlet browserInstance: Browser | null = null\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/google/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/google/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 4) ---\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { CreateNewBrowser } from '../../utils/proxyAgent';\nimport { Browser } from 'puppeteer';\nimport { simplifyPageAll } from '../../utils/puppeteer';\n\npuppeteer.use(StealthPlugin());\n\nexport class Google extends Chat {\n  private browser?: Browser;\n  constructor(options?: ChatOptions) {\n    super(options);\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/bing/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/bing/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 4) ---\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\nimport { CreateNewBrowser } from '../../utils/proxyAgent';\nimport { Browser } from 'puppeteer';\nimport { simplifyPageAll } from '../../utils/puppeteer';\n\npuppeteer.use(StealthPlugin());\n\nexport class Bing extends Chat {\n  private browser?: Browser;\n  constructor(options?: ChatOptions) {\n    super(options);\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/www/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/www/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 16) ---\nimport { Config } from '../../utils/config';\nimport fs from 'fs';\nimport pdfParse from 'pdf-parse';\nimport { AwsLambda } from 'elastic-apm-node/types/aws-lambda';\n\npuppeteer.use(StealthPlugin());\n\ninterface WWWChatRequest extends ChatRequest {\n  max_tokens?: number;\n}\n\n"},{"type":"text","text":"Repository: codeSTACKr/minter-dapp\nPath: backend/utils/functions/refreshOpensea.js\nURL: https://github.com/codeSTACKr/minter-dapp/blob/main/backend/utils/functions/refreshOpensea.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst basePath = process.cwd();\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\nlet [START, END] = process.argv.slice(2);\nconst { CONTRACT_ADDRESS, CHAIN } = require(`${basePath}/src/config.js`);\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: model/ddg/index.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/model/ddg/index.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 19) ---\n} from '../../utils/pool';\nimport { Config } from '../../utils/config';\nimport es from 'event-stream';\nimport { ModelMap } from './define';\n\npuppeteer.use(StealthPlugin());\n\ninterface Account extends ComInfo {}\n\nclass Child extends ComChild<Account> {\n  public page!: Page;\n"},{"type":"text","text":"Repository: codeSTACKr/create-10k-nft-collection\nPath: utils/functions/txnCheck.js\nURL: https://github.com/codeSTACKr/create-10k-nft-collection/blob/main/utils/functions/txnCheck.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\n\nasync function txnCheck(url) {\n  return new Promise(async (resolve, reject) => {\n"},{"type":"text","text":"Repository: astrada/google-drive-ocamlfuse\nPath: login_puppet.js\nURL: https://github.com/astrada/google-drive-ocamlfuse/blob/beta/login_puppet.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst puppeteer = require('puppeteer-extra')\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth')\npuppeteer.use(StealthPlugin())\n\n/* \n\n  Author: Peter Herz (peter at tachy0n.com)\n  \n"},{"type":"text","text":"Repository: codeSTACKr/create-10k-nft-collection\nPath: utils/functions/refreshOpensea.js\nURL: https://github.com/codeSTACKr/create-10k-nft-collection/blob/main/utils/functions/refreshOpensea.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nconst basePath = process.cwd();\nconst puppeteer = require(\"puppeteer-extra\");\nconst StealthPlugin = require(\"puppeteer-extra-plugin-stealth\");\npuppeteer.use(StealthPlugin());\nconst AdblockerPlugin = require(\"puppeteer-extra-plugin-adblocker\");\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\nlet [START, END] = process.argv.slice(2);\nconst { CONTRACT_ADDRESS, CHAIN } = require(`${basePath}/src/config.js`);\n\n"},{"type":"text","text":"Repository: xiangsx/gpt4free-ts\nPath: utils/puppeteer.ts\nURL: https://github.com/xiangsx/gpt4free-ts/blob/master/utils/puppeteer.ts\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 22) ---\nimport { GoogleMailAccount } from './config';\n\nconst puppeteer = require('puppeteer-extra');\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth');\n\npuppeteer.use(StealthPlugin());\n\nexport interface PageInfo<T> {\n  id: string;\n  ready: boolean;\n  page?: Page;\n"}],"sourceToolAssistantUUID":"52dcefd6-a2ca-408c-a262-8358f428313a"}
{"parentUuid":"dd98cecc-5ec1-4a14-a6df-3a5ca528f576","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Lxv2tJiNdYQpMh4gtPQPnw","type":"tool_result","content":[{"type":"text","text":"Repository: puppeteer/puppeteer\nPath: test/src/evaluation.spec.ts\nURL: https://github.com/puppeteer/puppeteer/blob/main/test/src/evaluation.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 526) ---\n        b: undefined,\n      });\n    });\n  });\n\n  describe('Page.evaluateOnNewDocument', function () {\n    it('should evaluate before anything else on the page', async () => {\n      const {page, server} = await getTestState();\n\n      await page.evaluateOnNewDocument(function () {\n        (globalThis as any).injected = 123;\n      });\n      await page.goto(server.PREFIX + '/tamperable.html');\n      expect(\n        await page.evaluate(() => {\n\n\n--- Snippet 2 (Line 545) ---\n    it('should work with CSP', async () => {\n      const {page, server} = await getTestState();\n\n      server.setCSP('/empty.html', 'script-src ' + server.PREFIX);\n      await page.evaluateOnNewDocument(function () {\n"},{"type":"text","text":"Repository: NikolaiT/se-scraper\nPath: examples/detection_checker.js\nURL: https://github.com/NikolaiT/se-scraper/blob/master/examples/detection_checker.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 11) ---\n    const userAgent = 'Mozilla/5.0 (X11; Linux x86_64)' +\n        'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n    await page.setUserAgent(userAgent);\n\n    // Pass the Webdriver Test.\n    await page.evaluateOnNewDocument(() => {\n        const newProto = navigator.__proto__;\n        delete newProto.webdriver;\n        navigator.__proto__ = newProto;\n    });\n\n    // Pass the Chrome Test.\n    await page.evaluateOnNewDocument(() => {\n        // We can mock this in as much depth as we need for the test.\n        const mockObj = {\n            app: {\n                isInstalled: false,\n            },\n"},{"type":"text","text":"Repository: AlienwareHe/awesome-reverse\nPath: js/pass-webdriver.js\nURL: https://github.com/AlienwareHe/awesome-reverse/blob/main/js/pass-webdriver.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n    'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n  await page.setUserAgent(userAgent);\n\n  // Pass the Webdriver Test.\n  await page.evaluateOnNewDocument(() => {\n    Object.defineProperty(navigator, 'webdriver', {\n      get: () => false,\n    });\n  });\n\n  // Pass the Chrome Test.\n  await page.evaluateOnNewDocument(() => {\n    // We can mock this in as much depth as we need for the test.\n    window.navigator.chrome = {\n      runtime: {},\n      // etc.\n    };\n  });\n\n  // Pass the Permissions Test.\n  await page.evaluateOnNewDocument(() => {\n"},{"type":"text","text":"Repository: NikolaiT/se-scraper\nPath: src/modules/se_scraper.js\nURL: https://github.com/NikolaiT/se-scraper/blob/master/src/modules/se_scraper.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 419) ---\n\n// This is where we'll put the code to get around the tests.\nasync function evadeChromeHeadlessDetection(page) {\n\n        // Pass the Webdriver Test.\n        await page.evaluateOnNewDocument(() => {\n            const newProto = navigator.__proto__;\n            delete newProto.webdriver;\n            navigator.__proto__ = newProto;\n        });\n\n        // Pass the Chrome Test.\n        await page.evaluateOnNewDocument(() => {\n            // We can mock this in as much depth as we need for the test.\n            const mockObj = {\n                app: {\n                    isInstalled: false,\n                },\n"},{"type":"text","text":"Repository: puppeteer/puppeteer\nPath: test/src/oopif.spec.ts\nURL: https://github.com/puppeteer/puppeteer/blob/main/test/src/oopif.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 457) ---\n  });\n\n  it('should support evaluateOnNewDocument', async () => {\n    const {page, server} = state;\n\n    await page.evaluateOnNewDocument(() => {\n      (window as any).evaluateOnNewDocument = true;\n    });\n    await page.goto(server.PREFIX + '/dynamic-oopif.html');\n    await page.waitForFrame(frame => {\n      return frame.url().endsWith('/oopif.html');\n\n\n--- Snippet 2 (Line 477) ---\n  });\n\n  it('should support removing evaluateOnNewDocument scripts', async () => {\n    const {page, server} = state;\n\n    const {identifier} = await page.evaluateOnNewDocument(() => {\n      (window as any).evaluateOnNewDocument = true;\n    });\n    await page.goto(server.PREFIX + '/dynamic-oopif.html');\n"},{"type":"text","text":"Repository: jina-ai/reader\nPath: src/services/serp/puppeteer.ts\nURL: https://github.com/jina-ai/reader/blob/main/src/services/serp/puppeteer.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 333) ---\n            page.emit(this._REPORT_FUNCTION_NAME, thing);\n        }));\n        preparations.push(page.exposeFunction('setViewport', (viewport: Viewport | null) => {\n            page.setViewport(viewport).catch(() => undefined);\n        }));\n        preparations.push(page.evaluateOnNewDocument(SCRIPT_TO_INJECT_INTO_FRAME));\n\n        await Promise.all(preparations);\n\n        this.snMap.set(page, sn);\n        this.logger.debug(`Page ${sn} created.`);\n\n\n--- Snippet 2 (Line 549) ---\n        await page.setRequestInterception(true);\n\n        const sn = this.snMap.get(page);\n        this.logger.info(`Page ${sn}: Scraping ${url}`, { url });\n\n        await page.evaluateOnNewDocument(`(function () {\nif (window.top !== window.self) {\n    return;\n}\n"},{"type":"text","text":"Repository: GoogleChrome/rendertron\nPath: src/renderer.ts\nURL: https://github.com/GoogleChrome/rendertron/blob/main/src/renderer.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 119) ---\n      }\n    }\n\n    await page.setExtraHTTPHeaders(this.config.reqHeaders);\n\n    page.evaluateOnNewDocument('customElements.forcePolyfill = true');\n    page.evaluateOnNewDocument('ShadyDOM = {force: true}');\n    page.evaluateOnNewDocument('ShadyCSS = {shimcssproperties: true}');\n\n    await page.setRequestInterception(true);\n\n    page.on('request', (interceptedRequest: puppeteer.HTTPRequest) => {\n      if (this.restrictRequest(interceptedRequest.url())) {\n"},{"type":"text","text":"Repository: paulirish/headless-cat-n-mouse\nPath: apply-evasions.js\nURL: https://github.com/paulirish/headless-cat-n-mouse/blob/master/apply-evasions.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n    'Mozilla/5.0 (X11; Linux x86_64)' +\n    'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n  await page.setUserAgent(userAgent);\n\n  // Pass the Webdriver Test.\n  await page.evaluateOnNewDocument(() => {\n    const newProto = navigator.__proto__;\n    delete newProto.webdriver;\n    navigator.__proto__ = newProto;\n  });\n\n  // Pass the Chrome Test.\n  await page.evaluateOnNewDocument(() => {\n    // We can mock this in as much depth as we need for the test.\n    window.chrome = {\n      runtime: {}\n    };\n  });\n\n  // Pass the Permissions Test.\n  await page.evaluateOnNewDocument(() => {\n"},{"type":"text","text":"Repository: macbre/phantomas\nPath: lib/index.js\nURL: https://github.com/macbre/phantomas/blob/devel/lib/index.js\nLicense: BSD-2-Clause\n\nSnippets:\n--- Snippet 1 (Line 87) ---\n        ) /* istanbul ignore next */ {\n          debug('querySelectorAll(\"%s\")', selector);\n          return page.$$(selector);\n        },\n\n        // @see https://pptr.dev/api/puppeteer.page.evaluateonnewdocument\n        // Adds a function which would be invoked in when:\n        //  - the child frame is attached or navigated\n        //  - the page is navigated\n        injectJs: async (script) => {\n          const debug = require(\"debug\")(\"phantomas:injectJs\");\n\n\n--- Snippet 2 (Line 103) ---\n          const preloadFile =\n            prefix +\n            (await require(\"fs/promises\").readFile(script, \"utf8\")) +\n            suffix;\n\n          await page.evaluateOnNewDocument(preloadFile);\n\n          debug(script + \" JavaScript file has been injected into page scope\");\n        },\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/_utils/withUtils.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/_utils/withUtils.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 25) ---\n        _args: args || []\n      }\n    )\n  },\n  /**\n   * Simple `page.evaluateOnNewDocument` replacement to preload utils\n   */\n  evaluateOnNewDocument: async function (mainFunction, ...args) {\n    return page.evaluateOnNewDocument(\n      ({ _utilsFns, _mainFunction, _args }) => {\n        // Add this point we cannot use our utililty functions as they're just strings, we need to materialize them first\n        const utils = Object.fromEntries(\n          Object.entries(_utilsFns).map(([key, value]) => [key, eval(value)]) // eslint-disable-line no-eval\n        )\n"}]}]},"uuid":"2863f870-9291-414a-b65c-ba2f2f71ab6b","timestamp":"2026-01-12T23:30:49.029Z","toolUseResult":[{"type":"text","text":"Repository: puppeteer/puppeteer\nPath: test/src/evaluation.spec.ts\nURL: https://github.com/puppeteer/puppeteer/blob/main/test/src/evaluation.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 526) ---\n        b: undefined,\n      });\n    });\n  });\n\n  describe('Page.evaluateOnNewDocument', function () {\n    it('should evaluate before anything else on the page', async () => {\n      const {page, server} = await getTestState();\n\n      await page.evaluateOnNewDocument(function () {\n        (globalThis as any).injected = 123;\n      });\n      await page.goto(server.PREFIX + '/tamperable.html');\n      expect(\n        await page.evaluate(() => {\n\n\n--- Snippet 2 (Line 545) ---\n    it('should work with CSP', async () => {\n      const {page, server} = await getTestState();\n\n      server.setCSP('/empty.html', 'script-src ' + server.PREFIX);\n      await page.evaluateOnNewDocument(function () {\n"},{"type":"text","text":"Repository: NikolaiT/se-scraper\nPath: examples/detection_checker.js\nURL: https://github.com/NikolaiT/se-scraper/blob/master/examples/detection_checker.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 11) ---\n    const userAgent = 'Mozilla/5.0 (X11; Linux x86_64)' +\n        'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n    await page.setUserAgent(userAgent);\n\n    // Pass the Webdriver Test.\n    await page.evaluateOnNewDocument(() => {\n        const newProto = navigator.__proto__;\n        delete newProto.webdriver;\n        navigator.__proto__ = newProto;\n    });\n\n    // Pass the Chrome Test.\n    await page.evaluateOnNewDocument(() => {\n        // We can mock this in as much depth as we need for the test.\n        const mockObj = {\n            app: {\n                isInstalled: false,\n            },\n"},{"type":"text","text":"Repository: AlienwareHe/awesome-reverse\nPath: js/pass-webdriver.js\nURL: https://github.com/AlienwareHe/awesome-reverse/blob/main/js/pass-webdriver.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n    'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n  await page.setUserAgent(userAgent);\n\n  // Pass the Webdriver Test.\n  await page.evaluateOnNewDocument(() => {\n    Object.defineProperty(navigator, 'webdriver', {\n      get: () => false,\n    });\n  });\n\n  // Pass the Chrome Test.\n  await page.evaluateOnNewDocument(() => {\n    // We can mock this in as much depth as we need for the test.\n    window.navigator.chrome = {\n      runtime: {},\n      // etc.\n    };\n  });\n\n  // Pass the Permissions Test.\n  await page.evaluateOnNewDocument(() => {\n"},{"type":"text","text":"Repository: NikolaiT/se-scraper\nPath: src/modules/se_scraper.js\nURL: https://github.com/NikolaiT/se-scraper/blob/master/src/modules/se_scraper.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 419) ---\n\n// This is where we'll put the code to get around the tests.\nasync function evadeChromeHeadlessDetection(page) {\n\n        // Pass the Webdriver Test.\n        await page.evaluateOnNewDocument(() => {\n            const newProto = navigator.__proto__;\n            delete newProto.webdriver;\n            navigator.__proto__ = newProto;\n        });\n\n        // Pass the Chrome Test.\n        await page.evaluateOnNewDocument(() => {\n            // We can mock this in as much depth as we need for the test.\n            const mockObj = {\n                app: {\n                    isInstalled: false,\n                },\n"},{"type":"text","text":"Repository: puppeteer/puppeteer\nPath: test/src/oopif.spec.ts\nURL: https://github.com/puppeteer/puppeteer/blob/main/test/src/oopif.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 457) ---\n  });\n\n  it('should support evaluateOnNewDocument', async () => {\n    const {page, server} = state;\n\n    await page.evaluateOnNewDocument(() => {\n      (window as any).evaluateOnNewDocument = true;\n    });\n    await page.goto(server.PREFIX + '/dynamic-oopif.html');\n    await page.waitForFrame(frame => {\n      return frame.url().endsWith('/oopif.html');\n\n\n--- Snippet 2 (Line 477) ---\n  });\n\n  it('should support removing evaluateOnNewDocument scripts', async () => {\n    const {page, server} = state;\n\n    const {identifier} = await page.evaluateOnNewDocument(() => {\n      (window as any).evaluateOnNewDocument = true;\n    });\n    await page.goto(server.PREFIX + '/dynamic-oopif.html');\n"},{"type":"text","text":"Repository: jina-ai/reader\nPath: src/services/serp/puppeteer.ts\nURL: https://github.com/jina-ai/reader/blob/main/src/services/serp/puppeteer.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 333) ---\n            page.emit(this._REPORT_FUNCTION_NAME, thing);\n        }));\n        preparations.push(page.exposeFunction('setViewport', (viewport: Viewport | null) => {\n            page.setViewport(viewport).catch(() => undefined);\n        }));\n        preparations.push(page.evaluateOnNewDocument(SCRIPT_TO_INJECT_INTO_FRAME));\n\n        await Promise.all(preparations);\n\n        this.snMap.set(page, sn);\n        this.logger.debug(`Page ${sn} created.`);\n\n\n--- Snippet 2 (Line 549) ---\n        await page.setRequestInterception(true);\n\n        const sn = this.snMap.get(page);\n        this.logger.info(`Page ${sn}: Scraping ${url}`, { url });\n\n        await page.evaluateOnNewDocument(`(function () {\nif (window.top !== window.self) {\n    return;\n}\n"},{"type":"text","text":"Repository: GoogleChrome/rendertron\nPath: src/renderer.ts\nURL: https://github.com/GoogleChrome/rendertron/blob/main/src/renderer.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 119) ---\n      }\n    }\n\n    await page.setExtraHTTPHeaders(this.config.reqHeaders);\n\n    page.evaluateOnNewDocument('customElements.forcePolyfill = true');\n    page.evaluateOnNewDocument('ShadyDOM = {force: true}');\n    page.evaluateOnNewDocument('ShadyCSS = {shimcssproperties: true}');\n\n    await page.setRequestInterception(true);\n\n    page.on('request', (interceptedRequest: puppeteer.HTTPRequest) => {\n      if (this.restrictRequest(interceptedRequest.url())) {\n"},{"type":"text","text":"Repository: paulirish/headless-cat-n-mouse\nPath: apply-evasions.js\nURL: https://github.com/paulirish/headless-cat-n-mouse/blob/master/apply-evasions.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n    'Mozilla/5.0 (X11; Linux x86_64)' +\n    'AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.39 Safari/537.36';\n  await page.setUserAgent(userAgent);\n\n  // Pass the Webdriver Test.\n  await page.evaluateOnNewDocument(() => {\n    const newProto = navigator.__proto__;\n    delete newProto.webdriver;\n    navigator.__proto__ = newProto;\n  });\n\n  // Pass the Chrome Test.\n  await page.evaluateOnNewDocument(() => {\n    // We can mock this in as much depth as we need for the test.\n    window.chrome = {\n      runtime: {}\n    };\n  });\n\n  // Pass the Permissions Test.\n  await page.evaluateOnNewDocument(() => {\n"},{"type":"text","text":"Repository: macbre/phantomas\nPath: lib/index.js\nURL: https://github.com/macbre/phantomas/blob/devel/lib/index.js\nLicense: BSD-2-Clause\n\nSnippets:\n--- Snippet 1 (Line 87) ---\n        ) /* istanbul ignore next */ {\n          debug('querySelectorAll(\"%s\")', selector);\n          return page.$$(selector);\n        },\n\n        // @see https://pptr.dev/api/puppeteer.page.evaluateonnewdocument\n        // Adds a function which would be invoked in when:\n        //  - the child frame is attached or navigated\n        //  - the page is navigated\n        injectJs: async (script) => {\n          const debug = require(\"debug\")(\"phantomas:injectJs\");\n\n\n--- Snippet 2 (Line 103) ---\n          const preloadFile =\n            prefix +\n            (await require(\"fs/promises\").readFile(script, \"utf8\")) +\n            suffix;\n\n          await page.evaluateOnNewDocument(preloadFile);\n\n          debug(script + \" JavaScript file has been injected into page scope\");\n        },\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/_utils/withUtils.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/_utils/withUtils.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 25) ---\n        _args: args || []\n      }\n    )\n  },\n  /**\n   * Simple `page.evaluateOnNewDocument` replacement to preload utils\n   */\n  evaluateOnNewDocument: async function (mainFunction, ...args) {\n    return page.evaluateOnNewDocument(\n      ({ _utilsFns, _mainFunction, _args }) => {\n        // Add this point we cannot use our utililty functions as they're just strings, we need to materialize them first\n        const utils = Object.fromEntries(\n          Object.entries(_utilsFns).map(([key, value]) => [key, eval(value)]) // eslint-disable-line no-eval\n        )\n"}],"sourceToolAssistantUUID":"dd98cecc-5ec1-4a14-a6df-3a5ca528f576"}
{"parentUuid":"2a7e494a-1da4-4ec6-ba8d-a06fc9ac29a4","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01MZpEKiGGQzbvCfWyZYbakQ","type":"tool_result","content":[{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/navigator.webdriver/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/navigator.webdriver/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 2) ---\n\nconst { PuppeteerExtraPlugin } = require('puppeteer-extra-plugin')\n\n/**\n * Pass the Webdriver Test.\n * Will delete `navigator.webdriver` property.\n */\nclass Plugin extends PuppeteerExtraPlugin {\n  constructor(opts = {}) {\n    super(opts)\n  }\n\n  get name() {\n    return 'stealth/evasions/navigator.webdriver'\n  }\n\n  async onPageCreated(page) {\n    await page.evaluateOnNewDocument(() => {\n      if (navigator.webdriver === false) {\n        // Post Chrome 89.0.4339.0 and already good\n      } else if (navigator.webdriver === undefined) {\n"},{"type":"text","text":"Repository: 14790897/auto-read-liunxdo\nPath: pteer.js\nURL: https://github.com/14790897/auto-read-liunxdo/blob/main/pteer.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 110) ---\n      \"accept-language\": \"en-US,en;q=0.9\",\n    });\n\n    // \n    await bypassDetection(page);\n    //  `navigator.webdriver`  undefined\n    const isWebDriverUndefined = await page.evaluate(() => {\n      return `${navigator.webdriver}`;\n    });\n\n    console.log(\"navigator.webdriver is :\", isWebDriverUndefined); //  true\n    page.on(\"pageerror\", (error) => {\n      console.error(`Page error: ${error.message}`);\n    });\n    page.on(\"error\", async (error) => {\n      console.error(`Error: ${error.message}`);\n"},{"type":"text","text":"Repository: cypress-io/cypress\nPath: packages/driver/cypress/e2e/issues/27939.cy.js\nURL: https://github.com/cypress-io/cypress/blob/develop/packages/driver/cypress/e2e/issues/27939.cy.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n// Chrome, Firefox, and Electron all have navigator.webdriver set to true in Cypress tests.\n// TODO: Webkit should have this set, this needs to be fixed https://github.com/cypress-io/cypress/issues/29446\n// https://w3c.github.io/webdriver/#interface\n// https://github.com/cypress-io/cypress/issues/27939\nit('visit', { browser: '!webkit' }, () => {\n  cy.visit('/fixtures/issue-27939.html')\n  cy.get('#content').should('have.text', 'navigator.webdriver is true')\n"},{"type":"text","text":"Repository: microsoft/playwright\nPath: tests/page/page-basic.spec.ts\nURL: https://github.com/microsoft/playwright/blob/main/tests/page/page-basic.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 166) ---\n  const frame = page.frame('inner');\n  await frame.press('textarea', 'a');\n  expect(await frame.evaluate(() => document.querySelector('textarea').value)).toBe('a');\n});\n\nit('has navigator.webdriver set to true', async ({ page }) => {\n  expect(await page.evaluate(() => navigator.webdriver)).toBe(true);\n});\n\nit('should iterate over page properties', async ({ page }) => {\n  const props = [];\n  for (const prop in page) {\n"},{"type":"text","text":"Repository: jashkenas/backbone\nPath: test/debuginfo.js\nURL: https://github.com/jashkenas/backbone/blob/master/test/debuginfo.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 30) ---\n    assert.strictEqual(info.$, $.fn.jquery, 'includes jQuery version');\n    if (typeof navigator !== 'undefined') {\n      assert.ok(typeof info.navigator === 'object');\n      assert.strictEqual(info.navigator.userAgent, navigator.userAgent, 'includes user agent');\n      assert.strictEqual(info.navigator.platform, navigator.platform, 'includes navigator platform');\n      assert.strictEqual(info.navigator.webdriver, navigator.webdriver, 'includes webdriver state');\n    }\n    assert.strictEqual(logs.length, 1, 'prints to console as side effect');\n    var debugArgs = logs[0];\n    var infoString = JSON.stringify(info, null, 4);\n    assert.strictEqual(debugArgs[1], infoString, 'prints payload as second argument');\n"},{"type":"text","text":"Repository: MetaMask/metamask-extension\nPath: app/offscreen/offscreen.ts\nURL: https://github.com/MetaMask/metamask-extension/blob/main/app/offscreen/offscreen.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 73) ---\n  chrome.runtime.sendMessage({\n    target: OffscreenCommunicationTarget.extensionMain,\n    isBooted: true,\n\n    // This message is being sent from the Offscreen Document to the Service Worker.\n    // The Service Worker has no way to query `navigator.webdriver`, so we send it here.\n    webdriverPresent: navigator.webdriver === true,\n  });\n"},{"type":"text","text":"Repository: remix-project-org/remix-project\nPath: apps/remix-ide/src/app/matomo/BotDetector.ts\nURL: https://github.com/remix-project-org/remix-project/blob/master/apps/remix-ide/src/app/matomo/BotDetector.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n * - Headless browsers (Puppeteer, Playwright, Selenium)\n * - AI scrapers (ChatGPT, Claude, etc.)\n *\n * Detection methods:\n * 1. User Agent string analysis\n * 2. Browser automation flags (navigator.webdriver)\n * 3. Headless browser detection\n * 4. Missing browser features\n * 5. Behavioral signals\n * 6. Mouse movement analysis\n */\n\n\n--- Snippet 2 (Line 377) ---\n    // Check 2: Automation flags (very reliable)\n    if (this.checkAutomationFlags()) {\n      isBot = true;\n      botType = botType || 'automation';\n      confidence = 'high';\n      reasons.push('Browser automation detected (navigator.webdriver or similar)');\n    }\n\n    // Check 3: Headless browser detection\n"},{"type":"text","text":"Repository: tutao/tutanota\nPath: libs/botd.mjs\nURL: https://github.com/tutao/tutanota/blob/master/libs/botd.mjs\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 727) ---\nfunction getUserAgent() {\n    return navigator.userAgent;\n}\n\nfunction getWebDriver() {\n    if (navigator.webdriver == undefined) {\n        throw new BotdError(-1 /* State.Undefined */, 'navigator.webdriver is undefined');\n    }\n    return navigator.webdriver;\n}\n\nfunction getWebGL() {\n    var canvasElement = document.createElement('canvas');\n    if (typeof canvasElement.getContext !== 'function') {\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/test/cat-and-mouse.test.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/test/cat-and-mouse.test.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 46) ---\n    return /HeadlessChrome/.test(window.navigator.userAgent)\n  })\n\n  // navigator.webdriver behavior change since release 89.0.4339.0. See also #448\n  if (await compareLooseVersionStrings(navigator.userAgent, '89.0.4339.0') >= 0) {\n    await test('navigator.webdriver is not false', _ => {\n      return navigator.webdriver !== false\n    })\n  } else {\n    // Detects the --enable-automation || --headless flags\n    // Will return true in headful if --enable-automation is provided\n    await test('navigator.webdriver present', _ => {\n      return 'webdriver' in navigator\n    })\n\n    await test('navigator.webdriver not undefined', _ => {\n      return navigator.webdriver !== undefined\n    })\n\n    /* eslint-disable no-proto */\n    await test('navigator.webdriver property overridden', _ => {\n"},{"type":"text","text":"Repository: abrahamjuliot/creepjs\nPath: src/headless/index.ts\nURL: https://github.com/abrahamjuliot/creepjs/blob/master/src/headless/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 94) ---\n\t\t\t\tnoContactsManager: !!headlessEstimate?.noContactsManager,\n\t\t\t\tnoDownlinkMax: !!headlessEstimate?.noDownlinkMax,\n\t\t\t},\n\t\t\theadless: {\n\t\t\t\twebDriverIsOn: (\n\t\t\t\t\t(CSS.supports('border-end-end-radius: initial') && navigator.webdriver === undefined) ||\n\t\t\t\t\t!!navigator.webdriver ||\n\t\t\t\t\t!!lieProps['Navigator.webdriver']\n\t\t\t\t),\n\t\t\t\thasHeadlessUA: (\n\t\t\t\t\t/HeadlessChrome/.test(navigator.userAgent) ||\n\t\t\t\t\t/HeadlessChrome/.test(navigator.appVersion)\n\t\t\t\t),\n"}]}]},"uuid":"428503ea-925d-4886-a9ff-98adae27727d","timestamp":"2026-01-12T23:30:49.270Z","toolUseResult":[{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/evasions/navigator.webdriver/index.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/evasions/navigator.webdriver/index.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 2) ---\n\nconst { PuppeteerExtraPlugin } = require('puppeteer-extra-plugin')\n\n/**\n * Pass the Webdriver Test.\n * Will delete `navigator.webdriver` property.\n */\nclass Plugin extends PuppeteerExtraPlugin {\n  constructor(opts = {}) {\n    super(opts)\n  }\n\n  get name() {\n    return 'stealth/evasions/navigator.webdriver'\n  }\n\n  async onPageCreated(page) {\n    await page.evaluateOnNewDocument(() => {\n      if (navigator.webdriver === false) {\n        // Post Chrome 89.0.4339.0 and already good\n      } else if (navigator.webdriver === undefined) {\n"},{"type":"text","text":"Repository: 14790897/auto-read-liunxdo\nPath: pteer.js\nURL: https://github.com/14790897/auto-read-liunxdo/blob/main/pteer.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 110) ---\n      \"accept-language\": \"en-US,en;q=0.9\",\n    });\n\n    // \n    await bypassDetection(page);\n    //  `navigator.webdriver`  undefined\n    const isWebDriverUndefined = await page.evaluate(() => {\n      return `${navigator.webdriver}`;\n    });\n\n    console.log(\"navigator.webdriver is :\", isWebDriverUndefined); //  true\n    page.on(\"pageerror\", (error) => {\n      console.error(`Page error: ${error.message}`);\n    });\n    page.on(\"error\", async (error) => {\n      console.error(`Error: ${error.message}`);\n"},{"type":"text","text":"Repository: cypress-io/cypress\nPath: packages/driver/cypress/e2e/issues/27939.cy.js\nURL: https://github.com/cypress-io/cypress/blob/develop/packages/driver/cypress/e2e/issues/27939.cy.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n// Chrome, Firefox, and Electron all have navigator.webdriver set to true in Cypress tests.\n// TODO: Webkit should have this set, this needs to be fixed https://github.com/cypress-io/cypress/issues/29446\n// https://w3c.github.io/webdriver/#interface\n// https://github.com/cypress-io/cypress/issues/27939\nit('visit', { browser: '!webkit' }, () => {\n  cy.visit('/fixtures/issue-27939.html')\n  cy.get('#content').should('have.text', 'navigator.webdriver is true')\n"},{"type":"text","text":"Repository: microsoft/playwright\nPath: tests/page/page-basic.spec.ts\nURL: https://github.com/microsoft/playwright/blob/main/tests/page/page-basic.spec.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 166) ---\n  const frame = page.frame('inner');\n  await frame.press('textarea', 'a');\n  expect(await frame.evaluate(() => document.querySelector('textarea').value)).toBe('a');\n});\n\nit('has navigator.webdriver set to true', async ({ page }) => {\n  expect(await page.evaluate(() => navigator.webdriver)).toBe(true);\n});\n\nit('should iterate over page properties', async ({ page }) => {\n  const props = [];\n  for (const prop in page) {\n"},{"type":"text","text":"Repository: jashkenas/backbone\nPath: test/debuginfo.js\nURL: https://github.com/jashkenas/backbone/blob/master/test/debuginfo.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 30) ---\n    assert.strictEqual(info.$, $.fn.jquery, 'includes jQuery version');\n    if (typeof navigator !== 'undefined') {\n      assert.ok(typeof info.navigator === 'object');\n      assert.strictEqual(info.navigator.userAgent, navigator.userAgent, 'includes user agent');\n      assert.strictEqual(info.navigator.platform, navigator.platform, 'includes navigator platform');\n      assert.strictEqual(info.navigator.webdriver, navigator.webdriver, 'includes webdriver state');\n    }\n    assert.strictEqual(logs.length, 1, 'prints to console as side effect');\n    var debugArgs = logs[0];\n    var infoString = JSON.stringify(info, null, 4);\n    assert.strictEqual(debugArgs[1], infoString, 'prints payload as second argument');\n"},{"type":"text","text":"Repository: MetaMask/metamask-extension\nPath: app/offscreen/offscreen.ts\nURL: https://github.com/MetaMask/metamask-extension/blob/main/app/offscreen/offscreen.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 73) ---\n  chrome.runtime.sendMessage({\n    target: OffscreenCommunicationTarget.extensionMain,\n    isBooted: true,\n\n    // This message is being sent from the Offscreen Document to the Service Worker.\n    // The Service Worker has no way to query `navigator.webdriver`, so we send it here.\n    webdriverPresent: navigator.webdriver === true,\n  });\n"},{"type":"text","text":"Repository: remix-project-org/remix-project\nPath: apps/remix-ide/src/app/matomo/BotDetector.ts\nURL: https://github.com/remix-project-org/remix-project/blob/master/apps/remix-ide/src/app/matomo/BotDetector.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 8) ---\n * - Headless browsers (Puppeteer, Playwright, Selenium)\n * - AI scrapers (ChatGPT, Claude, etc.)\n *\n * Detection methods:\n * 1. User Agent string analysis\n * 2. Browser automation flags (navigator.webdriver)\n * 3. Headless browser detection\n * 4. Missing browser features\n * 5. Behavioral signals\n * 6. Mouse movement analysis\n */\n\n\n--- Snippet 2 (Line 377) ---\n    // Check 2: Automation flags (very reliable)\n    if (this.checkAutomationFlags()) {\n      isBot = true;\n      botType = botType || 'automation';\n      confidence = 'high';\n      reasons.push('Browser automation detected (navigator.webdriver or similar)');\n    }\n\n    // Check 3: Headless browser detection\n"},{"type":"text","text":"Repository: tutao/tutanota\nPath: libs/botd.mjs\nURL: https://github.com/tutao/tutanota/blob/master/libs/botd.mjs\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 727) ---\nfunction getUserAgent() {\n    return navigator.userAgent;\n}\n\nfunction getWebDriver() {\n    if (navigator.webdriver == undefined) {\n        throw new BotdError(-1 /* State.Undefined */, 'navigator.webdriver is undefined');\n    }\n    return navigator.webdriver;\n}\n\nfunction getWebGL() {\n    var canvasElement = document.createElement('canvas');\n    if (typeof canvasElement.getContext !== 'function') {\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/puppeteer-extra-plugin-stealth/test/cat-and-mouse.test.js\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/puppeteer-extra-plugin-stealth/test/cat-and-mouse.test.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 46) ---\n    return /HeadlessChrome/.test(window.navigator.userAgent)\n  })\n\n  // navigator.webdriver behavior change since release 89.0.4339.0. See also #448\n  if (await compareLooseVersionStrings(navigator.userAgent, '89.0.4339.0') >= 0) {\n    await test('navigator.webdriver is not false', _ => {\n      return navigator.webdriver !== false\n    })\n  } else {\n    // Detects the --enable-automation || --headless flags\n    // Will return true in headful if --enable-automation is provided\n    await test('navigator.webdriver present', _ => {\n      return 'webdriver' in navigator\n    })\n\n    await test('navigator.webdriver not undefined', _ => {\n      return navigator.webdriver !== undefined\n    })\n\n    /* eslint-disable no-proto */\n    await test('navigator.webdriver property overridden', _ => {\n"},{"type":"text","text":"Repository: abrahamjuliot/creepjs\nPath: src/headless/index.ts\nURL: https://github.com/abrahamjuliot/creepjs/blob/master/src/headless/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 94) ---\n\t\t\t\tnoContactsManager: !!headlessEstimate?.noContactsManager,\n\t\t\t\tnoDownlinkMax: !!headlessEstimate?.noDownlinkMax,\n\t\t\t},\n\t\t\theadless: {\n\t\t\t\twebDriverIsOn: (\n\t\t\t\t\t(CSS.supports('border-end-end-radius: initial') && navigator.webdriver === undefined) ||\n\t\t\t\t\t!!navigator.webdriver ||\n\t\t\t\t\t!!lieProps['Navigator.webdriver']\n\t\t\t\t),\n\t\t\t\thasHeadlessUA: (\n\t\t\t\t\t/HeadlessChrome/.test(navigator.userAgent) ||\n\t\t\t\t\t/HeadlessChrome/.test(navigator.appVersion)\n\t\t\t\t),\n"}],"sourceToolAssistantUUID":"2a7e494a-1da4-4ec6-ba8d-a06fc9ac29a4"}
{"parentUuid":"428503ea-925d-4886-a9ff-98adae27727d","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me search for more specific stealth techniques and bypass methods."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"2a7991f2-61ea-4033-acd7-4b259afeccff","timestamp":"2026-01-12T23:30:52.873Z"}
{"parentUuid":"2a7991f2-61ea-4033-acd7-4b259afeccff","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01FJpiCxsBuTitofd2K9XUrP","name":"mcp__grep__searchGitHub","input":{"query":"chrome.runtime","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"23cacde2-a711-42c7-922b-4a492c2cd686","timestamp":"2026-01-12T23:30:53.647Z"}
{"parentUuid":"23cacde2-a711-42c7-922b-4a492c2cd686","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01HjaZGEcnhyPipXWCoABqy8","name":"mcp__grep__searchGitHub","input":{"query":"window.chrome = {","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"0d9ecee5-fea0-404f-b77f-3de868eb8650","timestamp":"2026-01-12T23:30:54.508Z"}
{"parentUuid":"0d9ecee5-fea0-404f-b77f-3de868eb8650","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01EURKKY3ce7YrQgufvqtoeY","name":"mcp__grep__searchGitHub","input":{"query":"defineProperty(navigator","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"1d96c62c-279c-4b6c-a3af-3cd9b25b182d","timestamp":"2026-01-12T23:30:55.063Z"}
{"parentUuid":"1d96c62c-279c-4b6c-a3af-3cd9b25b182d","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DSns1LFigb7zpKC2r3w9db","name":"mcp__grep__searchGitHub","input":{"query":"playwright-extra","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"b0a41e24-1ce2-4c24-baa2-92a8b0bb0b9b","timestamp":"2026-01-12T23:30:55.653Z"}
{"parentUuid":"b0a41e24-1ce2-4c24-baa2-92a8b0bb0b9b","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_011vLQRRHRtxxnAu4yg2G77C","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01XGetkz6rf1yEptCzRYHdTm","name":"mcp__grep__searchGitHub","input":{"query":"fingerprint evasion","language":["JavaScript","TypeScript"]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":6,"cache_creation_input_tokens":13762,"cache_read_input_tokens":20378,"cache_creation":{"ephemeral_5m_input_tokens":13762,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MY6M2zHZ7fvzT1LqbK","type":"assistant","uuid":"53c4f7d1-a4bb-4b21-9d30-ddd89dad8251","timestamp":"2026-01-12T23:30:56.237Z"}
{"parentUuid":"23cacde2-a711-42c7-922b-4a492c2cd686","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01FJpiCxsBuTitofd2K9XUrP","type":"tool_result","content":[{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/battery-service-demo/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/battery-service-demo/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 48) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function(chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (self.service_ && service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 79) ---\n        // Enable notifications from the characteristic.\n        chrome.bluetoothLowEnergy.startCharacteristicNotifications(\n            chrc.instanceId,\n            function() {\n          if (chrome.runtime.lastError &&\n              chrome.runtime.lastError.message != 'Already notifying') {\n            console.log('Failed to enable Battery Level notifications: ' +\n                        chrome.runtime.lastError.message);\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/heart-rate-sensor/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/heart-rate-sensor/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 54) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function (chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 81) ---\n          // Enable notifications from the characteristic.\n          chrome.bluetoothLowEnergy.startCharacteristicNotifications(\n              chrc.instanceId,\n              function () {\n            if (chrome.runtime.lastError) {\n              console.log(\n                  'Failed to enable Heart Rate Measurement notifications: ' +\n                   chrome.runtime.lastError.message);\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/device-info-demo/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/device-info-demo/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 43) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function (chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (self.service_ && service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 99) ---\n        self.chrcMap_[fieldId] = chrc;\n\n        // Read the value of the characteristic and store it.\n        chrome.bluetoothLowEnergy.readCharacteristicValue(chrc.instanceId,\n                                                          function (readChrc) {\n          if (chrome.runtime.lastError) {\n            console.log(chrome.runtime.lastError.message);\n            return;\n"},{"type":"text","text":"Repository: calcom/cal.com\nPath: companion/utils/storage.ts\nURL: https://github.com/calcom/cal.com/blob/main/companion/utils/storage.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 44) ---\nexport const secureStorage = {\n  get: async (key: string): Promise<string | null> => {\n    if (isChromeStorageAvailable()) {\n      return new Promise((resolve, reject) => {\n        chrome.storage.local.get([key], (result) => {\n          if (chrome.runtime.lastError) {\n            reject(new Error(chrome.runtime.lastError.message));\n          } else {\n            resolve((result[key] as string) ?? null);\n          }\n        });\n      });\n\n\n--- Snippet 2 (Line 62) ---\n\n  set: async (key: string, value: string): Promise<void> => {\n    if (isChromeStorageAvailable()) {\n      return new Promise((resolve, reject) => {\n        chrome.storage.local.set({ [key]: value }, () => {\n          if (chrome.runtime.lastError) {\n            reject(new Error(chrome.runtime.lastError.message));\n          } else {\n"},{"type":"text","text":"Repository: angular/angular\nPath: devtools/projects/shell-browser/src/app/background.ts\nURL: https://github.com/angular/angular/blob/main/devtools/projects/shell-browser/src/app/background.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 22) ---\n    return 'production.html';\n  }\n  return 'supported.html';\n}\n\nif (chrome !== undefined && chrome.runtime !== undefined) {\n  const isManifestV3 = chrome.runtime.getManifest().manifest_version === 3;\n\n  const browserAction = (() => {\n    // Electron does not expose browserAction object,\n    // Use empty calls as fallback if they are not defined.\n    const noopAction = {setIcon: () => {}, setPopup: () => {}};\n\n\n--- Snippet 2 (Line 42) ---\n  // By default use the black and white icon.\n  // Replace it only when we detect an Angular app.\n  browserAction.setIcon(\n    {\n      path: {\n        16: chrome.runtime.getURL(`assets/icon-bw16.png`),\n        48: chrome.runtime.getURL(`assets/icon-bw48.png`),\n        128: chrome.runtime.getURL(`assets/icon-bw128.png`),\n"},{"type":"text","text":"Repository: calcom/cal.com\nPath: companion/extension/entrypoints/content.ts\nURL: https://github.com/calcom/cal.com/blob/main/companion/extension/entrypoints/content.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 172) ---\n    });\n\n    // Handle OAuth requests by forwarding to background script\n    function handleOAuthRequest(authUrl: string, iframeWindow: Window | null) {\n      // Send request to background script\n      chrome.runtime.sendMessage(\n        { action: \"start-extension-oauth\", authUrl: authUrl },\n        (response) => {\n          if (chrome.runtime.lastError) {\n            devLog.error(\n              \"Failed to communicate with background script:\",\n              chrome.runtime.lastError.message\n            );\n            iframeWindow?.postMessage(\n              {\n                type: \"cal-extension-oauth-result\",\n                success: false,\n                error: `Extension communication failed: ${chrome.runtime.lastError.message}`,\n              },\n              \"*\"\n            );\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/background/overlay.background.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/background/overlay.background.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 120) ---\n  let tabsSendMessageSpy: jest.SpyInstance;\n  let tabSendMessageDataSpy: jest.SpyInstance;\n  let getTabFromCurrentWindowIdSpy: jest.SpyInstance;\n  let getTabSpy: jest.SpyInstance;\n  let openUnlockPopoutSpy: jest.SpyInstance;\n  let buttonPortSpy: chrome.runtime.Port;\n  let buttonMessageConnectorSpy: chrome.runtime.Port;\n  let listPortSpy: chrome.runtime.Port;\n  let listMessageConnectorSpy: chrome.runtime.Port;\n\n  let getFrameCounter: number = 2;\n  async function initOverlayElementPorts(options = { initList: true, initButton: true }) {\n    const { initList, initButton } = options;\n    if (initButton) {\n\n\n--- Snippet 2 (Line 251) ---\n    const tabId = 1;\n\n    beforeEach(() => {\n      sendMockExtensionMessage(\n        { command: \"collectPageDetailsResponse\", details: createAutofillPageDetailsMock() },\n        mock<chrome.runtime.MessageSender>({ tab: createChromeTabMock({ id: tabId }), frameId: 0 }),\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/background/overlay.background.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/background/overlay.background.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 115) ---\n  private readonly storeInlineMenuFido2Credentials$ = new ReplaySubject<number>(1);\n  private readonly startInlineMenuDelayedClose$ = new Subject<void>();\n  private readonly cancelInlineMenuDelayedClose$ = new Subject<boolean>();\n  private readonly startInlineMenuFadeIn$ = new Subject<void>();\n  private readonly cancelInlineMenuFadeIn$ = new Subject<boolean>();\n  private readonly startUpdateInlineMenuPosition$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly cancelUpdateInlineMenuPosition$ = new Subject<void>();\n  private readonly repositionInlineMenu$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly rebuildSubFrameOffsets$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly addNewVaultItem$ = new Subject<CurrentAddNewItemData>();\n  private pageDetailsForTab: PageDetailsForTab = {};\n  private subFrameOffsetsForTab: SubFrameOffsetsForTab = {};\n  private portKeyForTab: Record<number, string> = {};\n  private expiredPorts: chrome.runtime.Port[] = [];\n  private inlineMenuButtonPort: chrome.runtime.Port;\n  private inlineMenuButtonMessageConnectorPort: chrome.runtime.Port;\n  private inlineMenuListPort: chrome.runtime.Port;\n  private inlineMenuListMessageConnectorPort: chrome.runtime.Port;\n  private inlineMenuCiphers: Map<string, CipherView> = new Map();\n  private inlineMenuFido2Credentials: Set<string> = new Set();\n  private inlineMenuPageTranslations: Record<string, string>;\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: src/ui/connect/connector.ts\nURL: https://github.com/darkreader/darkreader/blob/main/src/ui/connect/connector.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 16) ---\n        this.changeSubscribers = new Set();\n    }\n\n    private async sendRequest<T>(type: MessageTypeUItoBG, data?: string): Promise<T> {\n        return new Promise<T>((resolve, reject) => {\n            chrome.runtime.sendMessage<MessageUItoBG>({type, data}, ({data, error}: MessageUItoBG) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(data);\n                }\n\n\n--- Snippet 2 (Line 28) ---\n        });\n    }\n\n    private async firefoxSendRequestWithResponse<T>(type: MessageTypeUItoBG, data?: string): Promise<T> {\n        return new Promise<T>((resolve, reject) => {\n            const dataPort = chrome.runtime.connect({name: type});\n            dataPort.onDisconnect.addListener(() => reject());\n            dataPort.onMessage.addListener(({data, error}) => {\n                if (error) {\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/blink1/blink1.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/blink1/blink1.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 6) ---\nBlink1.VENDOR_ID = 0x27B8;\nBlink1.PRODUCT_ID = 0x01ED;\n\nBlink1.prototype.connect = function(cb) {\n  chrome.hid.connect(this.deviceId, function(connectionInfo) {\n    if (chrome.runtime.lastError) {\n      console.warn(\"Unable to connect device: \" +\n                   chrome.runtime.lastError.message);\n      cb(false);\n      return;\n    }\n\n    this.connection = connectionInfo.connectionId;\n\n\n--- Snippet 2 (Line 21) ---\n};\n\nBlink1.prototype.disconnect = function(cb) {\n  chrome.hid.disconnect(this.connection, function() {\n    if (chrome.runtime.lastError) {\n      console.warn(\"Unable to disconnect device: \" +\n                   chrome.runtime.lastError.message);\n"}]}]},"uuid":"d93bc023-d76f-459d-a296-2f8a6b00ce25","timestamp":"2026-01-12T23:30:56.611Z","toolUseResult":[{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/battery-service-demo/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/battery-service-demo/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 48) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function(chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (self.service_ && service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 79) ---\n        // Enable notifications from the characteristic.\n        chrome.bluetoothLowEnergy.startCharacteristicNotifications(\n            chrc.instanceId,\n            function() {\n          if (chrome.runtime.lastError &&\n              chrome.runtime.lastError.message != 'Already notifying') {\n            console.log('Failed to enable Battery Level notifications: ' +\n                        chrome.runtime.lastError.message);\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/heart-rate-sensor/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/heart-rate-sensor/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 54) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function (chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 81) ---\n          // Enable notifications from the characteristic.\n          chrome.bluetoothLowEnergy.startCharacteristicNotifications(\n              chrc.instanceId,\n              function () {\n            if (chrome.runtime.lastError) {\n              console.log(\n                  'Failed to enable Heart Rate Measurement notifications: ' +\n                   chrome.runtime.lastError.message);\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/bluetooth-samples/device-info-demo/main.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/bluetooth-samples/device-info-demo/main.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 43) ---\n\n    // Get the characteristics of the selected service.\n    var self = this;\n    chrome.bluetoothLowEnergy.getCharacteristics(service.instanceId,\n                                                 function (chrcs) {\n      if (chrome.runtime.lastError) {\n        console.log(chrome.runtime.lastError.message);\n        return;\n      }\n\n      // Make sure that the same service is still selected.\n      if (self.service_ && service.instanceId != self.service_.instanceId) {\n\n\n--- Snippet 2 (Line 99) ---\n        self.chrcMap_[fieldId] = chrc;\n\n        // Read the value of the characteristic and store it.\n        chrome.bluetoothLowEnergy.readCharacteristicValue(chrc.instanceId,\n                                                          function (readChrc) {\n          if (chrome.runtime.lastError) {\n            console.log(chrome.runtime.lastError.message);\n            return;\n"},{"type":"text","text":"Repository: calcom/cal.com\nPath: companion/utils/storage.ts\nURL: https://github.com/calcom/cal.com/blob/main/companion/utils/storage.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 44) ---\nexport const secureStorage = {\n  get: async (key: string): Promise<string | null> => {\n    if (isChromeStorageAvailable()) {\n      return new Promise((resolve, reject) => {\n        chrome.storage.local.get([key], (result) => {\n          if (chrome.runtime.lastError) {\n            reject(new Error(chrome.runtime.lastError.message));\n          } else {\n            resolve((result[key] as string) ?? null);\n          }\n        });\n      });\n\n\n--- Snippet 2 (Line 62) ---\n\n  set: async (key: string, value: string): Promise<void> => {\n    if (isChromeStorageAvailable()) {\n      return new Promise((resolve, reject) => {\n        chrome.storage.local.set({ [key]: value }, () => {\n          if (chrome.runtime.lastError) {\n            reject(new Error(chrome.runtime.lastError.message));\n          } else {\n"},{"type":"text","text":"Repository: angular/angular\nPath: devtools/projects/shell-browser/src/app/background.ts\nURL: https://github.com/angular/angular/blob/main/devtools/projects/shell-browser/src/app/background.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 22) ---\n    return 'production.html';\n  }\n  return 'supported.html';\n}\n\nif (chrome !== undefined && chrome.runtime !== undefined) {\n  const isManifestV3 = chrome.runtime.getManifest().manifest_version === 3;\n\n  const browserAction = (() => {\n    // Electron does not expose browserAction object,\n    // Use empty calls as fallback if they are not defined.\n    const noopAction = {setIcon: () => {}, setPopup: () => {}};\n\n\n--- Snippet 2 (Line 42) ---\n  // By default use the black and white icon.\n  // Replace it only when we detect an Angular app.\n  browserAction.setIcon(\n    {\n      path: {\n        16: chrome.runtime.getURL(`assets/icon-bw16.png`),\n        48: chrome.runtime.getURL(`assets/icon-bw48.png`),\n        128: chrome.runtime.getURL(`assets/icon-bw128.png`),\n"},{"type":"text","text":"Repository: calcom/cal.com\nPath: companion/extension/entrypoints/content.ts\nURL: https://github.com/calcom/cal.com/blob/main/companion/extension/entrypoints/content.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 172) ---\n    });\n\n    // Handle OAuth requests by forwarding to background script\n    function handleOAuthRequest(authUrl: string, iframeWindow: Window | null) {\n      // Send request to background script\n      chrome.runtime.sendMessage(\n        { action: \"start-extension-oauth\", authUrl: authUrl },\n        (response) => {\n          if (chrome.runtime.lastError) {\n            devLog.error(\n              \"Failed to communicate with background script:\",\n              chrome.runtime.lastError.message\n            );\n            iframeWindow?.postMessage(\n              {\n                type: \"cal-extension-oauth-result\",\n                success: false,\n                error: `Extension communication failed: ${chrome.runtime.lastError.message}`,\n              },\n              \"*\"\n            );\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/background/overlay.background.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/background/overlay.background.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 120) ---\n  let tabsSendMessageSpy: jest.SpyInstance;\n  let tabSendMessageDataSpy: jest.SpyInstance;\n  let getTabFromCurrentWindowIdSpy: jest.SpyInstance;\n  let getTabSpy: jest.SpyInstance;\n  let openUnlockPopoutSpy: jest.SpyInstance;\n  let buttonPortSpy: chrome.runtime.Port;\n  let buttonMessageConnectorSpy: chrome.runtime.Port;\n  let listPortSpy: chrome.runtime.Port;\n  let listMessageConnectorSpy: chrome.runtime.Port;\n\n  let getFrameCounter: number = 2;\n  async function initOverlayElementPorts(options = { initList: true, initButton: true }) {\n    const { initList, initButton } = options;\n    if (initButton) {\n\n\n--- Snippet 2 (Line 251) ---\n    const tabId = 1;\n\n    beforeEach(() => {\n      sendMockExtensionMessage(\n        { command: \"collectPageDetailsResponse\", details: createAutofillPageDetailsMock() },\n        mock<chrome.runtime.MessageSender>({ tab: createChromeTabMock({ id: tabId }), frameId: 0 }),\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/background/overlay.background.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/background/overlay.background.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 115) ---\n  private readonly storeInlineMenuFido2Credentials$ = new ReplaySubject<number>(1);\n  private readonly startInlineMenuDelayedClose$ = new Subject<void>();\n  private readonly cancelInlineMenuDelayedClose$ = new Subject<boolean>();\n  private readonly startInlineMenuFadeIn$ = new Subject<void>();\n  private readonly cancelInlineMenuFadeIn$ = new Subject<boolean>();\n  private readonly startUpdateInlineMenuPosition$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly cancelUpdateInlineMenuPosition$ = new Subject<void>();\n  private readonly repositionInlineMenu$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly rebuildSubFrameOffsets$ = new Subject<chrome.runtime.MessageSender>();\n  private readonly addNewVaultItem$ = new Subject<CurrentAddNewItemData>();\n  private pageDetailsForTab: PageDetailsForTab = {};\n  private subFrameOffsetsForTab: SubFrameOffsetsForTab = {};\n  private portKeyForTab: Record<number, string> = {};\n  private expiredPorts: chrome.runtime.Port[] = [];\n  private inlineMenuButtonPort: chrome.runtime.Port;\n  private inlineMenuButtonMessageConnectorPort: chrome.runtime.Port;\n  private inlineMenuListPort: chrome.runtime.Port;\n  private inlineMenuListMessageConnectorPort: chrome.runtime.Port;\n  private inlineMenuCiphers: Map<string, CipherView> = new Map();\n  private inlineMenuFido2Credentials: Set<string> = new Set();\n  private inlineMenuPageTranslations: Record<string, string>;\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: src/ui/connect/connector.ts\nURL: https://github.com/darkreader/darkreader/blob/main/src/ui/connect/connector.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 16) ---\n        this.changeSubscribers = new Set();\n    }\n\n    private async sendRequest<T>(type: MessageTypeUItoBG, data?: string): Promise<T> {\n        return new Promise<T>((resolve, reject) => {\n            chrome.runtime.sendMessage<MessageUItoBG>({type, data}, ({data, error}: MessageUItoBG) => {\n                if (error) {\n                    reject(error);\n                } else {\n                    resolve(data);\n                }\n\n\n--- Snippet 2 (Line 28) ---\n        });\n    }\n\n    private async firefoxSendRequestWithResponse<T>(type: MessageTypeUItoBG, data?: string): Promise<T> {\n        return new Promise<T>((resolve, reject) => {\n            const dataPort = chrome.runtime.connect({name: type});\n            dataPort.onDisconnect.addListener(() => reject());\n            dataPort.onMessage.addListener(({data, error}) => {\n                if (error) {\n"},{"type":"text","text":"Repository: GoogleChrome/chrome-extensions-samples\nPath: _archive/apps/samples/blink1/blink1.js\nURL: https://github.com/GoogleChrome/chrome-extensions-samples/blob/main/_archive/apps/samples/blink1/blink1.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 6) ---\nBlink1.VENDOR_ID = 0x27B8;\nBlink1.PRODUCT_ID = 0x01ED;\n\nBlink1.prototype.connect = function(cb) {\n  chrome.hid.connect(this.deviceId, function(connectionInfo) {\n    if (chrome.runtime.lastError) {\n      console.warn(\"Unable to connect device: \" +\n                   chrome.runtime.lastError.message);\n      cb(false);\n      return;\n    }\n\n    this.connection = connectionInfo.connectionId;\n\n\n--- Snippet 2 (Line 21) ---\n};\n\nBlink1.prototype.disconnect = function(cb) {\n  chrome.hid.disconnect(this.connection, function() {\n    if (chrome.runtime.lastError) {\n      console.warn(\"Unable to disconnect device: \" +\n                   chrome.runtime.lastError.message);\n"}],"sourceToolAssistantUUID":"23cacde2-a711-42c7-922b-4a492c2cd686"}
{"parentUuid":"0d9ecee5-fea0-404f-b77f-3de868eb8650","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01HjaZGEcnhyPipXWCoABqy8","type":"tool_result","content":[{"type":"text","text":"Repository: freelawproject/recap-chrome\nPath: spec/ContentDelegateSpec.js\nURL: https://github.com/freelawproject/recap-chrome/blob/main/spec/ContentDelegateSpec.js\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n/*global jasmine, DEBUGLEVEL */\ndescribe('The ContentDelegate class', function () {\n  // 'tabId' values\n  const tabId = 1234;\n  // create initial chrome object\n  window.chrome = {\n    storage: {\n      local: {\n        get: jasmine.createSpy().and.callFake(function (_, cb) {\n          cb({ options: {} });\n        }),\n\n\n--- Snippet 2 (Line 100) ---\n    '04505578701',\n    []\n  );\n  //TODO\n  function setupChromeSpy() {\n    window.chrome = {\n      runtime: {\n        getURL: jasmine.createSpy(),\n        sendMessage: jasmine.createSpy(),\n"},{"type":"text","text":"Repository: angular/angular.js\nPath: test/ng/snifferSpec.js\nURL: https://github.com/angular/angular.js/blob/master/test/ng/snifferSpec.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 80) ---\n          }\n        };\n\n        if (isChrome) {\n          var chromeAppObj = isPackagedApp ? {runtime: {}} : {};\n          mockWindow.chrome = {app: chromeAppObj};\n        }\n\n        return mockWindow;\n      }\n    });\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: tests/inject/support/polyfills.ts\nURL: https://github.com/darkreader/darkreader/blob/main/tests/inject/support/polyfills.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nif (!window.hasOwnProperty('chrome')) {\n    window.chrome = {} as any;\n}\nif (!chrome.hasOwnProperty('runtime')) {\n    chrome.runtime = {} as any;\n}\nif (!chrome.runtime.hasOwnProperty('onMessage')) {\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: src/api/chrome.ts\nURL: https://github.com/darkreader/darkreader/blob/main/src/api/chrome.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 3) ---\nimport {readResponseAsDataURL} from '../utils/network';\n\nimport {callFetchMethod} from './fetch';\n\nif (!window.chrome) {\n    window.chrome = {} as any;\n}\nif (!chrome.runtime) {\n    chrome.runtime = {} as any;\n}\n\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/at-risk-notification/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/at-risk-notification/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 38) ---\n};\nexport const Default: StoryObj<AtRiskNotificationProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/confirmation/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/confirmation/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 47) ---\n\nexport const Default: StoryObj<NotificationConfirmationContainerProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 55) ---\n\nexport const Default: StoryObj<NotificationContainerProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/rows/button-row.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/rows/button-row.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 94) ---\n      default: \"Dark\",\n    },\n  },\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/web/src/app/core/web-platform-utils.service.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/web/src/app/core/web-platform-utils.service.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 162) ---\n      },\n      {\n        userAgent:\n          \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\",\n        expectedDevice: DeviceType.ChromeBrowser,\n        windowProps: { chrome: {} }, // set window.chrome = {} to simulate Chrome\n      },\n      {\n        userAgent:\n          \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0\",\n        expectedDevice: DeviceType.FirefoxBrowser,\n"},{"type":"text","text":"Repository: minbrowser/min\nPath: js/preload/siteUnbreak.js\nURL: https://github.com/minbrowser/min/blob/master/js/preload/siteUnbreak.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 33) ---\n\n     As of 2/7/22, this also breaks drive, so disable it there also\n     */\n\n  scriptsToRun.push(`\n    window.chrome = {\n      runtime: {\n        connect: () => {\n          return {\n            onMessage: {\n              addListener: () => {console.warn('chrome.runtime is not implemented')},\n"}]}]},"uuid":"1b763ab8-f61f-4226-b73c-d7b35e3b20fa","timestamp":"2026-01-12T23:30:56.948Z","toolUseResult":[{"type":"text","text":"Repository: freelawproject/recap-chrome\nPath: spec/ContentDelegateSpec.js\nURL: https://github.com/freelawproject/recap-chrome/blob/main/spec/ContentDelegateSpec.js\nLicense: GPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\n/*global jasmine, DEBUGLEVEL */\ndescribe('The ContentDelegate class', function () {\n  // 'tabId' values\n  const tabId = 1234;\n  // create initial chrome object\n  window.chrome = {\n    storage: {\n      local: {\n        get: jasmine.createSpy().and.callFake(function (_, cb) {\n          cb({ options: {} });\n        }),\n\n\n--- Snippet 2 (Line 100) ---\n    '04505578701',\n    []\n  );\n  //TODO\n  function setupChromeSpy() {\n    window.chrome = {\n      runtime: {\n        getURL: jasmine.createSpy(),\n        sendMessage: jasmine.createSpy(),\n"},{"type":"text","text":"Repository: angular/angular.js\nPath: test/ng/snifferSpec.js\nURL: https://github.com/angular/angular.js/blob/master/test/ng/snifferSpec.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 80) ---\n          }\n        };\n\n        if (isChrome) {\n          var chromeAppObj = isPackagedApp ? {runtime: {}} : {};\n          mockWindow.chrome = {app: chromeAppObj};\n        }\n\n        return mockWindow;\n      }\n    });\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: tests/inject/support/polyfills.ts\nURL: https://github.com/darkreader/darkreader/blob/main/tests/inject/support/polyfills.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nif (!window.hasOwnProperty('chrome')) {\n    window.chrome = {} as any;\n}\nif (!chrome.hasOwnProperty('runtime')) {\n    chrome.runtime = {} as any;\n}\nif (!chrome.runtime.hasOwnProperty('onMessage')) {\n"},{"type":"text","text":"Repository: darkreader/darkreader\nPath: src/api/chrome.ts\nURL: https://github.com/darkreader/darkreader/blob/main/src/api/chrome.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 3) ---\nimport {readResponseAsDataURL} from '../utils/network';\n\nimport {callFetchMethod} from './fetch';\n\nif (!window.chrome) {\n    window.chrome = {} as any;\n}\nif (!chrome.runtime) {\n    chrome.runtime = {} as any;\n}\n\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/at-risk-notification/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/at-risk-notification/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 38) ---\n};\nexport const Default: StoryObj<AtRiskNotificationProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/confirmation/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/confirmation/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 47) ---\n\nexport const Default: StoryObj<NotificationConfirmationContainerProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/notification/container.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/notification/container.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 55) ---\n\nexport const Default: StoryObj<NotificationContainerProps> = {\n  render: Template,\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/autofill/content/components/lit-stories/rows/button-row.lit-stories.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/autofill/content/components/lit-stories/rows/button-row.lit-stories.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 94) ---\n      default: \"Dark\",\n    },\n  },\n};\n\nwindow.chrome = {\n  ...window.chrome,\n  i18n: {\n    getMessage: mockBrowserI18nGetMessage,\n  },\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/web/src/app/core/web-platform-utils.service.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/web/src/app/core/web-platform-utils.service.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 162) ---\n      },\n      {\n        userAgent:\n          \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\",\n        expectedDevice: DeviceType.ChromeBrowser,\n        windowProps: { chrome: {} }, // set window.chrome = {} to simulate Chrome\n      },\n      {\n        userAgent:\n          \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0\",\n        expectedDevice: DeviceType.FirefoxBrowser,\n"},{"type":"text","text":"Repository: minbrowser/min\nPath: js/preload/siteUnbreak.js\nURL: https://github.com/minbrowser/min/blob/master/js/preload/siteUnbreak.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 33) ---\n\n     As of 2/7/22, this also breaks drive, so disable it there also\n     */\n\n  scriptsToRun.push(`\n    window.chrome = {\n      runtime: {\n        connect: () => {\n          return {\n            onMessage: {\n              addListener: () => {console.warn('chrome.runtime is not implemented')},\n"}],"sourceToolAssistantUUID":"0d9ecee5-fea0-404f-b77f-3de868eb8650"}
{"parentUuid":"1d96c62c-279c-4b6c-a3af-3cd9b25b182d","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01EURKKY3ce7YrQgufvqtoeY","type":"tool_result","content":[{"type":"text","text":"Repository: langgenius/dify\nPath: web/utils/clipboard.spec.ts\nURL: https://github.com/langgenius/dify/blob/main/web/utils/clipboard.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 20) ---\n     * Test modern Clipboard API usage\n     * When navigator.clipboard is available, should use the modern API\n     */\n    it('should use navigator.clipboard.writeText when available', async () => {\n      const mockWriteText = vi.fn().mockResolvedValue(undefined)\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: mockWriteText },\n        writable: true,\n        configurable: true,\n      })\n\n\n\n--- Snippet 2 (Line 36) ---\n     * Test fallback to legacy execCommand method\n     * When Clipboard API is unavailable, should use document.execCommand('copy')\n     * This involves creating a temporary textarea element\n     */\n    it('should fallback to execCommand when clipboard API not available', async () => {\n      Object.defineProperty(navigator, 'clipboard', {\n        value: undefined,\n        writable: true,\n        configurable: true,\n"},{"type":"text","text":"Repository: gitlabhq/gitlabhq\nPath: spec/frontend/lib/utils/touch_detection_spec.js\nURL: https://github.com/gitlabhq/gitlabhq/blob/master/spec/frontend/lib/utils/touch_detection_spec.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 22) ---\n    } else {\n      delete window.ontouchstart;\n    }\n\n    if (originalMaxTouchPoints) {\n      Object.defineProperty(navigator, 'maxTouchPoints', originalMaxTouchPoints);\n    } else {\n      delete navigator.maxTouchPoints;\n    }\n\n    if (originalMsMaxTouchPoints) {\n      Object.defineProperty(navigator, 'msMaxTouchPoints', originalMsMaxTouchPoints);\n    } else {\n      delete navigator.msMaxTouchPoints;\n    }\n\n    if (originalDocumentTouch) {\n"},{"type":"text","text":"Repository: prebid/Prebid.js\nPath: test/spec/modules/nexverseBidAdapter_spec.js\nURL: https://github.com/prebid/Prebid.js/blob/master/test/spec/modules/nexverseBidAdapter_spec.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 65) ---\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', configurable: true });\n      expect(getDeviceModel()).to.equal('iPhone');\n    });\n\n    it('should return \"iPad\" for iPad userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (iPad; CPU OS 14_0 like Mac OS X)', configurable: true });\n      expect(getDeviceModel()).to.equal('iPad');\n    });\n\n    it('should return the Android device name for Android userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Linux; Android 10; Pixel 3 Build/QQ2A.200305.003) AppleWebKit/537.36', configurable: true });\n      expect(getDeviceModel()).to.equal('Pixel 3');\n    });\n\n    it('should return \"Unknown Android Device\" if device name is missing in Android userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Linux; Android 10;) AppleWebKit/537.36', configurable: true });\n      expect(getDeviceModel()).to.equal('Unknown Android Device');\n    });\n\n    it('should return \"Mac\" for Mac userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', configurable: true });\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/platform/services/platform-utils/browser-platform-utils.service.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/platform/services/platform-utils/browser-platform-utils.service.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 46) ---\n\n  describe(\"getBrowser\", () => {\n    const originalUserAgent = navigator.userAgent;\n    // Reset the userAgent.\n    afterAll(() => {\n      Object.defineProperty(navigator, \"userAgent\", {\n        value: originalUserAgent,\n      });\n    });\n\n    beforeEach(() => {\n\n\n--- Snippet 2 (Line 61) ---\n      window.matchMedia = undefined;\n      (BrowserPlatformUtilsService as any).deviceCache = null;\n    });\n\n    it(\"should detect chrome\", () => {\n      Object.defineProperty(navigator, \"userAgent\", {\n        configurable: true,\n        value:\n          \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\",\n"},{"type":"text","text":"Repository: TeamWiseFlow/wiseflow\nPath: core/wis/js_snippet/navigator_overrider_enhanced.js\nURL: https://github.com/TeamWiseFlow/wiseflow/blob/master/core/wis/js_snippet/navigator_overrider_enhanced.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 18) ---\n        };\n        return new Proxy(fn, handler);\n    };\n\n    // 1.  webdriver \n    Object.defineProperty(navigator, 'webdriver', {\n        get: likeNative(() => undefined, nativeToStringFunctionString),\n        configurable: true\n    });\n\n    //  webdriver \n\n\n--- Snippet 2 (Line 126) ---\n    ];\n\n    Object.defineProperty(navigator, 'plugins', {\n        get: likeNative(() => mockPlugins, nativeToStringFunctionString),\n        configurable: true\n    });\n\n    // 5. \n    Object.defineProperty(navigator, 'languages', {\n"},{"type":"text","text":"Repository: faisalman/ua-parser-js\nPath: test/e2e/browser.spec.mjs\nURL: https://github.com/faisalman/ua-parser-js/blob/master/test/e2e/browser.spec.mjs\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 11) ---\n\ntest.describe('Custom navigator.userAgent tests', () => {\n\n    test('Undefined navigator.userAgent regarded as an empty user-agent string', async ({ page }) => {\n        await page.addInitScript(() => {\n            Object.defineProperty(navigator, 'userAgent', {\n                value: undefined\n            });\n        });\n        await page.goto(localHtml);\n        // @ts-ignore\n\n\n--- Snippet 2 (Line 48) ---\ntest.describe('withClientHints() tests', () => {\n\n    test('Detect custom Client Hints data', async ({ page, browserName }) => {        \n        await page.addInitScript((browserName) => {\n            if (browserName == 'chromium') {\n                Object.defineProperty(navigator, 'userAgentData', {\n                    value: {\n                        brands: [],\n                        platform: '',\n"},{"type":"text","text":"Repository: johannesjo/super-productivity\nPath: src/app/features/tasks/task-attachment/task-attachment-list/task-attachment-list.component.spec.ts\nURL: https://github.com/johannesjo/super-productivity/blob/master/src/app/features/tasks/task-attachment/task-attachment-list/task-attachment-list.component.spec.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 56) ---\n    });\n\n    afterEach(() => {\n      // Restore original implementations\n      if (originalClipboard) {\n        Object.defineProperty(navigator, 'clipboard', {\n          value: originalClipboard,\n          writable: true,\n        });\n      }\n      document.execCommand = originalExecCommand;\n\n\n--- Snippet 2 (Line 79) ---\n\n    it('should copy using modern clipboard API when available', async () => {\n      const writeTextSpy = jasmine\n        .createSpy('writeText')\n        .and.returnValue(Promise.resolve());\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: writeTextSpy },\n        writable: true,\n      });\n"},{"type":"text","text":"Repository: prebid/Prebid.js\nPath: test/spec/modules/wurflRtdProvider_spec.js\nURL: https://github.com/prebid/Prebid.js/blob/master/test/spec/modules/wurflRtdProvider_spec.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 138) ---\n            { brand: 'Chromium', version: '130.0.6723.58' }\n          ]\n        };\n\n        const getHighEntropyValuesStub = sandbox.stub().resolves(mockClientHints);\n        Object.defineProperty(navigator, 'userAgentData', {\n          value: { getHighEntropyValues: getHighEntropyValuesStub },\n          configurable: true,\n          writable: true\n        });\n\n\n\n--- Snippet 2 (Line 186) ---\n      it('should load WURFL.js without client hints when not available', (done) => {\n        reqBidsConfigObj.ortb2Fragments.global.device = {};\n        reqBidsConfigObj.ortb2Fragments.bidder = {};\n\n        // No client hints available\n        Object.defineProperty(navigator, 'userAgentData', {\n          value: undefined,\n          configurable: true,\n          writable: true\n"},{"type":"text","text":"Repository: saifyxpro/HeadlessX\nPath: src/services/stealth.js\nURL: https://github.com/saifyxpro/HeadlessX/blob/main/src/services/stealth.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 272) ---\n                        delete navigator[prop];\n                        delete document[prop];\n                    } catch (e) {}\n                });\n                \n                Object.defineProperty(navigator, 'webdriver', {\n                    get: () => undefined,  // Must return undefined, not false\n                    configurable: false,\n                    enumerable: false\n                });\n                \n\n\n--- Snippet 2 (Line 450) ---\n                };\n                \n                Object.defineProperty(navigator, 'plugins', { \n                    get: () => plugins,\n                    configurable: false,\n                    enumerable: true\n                });\n                \n                Object.defineProperty(navigator, 'mimeTypes', {\n"},{"type":"text","text":"Repository: labring/FastGPT\nPath: plugins/webcrawler/SPIDER/src/utils/setupPage.ts\nURL: https://github.com/labring/FastGPT/blob/main/plugins/webcrawler/SPIDER/src/utils/setupPage.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 52) ---\n    };\n    (window as any).chrome.csi = function () {};\n    (window as any).chrome.loadTimes = function () {};\n    (window as any).chrome.runtime = function () {};\n    Object.defineProperty(navigator, 'userAgent', {\n      get: () => getRandomUserAgent()\n    });\n    Object.defineProperty(navigator, 'platform', {\n      get: () => getRandomPlatform()\n    });\n    Object.defineProperty(navigator, 'plugins', {\n      get: () => [\n        {\n          description: 'Shockwave Flash',\n          filename: 'pepflashplayer.dll',\n          length: 1,\n          name: 'Shockwave Flash'\n        }\n      ]\n    });\n    Object.defineProperty(navigator, 'languages', {\n"}]}]},"uuid":"30eeccfe-a951-4bd6-b37e-e6f5db07203a","timestamp":"2026-01-12T23:30:57.379Z","toolUseResult":[{"type":"text","text":"Repository: langgenius/dify\nPath: web/utils/clipboard.spec.ts\nURL: https://github.com/langgenius/dify/blob/main/web/utils/clipboard.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 20) ---\n     * Test modern Clipboard API usage\n     * When navigator.clipboard is available, should use the modern API\n     */\n    it('should use navigator.clipboard.writeText when available', async () => {\n      const mockWriteText = vi.fn().mockResolvedValue(undefined)\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: mockWriteText },\n        writable: true,\n        configurable: true,\n      })\n\n\n\n--- Snippet 2 (Line 36) ---\n     * Test fallback to legacy execCommand method\n     * When Clipboard API is unavailable, should use document.execCommand('copy')\n     * This involves creating a temporary textarea element\n     */\n    it('should fallback to execCommand when clipboard API not available', async () => {\n      Object.defineProperty(navigator, 'clipboard', {\n        value: undefined,\n        writable: true,\n        configurable: true,\n"},{"type":"text","text":"Repository: gitlabhq/gitlabhq\nPath: spec/frontend/lib/utils/touch_detection_spec.js\nURL: https://github.com/gitlabhq/gitlabhq/blob/master/spec/frontend/lib/utils/touch_detection_spec.js\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 22) ---\n    } else {\n      delete window.ontouchstart;\n    }\n\n    if (originalMaxTouchPoints) {\n      Object.defineProperty(navigator, 'maxTouchPoints', originalMaxTouchPoints);\n    } else {\n      delete navigator.maxTouchPoints;\n    }\n\n    if (originalMsMaxTouchPoints) {\n      Object.defineProperty(navigator, 'msMaxTouchPoints', originalMsMaxTouchPoints);\n    } else {\n      delete navigator.msMaxTouchPoints;\n    }\n\n    if (originalDocumentTouch) {\n"},{"type":"text","text":"Repository: prebid/Prebid.js\nPath: test/spec/modules/nexverseBidAdapter_spec.js\nURL: https://github.com/prebid/Prebid.js/blob/master/test/spec/modules/nexverseBidAdapter_spec.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 65) ---\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X)', configurable: true });\n      expect(getDeviceModel()).to.equal('iPhone');\n    });\n\n    it('should return \"iPad\" for iPad userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (iPad; CPU OS 14_0 like Mac OS X)', configurable: true });\n      expect(getDeviceModel()).to.equal('iPad');\n    });\n\n    it('should return the Android device name for Android userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Linux; Android 10; Pixel 3 Build/QQ2A.200305.003) AppleWebKit/537.36', configurable: true });\n      expect(getDeviceModel()).to.equal('Pixel 3');\n    });\n\n    it('should return \"Unknown Android Device\" if device name is missing in Android userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Linux; Android 10;) AppleWebKit/537.36', configurable: true });\n      expect(getDeviceModel()).to.equal('Unknown Android Device');\n    });\n\n    it('should return \"Mac\" for Mac userAgent', function () {\n      Object.defineProperty(navigator, 'userAgent', { value: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)', configurable: true });\n"},{"type":"text","text":"Repository: bitwarden/clients\nPath: apps/browser/src/platform/services/platform-utils/browser-platform-utils.service.spec.ts\nURL: https://github.com/bitwarden/clients/blob/main/apps/browser/src/platform/services/platform-utils/browser-platform-utils.service.spec.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 46) ---\n\n  describe(\"getBrowser\", () => {\n    const originalUserAgent = navigator.userAgent;\n    // Reset the userAgent.\n    afterAll(() => {\n      Object.defineProperty(navigator, \"userAgent\", {\n        value: originalUserAgent,\n      });\n    });\n\n    beforeEach(() => {\n\n\n--- Snippet 2 (Line 61) ---\n      window.matchMedia = undefined;\n      (BrowserPlatformUtilsService as any).deviceCache = null;\n    });\n\n    it(\"should detect chrome\", () => {\n      Object.defineProperty(navigator, \"userAgent\", {\n        configurable: true,\n        value:\n          \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36\",\n"},{"type":"text","text":"Repository: TeamWiseFlow/wiseflow\nPath: core/wis/js_snippet/navigator_overrider_enhanced.js\nURL: https://github.com/TeamWiseFlow/wiseflow/blob/master/core/wis/js_snippet/navigator_overrider_enhanced.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 18) ---\n        };\n        return new Proxy(fn, handler);\n    };\n\n    // 1.  webdriver \n    Object.defineProperty(navigator, 'webdriver', {\n        get: likeNative(() => undefined, nativeToStringFunctionString),\n        configurable: true\n    });\n\n    //  webdriver \n\n\n--- Snippet 2 (Line 126) ---\n    ];\n\n    Object.defineProperty(navigator, 'plugins', {\n        get: likeNative(() => mockPlugins, nativeToStringFunctionString),\n        configurable: true\n    });\n\n    // 5. \n    Object.defineProperty(navigator, 'languages', {\n"},{"type":"text","text":"Repository: faisalman/ua-parser-js\nPath: test/e2e/browser.spec.mjs\nURL: https://github.com/faisalman/ua-parser-js/blob/master/test/e2e/browser.spec.mjs\nLicense: AGPL-3.0\n\nSnippets:\n--- Snippet 1 (Line 11) ---\n\ntest.describe('Custom navigator.userAgent tests', () => {\n\n    test('Undefined navigator.userAgent regarded as an empty user-agent string', async ({ page }) => {\n        await page.addInitScript(() => {\n            Object.defineProperty(navigator, 'userAgent', {\n                value: undefined\n            });\n        });\n        await page.goto(localHtml);\n        // @ts-ignore\n\n\n--- Snippet 2 (Line 48) ---\ntest.describe('withClientHints() tests', () => {\n\n    test('Detect custom Client Hints data', async ({ page, browserName }) => {        \n        await page.addInitScript((browserName) => {\n            if (browserName == 'chromium') {\n                Object.defineProperty(navigator, 'userAgentData', {\n                    value: {\n                        brands: [],\n                        platform: '',\n"},{"type":"text","text":"Repository: johannesjo/super-productivity\nPath: src/app/features/tasks/task-attachment/task-attachment-list/task-attachment-list.component.spec.ts\nURL: https://github.com/johannesjo/super-productivity/blob/master/src/app/features/tasks/task-attachment/task-attachment-list/task-attachment-list.component.spec.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 56) ---\n    });\n\n    afterEach(() => {\n      // Restore original implementations\n      if (originalClipboard) {\n        Object.defineProperty(navigator, 'clipboard', {\n          value: originalClipboard,\n          writable: true,\n        });\n      }\n      document.execCommand = originalExecCommand;\n\n\n--- Snippet 2 (Line 79) ---\n\n    it('should copy using modern clipboard API when available', async () => {\n      const writeTextSpy = jasmine\n        .createSpy('writeText')\n        .and.returnValue(Promise.resolve());\n      Object.defineProperty(navigator, 'clipboard', {\n        value: { writeText: writeTextSpy },\n        writable: true,\n      });\n"},{"type":"text","text":"Repository: prebid/Prebid.js\nPath: test/spec/modules/wurflRtdProvider_spec.js\nURL: https://github.com/prebid/Prebid.js/blob/master/test/spec/modules/wurflRtdProvider_spec.js\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 138) ---\n            { brand: 'Chromium', version: '130.0.6723.58' }\n          ]\n        };\n\n        const getHighEntropyValuesStub = sandbox.stub().resolves(mockClientHints);\n        Object.defineProperty(navigator, 'userAgentData', {\n          value: { getHighEntropyValues: getHighEntropyValuesStub },\n          configurable: true,\n          writable: true\n        });\n\n\n\n--- Snippet 2 (Line 186) ---\n      it('should load WURFL.js without client hints when not available', (done) => {\n        reqBidsConfigObj.ortb2Fragments.global.device = {};\n        reqBidsConfigObj.ortb2Fragments.bidder = {};\n\n        // No client hints available\n        Object.defineProperty(navigator, 'userAgentData', {\n          value: undefined,\n          configurable: true,\n          writable: true\n"},{"type":"text","text":"Repository: saifyxpro/HeadlessX\nPath: src/services/stealth.js\nURL: https://github.com/saifyxpro/HeadlessX/blob/main/src/services/stealth.js\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 272) ---\n                        delete navigator[prop];\n                        delete document[prop];\n                    } catch (e) {}\n                });\n                \n                Object.defineProperty(navigator, 'webdriver', {\n                    get: () => undefined,  // Must return undefined, not false\n                    configurable: false,\n                    enumerable: false\n                });\n                \n\n\n--- Snippet 2 (Line 450) ---\n                };\n                \n                Object.defineProperty(navigator, 'plugins', { \n                    get: () => plugins,\n                    configurable: false,\n                    enumerable: true\n                });\n                \n                Object.defineProperty(navigator, 'mimeTypes', {\n"},{"type":"text","text":"Repository: labring/FastGPT\nPath: plugins/webcrawler/SPIDER/src/utils/setupPage.ts\nURL: https://github.com/labring/FastGPT/blob/main/plugins/webcrawler/SPIDER/src/utils/setupPage.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 52) ---\n    };\n    (window as any).chrome.csi = function () {};\n    (window as any).chrome.loadTimes = function () {};\n    (window as any).chrome.runtime = function () {};\n    Object.defineProperty(navigator, 'userAgent', {\n      get: () => getRandomUserAgent()\n    });\n    Object.defineProperty(navigator, 'platform', {\n      get: () => getRandomPlatform()\n    });\n    Object.defineProperty(navigator, 'plugins', {\n      get: () => [\n        {\n          description: 'Shockwave Flash',\n          filename: 'pepflashplayer.dll',\n          length: 1,\n          name: 'Shockwave Flash'\n        }\n      ]\n    });\n    Object.defineProperty(navigator, 'languages', {\n"}],"sourceToolAssistantUUID":"1d96c62c-279c-4b6c-a3af-3cd9b25b182d"}
{"parentUuid":"b0a41e24-1ce2-4c24-baa2-92a8b0bb0b9b","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DSns1LFigb7zpKC2r3w9db","type":"tool_result","content":[{"type":"text","text":"Repository: apify/crawlee\nPath: docs/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/docs/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.15/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.15/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.14/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.14/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.13/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.13/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.10/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.10/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.11/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.11/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.12/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.12/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/playwright-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/playwright-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 41) ---\n *\n * Using `addExtra` will always create a fresh PlaywrightExtra instance.\n *\n * @example\n * import playwright from 'playwright'\n * import { addExtra } from 'playwright-extra'\n *\n * const chromium = addExtra(playwright.chromium)\n * chromium.use(plugin)\n *\n * @param launcher - Playwright (or compatible) browser launcher\n\n\n--- Snippet 2 (Line 68) ---\n * PlaywrightExtra instance, even when used in different files. If you need multiple\n * instances with different plugins please use `addExtra`.\n *\n * @example\n * // javascript import\n * const { chromium } = require('playwright-extra')\n *\n * // typescript/es6 module import\n * import { chromium } from 'playwright-extra'\n"},{"type":"text","text":"Repository: 14790897/auto-read-liunxdo\nPath: bypasscf_playwright.mjs\nURL: https://github.com/14790897/auto-read-liunxdo/blob/main/bypasscf_playwright.mjs\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 9) ---\n  4. Browser   Context  Page \n  5. TelegramExpress \n\n  \n  ----------------\n  npm i playwright-extra playwright-extra-plugin-stealth playwright @playwright/test node-telegram-bot-api dotenv express\n  # \n  npx playwright install chromium\n\n  \n  node auto-read-playwright.mjs\n\n\n--- Snippet 2 (Line 25) ---\nimport dotenv from \"dotenv\";\nimport TelegramBot from \"node-telegram-bot-api\";\nimport express from \"express\";\n\n// --- Playwright & Stealth ----------------------------------------------\nimport { chromium } from \"playwright-extra\";\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nconst stealth = StealthPlugin();\nchromium.use(stealth);\n"},{"type":"text","text":"Repository: promptfoo/promptfoo\nPath: src/providers/browser.ts\nURL: https://github.com/promptfoo/promptfoo/blob/main/src/providers/browser.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 155) ---\n    // Mark that we've made at least one call\n    this.isFirstCall = false;\n\n    let chromium, stealth;\n    try {\n      ({ chromium } = await import('playwright-extra'));\n      ({ default: stealth } = await import('puppeteer-extra-plugin-stealth'));\n    } catch (error) {\n      return {\n        error: `Failed to import required modules. Please ensure the following packages are installed:\\n\\tplaywright @playwright/browser-chromium playwright-extra puppeteer-extra-plugin-stealth\\n\\nError: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      };\n    }\n\n    chromium.use(stealth());\n\n"}]}]},"uuid":"106d65d5-9e15-4549-8693-68d295e64d63","timestamp":"2026-01-12T23:30:57.635Z","toolUseResult":[{"type":"text","text":"Repository: apify/crawlee\nPath: docs/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/docs/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.15/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.15/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.14/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.14/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.13/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.13/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.10/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.10/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.11/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.11/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: apify/crawlee\nPath: website/versioned_docs/version-3.12/examples/crawler-plugins/playwright-extra.ts\nURL: https://github.com/apify/crawlee/blob/master/website/versioned_docs/version-3.12/examples/crawler-plugins/playwright-extra.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 1) ---\nimport { PlaywrightCrawler } from 'crawlee';\n\n// For playwright-extra you will need to import the browser type itself that you want to use!\n// By default, PlaywrightCrawler uses chromium, but you can also use firefox or webkit.\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\n// First, we tell playwright-extra to use the plugin (or plugins) we want.\n// Certain plugins might have options you can pass in - read up on their documentation!\nchromium.use(stealthPlugin());\n\n// Create an instance of the PlaywrightCrawler class - a crawler\n// that automatically loads the URLs in headless Chrome / Playwright.\nconst crawler = new PlaywrightCrawler({\n    launchContext: {\n        // !!! You need to specify this option to tell Crawlee to use playwright-extra as the launcher !!!\n        launcher: chromium,\n        launchOptions: {\n            // Other playwright options work as usual\n            headless: true,\n        },\n"},{"type":"text","text":"Repository: berstend/puppeteer-extra\nPath: packages/playwright-extra/src/index.ts\nURL: https://github.com/berstend/puppeteer-extra/blob/master/packages/playwright-extra/src/index.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 41) ---\n *\n * Using `addExtra` will always create a fresh PlaywrightExtra instance.\n *\n * @example\n * import playwright from 'playwright'\n * import { addExtra } from 'playwright-extra'\n *\n * const chromium = addExtra(playwright.chromium)\n * chromium.use(plugin)\n *\n * @param launcher - Playwright (or compatible) browser launcher\n\n\n--- Snippet 2 (Line 68) ---\n * PlaywrightExtra instance, even when used in different files. If you need multiple\n * instances with different plugins please use `addExtra`.\n *\n * @example\n * // javascript import\n * const { chromium } = require('playwright-extra')\n *\n * // typescript/es6 module import\n * import { chromium } from 'playwright-extra'\n"},{"type":"text","text":"Repository: 14790897/auto-read-liunxdo\nPath: bypasscf_playwright.mjs\nURL: https://github.com/14790897/auto-read-liunxdo/blob/main/bypasscf_playwright.mjs\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 9) ---\n  4. Browser   Context  Page \n  5. TelegramExpress \n\n  \n  ----------------\n  npm i playwright-extra playwright-extra-plugin-stealth playwright @playwright/test node-telegram-bot-api dotenv express\n  # \n  npx playwright install chromium\n\n  \n  node auto-read-playwright.mjs\n\n\n--- Snippet 2 (Line 25) ---\nimport dotenv from \"dotenv\";\nimport TelegramBot from \"node-telegram-bot-api\";\nimport express from \"express\";\n\n// --- Playwright & Stealth ----------------------------------------------\nimport { chromium } from \"playwright-extra\";\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth'\nconst stealth = StealthPlugin();\nchromium.use(stealth);\n"},{"type":"text","text":"Repository: promptfoo/promptfoo\nPath: src/providers/browser.ts\nURL: https://github.com/promptfoo/promptfoo/blob/main/src/providers/browser.ts\nLicense: MIT\n\nSnippets:\n--- Snippet 1 (Line 155) ---\n    // Mark that we've made at least one call\n    this.isFirstCall = false;\n\n    let chromium, stealth;\n    try {\n      ({ chromium } = await import('playwright-extra'));\n      ({ default: stealth } = await import('puppeteer-extra-plugin-stealth'));\n    } catch (error) {\n      return {\n        error: `Failed to import required modules. Please ensure the following packages are installed:\\n\\tplaywright @playwright/browser-chromium playwright-extra puppeteer-extra-plugin-stealth\\n\\nError: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      };\n    }\n\n    chromium.use(stealth());\n\n"}],"sourceToolAssistantUUID":"b0a41e24-1ce2-4c24-baa2-92a8b0bb0b9b"}
{"parentUuid":"53c4f7d1-a4bb-4b21-9d30-ddd89dad8251","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01XGetkz6rf1yEptCzRYHdTm","type":"tool_result","content":[{"type":"text","text":"Repository: open-webui/open-webui\nPath: src/lib/utils/index.ts\nURL: https://github.com/open-webui/open-webui/blob/main/src/lib/utils/index.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 338) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn `${WEBUI_BASE_URL}/user.png`;\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"},{"type":"text","text":"Repository: xxnuo/open-coreui\nPath: frontend/src/lib/utils/index.ts\nURL: https://github.com/xxnuo/open-coreui/blob/main/frontend/src/lib/utils/index.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 347) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn `${WEBUI_BASE_URL}/user.png`;\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"},{"type":"text","text":"Repository: duoyang666/ai_novel\nPath: open-webui/src/lib/utils/index.ts\nURL: https://github.com/duoyang666/ai_novel/blob/main/open-webui/src/lib/utils/index.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 181) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn '/user.png';\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"}]}]},"uuid":"a2fcec33-3fc8-4aa8-818c-940e654d3710","timestamp":"2026-01-12T23:30:57.928Z","toolUseResult":[{"type":"text","text":"Repository: open-webui/open-webui\nPath: src/lib/utils/index.ts\nURL: https://github.com/open-webui/open-webui/blob/main/src/lib/utils/index.ts\nLicense: Unknown\n\nSnippets:\n--- Snippet 1 (Line 338) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn `${WEBUI_BASE_URL}/user.png`;\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"},{"type":"text","text":"Repository: xxnuo/open-coreui\nPath: frontend/src/lib/utils/index.ts\nURL: https://github.com/xxnuo/open-coreui/blob/main/frontend/src/lib/utils/index.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 347) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn `${WEBUI_BASE_URL}/user.png`;\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"},{"type":"text","text":"Repository: duoyang666/ai_novel\nPath: open-webui/src/lib/utils/index.ts\nURL: https://github.com/duoyang666/ai_novel/blob/main/open-webui/src/lib/utils/index.ts\nLicense: Apache-2.0\n\nSnippets:\n--- Snippet 1 (Line 181) ---\n\tcanvas.width = 100;\n\tcanvas.height = 100;\n\n\tif (!canvasPixelTest()) {\n\t\tconsole.log(\n\t\t\t'generateInitialsImage: failed pixel test, fingerprint evasion is likely. Using default image.'\n\t\t);\n\t\treturn '/user.png';\n\t}\n\n\tctx.fillStyle = '#F39C12';\n"}],"sourceToolAssistantUUID":"53c4f7d1-a4bb-4b21-9d30-ddd89dad8251"}
{"parentUuid":"a2fcec33-3fc8-4aa8-818c-940e654d3710","isSidechain":true,"userType":"external","cwd":"/Users/imorgado","sessionId":"065969ce-0ec1-41b0-84bf-754cac4bde05","version":"2.1.5","gitBranch":"","agentId":"a3fa08e","message":{"model":"claude-sonnet-4-5-20250929","id":"msg_01WaTEq7jZ38gukEZxwDhGm2","type":"message","role":"assistant","content":[{"type":"text","text":"Based on my GitHub search, here's a comprehensive summary of the best Puppeteer stealth libraries and implementations:\n\n## 1. **puppeteer-extra-plugin-stealth** (Most Popular Solution)\n\n**Main Repository**: `berstend/puppeteer-extra` (MIT License)\n- 10,000+ stars on GitHub\n- Most actively maintained stealth solution\n- Comprehensive evasion techniques\n\n### Basic Usage Pattern:\n```javascript\nconst puppeteer = require('puppeteer-extra');\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth');\n\npuppeteer.use(StealthPlugin());\n\nconst browser = await puppeteer.launch({\n  headless: true,\n  args: ['--no-sandbox', '--disable-setuid-sandbox']\n});\n```\n\n### Advanced Usage with Individual Evasions:\n```javascript\n// Load all evasion modules individually (useful for bundling)\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.app');\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.csi');\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.loadTimes');\nrequire('puppeteer-extra-plugin-stealth/evasions/chrome.runtime');\nrequire('puppeteer-extra-plugin-stealth/evasions/iframe.contentWindow');\nrequire('puppeteer-extra-plugin-stealth/evasions/media.codecs');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.hardwareConcurrency');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.languages');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.permissions');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.plugins');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.vendor');\nrequire('puppeteer-extra-plugin-stealth/evasions/navigator.webdriver');\nrequire('puppeteer-extra-plugin-stealth/evasions/sourceurl');\nrequire('puppeteer-extra-plugin-stealth/evasions/user-agent-override');\nrequire('puppeteer-extra-plugin-stealth/evasions/webgl.vendor');\nrequire('puppeteer-extra-plugin-stealth/evasions/window.outerdimensions');\n```\n\n### With TypeScript and addExtra:\n```typescript\nimport puppeteerVanilla from 'puppeteer';\nimport { addExtra } from 'puppeteer-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\n\nconst puppeteer = addExtra(puppeteerVanilla);\npuppeteer.use(StealthPlugin());\n```\n\n## 2. **Playwright-Extra** (For Playwright Users)\n\n**Usage Pattern**:\n```typescript\nimport { chromium } from 'playwright-extra';\nimport StealthPlugin from 'puppeteer-extra-plugin-stealth';\n\nchromium.use(StealthPlugin());\n\nconst browser = await chromium.launch({\n  headless: true\n});\n```\n\n## 3. **Manual Stealth Techniques**\n\n### Key Detection Bypasses:\n\n#### A. Navigator.webdriver Removal:\n```javascript\nawait page.evaluateOnNewDocument(() => {\n  // Modern approach (Chrome 89+)\n  if (navigator.webdriver === false) {\n    // Already good\n  } else if (navigator.webdriver === undefined) {\n    // Pre-89 approach\n  } else {\n    delete Object.getPrototypeOf(navigator).webdriver;\n  }\n});\n```\n\n#### B. Chrome Object Mocking:\n```javascript\nawait page.evaluateOnNewDocument(() => {\n  window.chrome = {\n    runtime: {},\n    loadTimes: function() {},\n    csi: function() {},\n    app: {\n      isInstalled: false,\n      InstallState: {\n        DISABLED: 'disabled',\n        INSTALLED: 'installed',\n        NOT_INSTALLED: 'not_installed'\n      },\n      RunningState: {\n        CANNOT_RUN: 'cannot_run',\n        READY_TO_RUN: 'ready_to_run',\n        RUNNING: 'running'\n      }\n    }\n  };\n});\n```\n\n#### C. Plugins and MimeTypes:\n```javascript\nawait page.evaluateOnNewDocument(() => {\n  Object.defineProperty(navigator, 'plugins', {\n    get: () => [\n      {\n        description: 'Portable Document Format',\n        filename: 'internal-pdf-viewer',\n        length: 1,\n        name: 'Chrome PDF Plugin'\n      }\n    ],\n    configurable: true\n  });\n});\n```\n\n#### D. Permissions Override:\n```javascript\nawait page.evaluateOnNewDocument(() => {\n  const originalQuery = window.navigator.permissions.query;\n  window.navigator.permissions.query = (parameters) => (\n    parameters.name === 'notifications' ?\n      Promise.resolve({ state: Notification.permission }) :\n      originalQuery(parameters)\n  );\n});\n```\n\n## 4. **Popular Real-World Implementations**\n\n### High-Star Repositories Using Stealth:\n1. **vogler/free-games-claimer** (AGPL-3.0) - Automated game claiming\n2. **omnivore-app/omnivore** (AGPL-3.0) - Content parsing with stealth\n3. **xiangsx/gpt4free-ts** (GPL-3.0) - Multiple AI service automation\n4. **apify/crawlee** (Apache-2.0) - Web scraping framework\n\n### Production-Ready Pattern from Crawlee:\n```typescript\nimport { PlaywrightCrawler } from 'crawlee';\nimport { chromium } from 'playwright-extra';\nimport stealthPlugin from 'puppeteer-extra-plugin-stealth';\n\nchromium.use(stealthPlugin());\n\nconst crawler = new PlaywrightCrawler({\n  launchContext: {\n    launcher: chromium,\n    launchOptions: {\n      headless: true,\n    },\n  },\n  // ... crawler options\n});\n```\n\n## 5. **Additional Stealth Plugins**\n\n```javascript\nconst puppeteer = require('puppeteer-extra');\nconst StealthPlugin = require('puppeteer-extra-plugin-stealth');\nconst AdblockerPlugin = require('puppeteer-extra-plugin-adblocker');\n\npuppeteer.use(StealthPlugin());\npuppeteer.use(AdblockerPlugin({ blockTrackers: true }));\n```\n\n## Key Recommendations:\n\n1. **Use puppeteer-extra-plugin-stealth** - It's the industry standard with the most comprehensive evasions\n2. **Combine with other plugins** - Add adblocker plugin for more realistic behavior\n3. **For Playwright** - Use playwright-extra with the same stealth plugin\n4. **For bundling/packaging** - Import individual evasion modules explicitly\n5. **Keep updated** - Detection techniques evolve, so keep your dependencies current\n\nThe berstend/puppeteer-extra repository is the gold standard, with MIT license and active maintenance. It handles all major detection vectors including navigator.webdriver, chrome object, plugins, permissions, and WebGL vendor masking."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":2,"cache_creation_input_tokens":12989,"cache_read_input_tokens":34140,"cache_creation":{"ephemeral_5m_input_tokens":12989,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CX4MYjRE69PKtMvqy8epA","type":"assistant","uuid":"2d75546f-d4a6-465d-b3d4-bc45e22f6ab3","timestamp":"2026-01-12T23:31:27.021Z"}
