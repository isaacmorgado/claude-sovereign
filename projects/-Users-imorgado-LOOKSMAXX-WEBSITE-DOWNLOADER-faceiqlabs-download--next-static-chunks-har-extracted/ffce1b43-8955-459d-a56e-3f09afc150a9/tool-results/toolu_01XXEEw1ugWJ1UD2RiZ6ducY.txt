n.onload=()=>t(n.result),n.onerror=r,n.readAsDataURL(e)}),[]),O=(0,r.useCallback)(async(e,t)=>{s({original:null,processed:await _(t||e)})},[_]),j=(0,r.useCallback)(async e=>{l({original:await _(e)})},[_]),E=(0,r.useCallback)(e=>{f(e)},[]),S=(0,r.useCallback)(e=>{p(e)},[]),P=(0,r.useCallback)((e,t,r,n)=>{g({imageDataUrl:e,landmarks:t,width:r,height:n})},[]),k=(0,r.useCallback)(e=>{v(e)},[]),M=(0,r.useCallback)(e=>{m(e)},[]),T=(0,r.useCallback)(e=>{w(Array.isArray(e)?e.join(","):e)},[]),A=(0,r.useCallback)(e=>{a(e)},[]),R=(0,r.useCallback)(()=>o,[o]),C=(0,r.useCallback)(()=>u,[u]),L=(0,r.useCallback)(()=>i,[i]),I=(0,r.useCallback)(()=>c,[c]),N=(0,r.useCallback)(()=>d,[d]),U=(0,r.useCallback)(()=>y,[y]),D=(0,r.useCallback)(()=>h,[h]),G=(0,r.useCallback)(()=>b,[b]),$=(0,r.useCallback)(()=>x,[x]),B=(0,r.useCallback)(()=>({currentStep:o,frontPhoto:u,sidePhoto:i,frontLandmarks:c,sideLandmarks:d,sideStandardized:y,sideDirection:h,gender:b,race:x}),[o,u,i,c,d,y,h,b,x]),F=(0,r.useCallback)(()=>{g(null)},[]),q=(0,r.useCallback)(()=>{a("upload"),s(null),l(null),f(null),p(null),g(null),v(null),m(null),w(null)},[])
return(0,t.jsx)(n.Provider,{value:{currentStep:o,frontPhoto:u,sidePhoto:i,frontLandmarks:c,sideLandmarks:d,sideStandardized:y,sideDirection:h,gender:b,race:x,saveFrontPhoto:O,saveSidePhoto:j,saveFrontLandmarks:E,saveSideLandmarks:S,saveSideStandardized:P,saveSideDirection:k,saveGender:M,saveRace:T,saveCurrentStep:A,getCurrentStep:R,getFrontPhoto:C,getSidePhoto:L,getFrontLandmarks:I,getSideLandmarks:N,getSideStandardized:U,getSideDirection:D,getGender:G,getRace:$,getAllData:B,clearSideStandardized:F,clearAll:q},children:e})}function a(){let e=(0,r.useContext)(n)
return n.setDate(n.getDate()+7),localStorage.setItem(f,JSON.stringify({isGDPR:r,expiry:n.toISOString()})),r}catch(e){return console.error("Failed to detect GDPR country:",e),!0}}function p(){let[e,t]=(0,o.useState)(null),{data:n}=(0,r.useSession)()