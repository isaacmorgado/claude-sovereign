     1→'use client';
     2→
     3→import { useState, useRef, useCallback, useEffect } from 'react';
     4→import Image from 'next/image';
     5→import { motion, AnimatePresence } from 'framer-motion';
     6→import {
     7→  ChevronLeft,
     8→  ChevronRight,
     9→  ChevronUp,
    10→  ChevronDown,
    11→  ZoomIn,
    12→  ZoomOut,
    13→  RotateCcw,
    14→  Check,
    15→  Info,
    16→  Eye,
    17→  EyeOff,
    18→  Keyboard,
    19→  HelpCircle,
    20→} from 'lucide-react';
    21→import {
    22→  LandmarkPoint,
    23→  FRONT_PROFILE_LANDMARKS,
    24→  SIDE_PROFILE_LANDMARKS,
    25→  getLandmarkColor,
    26→  FRONT_LANDMARK_CATEGORIES,
    27→  SIDE_LANDMARK_CATEGORIES,
    28→} from '@/lib/landmarks';
    29→
    30→interface LandmarkAnalysisToolProps {
    31→  imageUrl: string;
    32→  mode: 'front' | 'side';
    33→  initialLandmarks?: LandmarkPoint[];
    34→  onLandmarksChange?: (landmarks: LandmarkPoint[]) => void;
    35→  onComplete?: (landmarks: LandmarkPoint[]) => void;
    36→  onBack?: () => void;
    37→}
    38→
    39→// Get ordered landmarks for guided placement
    40→function getOrderedLandmarks(mode: 'front' | 'side'): string[] {
    41→  const landmarks = mode === 'front' ? FRONT_PROFILE_LANDMARKS : SIDE_PROFILE_LANDMARKS;
    42→  return landmarks.map(lm => lm.id);
    43→}
    44→
    45→// Keyboard key component with 3D effect - Light theme version
    46→function KeyboardKey({ label, isPressed }: { label: string; isPressed: boolean }) {
    47→  return (
    48→    <span
    49→      className={`px-2 py-1 text-xs font-mono rounded border transition-colors duration-75 ${
    50→        isPressed
    51→          ? 'bg-gray-900 border-gray-900 text-white'
    52→          : 'bg-gray-100 border-gray-200 text-gray-700'
    53→      }`}
    54→      style={{ transform: isPressed ? 'translateY(1px)' : 'none' }}
    55→    >
    56→      {label}
    57→    </span>
    58→  );
    59→}
    60→
    61→export function LandmarkAnalysisTool({
    62→  imageUrl,
    63→  mode,
    64→  initialLandmarks,
    65→  onLandmarksChange,
    66→  onComplete,
    67→  onBack,
    68→}: LandmarkAnalysisToolProps) {
    69→  const containerRef = useRef<HTMLDivElement>(null);
    70→  const defaultLandmarks = mode === 'front' ? FRONT_PROFILE_LANDMARKS : SIDE_PROFILE_LANDMARKS;
    71→  const categories = mode === 'front' ? FRONT_LANDMARK_CATEGORIES : SIDE_LANDMARK_CATEGORIES;
    72→  const orderedIds = getOrderedLandmarks(mode);
    73→
    74→  const [landmarks, setLandmarks] = useState<LandmarkPoint[]>(
    75→    initialLandmarks || defaultLandmarks
    76→  );
    77→  const [currentStepIndex, setCurrentStepIndex] = useState(0);
    78→  const [zoomLevel, setZoomLevel] = useState(1);
    79→  const [pan, setPan] = useState({ x: 0, y: 0 });
    80→  const [isDragging, setIsDragging] = useState(false);
    81→  const [showAllPoints, setShowAllPoints] = useState(true);
    82→  const [pressedKey, setPressedKey] = useState<string | null>(null);
    83→  const [activeTab, setActiveTab] = useState<'photo' | 'reference'>('photo');
    84→
    85→  const currentLandmarkId = orderedIds[currentStepIndex];
    86→  const currentLandmark = landmarks.find((lm) => lm.id === currentLandmarkId);
    87→  const totalSteps = orderedIds.length;
    88→  const progress = ((currentStepIndex + 1) / totalSteps) * 100;
    89→
    90→  const color = currentLandmark
    91→    ? getLandmarkColor(currentLandmark.id, categories)
    92→    : '#10b981';
    93→
    94→  useEffect(() => {
    95→    onLandmarksChange?.(landmarks);
    96→  }, [landmarks, onLandmarksChange]);
    97→
    98→  const updateLandmarkPosition = useCallback(
    99→    (x: number, y: number) => {
   100→      setLandmarks((prev) =>
   101→        prev.map((lm) =>
   102→          lm.id === currentLandmarkId ? { ...lm, x, y } : lm
   103→        )
   104→      );
   105→    },
   106→    [currentLandmarkId]
   107→  );
   108→
   109→  const handleContainerClick = useCallback(
   110→    (e: React.MouseEvent<HTMLDivElement>) => {
   111→      if (!containerRef.current || isDragging) return;
   112→
   113→      const rect = containerRef.current.getBoundingClientRect();
   114→      const rawX = (e.clientX - rect.left - rect.width / 2 - pan.x) / zoomLevel + rect.width / 2;
   115→      const rawY = (e.clientY - rect.top - rect.height / 2 - pan.y) / zoomLevel + rect.height / 2;
   116→
   117→      const x = Math.max(0, Math.min(1, rawX / rect.width));
   118→      const y = Math.max(0, Math.min(1, rawY / rect.height));
   119→
   120→      updateLandmarkPosition(x, y);
   121→    },
   122→    [isDragging, pan, zoomLevel, updateLandmarkPosition]
   123→  );
   124→
   125→  const handleMouseDown = useCallback(
   126→    (e: React.MouseEvent) => {
   127→      if (e.button === 0 && zoomLevel > 1) {
   128→        setIsDragging(true);
   129→      }
   130→    },
   131→    [zoomLevel]
   132→  );
   133→
   134→  const handleMouseMove = useCallback(
   135→    (e: React.MouseEvent) => {
   136→      if (isDragging && zoomLevel > 1) {
   137→        setPan((prev) => ({
   138→          x: prev.x + e.movementX,
   139→          y: prev.y + e.movementY,
   140→        }));
   141→      }
   142→    },
   143→    [isDragging, zoomLevel]
   144→  );
   145→
   146→  const handleMouseUp = useCallback(() => {
   147→    setIsDragging(false);
   148→  }, []);
   149→
   150→  const handleResetZoom = useCallback(() => {
   151→    setZoomLevel(1);
   152→    setPan({ x: 0, y: 0 });
   153→  }, []);
   154→
   155→  const moveLandmark = useCallback((direction: 'up' | 'down' | 'left' | 'right') => {
   156→    const step = 0.002;
   157→    setLandmarks((prev) =>
   158→      prev.map((lm) => {
   159→        if (lm.id !== currentLandmarkId) return lm;
   160→        let newX = lm.x;
   161→        let newY = lm.y;
   162→        switch (direction) {
   163→          case 'up': newY = Math.max(0, lm.y - step); break;
   164→          case 'down': newY = Math.min(1, lm.y + step); break;
   165→          case 'left': newX = Math.max(0, lm.x - step); break;
   166→          case 'right': newX = Math.min(1, lm.x + step); break;
   167→        }
   168→        return { ...lm, x: newX, y: newY };
   169→      })
   170→    );
   171→  }, [currentLandmarkId]);
   172→
   173→  const handleNext = useCallback(() => {
   174→    if (currentStepIndex < totalSteps - 1) {
   175→      setCurrentStepIndex((prev) => prev + 1);
   176→      handleResetZoom();
   177→    } else {
   178→      onComplete?.(landmarks);
   179→    }
   180→  }, [currentStepIndex, totalSteps, landmarks, onComplete, handleResetZoom]);
   181→
   182→  const handlePrevious = useCallback(() => {
   183→    if (currentStepIndex > 0) {
   184→      setCurrentStepIndex((prev) => prev - 1);
   185→      handleResetZoom();
   186→    } else {
   187→      onBack?.();
   188→    }
   189→  }, [currentStepIndex, handleResetZoom, onBack]);
   190→
   191→  // Keyboard handlers
   192→  useEffect(() => {
   193→    const handleKeyDown = (e: KeyboardEvent) => {
   194→      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter', 'Backspace', 'r', 'R'].includes(e.key)) {
   195→        e.preventDefault();
   196→      }
   197→      setPressedKey(e.key);
   198→
   199→      switch (e.key) {
   200→        case 'ArrowUp': moveLandmark('up'); break;
   201→        case 'ArrowDown': moveLandmark('down'); break;
   202→        case 'ArrowLeft': moveLandmark('left'); break;
   203→        case 'ArrowRight': moveLandmark('right'); break;
   204→        case 'Enter': handleNext(); break;
   205→        case 'Backspace': handlePrevious(); break;
   206→        case 'r':
   207→        case 'R': handleResetZoom(); break;
   208→      }
   209→    };
   210→
   211→    const handleKeyUp = () => setPressedKey(null);
   212→
   213→    window.addEventListener('keydown', handleKeyDown);
   214→    window.addEventListener('keyup', handleKeyUp);
   215→    return () => {
   216→      window.removeEventListener('keydown', handleKeyDown);
   217→      window.removeEventListener('keyup', handleKeyUp);
   218→    };
   219→  }, [moveLandmark, handleNext, handlePrevious, handleResetZoom]);
   220→
   221→  return (
   222→    <div className="fixed inset-0 bg-white">
   223→      <div className="flex flex-col md:flex-row h-[100dvh] md:h-full gap-2 md:gap-4 p-2 md:p-4 overflow-hidden">
   224→        {/* Sidebar - Right on desktop, top on mobile */}
   225→        <div className="w-full md:w-80 flex-shrink-0 flex flex-col gap-2 md:gap-4 md:order-2 md:overflow-y-auto md:max-h-full">
   226→          {/* Progress Card */}
   227→          <div className="bg-white rounded-xl border border-gray-200 overflow-hidden flex-shrink-0">
   228→            <div className="p-4 border-b border-gray-100">
   229→              <div className="flex items-center justify-between text-xs text-gray-600 mb-2">
   230→                <span>Step {currentStepIndex + 1} of {totalSteps}</span>
   231→                <span>{Math.round(progress)}%</span>
   232→              </div>
   233→              <div className="h-1.5 bg-gray-200 rounded-full overflow-hidden mb-3">
   234→                <motion.div
   235→                  className="h-full bg-gray-900 transition-all duration-300"
   236→                  style={{ width: `${progress}%` }}
   237→                />
   238→              </div>
   239→              <div className="flex items-center justify-between">
   240→                <div className="flex items-center gap-2">
   241→                  <div className="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
   242→                    <Check className="w-3.5 h-3.5 text-white" />
   243→                  </div>
   244→                  <span className="text-sm font-medium text-gray-900">
   245→                    {currentStepIndex} placed
   246→                  </span>
   247→                </div>
   248→              </div>
   249→            </div>
   250→
   251→            {/* View Tabs */}
   252→            <div className="flex border-b border-gray-200">
   253→              <button
   254→                onClick={() => setActiveTab('photo')}
   255→                className={`flex-1 py-2.5 text-xs font-medium transition-colors ${
   256→                  activeTab === 'photo'
   257→                    ? 'text-gray-900 border-b-2 border-gray-900'
   258→                    : 'text-gray-500 hover:text-gray-700'
   259→                }`}
   260→              >
   261→                {mode === 'front' ? 'Front View' : 'Side View'}
   262→              </button>
   263→              <button
   264→                onClick={() => setActiveTab('reference')}
   265→                className={`flex-1 py-2.5 text-xs font-medium transition-colors ${
   266→                  activeTab === 'reference'
   267→                    ? 'text-gray-900 border-b-2 border-gray-900'
   268→                    : 'text-gray-500 hover:text-gray-700'
   269→                }`}
   270→              >
   271→                Reference
   272→              </button>
   273→            </div>
   274→
   275→            {/* Reference Image */}
   276→            <div className="relative w-full h-48 overflow-hidden bg-gray-50 flex items-center justify-center">
   277→              {activeTab === 'photo' ? (
   278→                <div className="text-center p-4">
   279→                  <div
   280→                    className="w-12 h-12 rounded-full mx-auto mb-2 flex items-center justify-center"
   281→                    style={{ backgroundColor: `${color}20`, border: `2px solid ${color}` }}
   282→                  >
   283→                    <div className="w-3 h-3 rounded-full" style={{ backgroundColor: color }} />
   284→                  </div>
   285→                  <p className="text-sm font-medium text-gray-900">{currentLandmark?.label}</p>
   286→                  <p className="text-xs text-gray-500 mt-1">{currentLandmark?.medicalTerm}</p>
   287→                </div>
   288→              ) : (
   289→                <div className="text-center p-4">
   290→                  <Info className="w-8 h-8 mx-auto mb-2 text-gray-400" />
   291→                  <p className="text-sm text-gray-600">{currentLandmark?.description}</p>
   292→                </div>
   293→              )}
   294→            </div>
   295→          </div>
   296→
   297→          {/* Keyboard Shortcuts - Desktop only */}
   298→          <div className="hidden md:flex flex-col gap-4">
   299→            <div className="bg-white rounded-xl border border-gray-200 p-4">
   300→              <div className="flex justify-center mb-4">
   301→                <div className="flex flex-col gap-1 items-center">
   302→                  <div className="relative w-9 h-9">
   303→                    <div
   304→                      className={`absolute inset-0 rounded-md transition-colors duration-75 ${
   305→                        pressedKey === 'ArrowUp' ? 'bg-emerald-200' : 'bg-gray-300'
   306→                      }`}
   307→                      style={{ transform: 'translateY(3px)' }}
   308→                    />
   309→                    <div
   310→                      className={`relative w-full h-full rounded-md border flex items-center justify-center transition-colors duration-75 ${
   311→                        pressedKey === 'ArrowUp'
   312→                          ? 'bg-emerald-500 border-emerald-500 text-white'
   313→                          : 'bg-gray-100 border-gray-200 text-gray-600'
   314→                      }`}
   315→                    >
   316→                      <ChevronUp className="w-4 h-4" />
   317→                    </div>
   318→                  </div>
   319→                  <div className="flex gap-1">
   320→                    {['ArrowLeft', 'ArrowDown', 'ArrowRight'].map((key) => (
   321→                      <div key={key} className="relative w-9 h-9">
   322→                        <div
   323→                          className={`absolute inset-0 rounded-md transition-colors duration-75 ${
   324→                            pressedKey === key ? 'bg-emerald-200' : 'bg-gray-300'
   325→                          }`}
   326→                          style={{ transform: 'translateY(3px)' }}
   327→                        />
   328→                        <div
   329→                          className={`relative w-full h-full rounded-md border flex items-center justify-center transition-colors duration-75 ${
   330→                            pressedKey === key
   331→                              ? 'bg-emerald-500 border-emerald-500 text-white'
   332→                              : 'bg-gray-100 border-gray-200 text-gray-600'
   333→                          }`}
   334→                        >
   335→                          {key === 'ArrowLeft' && <ChevronLeft className="w-4 h-4" />}
   336→                          {key === 'ArrowDown' && <ChevronDown className="w-4 h-4" />}
   337→                          {key === 'ArrowRight' && <ChevronRight className="w-4 h-4" />}
   338→                        </div>
   339→                      </div>
   340→                    ))}
   341→                  </div>
   342→                </div>
   343→              </div>
   344→
   345→              <div className="flex items-center gap-3 mb-2">
   346→                <KeyboardKey label="Enter" isPressed={pressedKey === 'Enter'} />
   347→                <span className="text-xs text-gray-500">Next</span>
   348→              </div>
   349→              <div className="flex items-center gap-3 mb-2">
   350→                <KeyboardKey label="Backspace" isPressed={pressedKey === 'Backspace'} />
   351→                <span className="text-xs text-gray-500">Previous</span>
   352→              </div>
   353→              <div className="flex items-center gap-3">
   354→                <KeyboardKey label="R" isPressed={pressedKey === 'r' || pressedKey === 'R'} />
   355→                <span className="text-xs text-gray-500">Reset</span>
   356→              </div>
   357→            </div>
   358→
   359→            {/* Zoom Controls */}
   360→            <div className="bg-white rounded-xl border border-gray-200 p-4">
   361→              <p className="text-xs text-gray-500 font-medium uppercase tracking-wide mb-3">
   362→                Zoom Level
   363→              </p>
   364→              <div className="flex gap-2">
   365→                {[1, 2, 4].map((level) => (
   366→                  <button
   367→                    key={level}
   368→                    onClick={() => {
   369→                      setZoomLevel(level);
   370→                      if (level === 1) setPan({ x: 0, y: 0 });
   371→                    }}
   372→                    className={`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${
   373→                      zoomLevel === level
   374→                        ? 'bg-gray-900 text-white'
   375→                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
   376→                    }`}
   377→                  >
   378→                    {level}x
   379→                  </button>
   380→                ))}
   381→              </div>
   382→            </div>
   383→
   384→            {/* Toggle All Points */}
   385→            <div className="sticky bottom-0 bg-white pt-2 flex flex-col gap-4">
   386→              <div className="flex gap-2">
   387→                <button
   388→                  onClick={() => setShowAllPoints(!showAllPoints)}
   389→                  className={`flex-1 py-2.5 rounded-lg text-xs font-medium transition-colors flex items-center justify-center gap-2 ${
   390→                    showAllPoints
   391→                      ? 'bg-gray-900 text-white'
   392→                      : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
   393→                  }`}
   394→                >
   395→                  {showAllPoints ? <Eye className="w-4 h-4" /> : <EyeOff className="w-4 h-4" />}
   396→                  {showAllPoints ? 'Showing All' : 'Current Only'}
   397→                </button>
   398→                <button
   399→                  onClick={() => onComplete?.(landmarks)}
   400→                  className="py-2.5 px-4 rounded-lg text-xs font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors"
   401→                >
   402→                  Skip
   403→                </button>
   404→              </div>
   405→            </div>
   406→          </div>
   407→        </div>
   408→
   409→        {/* Main Image Area */}
   410→        <div className="flex-1 min-h-0 relative md:order-1">
   411→          <div
   412→            ref={containerRef}
   413→            className="relative w-full h-full bg-gray-100 overflow-hidden rounded-lg flex items-center justify-center select-none"
   414→            onClick={handleContainerClick}
   415→            onMouseDown={handleMouseDown}
   416→            onMouseMove={handleMouseMove}
   417→            onMouseUp={handleMouseUp}
   418→            onMouseLeave={handleMouseUp}
   419→            style={{
   420→              cursor: zoomLevel > 1 && isDragging ? 'grabbing' : zoomLevel > 1 ? 'grab' : 'crosshair',
   421→            }}
   422→          >
   423→            {/* Transformed Content */}
   424→            <div
   425→              className="relative w-full h-full transition-transform duration-100"
   426→              style={{
   427→                transform: `scale(${zoomLevel}) translate(${pan.x / zoomLevel}px, ${pan.y / zoomLevel}px)`,
   428→                transformOrigin: 'center center',
   429→              }}
   430→            >
   431→              {/* User's Image */}
   432→              <Image
   433→                src={imageUrl}
   434→                alt="Your photo"
   435→                fill
   436→                className="object-contain pointer-events-none select-none"
   437→                unoptimized
   438→                draggable={false}
   439→              />
   440→
   441→              {/* All Landmarks (dimmed) */}
   442→              {showAllPoints &&
   443→                landmarks.map((landmark) => {
   444→                  if (landmark.id === currentLandmarkId) return null;
   445→                  const lmColor = getLandmarkColor(landmark.id, categories);
   446→                  return (
   447→                    <div
   448→                      key={landmark.id}
   449→                      className="absolute w-2.5 h-2.5 -translate-x-1/2 -translate-y-1/2 pointer-events-none"
   450→                      style={{
   451→                        left: `${landmark.x * 100}%`,
   452→                        top: `${landmark.y * 100}%`,
   453→                        opacity: 0.4,
   454→                      }}
   455→                    >
   456→                      <div
   457→                        className="w-full h-full rounded-full border border-white/80"
   458→                        style={{ backgroundColor: lmColor }}
   459→                      />
   460→                    </div>
   461→                  );
   462→                })}
   463→
   464→              {/* Current Landmark (highlighted) */}
   465→              {currentLandmark && (
   466→                <motion.div
   467→                  key={currentLandmarkId}
   468→                  initial={{ scale: 0 }}
   469→                  animate={{ scale: 1 }}
   470→                  className="absolute pointer-events-none"
   471→                  style={{
   472→                    left: `${currentLandmark.x * 100}%`,
   473→                    top: `${currentLandmark.y * 100}%`,
   474→                  }}
   475→                >
   476→                  {/* Pulsing glow */}
   477→                  <motion.div
   478→                    className="absolute -translate-x-1/2 -translate-y-1/2 rounded-full"
   479→                    style={{
   480→                      width: 32,
   481→                      height: 32,
   482→                      boxShadow: `0 0 20px 8px ${color}40`,
   483→                    }}
   484→                    animate={{
   485→                      scale: [1, 1.3, 1],
   486→                      opacity: [0.6, 0.2, 0.6],
   487→                    }}
   488→                    transition={{
   489→                      duration: 1.5,
   490→                      repeat: Infinity,
   491→                      ease: 'easeInOut',
   492→                    }}
   493→                  />
   494→
   495→                  {/* Main dot */}
   496→                  <div
   497→                    className="absolute -translate-x-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 border-white shadow-lg"
   498→                    style={{
   499→                      backgroundColor: color,
   500→                      boxShadow: `0 2px 8px ${color}80`,
   501→                    }}
   502→                  />
   503→                </motion.div>
   504→              )}
   505→            </div>
   506→
   507→            {/* Zoom indicator */}
   508→            {zoomLevel > 1 && (
   509→              <div className="absolute top-3 left-3 px-2 py-1 rounded bg-black/60 text-white text-xs">
   510→                {zoomLevel}x - Drag to pan
   511→              </div>
   512→            )}
   513→
   514→            {/* Current landmark label overlay */}
   515→            <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4 pointer-events-none">
   516→              <p className="text-center text-white text-sm font-medium">
   517→                Click to place:{' '}
   518→                <span style={{ color }}>{currentLandmark?.label}</span>
   519→              </p>
   520→            </div>
   521→          </div>
   522→
   523→          {/* Navigation Bar */}
   524→          <div className="absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-3 bg-white/95 backdrop-blur-sm rounded-full shadow-lg border border-gray-200 px-2 py-1.5">
   525→            <button
   526→              onClick={handlePrevious}
   527→              disabled={currentStepIndex === 0 && !onBack}
   528→              className="p-2 rounded-full text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"
   529→            >
   530→              <ChevronLeft className="w-5 h-5" />
   531→            </button>
   532→
   533→            {/* Step dots */}
   534→            <div className="flex items-center gap-1 px-2">
   535→              {Array.from({ length: Math.min(7, totalSteps) }).map((_, i) => {
   536→                let stepIndex: number;
   537→                if (totalSteps <= 7) {
   538→                  stepIndex = i;
   539→                } else if (currentStepIndex < 3) {
   540→                  stepIndex = i;
   541→                } else if (currentStepIndex > totalSteps - 4) {
   542→                  stepIndex = totalSteps - 7 + i;
   543→                } else {
   544→                  stepIndex = currentStepIndex - 3 + i;
   545→                }
   546→
   547→                const isCompleted = stepIndex < currentStepIndex;
   548→                const isCurrent = stepIndex === currentStepIndex;
   549→
   550→                return (
   551→                  <button
   552→                    key={stepIndex}
   553→                    onClick={() => {
   554→                      setCurrentStepIndex(stepIndex);
   555→                      handleResetZoom();
   556→                    }}
   557→                    className={`rounded-full transition-all ${
   558→                      isCurrent
   559→                        ? 'w-6 h-2 bg-gray-900'
   560→                        : isCompleted
   561→                          ? 'w-2 h-2 bg-emerald-500'
   562→                          : 'w-2 h-2 bg-gray-300'
   563→                    }`}
   564→                  />
   565→                );
   566→              })}
   567→            </div>
   568→
   569→            <button
   570→              onClick={handleNext}
   571→              className={`flex items-center gap-1.5 px-4 py-2 rounded-full font-medium text-sm transition-all ${
   572→                currentStepIndex === totalSteps - 1
   573→                  ? 'bg-emerald-500 text-white hover:bg-emerald-600'
   574→                  : 'bg-gray-900 text-white hover:bg-gray-800'
   575→              }`}
   576→            >
   577→              {currentStepIndex === totalSteps - 1 ? (
   578→                <>
   579→                  <Check className="w-4 h-4" />
   580→                  Done
   581→                </>
   582→              ) : (
   583→                <>
   584→                  Next
   585→                  <ChevronRight className="w-4 h-4" />
   586→                </>
   587→              )}
   588→            </button>
   589→          </div>
   590→        </div>
   591→
   592→        {/* Mobile Bottom Bar */}
   593→        <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 flex items-center justify-between">
   594→          <button
   595→            onClick={handlePrevious}
   596→            className="flex items-center gap-1 text-gray-600 text-sm"
   597→          >
   598→            <ChevronLeft className="w-4 h-4" />
   599→            Back
   600→          </button>
   601→          <div className="text-xs text-gray-500">
   602→            {currentStepIndex + 1} / {totalSteps}
   603→          </div>
   604→          <button
   605→            onClick={handleNext}
   606→            className="flex items-center gap-1 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm font-medium"
   607→          >
   608→            {currentStepIndex === totalSteps - 1 ? 'Done' : 'Next'}
   609→            <ChevronRight className="w-4 h-4" />
   610→          </button>
   611→        </div>
   612→      </div>
   613→    </div>
   614→  );
   615→}
   616→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
