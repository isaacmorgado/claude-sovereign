     1→'use client';
     2→
     3→import { useState, useRef, useCallback, useEffect } from 'react';
     4→import Image from 'next/image';
     5→import { motion } from 'framer-motion';
     6→import {
     7→  ChevronLeft,
     8→  ChevronRight,
     9→  ChevronUp,
    10→  ChevronDown,
    11→  Check,
    12→  Info,
    13→  Eye,
    14→  EyeOff,
    15→} from 'lucide-react';
    16→import {
    17→  LandmarkPoint,
    18→  FRONT_PROFILE_LANDMARKS,
    19→  SIDE_PROFILE_LANDMARKS,
    20→  getLandmarkColor,
    21→  FRONT_LANDMARK_CATEGORIES,
    22→  SIDE_LANDMARK_CATEGORIES,
    23→} from '@/lib/landmarks';
    24→
    25→interface LandmarkAnalysisToolProps {
    26→  imageUrl: string;
    27→  mode: 'front' | 'side';
    28→  initialLandmarks?: LandmarkPoint[];
    29→  onLandmarksChange?: (landmarks: LandmarkPoint[]) => void;
    30→  onComplete?: (landmarks: LandmarkPoint[]) => void;
    31→  onBack?: () => void;
    32→}
    33→
    34→// Get ordered landmarks for guided placement
    35→function getOrderedLandmarks(mode: 'front' | 'side'): string[] {
    36→  const landmarks = mode === 'front' ? FRONT_PROFILE_LANDMARKS : SIDE_PROFILE_LANDMARKS;
    37→  return landmarks.map(lm => lm.id);
    38→}
    39→
    40→// Keyboard key component with 3D effect - Light theme version
    41→function KeyboardKey({ label, isPressed }: { label: string; isPressed: boolean }) {
    42→  return (
    43→    <span
    44→      className={`px-2 py-1 text-xs font-mono rounded border transition-colors duration-75 ${
    45→        isPressed
    46→          ? 'bg-gray-900 border-gray-900 text-white'
    47→          : 'bg-gray-100 border-gray-200 text-gray-700'
    48→      }`}
    49→      style={{ transform: isPressed ? 'translateY(1px)' : 'none' }}
    50→    >
    51→      {label}
    52→    </span>
    53→  );
    54→}
    55→
    56→export function LandmarkAnalysisTool({
    57→  imageUrl,
    58→  mode,
    59→  initialLandmarks,
    60→  onLandmarksChange,
    61→  onComplete,
    62→  onBack,
    63→}: LandmarkAnalysisToolProps) {
    64→  const containerRef = useRef<HTMLDivElement>(null);
    65→  const defaultLandmarks = mode === 'front' ? FRONT_PROFILE_LANDMARKS : SIDE_PROFILE_LANDMARKS;
    66→  const categories = mode === 'front' ? FRONT_LANDMARK_CATEGORIES : SIDE_LANDMARK_CATEGORIES;
    67→  const orderedIds = getOrderedLandmarks(mode);
    68→
    69→  const [landmarks, setLandmarks] = useState<LandmarkPoint[]>(
    70→    initialLandmarks || defaultLandmarks
    71→  );
    72→  const [currentStepIndex, setCurrentStepIndex] = useState(0);
    73→  const [zoomLevel, setZoomLevel] = useState(1);
    74→  const [pan, setPan] = useState({ x: 0, y: 0 });
    75→  const [isDragging, setIsDragging] = useState(false);
    76→  const [showAllPoints, setShowAllPoints] = useState(true);
    77→  const [pressedKey, setPressedKey] = useState<string | null>(null);
    78→  const [activeTab, setActiveTab] = useState<'photo' | 'reference'>('photo');
    79→
    80→  const currentLandmarkId = orderedIds[currentStepIndex];
    81→  const currentLandmark = landmarks.find((lm) => lm.id === currentLandmarkId);
    82→  const totalSteps = orderedIds.length;
    83→  const progress = ((currentStepIndex + 1) / totalSteps) * 100;
    84→
    85→  const color = currentLandmark
    86→    ? getLandmarkColor(currentLandmark.id, categories)
    87→    : '#10b981';
    88→
    89→  useEffect(() => {
    90→    onLandmarksChange?.(landmarks);
    91→  }, [landmarks, onLandmarksChange]);
    92→
    93→  const updateLandmarkPosition = useCallback(
    94→    (x: number, y: number) => {
    95→      setLandmarks((prev) =>
    96→        prev.map((lm) =>
    97→          lm.id === currentLandmarkId ? { ...lm, x, y } : lm
    98→        )
    99→      );
   100→    },
   101→    [currentLandmarkId]
   102→  );
   103→
   104→  const handleContainerClick = useCallback(
   105→    (e: React.MouseEvent<HTMLDivElement>) => {
   106→      if (!containerRef.current || isDragging) return;
   107→
   108→      const rect = containerRef.current.getBoundingClientRect();
   109→      const rawX = (e.clientX - rect.left - rect.width / 2 - pan.x) / zoomLevel + rect.width / 2;
   110→      const rawY = (e.clientY - rect.top - rect.height / 2 - pan.y) / zoomLevel + rect.height / 2;
   111→
   112→      const x = Math.max(0, Math.min(1, rawX / rect.width));
   113→      const y = Math.max(0, Math.min(1, rawY / rect.height));
   114→
   115→      updateLandmarkPosition(x, y);
   116→    },
   117→    [isDragging, pan, zoomLevel, updateLandmarkPosition]
   118→  );
   119→
   120→  const handleMouseDown = useCallback(
   121→    (e: React.MouseEvent) => {
   122→      if (e.button === 0 && zoomLevel > 1) {
   123→        setIsDragging(true);
   124→      }
   125→    },
   126→    [zoomLevel]
   127→  );
   128→
   129→  const handleMouseMove = useCallback(
   130→    (e: React.MouseEvent) => {
   131→      if (isDragging && zoomLevel > 1) {
   132→        setPan((prev) => ({
   133→          x: prev.x + e.movementX,
   134→          y: prev.y + e.movementY,
   135→        }));
   136→      }
   137→    },
   138→    [isDragging, zoomLevel]
   139→  );
   140→
   141→  const handleMouseUp = useCallback(() => {
   142→    setIsDragging(false);
   143→  }, []);
   144→
   145→  const handleResetZoom = useCallback(() => {
   146→    setZoomLevel(1);
   147→    setPan({ x: 0, y: 0 });
   148→  }, []);
   149→
   150→  const moveLandmark = useCallback((direction: 'up' | 'down' | 'left' | 'right') => {
   151→    const step = 0.002;
   152→    setLandmarks((prev) =>
   153→      prev.map((lm) => {
   154→        if (lm.id !== currentLandmarkId) return lm;
   155→        let newX = lm.x;
   156→        let newY = lm.y;
   157→        switch (direction) {
   158→          case 'up': newY = Math.max(0, lm.y - step); break;
   159→          case 'down': newY = Math.min(1, lm.y + step); break;
   160→          case 'left': newX = Math.max(0, lm.x - step); break;
   161→          case 'right': newX = Math.min(1, lm.x + step); break;
   162→        }
   163→        return { ...lm, x: newX, y: newY };
   164→      })
   165→    );
   166→  }, [currentLandmarkId]);
   167→
   168→  const handleNext = useCallback(() => {
   169→    if (currentStepIndex < totalSteps - 1) {
   170→      setCurrentStepIndex((prev) => prev + 1);
   171→      handleResetZoom();
   172→    } else {
   173→      onComplete?.(landmarks);
   174→    }
   175→  }, [currentStepIndex, totalSteps, landmarks, onComplete, handleResetZoom]);
   176→
   177→  const handlePrevious = useCallback(() => {
   178→    if (currentStepIndex > 0) {
   179→      setCurrentStepIndex((prev) => prev - 1);
   180→      handleResetZoom();
   181→    } else {
   182→      onBack?.();
   183→    }
   184→  }, [currentStepIndex, handleResetZoom, onBack]);
   185→
   186→  // Keyboard handlers
   187→  useEffect(() => {
   188→    const handleKeyDown = (e: KeyboardEvent) => {
   189→      if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'Enter', 'Backspace', 'r', 'R'].includes(e.key)) {
   190→        e.preventDefault();
   191→      }
   192→      setPressedKey(e.key);
   193→
   194→      switch (e.key) {
   195→        case 'ArrowUp': moveLandmark('up'); break;
   196→        case 'ArrowDown': moveLandmark('down'); break;
   197→        case 'ArrowLeft': moveLandmark('left'); break;
   198→        case 'ArrowRight': moveLandmark('right'); break;
   199→        case 'Enter': handleNext(); break;
   200→        case 'Backspace': handlePrevious(); break;
   201→        case 'r':
   202→        case 'R': handleResetZoom(); break;
   203→      }
   204→    };
   205→
   206→    const handleKeyUp = () => setPressedKey(null);
   207→
   208→    window.addEventListener('keydown', handleKeyDown);
   209→    window.addEventListener('keyup', handleKeyUp);
   210→    return () => {
   211→      window.removeEventListener('keydown', handleKeyDown);
   212→      window.removeEventListener('keyup', handleKeyUp);
   213→    };
   214→  }, [moveLandmark, handleNext, handlePrevious, handleResetZoom]);
   215→
   216→  return (
   217→    <div className="fixed inset-0 bg-white">
   218→      <div className="flex flex-col md:flex-row h-[100dvh] md:h-full gap-2 md:gap-4 p-2 md:p-4 overflow-hidden">
   219→        {/* Sidebar - Right on desktop, top on mobile */}
   220→        <div className="w-full md:w-80 flex-shrink-0 flex flex-col gap-2 md:gap-4 md:order-2 md:overflow-y-auto md:max-h-full">
   221→          {/* Progress Card */}
   222→          <div className="bg-white rounded-xl border border-gray-200 overflow-hidden flex-shrink-0">
   223→            <div className="p-4 border-b border-gray-100">
   224→              <div className="flex items-center justify-between text-xs text-gray-600 mb-2">
   225→                <span>Step {currentStepIndex + 1} of {totalSteps}</span>
   226→                <span>{Math.round(progress)}%</span>
   227→              </div>
   228→              <div className="h-1.5 bg-gray-200 rounded-full overflow-hidden mb-3">
   229→                <motion.div
   230→                  className="h-full bg-gray-900 transition-all duration-300"
   231→                  style={{ width: `${progress}%` }}
   232→                />
   233→              </div>
   234→              <div className="flex items-center justify-between">
   235→                <div className="flex items-center gap-2">
   236→                  <div className="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center flex-shrink-0">
   237→                    <Check className="w-3.5 h-3.5 text-white" />
   238→                  </div>
   239→                  <span className="text-sm font-medium text-gray-900">
   240→                    {currentStepIndex} placed
   241→                  </span>
   242→                </div>
   243→              </div>
   244→            </div>
   245→
   246→            {/* View Tabs */}
   247→            <div className="flex border-b border-gray-200">
   248→              <button
   249→                onClick={() => setActiveTab('photo')}
   250→                className={`flex-1 py-2.5 text-xs font-medium transition-colors ${
   251→                  activeTab === 'photo'
   252→                    ? 'text-gray-900 border-b-2 border-gray-900'
   253→                    : 'text-gray-500 hover:text-gray-700'
   254→                }`}
   255→              >
   256→                {mode === 'front' ? 'Front View' : 'Side View'}
   257→              </button>
   258→              <button
   259→                onClick={() => setActiveTab('reference')}
   260→                className={`flex-1 py-2.5 text-xs font-medium transition-colors ${
   261→                  activeTab === 'reference'
   262→                    ? 'text-gray-900 border-b-2 border-gray-900'
   263→                    : 'text-gray-500 hover:text-gray-700'
   264→                }`}
   265→              >
   266→                Reference
   267→              </button>
   268→            </div>
   269→
   270→            {/* Reference Image */}
   271→            <div className="relative w-full h-48 overflow-hidden bg-gray-50 flex items-center justify-center">
   272→              {activeTab === 'photo' ? (
   273→                <div className="text-center p-4">
   274→                  <div
   275→                    className="w-12 h-12 rounded-full mx-auto mb-2 flex items-center justify-center"
   276→                    style={{ backgroundColor: `${color}20`, border: `2px solid ${color}` }}
   277→                  >
   278→                    <div className="w-3 h-3 rounded-full" style={{ backgroundColor: color }} />
   279→                  </div>
   280→                  <p className="text-sm font-medium text-gray-900">{currentLandmark?.label}</p>
   281→                  <p className="text-xs text-gray-500 mt-1">{currentLandmark?.medicalTerm}</p>
   282→                </div>
   283→              ) : (
   284→                <div className="text-center p-4">
   285→                  <Info className="w-8 h-8 mx-auto mb-2 text-gray-400" />
   286→                  <p className="text-sm text-gray-600">{currentLandmark?.description}</p>
   287→                </div>
   288→              )}
   289→            </div>
   290→          </div>
   291→
   292→          {/* Keyboard Shortcuts - Desktop only */}
   293→          <div className="hidden md:flex flex-col gap-4">
   294→            <div className="bg-white rounded-xl border border-gray-200 p-4">
   295→              <div className="flex justify-center mb-4">
   296→                <div className="flex flex-col gap-1 items-center">
   297→                  <div className="relative w-9 h-9">
   298→                    <div
   299→                      className={`absolute inset-0 rounded-md transition-colors duration-75 ${
   300→                        pressedKey === 'ArrowUp' ? 'bg-emerald-200' : 'bg-gray-300'
   301→                      }`}
   302→                      style={{ transform: 'translateY(3px)' }}
   303→                    />
   304→                    <div
   305→                      className={`relative w-full h-full rounded-md border flex items-center justify-center transition-colors duration-75 ${
   306→                        pressedKey === 'ArrowUp'
   307→                          ? 'bg-emerald-500 border-emerald-500 text-white'
   308→                          : 'bg-gray-100 border-gray-200 text-gray-600'
   309→                      }`}
   310→                    >
   311→                      <ChevronUp className="w-4 h-4" />
   312→                    </div>
   313→                  </div>
   314→                  <div className="flex gap-1">
   315→                    {['ArrowLeft', 'ArrowDown', 'ArrowRight'].map((key) => (
   316→                      <div key={key} className="relative w-9 h-9">
   317→                        <div
   318→                          className={`absolute inset-0 rounded-md transition-colors duration-75 ${
   319→                            pressedKey === key ? 'bg-emerald-200' : 'bg-gray-300'
   320→                          }`}
   321→                          style={{ transform: 'translateY(3px)' }}
   322→                        />
   323→                        <div
   324→                          className={`relative w-full h-full rounded-md border flex items-center justify-center transition-colors duration-75 ${
   325→                            pressedKey === key
   326→                              ? 'bg-emerald-500 border-emerald-500 text-white'
   327→                              : 'bg-gray-100 border-gray-200 text-gray-600'
   328→                          }`}
   329→                        >
   330→                          {key === 'ArrowLeft' && <ChevronLeft className="w-4 h-4" />}
   331→                          {key === 'ArrowDown' && <ChevronDown className="w-4 h-4" />}
   332→                          {key === 'ArrowRight' && <ChevronRight className="w-4 h-4" />}
   333→                        </div>
   334→                      </div>
   335→                    ))}
   336→                  </div>
   337→                </div>
   338→              </div>
   339→
   340→              <div className="flex items-center gap-3 mb-2">
   341→                <KeyboardKey label="Enter" isPressed={pressedKey === 'Enter'} />
   342→                <span className="text-xs text-gray-500">Next</span>
   343→              </div>
   344→              <div className="flex items-center gap-3 mb-2">
   345→                <KeyboardKey label="Backspace" isPressed={pressedKey === 'Backspace'} />
   346→                <span className="text-xs text-gray-500">Previous</span>
   347→              </div>
   348→              <div className="flex items-center gap-3">
   349→                <KeyboardKey label="R" isPressed={pressedKey === 'r' || pressedKey === 'R'} />
   350→                <span className="text-xs text-gray-500">Reset</span>
   351→              </div>
   352→            </div>
   353→
   354→            {/* Zoom Controls */}
   355→            <div className="bg-white rounded-xl border border-gray-200 p-4">
   356→              <p className="text-xs text-gray-500 font-medium uppercase tracking-wide mb-3">
   357→                Zoom Level
   358→              </p>
   359→              <div className="flex gap-2">
   360→                {[1, 2, 4].map((level) => (
   361→                  <button
   362→                    key={level}
   363→                    onClick={() => {
   364→                      setZoomLevel(level);
   365→                      if (level === 1) setPan({ x: 0, y: 0 });
   366→                    }}
   367→                    className={`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${
   368→                      zoomLevel === level
   369→                        ? 'bg-gray-900 text-white'
   370→                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
   371→                    }`}
   372→                  >
   373→                    {level}x
   374→                  </button>
   375→                ))}
   376→              </div>
   377→            </div>
   378→
   379→            {/* Toggle All Points */}
   380→            <div className="sticky bottom-0 bg-white pt-2 flex flex-col gap-4">
   381→              <div className="flex gap-2">
   382→                <button
   383→                  onClick={() => setShowAllPoints(!showAllPoints)}
   384→                  className={`flex-1 py-2.5 rounded-lg text-xs font-medium transition-colors flex items-center justify-center gap-2 ${
   385→                    showAllPoints
   386→                      ? 'bg-gray-900 text-white'
   387→                      : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
   388→                  }`}
   389→                >
   390→                  {showAllPoints ? <Eye className="w-4 h-4" /> : <EyeOff className="w-4 h-4" />}
   391→                  {showAllPoints ? 'Showing All' : 'Current Only'}
   392→                </button>
   393→                <button
   394→                  onClick={() => onComplete?.(landmarks)}
   395→                  className="py-2.5 px-4 rounded-lg text-xs font-medium bg-gray-100 text-gray-600 hover:bg-gray-200 transition-colors"
   396→                >
   397→                  Skip
   398→                </button>
   399→              </div>
   400→            </div>
   401→          </div>
   402→        </div>
   403→
   404→        {/* Main Image Area */}
   405→        <div className="flex-1 min-h-0 relative md:order-1">
   406→          <div
   407→            ref={containerRef}
   408→            className="relative w-full h-full bg-gray-100 overflow-hidden rounded-lg flex items-center justify-center select-none"
   409→            onClick={handleContainerClick}
   410→            onMouseDown={handleMouseDown}
   411→            onMouseMove={handleMouseMove}
   412→            onMouseUp={handleMouseUp}
   413→            onMouseLeave={handleMouseUp}
   414→            style={{
   415→              cursor: zoomLevel > 1 && isDragging ? 'grabbing' : zoomLevel > 1 ? 'grab' : 'crosshair',
   416→            }}
   417→          >
   418→            {/* Transformed Content */}
   419→            <div
   420→              className="relative w-full h-full transition-transform duration-100"
   421→              style={{
   422→                transform: `scale(${zoomLevel}) translate(${pan.x / zoomLevel}px, ${pan.y / zoomLevel}px)`,
   423→                transformOrigin: 'center center',
   424→              }}
   425→            >
   426→              {/* User's Image */}
   427→              <Image
   428→                src={imageUrl}
   429→                alt="Your photo"
   430→                fill
   431→                className="object-contain pointer-events-none select-none"
   432→                unoptimized
   433→                draggable={false}
   434→              />
   435→
   436→              {/* All Landmarks (dimmed) */}
   437→              {showAllPoints &&
   438→                landmarks.map((landmark) => {
   439→                  if (landmark.id === currentLandmarkId) return null;
   440→                  const lmColor = getLandmarkColor(landmark.id, categories);
   441→                  return (
   442→                    <div
   443→                      key={landmark.id}
   444→                      className="absolute w-2.5 h-2.5 -translate-x-1/2 -translate-y-1/2 pointer-events-none"
   445→                      style={{
   446→                        left: `${landmark.x * 100}%`,
   447→                        top: `${landmark.y * 100}%`,
   448→                        opacity: 0.4,
   449→                      }}
   450→                    >
   451→                      <div
   452→                        className="w-full h-full rounded-full border border-white/80"
   453→                        style={{ backgroundColor: lmColor }}
   454→                      />
   455→                    </div>
   456→                  );
   457→                })}
   458→
   459→              {/* Current Landmark (highlighted) */}
   460→              {currentLandmark && (
   461→                <motion.div
   462→                  key={currentLandmarkId}
   463→                  initial={{ scale: 0 }}
   464→                  animate={{ scale: 1 }}
   465→                  className="absolute pointer-events-none"
   466→                  style={{
   467→                    left: `${currentLandmark.x * 100}%`,
   468→                    top: `${currentLandmark.y * 100}%`,
   469→                  }}
   470→                >
   471→                  {/* Pulsing glow */}
   472→                  <motion.div
   473→                    className="absolute -translate-x-1/2 -translate-y-1/2 rounded-full"
   474→                    style={{
   475→                      width: 32,
   476→                      height: 32,
   477→                      boxShadow: `0 0 20px 8px ${color}40`,
   478→                    }}
   479→                    animate={{
   480→                      scale: [1, 1.3, 1],
   481→                      opacity: [0.6, 0.2, 0.6],
   482→                    }}
   483→                    transition={{
   484→                      duration: 1.5,
   485→                      repeat: Infinity,
   486→                      ease: 'easeInOut',
   487→                    }}
   488→                  />
   489→
   490→                  {/* Main dot */}
   491→                  <div
   492→                    className="absolute -translate-x-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 border-white shadow-lg"
   493→                    style={{
   494→                      backgroundColor: color,
   495→                      boxShadow: `0 2px 8px ${color}80`,
   496→                    }}
   497→                  />
   498→                </motion.div>
   499→              )}
   500→            </div>
   501→
   502→            {/* Zoom indicator */}
   503→            {zoomLevel > 1 && (
   504→              <div className="absolute top-3 left-3 px-2 py-1 rounded bg-black/60 text-white text-xs">
   505→                {zoomLevel}x - Drag to pan
   506→              </div>
   507→            )}
   508→
   509→            {/* Current landmark label overlay */}
   510→            <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4 pointer-events-none">
   511→              <p className="text-center text-white text-sm font-medium">
   512→                Click to place:{' '}
   513→                <span style={{ color }}>{currentLandmark?.label}</span>
   514→              </p>
   515→            </div>
   516→          </div>
   517→
   518→          {/* Navigation Bar */}
   519→          <div className="absolute bottom-4 left-1/2 -translate-x-1/2 flex items-center gap-3 bg-white/95 backdrop-blur-sm rounded-full shadow-lg border border-gray-200 px-2 py-1.5">
   520→            <button
   521→              onClick={handlePrevious}
   522→              disabled={currentStepIndex === 0 && !onBack}
   523→              className="p-2 rounded-full text-gray-600 hover:bg-gray-100 disabled:opacity-40 disabled:cursor-not-allowed transition-colors"
   524→            >
   525→              <ChevronLeft className="w-5 h-5" />
   526→            </button>
   527→
   528→            {/* Step dots */}
   529→            <div className="flex items-center gap-1 px-2">
   530→              {Array.from({ length: Math.min(7, totalSteps) }).map((_, i) => {
   531→                let stepIndex: number;
   532→                if (totalSteps <= 7) {
   533→                  stepIndex = i;
   534→                } else if (currentStepIndex < 3) {
   535→                  stepIndex = i;
   536→                } else if (currentStepIndex > totalSteps - 4) {
   537→                  stepIndex = totalSteps - 7 + i;
   538→                } else {
   539→                  stepIndex = currentStepIndex - 3 + i;
   540→                }
   541→
   542→                const isCompleted = stepIndex < currentStepIndex;
   543→                const isCurrent = stepIndex === currentStepIndex;
   544→
   545→                return (
   546→                  <button
   547→                    key={stepIndex}
   548→                    onClick={() => {
   549→                      setCurrentStepIndex(stepIndex);
   550→                      handleResetZoom();
   551→                    }}
   552→                    className={`rounded-full transition-all ${
   553→                      isCurrent
   554→                        ? 'w-6 h-2 bg-gray-900'
   555→                        : isCompleted
   556→                          ? 'w-2 h-2 bg-emerald-500'
   557→                          : 'w-2 h-2 bg-gray-300'
   558→                    }`}
   559→                  />
   560→                );
   561→              })}
   562→            </div>
   563→
   564→            <button
   565→              onClick={handleNext}
   566→              className={`flex items-center gap-1.5 px-4 py-2 rounded-full font-medium text-sm transition-all ${
   567→                currentStepIndex === totalSteps - 1
   568→                  ? 'bg-emerald-500 text-white hover:bg-emerald-600'
   569→                  : 'bg-gray-900 text-white hover:bg-gray-800'
   570→              }`}
   571→            >
   572→              {currentStepIndex === totalSteps - 1 ? (
   573→                <>
   574→                  <Check className="w-4 h-4" />
   575→                  Done
   576→                </>
   577→              ) : (
   578→                <>
   579→                  Next
   580→                  <ChevronRight className="w-4 h-4" />
   581→                </>
   582→              )}
   583→            </button>
   584→          </div>
   585→        </div>
   586→
   587→        {/* Mobile Bottom Bar */}
   588→        <div className="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 flex items-center justify-between">
   589→          <button
   590→            onClick={handlePrevious}
   591→            className="flex items-center gap-1 text-gray-600 text-sm"
   592→          >
   593→            <ChevronLeft className="w-4 h-4" />
   594→            Back
   595→          </button>
   596→          <div className="text-xs text-gray-500">
   597→            {currentStepIndex + 1} / {totalSteps}
   598→          </div>
   599→          <button
   600→            onClick={handleNext}
   601→            className="flex items-center gap-1 bg-gray-900 text-white px-4 py-2 rounded-lg text-sm font-medium"
   602→          >
   603→            {currentStepIndex === totalSteps - 1 ? 'Done' : 'Next'}
   604→            <ChevronRight className="w-4 h-4" />
   605→          </button>
   606→        </div>
   607→      </div>
   608→    </div>
   609→  );
   610→}
   611→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
