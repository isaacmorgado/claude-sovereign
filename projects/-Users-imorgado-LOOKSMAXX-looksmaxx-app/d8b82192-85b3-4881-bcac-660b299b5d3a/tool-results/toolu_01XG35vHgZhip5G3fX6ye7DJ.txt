     1→/**
     2→ * Harmony-Style Results Page Types
     3→ * Complete type definitions for the results UI
     4→ */
     5→
     6→import { QualityTier, SeverityLevel, MeasurementUnit } from '@/lib/harmony-scoring';
     7→
     8→// ============================================
     9→// ILLUSTRATION TYPES
    10→// ============================================
    11→
    12→export interface IllustrationPoint {
    13→  type: 'landmark' | 'calculated';
    14→  landmarkId?: string;
    15→  x?: number;
    16→  y?: number;
    17→  label?: string;
    18→}
    19→
    20→export interface IllustrationLine {
    21→  from: string;
    22→  to: string;
    23→  color: string;
    24→  style?: 'solid' | 'dashed';
    25→  label?: string;
    26→  labelColor?: string;
    27→  labelPosition?: 'start' | 'middle' | 'end';
    28→}
    29→
    30→export interface RatioIllustration {
    31→  points: Record<string, IllustrationPoint>;
    32→  lines: Record<string, IllustrationLine>;
    33→}
    34→
    35→// ============================================
    36→// RATIO/MEASUREMENT TYPES
    37→// ============================================
    38→
    39→export interface Ratio {
    40→  id: string;
    41→  name: string;
    42→  value: number;
    43→  score: number;  // 0-10 scale
    44→  standardizedScore: number;
    45→  unit: 'x' | 'mm' | '%' | '°';
    46→  idealMin: number;
    47→  idealMax: number;
    48→  rangeMin: number;
    49→  rangeMax: number;
    50→  description: string;
    51→  category: string;
    52→  qualityLevel: QualityTier;
    53→  severity: SeverityLevel;
    54→  illustration: RatioIllustration;
    55→  mayIndicateFlaws: string[];
    56→  mayIndicateStrengths: string[];
    57→  usedLandmarks: string[];
    58→  scoringCurveConfig?: {
    59→    decayRate: number;
    60→    maxScore: number;
    61→  };
    62→  // Harmony Taxonomy classification
    63→  taxonomyPrimary?: string;    // 'harmony' | 'dimorphism' | 'angularity' | 'features'
    64→  taxonomySecondary?: string;  // Subcategory ID
    65→}
    66→
    67→// ============================================
    68→// STRENGTH/FLAW TYPES
    69→// ============================================
    70→
    71→export interface ResponsibleRatio {
    72→  ratioName: string;
    73→  ratioId: string;
    74→  score: number;
    75→  value: number;
    76→  isObfuscated?: boolean;
    77→  // Additional properties for AI descriptions
    78→  idealMin: number;
    79→  idealMax: number;
    80→  unit: string;
    81→  category?: string;
    82→}
    83→
    84→export interface Strength {
    85→  id: string;
    86→  strengthName: string;
    87→  summary: string;
    88→  avgScore: number;
    89→  qualityLevel: QualityTier;
    90→  categoryName: string;
    91→  responsibleRatios: ResponsibleRatio[];
    92→}
    93→
    94→export interface Flaw {
    95→  id: string;
    96→  flawName: string;
    97→  summary: string;
    98→  harmonyPercentageLost: number;
    99→  standardizedImpact: number;
   100→  categoryName: string;
   101→  isOther?: boolean;
   102→  responsibleRatios: ResponsibleRatio[];
   103→  rollingPointsDeducted?: number;
   104→  rollingHarmonyPercentageLost?: number;
   105→  rollingStandardizedImpact?: number;
   106→}
   107→
   108→// ============================================
   109→// RECOMMENDATION TYPES
   110→// ============================================
   111→
   112→export type RecommendationPhase = 'Surgical' | 'Minimally Invasive' | 'Foundational';
   113→
   114→export interface RecommendationTimeline {
   115→  effect_start: 'immediate' | 'delayed' | 'gradual';
   116→  full_results_weeks: number;
   117→  full_results_weeks_max?: number;
   118→}
   119→
   120→export interface RecommendationCost {
   121→  type: 'flat' | 'per_month' | 'per_session';
   122→  min: number;
   123→  max: number;
   124→  currency: string;
   125→}
   126→
   127→export interface RatioImpact {
   128→  ratioId: string;
   129→  ratioName: string;
   130→  direction: 'increase' | 'decrease' | 'both';
   131→  percentageEffect: number;
   132→}
   133→
   134→export interface Recommendation {
   135→  ref_id: string;
   136→  name: string;
   137→  description: string;
   138→  phase: RecommendationPhase;
   139→  impact: number;  // 0-1 effectiveness score
   140→  coverage: number;  // Number of metrics improved
   141→  percentage: string;  // e.g., "10-20%"
   142→  expectedImprovementRange?: { min: number; max: number };
   143→  matchedFlaws: string[];
   144→  matchedRatios: string[];
   145→  ratios_impacted: RatioImpact[];
   146→  timeline: RecommendationTimeline;
   147→  cost: RecommendationCost;
   148→  risks_side_effects: string | null;
   149→  warnings: string[];
   150→  gender: 'male' | 'female' | 'both';
   151→}
   152→
   153→// ============================================
   154→// HARMONY ANALYSIS TYPES
   155→// ============================================
   156→
   157→export interface ProfileAnalysis {
   158→  standardizedScore: number;
   159→  ratios: Ratio[];
   160→  overallAIDescription?: string | null;
   161→}
   162→
   163→export interface FullHarmonyAnalysis {
   164→  standardizedScore: number;
   165→  front: ProfileAnalysis;
   166→  side: ProfileAnalysis;
   167→  strengths: Strength[];
   168→  flaws: Flaw[];
   169→}
   170→
   171→// ============================================
   172→// FACE DATA TYPES
   173→// ============================================
   174→
   175→export interface FaceData {
   176→  id: string;
   177→  userId?: string;
   178→  frontPhotoUrl: string;
   179→  sidePhotoUrl?: string;
   180→  harmonyScore: number | null;
   181→  frontHarmonyScore: number | null;
   182→  sideHarmonyScore: number | null;
   183→  gender: 'male' | 'female';
   184→  race?: string;
   185→  unlocked: boolean;
   186→  actionPlanUnlocked: boolean;
   187→  harmonyAnalysis: FullHarmonyAnalysis;
   188→}
   189→
   190→// ============================================
   191→// UI STATE TYPES
   192→// ============================================
   193→
   194→export type ResultsTab =
   195→  | 'overview'
   196→  | 'front-ratios'
   197→  | 'side-ratios'
   198→  | 'leaderboard'
   199→  | 'psl'
   200→  | 'plan'
   201→  | 'community'
   202→  | 'options'
   203→  | 'support';
   204→
   205→// ============================================
   206→// LEADERBOARD TYPES
   207→// ============================================
   208→
   209→export interface UserRank {
   210→  userId: string;
   211→  score: number;
   212→  globalRank: number;
   213→  genderRank: number;
   214→  percentile: number;
   215→  totalUsers: number;
   216→  genderTotal: number;
   217→  anonymousName: string;
   218→  updatedAt: string;
   219→}
   220→
   221→export interface LeaderboardEntry {
   222→  userId: string;
   223→  rank: number;
   224→  score: number;
   225→  anonymousName: string;
   226→  gender: 'male' | 'female';
   227→  facePhotoUrl: string | null;
   228→  isCurrentUser: boolean;
   229→}
   230→
   231→export interface UserProfile extends Omit<LeaderboardEntry, 'isCurrentUser'> {
   232→  topStrengths: string[];
   233→  topImprovements: string[];
   234→}
   235→
   236→export interface LeaderboardData {
   237→  entries: LeaderboardEntry[];
   238→  totalCount: number;
   239→  userRank: UserRank | null;
   240→}
   241→
   242→export interface ResultsUIState {
   243→  activeTab: ResultsTab;
   244→  expandedMeasurementId: string | null;
   245→  selectedVisualizationMetric: string | null;
   246→  categoryFilter: string | null;
   247→  showLandmarkOverlay: boolean;
   248→}
   249→
   250→// ============================================
   251→// CATEGORY TYPES
   252→// ============================================
   253→
   254→export interface MeasurementCategory {
   255→  id: string;
   256→  name: string;
   257→  color: string;
   258→  description: string;
   259→}
   260→
   261→export const MEASUREMENT_CATEGORIES: MeasurementCategory[] = [
   262→  { id: 'midface', name: 'Midface/Face Shape', color: '#67e8f9', description: 'Facial proportions and overall shape' },
   263→  { id: 'jaw-growth', name: 'Occlusion/Jaw Growth', color: '#a78bfa', description: 'Jaw development and bite alignment' },
   264→  { id: 'jaw-shape', name: 'Jaw Shape', color: '#f97316', description: 'Jawline contour and angles' },
   265→  { id: 'upper-third', name: 'Upper Third', color: '#84cc16', description: 'Forehead and hairline proportions' },
   266→  { id: 'eyes', name: 'Eyes', color: '#06b6d4', description: 'Eye shape, spacing, and canthal tilt' },
   267→  { id: 'nose', name: 'Nose', color: '#fbbf24', description: 'Nasal proportions and angles' },
   268→  { id: 'lips', name: 'Lips', color: '#ec4899', description: 'Lip proportions and projection' },
   269→  { id: 'chin', name: 'Chin', color: '#ef4444', description: 'Chin projection and shape' },
   270→  { id: 'neck', name: 'Neck', color: '#14b8a6', description: 'Neck angle and throat definition' },
   271→  { id: 'other', name: 'Other', color: '#6b7280', description: 'Additional measurements' },
   272→];
   273→
   274→// ============================================
   275→// SCORE COLOR HELPERS
   276→// ============================================
   277→
   278→export function getScoreColor(score: number): string {
   279→  if (score >= 8) return '#67e8f9';  // Cyan - ideal
   280→  if (score >= 6) return '#22c55e';  // Green - good
   281→  if (score >= 4) return '#fbbf24';  // Yellow - fair
   282→  return 'rgb(227, 67, 67)';         // Red - poor
   283→}
   284→
   285→export function getQualityColor(quality: QualityTier): string {
   286→  switch (quality) {
   287→    case 'ideal': return '#67e8f9';
   288→    case 'excellent': return '#22c55e';
   289→    case 'good': return '#fbbf24';
   290→    case 'below_average': return 'rgb(227, 67, 67)';
   291→    default: return '#6b7280';
   292→  }
   293→}
   294→
   295→export function getSeverityColor(severity: SeverityLevel): string {
   296→  switch (severity) {
   297→    case 'optimal': return '#67e8f9';
   298→    case 'minor': return '#22c55e';
   299→    case 'moderate': return '#fbbf24';
   300→    case 'major': return '#f97316';
   301→    case 'severe': return '#ef4444';
   302→    case 'extremely_severe': return '#dc2626';
   303→    default: return '#6b7280';
   304→  }
   305→}
   306→
   307→export function getCategoryColor(categoryName: string): string {
   308→  const cat = MEASUREMENT_CATEGORIES.find(c =>
   309→    c.name.toLowerCase().includes(categoryName.toLowerCase()) ||
   310→    categoryName.toLowerCase().includes(c.name.toLowerCase())
   311→  );
   312→  return cat?.color || '#6b7280';
   313→}
   314→
   315→// ============================================
   316→// UNIT FORMATTING
   317→// ============================================
   318→
   319→export function formatUnit(unit: 'x' | 'mm' | '%' | '°' | MeasurementUnit): string {
   320→  switch (unit) {
   321→    case 'x':
   322→    case 'ratio': return 'x';
   323→    case 'mm': return 'mm';
   324→    case '%':
   325→    case 'percent': return '%';
   326→    case '°':
   327→    case 'degrees': return '°';
   328→    default: return '';
   329→  }
   330→}
   331→
   332→export function formatValue(value: number, unit: 'x' | 'mm' | '%' | '°' | MeasurementUnit): string {
   333→  const unitStr = formatUnit(unit);
   334→  if (unit === '%' || unit === 'percent') {
   335→    return `${value.toFixed(1)}${unitStr}`;
   336→  }
   337→  if (unit === '°' || unit === 'degrees') {
   338→    return `${value.toFixed(1)}${unitStr}`;
   339→  }
   340→  return `${value.toFixed(2)}${unitStr}`;
   341→}
   342→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
