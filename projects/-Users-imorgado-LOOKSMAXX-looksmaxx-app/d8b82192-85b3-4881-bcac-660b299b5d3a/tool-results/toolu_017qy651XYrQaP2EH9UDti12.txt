     1→# PSL Enhancement System - Implementation Specification
     2→
     3→## Overview
     4→
     5→This document outlines the implementation of an enhanced PSL (Pretty Scale Level) scoring system with AI-powered feature extraction, archetype classification, and personalized advice generation. The AI vision analysis is a **paid feature**.
     6→
     7→---
     8→
     9→## Table of Contents
    10→
    11→1. [System Architecture](#1-system-architecture)
    12→2. [PSL Scoring Formula](#2-psl-scoring-formula)
    13→3. [AI Vision Feature Extraction (Paid)](#3-ai-vision-feature-extraction-paid)
    14→4. [Archetype Classification System](#4-archetype-classification-system)
    15→5. [Advice Generation Engine](#5-advice-generation-engine)
    16→6. [Database Schema](#6-database-schema)
    17→7. [API Endpoints](#7-api-endpoints)
    18→8. [Frontend Components](#8-frontend-components)
    19→9. [Implementation Phases](#9-implementation-phases)
    20→10. [Cost & Pricing](#10-cost--pricing)
    21→
    22→---
    23→
    24→## 1. System Architecture
    25→
    26→### High-Level Flow
    27→
    28→```
    29→┌─────────────────────────────────────────────────────────────────────────────┐
    30→│                           USER INPUT                                         │
    31→├─────────────────────────────────────────────────────────────────────────────┤
    32→│  FREE TIER                          │  PAID TIER (AI Vision)                │
    33→│  ├── Gender                         │  ├── All FREE tier data               │
    34→│  ├── Ethnicity                      │  ├── AI Skin Analysis                 │
    35→│  ├── Front Photo                    │  ├── AI Hair/Hairline Analysis        │
    36→│  ├── Side Photo                     │  ├── AI Teeth Analysis                │
    37→│  └── Height (manual input)          │  ├── AI Hollow Cheeks Detection       │
    38→│                                      │  ├── AI Eye Color Extraction         │
    39→│                                      │  ├── Physique Photo (optional)        │
    40→│                                      │  └── AI Body Composition Analysis     │
    41→└─────────────────────────────────────────────────────────────────────────────┘
    42→                                    │
    43→                                    ▼
    44→┌─────────────────────────────────────────────────────────────────────────────┐
    45→│                         PROCESSING PIPELINE                                  │
    46→├─────────────────────────────────────────────────────────────────────────────┤
    47→│                                                                              │
    48→│  STAGE 1: Landmark Analysis (Existing)                                      │
    49→│  ├── MediaPipe 478 landmarks (client-side)                                  │
    50→│  ├── InsightFace 106 landmarks (server-side)                                │
    51→│  └── 70+ facial metrics computed                                            │
    52→│                                                                              │
    53→│  STAGE 2: AI Vision Extraction (Paid Only)                                  │
    54→│  ├── Claude Vision API analyzes photos                                      │
    55→│  ├── Extracts soft tissue features                                          │
    56→│  └── Stores in vision_extractions table                                     │
    57→│                                                                              │
    58→│  STAGE 3: PSL Calculation                                                   │
    59→│  ├── Face Score (from landmarks) × 0.75                                     │
    60→│  ├── Height Score (from input) × 0.20                                       │
    61→│  ├── Body Score (from AI vision, if available) × 0.05                       │
    62→│  ├── Apply bonuses and constraints                                          │
    63→│  └── Classify into tier                                                     │
    64→│                                                                              │
    65→│  STAGE 4: Archetype Classification                                          │
    66→│  ├── Rule-based scoring per archetype                                       │
    67→│  ├── AI refinement for edge cases (paid)                                    │
    68→│  └── Sub-archetype determination                                            │
    69→│                                                                              │
    70→│  STAGE 5: Advice Generation                                                 │
    71→│  ├── Hairstyle recommendations (face shape + hairline)                      │
    72→│  ├── Skincare routine (skin analysis)                                       │
    73→│  ├── Style guide (archetype-matched)                                        │
    74→│  └── Prioritized action plan (flaws → fixes)                                │
    75→│                                                                              │
    76→└─────────────────────────────────────────────────────────────────────────────┘
    77→                                    │
    78→                                    ▼
    79→┌─────────────────────────────────────────────────────────────────────────────┐
    80→│                              OUTPUT                                          │
    81→├─────────────────────────────────────────────────────────────────────────────┤
    82→│  ├── Enhanced PSL Score (0-10) with tier badge                              │
    83→│  ├── Score breakdown (Face/Height/Body/Bonuses)                             │
    84→│  ├── Primary + Secondary Archetype                                          │
    85→│  ├── Hairstyle Recommendations (3-5 options)                                │
    86→│  ├── Skincare Routine (AM/PM)                                               │
    87→│  ├── Style Guide (clothing, colors, accessories)                            │
    88→│  └── Personalized Action Plan (prioritized by impact)                       │
    89→└─────────────────────────────────────────────────────────────────────────────┘
    90→```
    91→
    92→### Service Architecture
    93→
    94→```
    95→looksmaxx-api/
    96→├── app/
    97→│   ├── services/
    98→│   │   ├── psl_service.py           # PSL calculation with formula
    99→│   │   ├── vision_service.py        # Claude Vision API integration
   100→│   │   ├── archetype_service.py     # Archetype classification
   101→│   │   └── advice_service.py        # Recommendation generation
   102→│   │
   103→│   ├── routers/
   104→│   │   ├── psl.py                   # PSL endpoints
   105→│   │   ├── vision.py                # AI vision endpoints
   106→│   │   └── advice.py                # Advice endpoints
   107→│   │
   108→│   └── data/
   109→│       ├── archetypes.json          # Archetype definitions
   110→│       ├── hairstyles.json          # Hairstyle database
   111→│       ├── skincare.json            # Skincare routines
   112→│       └── style_guides.json        # Style recommendations
   113→
   114→looksmaxx-app/
   115→├── src/
   116→│   ├── contexts/
   117→│   │   └── PSLContext.tsx           # Enhanced PSL state
   118→│   │
   119→│   ├── components/
   120→│   │   └── psl/
   121→│   │       ├── PSLScoreCard.tsx     # Main score display
   122→│   │       ├── PSLBreakdown.tsx     # Component breakdown
   123→│   │       ├── TierBadge.tsx        # Tier visualization
   124→│   │       ├── ArchetypeCard.tsx    # Archetype display
   125→│   │       ├── HairstyleRecs.tsx    # Hairstyle recommendations
   126→│   │       ├── SkincareRoutine.tsx  # Skincare display
   127→│   │       ├── StyleGuide.tsx       # Style recommendations
   128→│   │       └── ActionPlan.tsx       # Prioritized improvements
   129→│   │
   130→│   └── lib/
   131→│       ├── psl-calculator.ts        # Client-side PSL logic
   132→│       └── archetype-classifier.ts  # Client-side classification
   133→```
   134→
   135→---
   136→
   137→## 2. PSL Scoring Formula
   138→
   139→### 2.1 Base Formula
   140→
   141→```
   142→PSL_Score = (Face × 0.75) + (Height × 0.20) + (Body × 0.05) + Bonuses
   143→```
   144→
   145→Where:
   146→- **Face** = Harmony score from landmark analysis (0-10)
   147→- **Height** = Height rating from lookup table (0-10)
   148→- **Body** = Body composition score from AI vision (0-10), defaults to 5.0 if not available
   149→- **Bonuses** = Threshold and synergy bonuses (0-0.85 max)
   150→
   151→### 2.2 Height Rating Table
   152→
   153→| Height (Male) | Rating | Height (Female) | Rating |
   154→|---------------|--------|-----------------|--------|
   155→| < 5'3" (160cm) | 1.0 | < 4'11" (150cm) | 1.0 |
   156→| 5'3" (160cm) | 2.0 | 4'11" (150cm) | 2.0 |
   157→| 5'5" (165cm) | 3.0 | 5'1" (155cm) | 3.5 |
   158→| 5'7" (170cm) | 4.0 | 5'3" (160cm) | 5.0 |
   159→| 5'9" (175cm) | 5.0 | 5'5" (165cm) | 6.0 |
   160→| 5'10" (178cm) | 5.5 | 5'6" (168cm) | 6.5 |
   161→| 5'11" (180cm) | 6.0 | 5'7" (170cm) | 7.0 |
   162→| 6'0" (183cm) | 7.0 | 5'8" (173cm) | 7.5 |
   163→| 6'1" (185cm) | 7.5 | 5'9" (175cm) | 8.0 |
   164→| 6'2" (188cm) | 8.0 | 5'10" (178cm) | 8.5 |
   165→| 6'3" (190cm) | 8.5 | 5'11" (180cm) | 9.0 |
   166→| 6'4" (193cm) | 9.0 | 6'0"+ (183cm+) | 9.0 (cap) |
   167→| 6'5"+ (196cm+) | 9.5 (diminishing) | - | - |
   168→
   169→### 2.3 Body Rating Scale
   170→
   171→| Body Fat % | Muscle Level | Rating | Description |
   172→|------------|--------------|--------|-------------|
   173→| 25%+ | Low | 2.0-3.0 | Overweight, no definition |
   174→| 20-25% | Low | 3.5-4.5 | Soft, minimal definition |
   175→| 18-22% | Medium | 5.0-5.5 | Average, some definition |
   176→| 15-18% | Medium | 6.0-6.5 | Lean, visible abs starting |
   177→| 12-15% | Medium-High | 7.0-7.5 | Athletic, clear definition |
   178→| 10-12% | High | 8.0-8.5 | Shredded, competition lean |
   179→| 8-10% | Very High | 9.0-9.5 | Elite physique |
   180→| < 8% | Extreme | 9.5+ | IFBB Pro tier |
   181→
   182→### 2.4 Bonus System
   183→
   184→#### Threshold Bonuses (when category ≥ 8.5)
   185→| Category | Bonus |
   186→|----------|-------|
   187→| Face ≥ 8.5 | +0.30 |
   188→| Height ≥ 8.5 | +0.20 |
   189→| Body ≥ 8.5 | +0.10 |
   190→
   191→#### Synergy Bonuses (when multiple categories ≥ 8.5)
   192→| Combination | Additional Bonus |
   193→|-------------|------------------|
   194→| Face + Height ≥ 8.5 | +0.15 |
   195→| Face + Body ≥ 8.5 | +0.10 |
   196→| Height + Body ≥ 8.5 | +0.05 |
   197→
   198→#### Triple Synergy (all three ≥ 8.5)
   199→- **+0.35** flat bonus (replaces pair bonuses, stacks with threshold bonuses)
   200→
   201→### 2.5 Constraints (Failos)
   202→
   203→| Constraint | Effect |
   204→|------------|--------|
   205→| Major facial failo present | Caps tier regardless of score |
   206→| Body < 5.0 | -0.3 to face perception |
   207→| Height < 8.0 rating | Cannot reach Gigachad tier |
   208→| Severe asymmetry | -0.5 penalty |
   209→
   210→### 2.6 Tier Classification
   211→
   212→| Tier | Score Range | Percentile | Description |
   213→|------|-------------|------------|-------------|
   214→| Deformity | 0.0 - 1.0 | Bottom 0.01% | Medical intervention territory |
   215→| Subhuman | 1.25 - 1.75 | Bottom 0.1% | Genetic outlier |
   216→| Incel | 2.0 - 3.0 | Bottom 2.5% | Visibly below average |
   217→| LTN (Low Tier Normie) | 3.5 - 4.5 | Bottom 13.59% | Somewhat unattractive |
   218→| MTN (Mid Tier Normie) | 4.75 - 5.25 | Middle 68% | True average |
   219→| HTN (High Tier Normie) | 5.5 - 6.5 | Top 13.59% | Somewhat attractive |
   220→| Chadlite | 7.0 - 8.0 | Top 2.5% | Attractive, local star |
   221→| Chad | 8.25 - 8.75 | Top 0.1% | Very attractive, elite |
   222→| Gigachad | 9.0 - 9.5 | Top 0.01% | Mythical tier |
   223→| True Mogger | 9.5+ | Apex | Theoretical limit |
   224→
   225→### 2.7 Implementation
   226→
   227→```typescript
   228→// psl-calculator.ts
   229→
   230→interface PSLInput {
   231→  faceScore: number;        // 0-10 from harmony analysis
   232→  heightCm: number;         // User input
   233→  gender: 'male' | 'female';
   234→  bodyAnalysis?: {          // From AI vision (paid)
   235→    bodyFatPercent: number;
   236→    muscleLevel: 'low' | 'medium' | 'medium-high' | 'high' | 'very-high' | 'extreme';
   237→  };
   238→  failos?: string[];        // Detected major failos
   239→}
   240→
   241→interface PSLResult {
   242→  score: number;            // Final PSL 0-10
   243→  tier: string;             // Tier name
   244→  percentile: number;       // Population percentile
   245→  breakdown: {
   246→    face: { raw: number; weighted: number };
   247→    height: { raw: number; weighted: number };
   248→    body: { raw: number; weighted: number };
   249→    bonuses: { threshold: number; synergy: number; total: number };
   250→    penalties: number;
   251→  };
   252→  potential: number;        // Estimated max with improvements
   253→}
   254→
   255→function calculatePSL(input: PSLInput): PSLResult {
   256→  // 1. Get height rating
   257→  const heightRating = getHeightRating(input.heightCm, input.gender);
   258→
   259→  // 2. Get body rating (default 5.0 if not available)
   260→  const bodyRating = input.bodyAnalysis
   261→    ? getBodyRating(input.bodyAnalysis.bodyFatPercent, input.bodyAnalysis.muscleLevel)
   262→    : 5.0;
   263→
   264→  // 3. Calculate base score
   265→  const faceWeighted = input.faceScore * 0.75;
   266→  const heightWeighted = heightRating * 0.20;
   267→  const bodyWeighted = bodyRating * 0.05;
   268→  let baseScore = faceWeighted + heightWeighted + bodyWeighted;
   269→
   270→  // 4. Calculate bonuses
   271→  let thresholdBonus = 0;
   272→  let synergyBonus = 0;
   273→
   274→  if (input.faceScore >= 8.5) thresholdBonus += 0.30;
   275→  if (heightRating >= 8.5) thresholdBonus += 0.20;
   276→  if (bodyRating >= 8.5) thresholdBonus += 0.10;
   277→
   278→  const highCount = [input.faceScore, heightRating, bodyRating].filter(s => s >= 8.5).length;
   279→
   280→  if (highCount === 3) {
   281→    synergyBonus = 0.35; // Triple synergy replaces pairs
   282→  } else if (highCount === 2) {
   283→    if (input.faceScore >= 8.5 && heightRating >= 8.5) synergyBonus += 0.15;
   284→    if (input.faceScore >= 8.5 && bodyRating >= 8.5) synergyBonus += 0.10;
   285→    if (heightRating >= 8.5 && bodyRating >= 8.5) synergyBonus += 0.05;
   286→  }
   287→
   288→  // 5. Apply penalties
   289→  let penalties = 0;
   290→  if (bodyRating < 5.0) penalties += 0.3;
   291→  if (input.failos?.includes('severe_asymmetry')) penalties += 0.5;
   292→
   293→  // 6. Final score
   294→  const finalScore = Math.min(10, Math.max(0, baseScore + thresholdBonus + synergyBonus - penalties));
   295→
   296→  // 7. Classify tier (with constraints)
   297→  const tier = classifyTier(finalScore, heightRating, input.failos);
   298→
   299→  return {
   300→    score: Math.round(finalScore * 100) / 100,
   301→    tier: tier.name,
   302→    percentile: tier.percentile,
   303→    breakdown: {
   304→      face: { raw: input.faceScore, weighted: faceWeighted },
   305→      height: { raw: heightRating, weighted: heightWeighted },
   306→      body: { raw: bodyRating, weighted: bodyWeighted },
   307→      bonuses: { threshold: thresholdBonus, synergy: synergyBonus, total: thresholdBonus + synergyBonus },
   308→      penalties,
   309→    },
   310→    potential: estimatePotential(input),
   311→  };
   312→}
   313→```
   314→
   315→---
   316→
   317→## 3. AI Vision Feature Extraction (Paid)
   318→
   319→### 3.1 Features Extracted
   320→
   321→#### From Face Photos
   322→
   323→| Feature | Scale | Description | Used For |
   324→|---------|-------|-------------|----------|
   325→| **Skin Clarity** | 0-10 | Overall skin quality | Skincare recommendations |
   326→| **Skin Tone** | Category | pale/fair/medium/olive/tan/dark | Style color matching |
   327→| **Acne Level** | none/mild/moderate/severe | Current breakout status | Skincare priority |
   328→| **Acne Scarring** | none/mild/moderate/severe | Historical scarring | Treatment recommendations |
   329→| **Pore Visibility** | minimal/visible/prominent | Pore size assessment | Skincare routine |
   330→| **Texture Issues** | list | Roughness, bumps, etc. | Targeted treatments |
   331→| **Hairline NW** | 0-7 | Norwood scale classification | Hairstyle recommendations |
   332→| **Hair Density** | thin/medium/thick | Hair thickness | Hairstyle options |
   333→| **Hair Texture** | straight/wavy/curly/coily | Natural texture | Styling recommendations |
   334→| **Hair Color** | Category | Natural color classification | Style matching |
   335→| **Eye Color** | Category | Iris color | Style color matching |
   336→| **Under-eye Darkness** | 0-10 | Dark circle severity | Skincare/concealer advice |
   337→| **Under-eye Puffiness** | 0-10 | Bag severity | Lifestyle recommendations |
   338→| **Hollow Cheeks** | 0-10 | Buccal fat assessment | Leanness indicator |
   339→| **Teeth Color** | white/off-white/yellow/stained | Tooth shade | Whitening recommendations |
   340→| **Teeth Alignment** | aligned/minor-issues/crooked | Orthodontic status | Treatment options |
   341→| **Eyebrow Density** | sparse/medium/thick | Brow fullness | Grooming advice |
   342→| **Facial Hair Potential** | low/medium/high | Beard growth capability | Style recommendations |
   343→
   344→#### From Physique Photo (Optional)
   345→
   346→| Feature | Scale | Description | Used For |
   347→|---------|-------|-------------|----------|
   348→| **Body Fat %** | 5-40% | Estimated body fat | Body score calculation |
   349→| **Muscle Mass** | low/medium/medium-high/high/very-high | Muscularity | Body score, archetype |
   350→| **Frame Size** | small/medium/large/very-large | Skeletal frame | Archetype classification |
   351→| **Shoulder Width** | narrow/average/broad/very-broad | Shoulder assessment | Style recommendations |
   352→| **Waist Definition** | undefined/slight/defined/very-defined | V-taper indicator | Physique score |
   353→| **Posture** | poor/fair/good/excellent | Standing posture | Improvement advice |
   354→
   355→### 3.2 Claude Vision Implementation
   356→
   357→```python
   358→# vision_service.py
   359→
   360→import anthropic
   361→from typing import Optional
   362→import base64
   363→
   364→class VisionService:
   365→    def __init__(self):
   366→        self.client = anthropic.Anthropic()
   367→        self.model = "claude-sonnet-4-20250514"
   368→
   369→    async def extract_features(
   370→        self,
   371→        front_photo_url: str,
   372→        side_photo_url: Optional[str] = None,
   373→        physique_photo_url: Optional[str] = None
   374→    ) -> VisionExtractionResult:
   375→
   376→        # Prepare images
   377→        images = [{"type": "image", "source": {"type": "url", "url": front_photo_url}}]
   378→        if side_photo_url:
   379→            images.append({"type": "image", "source": {"type": "url", "url": side_photo_url}})
   380→
   381→        # Face analysis prompt
   382→        face_prompt = """Analyze this face photo and extract the following features.
   383→        Return a JSON object with these exact keys:
   384→
   385→        {
   386→          "skin": {
   387→            "clarity": <0-10 score>,
   388→            "tone": "<pale|fair|medium|olive|tan|dark>",
   389→            "acne_level": "<none|mild|moderate|severe>",
   390→            "acne_scarring": "<none|mild|moderate|severe>",
   391→            "pore_visibility": "<minimal|visible|prominent>",
   392→            "texture_issues": ["<list of issues>"]
   393→          },
   394→          "hair": {
   395→            "hairline_nw": <0-7 Norwood scale>,
   396→            "density": "<thin|medium|thick>",
   397→            "texture": "<straight|wavy|curly|coily>",
   398→            "color": "<blonde|light-brown|brown|dark-brown|black|red|gray>"
   399→          },
   400→          "eyes": {
   401→            "color": "<blue|green|hazel|brown|dark-brown|black>",
   402→            "under_eye_darkness": <0-10>,
   403→            "under_eye_puffiness": <0-10>
   404→          },
   405→          "facial_features": {
   406→            "hollow_cheeks": <0-10>,
   407→            "eyebrow_density": "<sparse|medium|thick>",
   408→            "facial_hair_potential": "<low|medium|high>"
   409→          },
   410→          "teeth": {
   411→            "color": "<white|off-white|yellow|stained>",
   412→            "alignment": "<aligned|minor-issues|crooked>",
   413→            "visible_in_photo": <boolean>
   414→          }
   415→        }
   416→
   417→        Be objective and accurate. If a feature cannot be determined from the photo, use null.
   418→        """
   419→
   420→        response = await self.client.messages.create(
   421→            model=self.model,
   422→            max_tokens=1024,
   423→            messages=[{
   424→                "role": "user",
   425→                "content": [*images, {"type": "text", "text": face_prompt}]
   426→            }]
   427→        )
   428→
   429→        face_features = parse_json_response(response.content[0].text)
   430→
   431→        # Body analysis if physique photo provided
   432→        body_features = None
   433→        if physique_photo_url:
   434→            body_features = await self._analyze_physique(physique_photo_url)
   435→
   436→        return VisionExtractionResult(
   437→            face=face_features,
   438→            body=body_features
   439→        )
   440→
   441→    async def _analyze_physique(self, photo_url: str) -> BodyAnalysis:
   442→        body_prompt = """Analyze this physique photo and extract:
   443→
   444→        {
   445→          "body_fat_percent": <estimated 5-40%>,
   446→          "muscle_mass": "<low|medium|medium-high|high|very-high>",
   447→          "frame_size": "<small|medium|large|very-large>",
   448→          "shoulder_width": "<narrow|average|broad|very-broad>",
   449→          "waist_definition": "<undefined|slight|defined|very-defined>",
   450→          "posture": "<poor|fair|good|excellent>",
   451→          "estimated_height_category": "<short|average|tall|very-tall>"
   452→        }
   453→
   454→        Be objective. Base body fat estimate on visible definition and vascularity.
   455→        """
   456→
   457→        response = await self.client.messages.create(
   458→            model=self.model,
   459→            max_tokens=512,
   460→            messages=[{
   461→                "role": "user",
   462→                "content": [
   463→                    {"type": "image", "source": {"type": "url", "url": photo_url}},
   464→                    {"type": "text", "text": body_prompt}
   465→                ]
   466→            }]
   467→        )
   468→
   469→        return parse_json_response(response.content[0].text)
   470→```
   471→
   472→### 3.3 Caching Strategy
   473→
   474→- Vision extractions are cached per analysis ID
   475→- Cache invalidated if photos are updated
   476→- Results stored in `vision_extractions` table
   477→- TTL: Permanent (until analysis deleted)
   478→
   479→---
   480→
   481→## 4. Archetype Classification System
   482→
   483→### 4.1 Archetype Taxonomy
   484→
   485→```
   486→ARCHETYPES
   487→├── SOFTBOY (Low Dimorphism, Ectomorphic)
   488→│   ├── K-Pop Idol
   489→│   │   ├── Traits: East/SE Asian, flat midface, clear skin, styled hair
   490→│   │   ├── Style: Slim tailored, high contrast colors, layered hair
   491→│   │   └── Examples: BTS members, K-drama actors
   492→│   │
   493→│   ├── Softboy
   494→│   │   ├── Traits: Youthful, delicate features, slim build
   495→│   │   ├── Style: Oversized fits, light colors, long hair
   496→│   │   └── Examples: Timothée Chalamet, young Leonardo DiCaprio
   497→│   │
   498→│   └── Academic
   499→│       ├── Traits: Intellectual look, refined, understated
   500→│       ├── Style: Preppy, glasses, earth tones
   501→│       └── Examples: Young Hugh Grant
   502→│
   503→├── PRETTYBOY (Balanced Dimorphism, Good Harmony)
   504→│   ├── Skater
   505→│   │   ├── Traits: Casual cool, athletic lean, relaxed
   506→│   │   ├── Style: Streetwear, baggy pants, sneakers
   507→│   │   └── Examples: Young Heath Ledger
   508→│   │
   509→│   ├── Prettyboy
   510→│   │   ├── Traits: Symmetrical, harmonious, classic beauty
   511→│   │   ├── Style: Clean, fitted, minimal
   512→│   │   └── Examples: Francisco Lachowski, Sean O'Pry
   513→│   │
   514→│   └── Surfer
   515→│       ├── Traits: Sun-kissed, athletic, carefree
   516→│       ├── Style: Beach casual, natural fabrics
   517→│       └── Examples: Young Chris Hemsworth
   518→│
   519→├── ROBUST PRETTYBOY (Pretty + Edge/Intensity)
   520→│   ├── Fallen Angel
   521→│   │   ├── Traits: Ethereal, intense, mysterious
   522→│   │   ├── Style: Dark romantic, leather, black
   523→│   │   └── Examples: Young Jared Leto, Jordan Barrett
   524→│   │
   525→│   ├── Prince
   526→│   │   ├── Traits: Regal, refined, elegant
   527→│   │   ├── Style: Tailored suits, classic elegance
   528→│   │   └── Examples: Young Alain Delon, Matt Bomer
   529→│   │
   530→│   ├── Bad Boy
   531→│   │   ├── Traits: Rebellious, smoldering, dangerous appeal
   532→│   │   ├── Style: Leather jackets, boots, rough edges
   533→│   │   └── Examples: James Dean, Young Johnny Depp
   534→│   │
   535→│   └── Artist
   536→│       ├── Traits: Creative, unconventional, magnetic
   537→│       ├── Style: Eclectic, statement pieces
   538→│       └── Examples: Harry Styles, Zayn Malik
   539→│
   540→├── CHAD (High Dimorphism, Strong Features)
   541→│   ├── Vampire
   542→│   │   ├── Traits: Sharp features, pale, mysterious, hollow cheeks
   543→│   │   ├── Style: Dark, sophisticated, elegant
   544→│   │   └── Examples: Robert Pattinson, Ian Somerhalder
   545→│   │
   546→│   ├── Superman
   547→│   │   ├── Traits: Heroic, strong jaw, broad build, classic handsome
   548→│   │   ├── Style: Classic American, clean-cut
   549→│   │   └── Examples: Henry Cavill, David Gandy
   550→│   │
   551→│   ├── Jock
   552→│   │   ├── Traits: Athletic, confident, dominant presence
   553→│   │   ├── Style: Athletic wear, casual sporty
   554→│   │   └── Examples: Chris Evans, Michael B. Jordan
   555→│   │
   556→│   ├── Casanova
   557→│   │   ├── Traits: Charming, seductive, smooth
   558→│   │   ├── Style: Tailored, sophisticated, European
   559→│   │   └── Examples: George Clooney, Pierce Brosnan
   560→│   │
   561→│   ├── Executive
   562→│   │   ├── Traits: Powerful, authoritative, successful look
   563→│   │   ├── Style: Power suits, luxury watches
   564→│   │   └── Examples: Jon Hamm, Gabriel Macht
   565→│   │
   566→│   └── Pharaoh
   567→│       ├── Traits: Exotic, regal, chiseled, Middle Eastern features
   568→│       ├── Style: Luxurious, gold accents, designer
   569→│       └── Examples: Fares Fares, Egyptian models
   570→│
   571→├── HYPERMASCULINE (Extreme Masculine Features)
   572→│   ├── Aquaman
   573→│   │   ├── Traits: Tall, muscular, long hair, rugged handsome
   574→│   │   ├── Style: Relaxed, bohemian, natural fabrics
   575→│   │   └── Examples: Jason Momoa, Thor-era Chris Hemsworth
   576→│   │
   577→│   ├── Hypermasculine
   578→│   │   ├── Traits: Extreme bone structure, heavy brow, dominant
   579→│   │   ├── Style: Minimalist, masculine basics
   580→│   │   └── Examples: Dolph Lundgren (prime), Michael Fassbender
   581→│   │
   582→│   ├── Outlaw
   583→│   │   ├── Traits: Rough, weathered, dangerous
   584→│   │   ├── Style: Leather, denim, boots, rugged
   585→│   │   └── Examples: Young Clint Eastwood, Josh Brolin
   586→│   │
   587→│   └── Countryman
   588→│       ├── Traits: Rugged, outdoorsy, strong silent
   589→│       ├── Style: Workwear, flannel, boots
   590→│       └── Examples: Yellowstone cast, Young Sam Elliott
   591→│
   592→└── OGRE (Maximum Size/Mass)
   593→    ├── Viking
   594→    │   ├── Traits: Massive, bearded, warrior look, Norse features
   595→    │   ├── Style: Rugged, fur, leather, minimalist
   596→    │   └── Examples: Hafþór Björnsson, Alexander Skarsgård (Northman)
   597→    │
   598→    └── Bodybuilder
   599→        ├── Traits: Extreme muscle, massive frame, imposing
   600→        ├── Style: Fitted to show physique, tank tops
   601→        └── Examples: Arnold Schwarzenegger (prime), Dwayne Johnson
   602→```
   603→
   604→### 4.2 Classification Criteria
   605→
   606→#### Input Features for Classification
   607→
   608→| Feature | Source | Weight |
   609→|---------|--------|--------|
   610→| Gonial Angle | Landmarks | High |
   611→| Facial Width/Height Ratio | Landmarks | High |
   612→| Brow Ridge Prominence | Landmarks + Vision | Medium |
   613→| Cheekbone Height | Landmarks | Medium |
   614→| Eye Area Score | Landmarks | Medium |
   615→| Dimorphism Level | Computed | High |
   616→| Body Type | Vision (physique) | Medium |
   617→| Frame Size | Vision | Medium |
   618→| Ethnicity | User input | Medium |
   619→| Hollow Cheeks | Vision | Low |
   620→| Skin Tone | Vision | Low |
   621→
   622→#### Dimorphism Classification
   623→
   624→| Level | Gonial Angle | Brow Ridge | Jaw Definition | Features |
   625→|-------|--------------|------------|----------------|----------|
   626→| Low | ≥ 130° | Minimal | Soft, undefined | Neotenous, youthful |
   627→| Low-Balanced | 125-130° | Slight | Harmonious soft | Balanced but softer |
   628→| Balanced | 118-125° | Moderate | Neutral | Neither masc nor fem |
   629→| Above-Average | 115-120° | Moderate+ | Defined | Leaning masculine |
   630→| High | 110-118° | Prominent | Very defined | Strongly masculine |
   631→| Very High | < 110° | Heavy | Extremely defined | Hypermasculine |
   632→
   633→#### Body Type Classification
   634→
   635→| Type | Shoulder-Waist Ratio | Build | Archetype Fit |
   636→|------|---------------------|-------|---------------|
   637→| Ectomorphic | < 1.35 | Slim, lean | Softboy, Prettyboy |
   638→| Ecto-Mesomorphic | 1.35-1.45 | Lean athletic | Robust Prettyboy, Vampire Chad |
   639→| Mesomorphic | 1.45-1.55 | Athletic | Chad, Jock |
   640→| Endo-Mesomorphic | > 1.55, high muscle | Muscular large | Hypermasculine, Aquaman |
   641→| Meso-Endomorphic | > 1.45, higher BF | Thick, strong | Ogre, Viking |
   642→
   643→### 4.3 Classification Algorithm
   644→
   645→```typescript
   646→// archetype-classifier.ts
   647→
   648→interface ClassificationInput {
   649→  // From landmarks
   650→  gonialAngle: number;
   651→  fwhr: number;
   652→  browRidgeProminence: number;
   653→  cheekboneHeight: number;
   654→  eyeAreaScore: number;
   655→
   656→  // Computed
   657→  dimorphismLevel: DimorphismLevel;
   658→
   659→  // From vision (if available)
   660→  hollowCheeks?: number;
   661→  skinTone?: string;
   662→
   663→  // From physique (if available)
   664→  bodyType?: BodyType;
   665→  frameSize?: FrameSize;
   666→
   667→  // User input
   668→  ethnicity: string;
   669→  gender: 'male' | 'female';
   670→}
   671→
   672→interface ArchetypeResult {
   673→  primary: {
   674→    category: string;      // e.g., "Chad"
   675→    subArchetype: string;  // e.g., "Vampire"
   676→    confidence: number;    // 0-1
   677→  };
   678→  secondary: {
   679→    category: string;
   680→    subArchetype: string;
   681→    confidence: number;
   682→  };
   683→  traits: string[];
   684→  styleGuide: StyleRecommendation;
   685→  transitionPath?: {
   686→    target: string;
   687→    requirements: string[];
   688→  };
   689→}
   690→
   691→function classifyArchetype(input: ClassificationInput): ArchetypeResult {
   692→  const scores: Record<string, number> = {};
   693→
   694→  // Score each main category
   695→  scores.Softboy = scoreSoftboy(input);
   696→  scores.Prettyboy = scorePrettyboy(input);
   697→  scores.RobustPrettyboy = scoreRobustPrettyboy(input);
   698→  scores.Chad = scoreChad(input);
   699→  scores.Hypermasculine = scoreHypermasculine(input);
   700→  scores.Ogre = scoreOgre(input);
   701→
   702→  // Get top 2 categories
   703→  const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
   704→  const primaryCategory = sorted[0][0];
   705→  const secondaryCategory = sorted[1][0];
   706→
   707→  // Determine sub-archetype within primary
   708→  const primarySub = classifySubArchetype(primaryCategory, input);
   709→  const secondarySub = classifySubArchetype(secondaryCategory, input);
   710→
   711→  return {
   712→    primary: {
   713→      category: primaryCategory,
   714→      subArchetype: primarySub.name,
   715→      confidence: sorted[0][1] / 100,
   716→    },
   717→    secondary: {
   718→      category: secondaryCategory,
   719→      subArchetype: secondarySub.name,
   720→      confidence: sorted[1][1] / 100,
   721→    },
   722→    traits: [...primarySub.traits, ...secondarySub.traits.slice(0, 2)],
   723→    styleGuide: getStyleGuide(primaryCategory, primarySub.name),
   724→    transitionPath: getTransitionPath(primaryCategory, sorted),
   725→  };
   726→}
   727→
   728→function scoreChad(input: ClassificationInput): number {
   729→  let score = 0;
   730→
   731→  // Gonial angle (strong jaw)
   732→  if (input.gonialAngle <= 120) score += 25;
   733→  else if (input.gonialAngle <= 125) score += 15;
   734→
   735→  // High dimorphism
   736→  if (input.dimorphismLevel === 'high') score += 25;
   737→  else if (input.dimorphismLevel === 'above-average') score += 15;
   738→
   739→  // Brow ridge
   740→  if (input.browRidgeProminence >= 7) score += 15;
   741→
   742→  // Body type
   743→  if (input.bodyType === 'mesomorphic') score += 15;
   744→  else if (input.bodyType === 'ecto-mesomorphic') score += 10;
   745→
   746→  // Hollow cheeks (vampire sub-type indicator)
   747→  if (input.hollowCheeks && input.hollowCheeks >= 7) score += 10;
   748→
   749→  // Frame
   750→  if (input.frameSize === 'large') score += 10;
   751→
   752→  return score;
   753→}
   754→
   755→// Similar scoring functions for other categories...
   756→```
   757→
   758→---
   759→
   760→## 5. Advice Generation Engine
   761→
   762→### 5.1 Advice Categories
   763→
   764→1. **Hairstyle Recommendations**
   765→2. **Skincare Routine**
   766→3. **Style Guide** (clothing, colors, accessories)
   767→4. **Grooming Guide** (facial hair, eyebrows, etc.)
   768→5. **Physique Recommendations**
   769→6. **Action Plan** (prioritized improvements)
   770→
   771→### 5.2 Hairstyle Recommendations
   772→
   773→#### Face Shape Detection (from landmarks)
   774→
   775→| Face Shape | Characteristics | Detection Criteria |
   776→|------------|-----------------|-------------------|
   777→| Oval | Balanced, slightly longer | FWHR 1.4-1.6, cheekbones widest |
   778→| Round | Wide, soft angles | FWHR > 1.6, minimal jaw definition |
   779→| Square | Strong jaw, equal width/length | FWHR ≈ 1.5, wide bigonial |
   780→| Oblong | Long, narrow | FWHR < 1.4, high forehead |
   781→| Heart | Wide forehead, narrow chin | Wide temples, narrow lower third |
   782→| Diamond | Narrow forehead/chin, wide cheeks | High cheekbones, narrow bigonial |
   783→
   784→#### Hairstyle Database Structure
   785→
   786→```json
   787→{
   788→  "hairstyles": [
   789→    {
   790→      "id": "textured-fringe",
   791→      "name": "Textured Fringe",
   792→      "description": "Layered top with textured fringe covering forehead",
   793→      "face_shapes": ["oblong", "heart", "diamond"],
   794→      "hairline_max_nw": 2,
   795→      "hair_textures": ["straight", "wavy"],
   796→      "archetypes": ["Prettyboy", "Softboy", "RobustPrettyboy"],
   797→      "maintenance": "medium",
   798→      "styling_time": "5-10 min",
   799→      "products": ["texturizing paste", "sea salt spray"],
   800→      "reference_images": ["url1", "url2"]
   801→    },
   802→    {
   803→      "id": "slicked-back",
   804→      "name": "Slicked Back",
   805→      "description": "Hair pushed back with product for clean look",
   806→      "face_shapes": ["oval", "square", "diamond"],
   807→      "hairline_max_nw": 1,
   808→      "hair_textures": ["straight", "wavy"],
   809→      "archetypes": ["Chad", "Executive", "Prince"],
   810→      "maintenance": "low",
   811→      "styling_time": "2-5 min",
   812→      "products": ["pomade", "gel"],
   813→      "reference_images": ["url1", "url2"]
   814→    },
   815→    {
   816→      "id": "buzz-cut",
   817→      "name": "Buzz Cut",
   818→      "description": "Very short all around, low maintenance",
   819→      "face_shapes": ["oval", "square"],
   820→      "hairline_max_nw": 7,
   821→      "hair_textures": ["any"],
   822→      "archetypes": ["Hypermasculine", "Jock", "Ogre"],
   823→      "maintenance": "very-low",
   824→      "styling_time": "0 min",
   825→      "products": [],
   826→      "reference_images": ["url1", "url2"]
   827→    }
   828→    // ... more hairstyles
   829→  ]
   830→}
   831→```
   832→
   833→#### Recommendation Logic
   834→
   835→```typescript
   836→function recommendHairstyles(
   837→  faceShape: FaceShape,
   838→  hairlineNW: number,
   839→  hairTexture: string,
   840→  archetype: ArchetypeResult,
   841→  preferences?: { maintenance?: string }
   842→): HairstyleRecommendation[] {
   843→
   844→  return HAIRSTYLES
   845→    .filter(h => h.face_shapes.includes(faceShape))
   846→    .filter(h => h.hairline_max_nw >= hairlineNW)
   847→    .filter(h => h.hair_textures.includes(hairTexture) || h.hair_textures.includes('any'))
   848→    .filter(h => h.archetypes.some(a =>
   849→      a === archetype.primary.category || a === archetype.primary.subArchetype
   850→    ))
   851→    .sort((a, b) => {
   852→      // Prioritize by archetype match strength
   853→      const aMatch = getArchetypeMatchScore(a, archetype);
   854→      const bMatch = getArchetypeMatchScore(b, archetype);
   855→      return bMatch - aMatch;
   856→    })
   857→    .slice(0, 5);
   858→}
   859→```
   860→
   861→### 5.3 Skincare Routine Generation
   862→
   863→#### Routine Structure
   864→
   865→```typescript
   866→interface SkincareRoutine {
   867→  morning: SkincareStep[];
   868→  evening: SkincareStep[];
   869→  weekly: SkincareStep[];
   870→  targetedTreatments: Treatment[];
   871→}
   872→
   873→interface SkincareStep {
   874→  order: number;
   875→  type: 'cleanser' | 'toner' | 'serum' | 'moisturizer' | 'sunscreen' | 'treatment';
   876→  product: {
   877→    name: string;
   878→    ingredients: string[];
   879→    purpose: string;
   880→  };
   881→  frequency: 'daily' | 'alternate' | 'weekly';
   882→  notes?: string;
   883→}
   884→```
   885→
   886→#### Routine Logic Based on Skin Analysis
   887→
   888→```typescript
   889→function generateSkincareRoutine(skinAnalysis: SkinAnalysis): SkincareRoutine {
   890→  const routine: SkincareRoutine = {
   891→    morning: [],
   892→    evening: [],
   893→    weekly: [],
   894→    targetedTreatments: [],
   895→  };
   896→
   897→  // Morning routine (always)
   898→  routine.morning.push(
   899→    { order: 1, type: 'cleanser', product: getCleanser(skinAnalysis) },
   900→    { order: 2, type: 'moisturizer', product: getMoisturizer(skinAnalysis) },
   901→    { order: 3, type: 'sunscreen', product: { name: 'SPF 50+ Sunscreen', ingredients: ['zinc oxide'], purpose: 'UV protection' } }
   902→  );
   903→
   904→  // Evening routine (always)
   905→  routine.evening.push(
   906→    { order: 1, type: 'cleanser', product: getCleanser(skinAnalysis) },
   907→    { order: 2, type: 'treatment', product: getEveningTreatment(skinAnalysis) },
   908→    { order: 3, type: 'moisturizer', product: getMoisturizer(skinAnalysis) }
   909→  );
   910→
   911→  // Add targeted treatments based on issues
   912→  if (skinAnalysis.acne_level !== 'none') {
   913→    routine.targetedTreatments.push({
   914→      concern: 'acne',
   915→      product: 'Benzoyl Peroxide 2.5% or Salicylic Acid 2%',
   916→      frequency: 'daily',
   917→      notes: 'Apply to affected areas only'
   918→    });
   919→  }
   920→
   921→  if (skinAnalysis.acne_scarring !== 'none') {
   922→    routine.targetedTreatments.push({
   923→      concern: 'scarring',
   924→      product: 'Vitamin C Serum (morning) + Retinol (evening)',
   925→      frequency: 'daily',
   926→      notes: 'Start retinol slowly, 2x/week then increase'
   927→    });
   928→  }
   929→
   930→  if (skinAnalysis.under_eye_darkness >= 6) {
   931→    routine.targetedTreatments.push({
   932→      concern: 'dark circles',
   933→      product: 'Caffeine Eye Serum + Vitamin K cream',
   934→      frequency: 'twice daily',
   935→      notes: 'Also improve sleep and hydration'
   936→    });
   937→  }
   938→
   939→  // Weekly treatments
   940→  if (skinAnalysis.pore_visibility !== 'minimal') {
   941→    routine.weekly.push({
   942→      order: 1,
   943→      type: 'treatment',
   944→      product: { name: 'Clay Mask', ingredients: ['kaolin', 'bentonite'], purpose: 'Deep pore cleansing' },
   945→      frequency: 'weekly'
   946→    });
   947→  }
   948→
   949→  return routine;
   950→}
   951→```
   952→
   953→### 5.4 Style Guide Generation
   954→
   955→```typescript
   956→interface StyleGuide {
   957→  archetype: string;
   958→  subArchetype: string;
   959→
   960→  clothing: {
   961→    essentials: ClothingItem[];
   962→    fits: string[];
   963→    avoid: string[];
   964→  };
   965→
   966→  colors: {
   967→    primary: string[];      // Best colors based on skin tone
   968→    accent: string[];       // Accent colors
   969→    avoid: string[];        // Colors to avoid
   970→  };
   971→
   972→  accessories: {
   973→    recommended: Accessory[];
   974→    optional: Accessory[];
   975→  };
   976→
   977→  grooming: {
   978→    facialHair: string;     // Recommendation based on features
   979→    eyebrows: string;
   980→    hair: string;           // Reference to hairstyle recs
   981→  };
   982→
   983→  inspirationImages: string[];
   984→  celebrityReferences: string[];
   985→}
   986→
   987→function generateStyleGuide(
   988→  archetype: ArchetypeResult,
   989→  skinTone: string,
   990→  visionFeatures: VisionFeatures
   991→): StyleGuide {
   992→
   993→  const baseGuide = STYLE_GUIDES[archetype.primary.subArchetype];
   994→
   995→  // Customize colors based on skin tone
   996→  const colors = getColorPalette(skinTone, archetype);
   997→
   998→  // Facial hair recommendation
   999→  const facialHair = recommendFacialHair(
  1000→    archetype,
  1001→    visionFeatures.facial_hair_potential,
  1002→    visionFeatures.hollow_cheeks
  1003→  );
  1004→
  1005→  return {
  1006→    ...baseGuide,
  1007→    colors,
  1008→    grooming: {
  1009→      facialHair,
  1010→      eyebrows: recommendEyebrowGrooming(visionFeatures.eyebrow_density),
  1011→      hair: 'See hairstyle recommendations',
  1012→    },
  1013→  };
  1014→}
  1015→```
  1016→
  1017→### 5.5 Action Plan Generation
  1018→
  1019→```typescript
  1020→interface ActionPlan {
  1021→  tier: 'foundation' | 'enhancement' | 'advanced';
  1022→  items: ActionItem[];
  1023→  estimatedTimeframe: string;
  1024→  estimatedCost: CostRange;
  1025→  potentialPSLGain: number;
  1026→}
  1027→
  1028→interface ActionItem {
  1029→  priority: number;
  1030→  category: 'skincare' | 'hair' | 'physique' | 'style' | 'dental' | 'surgical';
  1031→  action: string;
  1032→  reason: string;
  1033→  impact: 'high' | 'medium' | 'low';
  1034→  difficulty: 'easy' | 'medium' | 'hard';
  1035→  timeframe: string;
  1036→  cost: CostRange;
  1037→  linkedFlaw?: string;
  1038→}
  1039→
  1040→function generateActionPlan(
  1041→  flaws: Flaw[],
  1042→  strengths: Strength[],
  1043→  visionFeatures: VisionFeatures,
  1044→  archetype: ArchetypeResult,
  1045→  userPreferences: { budget: string; timeline: string }
  1046→): ActionPlan[] {
  1047→
  1048→  const items: ActionItem[] = [];
  1049→
  1050→  // 1. Foundation tier (softmaxxing, low cost, high impact)
  1051→
  1052→  // Skincare if issues detected
  1053→  if (visionFeatures.skin.acne_level !== 'none' || visionFeatures.skin.clarity < 7) {
  1054→    items.push({
  1055→      priority: 1,
  1056→      category: 'skincare',
  1057→      action: 'Establish consistent skincare routine',
  1058→      reason: `Current skin clarity: ${visionFeatures.skin.clarity}/10`,
  1059→      impact: 'high',
  1060→      difficulty: 'easy',
  1061→      timeframe: '2-4 weeks for visible improvement',
  1062→      cost: { min: 30, max: 100, currency: 'USD', frequency: 'monthly' },
  1063→    });
  1064→  }
  1065→
  1066→  // Haircut if not matching archetype
  1067→  items.push({
  1068→    priority: 2,
  1069→    category: 'hair',
  1070→    action: `Get archetype-matched haircut (${archetype.primary.subArchetype} style)`,
  1071→    reason: 'Hairstyle should complement face shape and archetype',
  1072→    impact: 'high',
  1073→    difficulty: 'easy',
  1074→    timeframe: 'Immediate',
  1075→    cost: { min: 20, max: 80, currency: 'USD', frequency: 'monthly' },
  1076→  });
  1077→
  1078→  // Physique if needed
  1079→  if (visionFeatures.body && visionFeatures.body.body_fat_percent > 18) {
  1080→    items.push({
  1081→      priority: 3,
  1082→      category: 'physique',
  1083→      action: 'Reduce body fat to 12-15% range',
  1084→      reason: `Current estimated BF: ${visionFeatures.body.body_fat_percent}%. Lower BF reveals facial definition and hollow cheeks.`,
  1085→      impact: 'high',
  1086→      difficulty: 'medium',
  1087→      timeframe: '3-6 months',
  1088→      cost: { min: 0, max: 100, currency: 'USD', frequency: 'monthly' },
  1089→    });
  1090→  }
  1091→
  1092→  // Style update
  1093→  items.push({
  1094→    priority: 4,
  1095→    category: 'style',
  1096→    action: `Adopt ${archetype.primary.subArchetype} wardrobe essentials`,
  1097→    reason: 'Clothing should reinforce your natural archetype',
  1098→    impact: 'medium',
  1099→    difficulty: 'easy',
  1100→    timeframe: '1-2 weeks',
  1101→    cost: { min: 200, max: 500, currency: 'USD', frequency: 'one-time' },
  1102→  });
  1103→
  1104→  // Dental if issues
  1105→  if (visionFeatures.teeth.color !== 'white') {
  1106→    items.push({
  1107→      priority: 5,
  1108→      category: 'dental',
  1109→      action: 'Whiten teeth',
  1110→      reason: `Current tooth color: ${visionFeatures.teeth.color}`,
  1111→      impact: 'medium',
  1112→      difficulty: 'easy',
  1113→      timeframe: '2-4 weeks',
  1114→      cost: { min: 30, max: 500, currency: 'USD', frequency: 'one-time' },
  1115→    });
  1116→  }
  1117→
  1118→  // 2. Enhancement tier (from existing flaws)
  1119→  flaws.forEach((flaw, index) => {
  1120→    const treatment = findBestTreatment(flaw);
  1121→    if (treatment && treatment.phase !== 'Surgical') {
  1122→      items.push({
  1123→        priority: 10 + index,
  1124→        category: treatment.category,
  1125→        action: treatment.name,
  1126→        reason: flaw.summary,
  1127→        impact: treatment.impact > 0.5 ? 'high' : 'medium',
  1128→        difficulty: 'medium',
  1129→        timeframe: treatment.timeline,
  1130→        cost: treatment.cost,
  1131→        linkedFlaw: flaw.id,
  1132→      });
  1133→    }
  1134→  });
  1135→
  1136→  // Sort by priority and group into tiers
  1137→  const sorted = items.sort((a, b) => a.priority - b.priority);
  1138→
  1139→  return [
  1140→    {
  1141→      tier: 'foundation',
  1142→      items: sorted.filter(i => i.priority <= 5),
  1143→      estimatedTimeframe: '1-3 months',
  1144→      estimatedCost: sumCosts(sorted.filter(i => i.priority <= 5)),
  1145→      potentialPSLGain: 0.5,
  1146→    },
  1147→    {
  1148→      tier: 'enhancement',
  1149→      items: sorted.filter(i => i.priority > 5 && i.priority <= 15),
  1150→      estimatedTimeframe: '3-6 months',
  1151→      estimatedCost: sumCosts(sorted.filter(i => i.priority > 5 && i.priority <= 15)),
  1152→      potentialPSLGain: 1.0,
  1153→    },
  1154→    {
  1155→      tier: 'advanced',
  1156→      items: sorted.filter(i => i.priority > 15),
  1157→      estimatedTimeframe: '6-12 months',
  1158→      estimatedCost: sumCosts(sorted.filter(i => i.priority > 15)),
  1159→      potentialPSLGain: 0.5,
  1160→    },
  1161→  ];
  1162→}
  1163→```
  1164→
  1165→---
  1166→
  1167→## 6. Database Schema
  1168→
  1169→### 6.1 New Tables
  1170→
  1171→```sql
  1172→-- Enhanced user profile
  1173→ALTER TABLE users ADD COLUMN IF NOT EXISTS height_cm INTEGER;
  1174→ALTER TABLE users ADD COLUMN IF NOT EXISTS physique_photo_url TEXT;
  1175→ALTER TABLE users ADD COLUMN IF NOT EXISTS psl_tier VARCHAR(20);
  1176→
  1177→-- Vision extractions (cached AI analysis)
  1178→CREATE TABLE vision_extractions (
  1179→    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  1180→    analysis_id UUID NOT NULL REFERENCES analyses(id) ON DELETE CASCADE,
  1181→    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  1182→
  1183→    -- Face features
  1184→    skin_clarity DECIMAL(3,2),
  1185→    skin_tone VARCHAR(50),
  1186→    acne_level VARCHAR(20),
  1187→    acne_scarring VARCHAR(20),
  1188→    pore_visibility VARCHAR(20),
  1189→    texture_issues JSONB,
  1190→
  1191→    -- Hair features
  1192→    hairline_nw INTEGER,
  1193→    hair_density VARCHAR(20),
  1194→    hair_texture VARCHAR(20),
  1195→    hair_color VARCHAR(50),
  1196→
  1197→    -- Eye features
  1198→    eye_color VARCHAR(50),
  1199→    under_eye_darkness DECIMAL(3,2),
  1200→    under_eye_puffiness DECIMAL(3,2),
  1201→
  1202→    -- Facial features
  1203→    hollow_cheeks DECIMAL(3,2),
  1204→    eyebrow_density VARCHAR(20),
  1205→    facial_hair_potential VARCHAR(20),
  1206→
  1207→    -- Teeth
  1208→    teeth_color VARCHAR(20),
  1209→    teeth_alignment VARCHAR(20),
  1210→
  1211→    -- Body (if physique photo provided)
  1212→    body_fat_percent DECIMAL(4,1),
  1213→    muscle_mass VARCHAR(20),
  1214→    frame_size VARCHAR(20),
  1215→    shoulder_width VARCHAR(20),
  1216→    waist_definition VARCHAR(20),
  1217→    posture VARCHAR(20),
  1218→
  1219→    -- Metadata
  1220→    raw_response JSONB,
  1221→    created_at TIMESTAMP DEFAULT NOW(),
  1222→
  1223→    UNIQUE(analysis_id)
  1224→);
  1225→
  1226→-- PSL scores (enhanced)
  1227→CREATE TABLE psl_scores (
  1228→    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  1229→    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  1230→    analysis_id UUID NOT NULL REFERENCES analyses(id) ON DELETE CASCADE,
  1231→
  1232→    -- Component scores
  1233→    face_score DECIMAL(4,2) NOT NULL,
  1234→    height_score DECIMAL(4,2) NOT NULL,
  1235→    body_score DECIMAL(4,2),
  1236→
  1237→    -- Bonuses
  1238→    threshold_bonus DECIMAL(4,2) DEFAULT 0,
  1239→    synergy_bonus DECIMAL(4,2) DEFAULT 0,
  1240→    penalties DECIMAL(4,2) DEFAULT 0,
  1241→
  1242→    -- Final
  1243→    total_score DECIMAL(4,2) NOT NULL,
  1244→    tier VARCHAR(20) NOT NULL,
  1245→    percentile DECIMAL(5,2),
  1246→
  1247→    -- Potential
  1248→    potential_score DECIMAL(4,2),
  1249→
  1250→    created_at TIMESTAMP DEFAULT NOW(),
  1251→
  1252→    UNIQUE(analysis_id)
  1253→);
  1254→
  1255→-- Archetype classifications
  1256→CREATE TABLE archetype_results (
  1257→    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  1258→    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  1259→    analysis_id UUID NOT NULL REFERENCES analyses(id) ON DELETE CASCADE,
  1260→
  1261→    -- Primary archetype
  1262→    primary_category VARCHAR(50) NOT NULL,
  1263→    primary_sub_archetype VARCHAR(50) NOT NULL,
  1264→    primary_confidence DECIMAL(3,2) NOT NULL,
  1265→
  1266→    -- Secondary archetype
  1267→    secondary_category VARCHAR(50),
  1268→    secondary_sub_archetype VARCHAR(50),
  1269→    secondary_confidence DECIMAL(3,2),
  1270→
  1271→    -- Details
  1272→    traits JSONB,
  1273→    style_guide JSONB,
  1274→    transition_path JSONB,
  1275→
  1276→    created_at TIMESTAMP DEFAULT NOW(),
  1277→
  1278→    UNIQUE(analysis_id)
  1279→);
  1280→
  1281→-- Generated advice
  1282→CREATE TABLE advice_results (
  1283→    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  1284→    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  1285→    analysis_id UUID NOT NULL REFERENCES analyses(id) ON DELETE CASCADE,
  1286→
  1287→    -- Recommendations
  1288→    hairstyle_recommendations JSONB,
  1289→    skincare_routine JSONB,
  1290→    style_guide JSONB,
  1291→    grooming_guide JSONB,
  1292→    action_plan JSONB,
  1293→
  1294→    -- User preferences used
  1295→    budget VARCHAR(20),
  1296→    timeline VARCHAR(20),
  1297→    goals JSONB,
  1298→
  1299→    created_at TIMESTAMP DEFAULT NOW(),
  1300→
  1301→    UNIQUE(analysis_id)
  1302→);
  1303→
  1304→-- Indexes
  1305→CREATE INDEX idx_vision_extractions_analysis ON vision_extractions(analysis_id);
  1306→CREATE INDEX idx_vision_extractions_user ON vision_extractions(user_id);
  1307→CREATE INDEX idx_psl_scores_analysis ON psl_scores(analysis_id);
  1308→CREATE INDEX idx_psl_scores_user ON psl_scores(user_id);
  1309→CREATE INDEX idx_archetype_results_analysis ON archetype_results(analysis_id);
  1310→CREATE INDEX idx_advice_results_analysis ON advice_results(analysis_id);
  1311→```
  1312→
  1313→---
  1314→
  1315→## 7. API Endpoints
  1316→
  1317→### 7.1 PSL Endpoints
  1318→
  1319→| Endpoint | Method | Auth | Paid | Description |
  1320→|----------|--------|------|------|-------------|
  1321→| `/psl/calculate` | POST | Yes | No | Calculate PSL from face + height |
  1322→| `/psl/calculate-full` | POST | Yes | Yes | Calculate PSL with AI vision + body |
  1323→| `/psl/{analysis_id}` | GET | Yes | No | Get stored PSL score |
  1324→
  1325→#### POST /psl/calculate
  1326→```json
  1327→// Request
  1328→{
  1329→  "analysis_id": "uuid",
  1330→  "height_cm": 180
  1331→}
  1332→
  1333→// Response
  1334→{
  1335→  "score": 6.75,
  1336→  "tier": "HTN",
  1337→  "percentile": 78.5,
  1338→  "breakdown": {
  1339→    "face": { "raw": 7.2, "weighted": 5.4 },
  1340→    "height": { "raw": 7.0, "weighted": 1.4 },
  1341→    "body": { "raw": 5.0, "weighted": 0.25 },
  1342→    "bonuses": { "threshold": 0, "synergy": 0, "total": 0 },
  1343→    "penalties": 0
  1344→  },
  1345→  "potential": 7.8
  1346→}
  1347→```
  1348→
  1349→### 7.2 Vision Endpoints (Paid)
  1350→
  1351→| Endpoint | Method | Auth | Paid | Description |
  1352→|----------|--------|------|------|-------------|
  1353→| `/vision/extract` | POST | Yes | Yes | Extract features from photos |
  1354→| `/vision/extract-body` | POST | Yes | Yes | Analyze physique photo |
  1355→| `/vision/{analysis_id}` | GET | Yes | Yes | Get stored vision extraction |
  1356→
  1357→#### POST /vision/extract
  1358→```json
  1359→// Request
  1360→{
  1361→  "analysis_id": "uuid",
  1362→  "include_body": false
  1363→}
  1364→
  1365→// Response
  1366→{
  1367→  "extraction_id": "uuid",
  1368→  "face": {
  1369→    "skin": {
  1370→      "clarity": 7.5,
  1371→      "tone": "medium",
  1372→      "acne_level": "mild",
  1373→      "acne_scarring": "none",
  1374→      "pore_visibility": "visible"
  1375→    },
  1376→    "hair": {
  1377→      "hairline_nw": 1,
  1378→      "density": "thick",
  1379→      "texture": "wavy",
  1380→      "color": "dark-brown"
  1381→    },
  1382→    "eyes": {
  1383→      "color": "brown",
  1384→      "under_eye_darkness": 4.5,
  1385→      "under_eye_puffiness": 2.0
  1386→    },
  1387→    "facial_features": {
  1388→      "hollow_cheeks": 6.5,
  1389→      "eyebrow_density": "thick",
  1390→      "facial_hair_potential": "high"
  1391→    },
  1392→    "teeth": {
  1393→      "color": "off-white",
  1394→      "alignment": "aligned"
  1395→    }
  1396→  },
  1397→  "body": null
  1398→}
  1399→```
  1400→
  1401→### 7.3 Archetype Endpoints
  1402→
  1403→| Endpoint | Method | Auth | Paid | Description |
  1404→|----------|--------|------|------|-------------|
  1405→| `/archetype/classify` | POST | Yes | No* | Classify archetype (enhanced with vision if paid) |
  1406→| `/archetype/{analysis_id}` | GET | Yes | No | Get stored archetype |
  1407→| `/archetype/styles` | GET | No | No | Get all style guides |
  1408→
  1409→### 7.4 Advice Endpoints (Paid)
  1410→
  1411→| Endpoint | Method | Auth | Paid | Description |
  1412→|----------|--------|------|------|-------------|
  1413→| `/advice/generate` | POST | Yes | Yes | Generate full advice package |
  1414→| `/advice/hairstyles` | GET | Yes | Yes | Get hairstyle recommendations |
  1415→| `/advice/skincare` | GET | Yes | Yes | Get skincare routine |
  1416→| `/advice/style` | GET | Yes | Yes | Get style guide |
  1417→| `/advice/action-plan` | GET | Yes | Yes | Get action plan |
  1418→| `/advice/{analysis_id}` | GET | Yes | Yes | Get all stored advice |
  1419→
  1420→#### POST /advice/generate
  1421→```json
  1422→// Request
  1423→{
  1424→  "analysis_id": "uuid",
  1425→  "preferences": {
  1426→    "budget": "medium",
  1427→    "timeline": "6mo",
  1428→    "goals": ["dating", "confidence"]
  1429→  }
  1430→}
  1431→
  1432→// Response
  1433→{
  1434→  "advice_id": "uuid",
  1435→  "hairstyles": [...],
  1436→  "skincare": {...},
  1437→  "style_guide": {...},
  1438→  "grooming": {...},
  1439→  "action_plan": [...]
  1440→}
  1441→```
  1442→
  1443→---
  1444→
  1445→## 8. Frontend Components
  1446→
  1447→### 8.1 Component Structure
  1448→
  1449→```
  1450→src/components/psl/
  1451→├── PSLScoreCard.tsx          # Main score display with tier badge
  1452→├── PSLBreakdown.tsx          # Visual breakdown (face/height/body pie)
  1453→├── PSLTierBadge.tsx          # Tier icon and name
  1454→├── PSLComparison.tsx         # Current vs Potential
  1455→├── PSLUpgradePrompt.tsx      # Prompt to unlock AI vision
  1456→│
  1457→├── archetype/
  1458→│   ├── ArchetypeCard.tsx     # Primary archetype display
  1459→│   ├── ArchetypeTraits.tsx   # Trait badges
  1460→│   ├── ArchetypeComparison.tsx # Primary vs Secondary
  1461→│   └── ArchetypeTransition.tsx # Path to next archetype
  1462→│
  1463→├── advice/
  1464→│   ├── HairstyleRecommendations.tsx  # Hairstyle cards with images
  1465→│   ├── SkincareRoutine.tsx           # AM/PM routine display
  1466→│   ├── StyleGuide.tsx                # Clothing/color recommendations
  1467→│   ├── GroomingGuide.tsx             # Facial hair, brows, etc.
  1468→│   └── ActionPlan.tsx                # Prioritized improvements
  1469→│
  1470→└── shared/
  1471→    ├── FeatureCard.tsx       # Extracted feature display
  1472→    ├── ScoreBar.tsx          # Horizontal score visualization
  1473→    ├── TierIcon.tsx          # Tier-specific icons
  1474→    └── PaywallOverlay.tsx    # Upgrade prompt overlay
  1475→```
  1476→
  1477→### 8.2 Results Tab Integration
  1478→
  1479→```typescript
  1480→// Add to ResultsLayout.tsx tabs
  1481→const TABS: TabConfig[] = [
  1482→  { id: 'overview', label: 'Overview', icon: <LayoutDashboard size={18} /> },
  1483→  { id: 'front-ratios', label: 'Front Ratios', icon: <User size={18} /> },
  1484→  { id: 'side-ratios', label: 'Side Ratios', icon: <ScanFace size={18} /> },
  1485→  { id: 'leaderboard', label: 'Leaderboard', icon: <Trophy size={18} /> },
  1486→  { id: 'plan', label: 'Your Plan', icon: <Sparkles size={18} /> },
  1487→  // NEW TABS
  1488→  { id: 'psl', label: 'PSL Score', icon: <Gauge size={18} />, paid: false },
  1489→  { id: 'archetype', label: 'Archetype', icon: <Shapes size={18} />, paid: false },
  1490→  { id: 'advice', label: 'AI Advice', icon: <Lightbulb size={18} />, paid: true },
  1491→  // EXISTING
  1492→  { id: 'options', label: 'Options', icon: <Settings size={18} /> },
  1493→  { id: 'support', label: 'Support', icon: <HelpCircle size={18} /> },
  1494→];
  1495→```
  1496→
  1497→### 8.3 Key Component: PSLScoreCard
  1498→
  1499→```tsx
  1500→// PSLScoreCard.tsx
  1501→interface PSLScoreCardProps {
  1502→  psl: PSLResult;
  1503→  showBreakdown?: boolean;
  1504→  showPotential?: boolean;
  1505→}
  1506→
  1507→export function PSLScoreCard({ psl, showBreakdown = true, showPotential = true }: PSLScoreCardProps) {
  1508→  return (
  1509→    <div className="bg-zinc-900 rounded-xl p-6 border border-zinc-800">
  1510→      {/* Header */}
  1511→      <div className="flex items-center justify-between mb-6">
  1512→        <h2 className="text-xl font-semibold text-white">PSL Rating</h2>
  1513→        <PSLTierBadge tier={psl.tier} />
  1514→      </div>
  1515→
  1516→      {/* Main Score */}
  1517→      <div className="flex items-center gap-6 mb-6">
  1518→        <div className="text-6xl font-bold text-cyan-400">
  1519→          {psl.score.toFixed(2)}
  1520→        </div>
  1521→        <div className="text-zinc-400">
  1522→          <div className="text-lg">{psl.tier}</div>
  1523→          <div className="text-sm">Top {(100 - psl.percentile).toFixed(1)}%</div>
  1524→        </div>
  1525→      </div>
  1526→
  1527→      {/* Breakdown */}
  1528→      {showBreakdown && (
  1529→        <PSLBreakdown breakdown={psl.breakdown} />
  1530→      )}
  1531→
  1532→      {/* Potential */}
  1533→      {showPotential && psl.potential > psl.score && (
  1534→        <div className="mt-4 pt-4 border-t border-zinc-800">
  1535→          <div className="flex items-center justify-between text-sm">
  1536→            <span className="text-zinc-400">Potential with improvements</span>
  1537→            <span className="text-green-400 font-semibold">
  1538→              {psl.potential.toFixed(2)} (+{(psl.potential - psl.score).toFixed(2)})
  1539→            </span>
  1540→          </div>
  1541→        </div>
  1542→      )}
  1543→    </div>
  1544→  );
  1545→}
  1546→```
  1547→
  1548→### 8.4 Key Component: ArchetypeCard
  1549→
  1550→```tsx
  1551→// ArchetypeCard.tsx
  1552→interface ArchetypeCardProps {
  1553→  archetype: ArchetypeResult;
  1554→  showSecondary?: boolean;
  1555→  showTransition?: boolean;
  1556→}
  1557→
  1558→export function ArchetypeCard({ archetype, showSecondary = true, showTransition = true }: ArchetypeCardProps) {
  1559→  return (
  1560→    <div className="bg-zinc-900 rounded-xl p-6 border border-zinc-800">
  1561→      {/* Primary Archetype */}
  1562→      <div className="flex items-start gap-4 mb-6">
  1563→        <div className="w-16 h-16 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center">
  1564→          <ArchetypeIcon archetype={archetype.primary.subArchetype} />
  1565→        </div>
  1566→        <div>
  1567→          <div className="text-sm text-zinc-400 mb-1">Your Archetype</div>
  1568→          <div className="text-2xl font-bold text-white">
  1569→            {archetype.primary.subArchetype}
  1570→          </div>
  1571→          <div className="text-sm text-zinc-500">
  1572→            {archetype.primary.category} • {(archetype.primary.confidence * 100).toFixed(0)}% match
  1573→          </div>
  1574→        </div>
  1575→      </div>
  1576→
  1577→      {/* Traits */}
  1578→      <div className="flex flex-wrap gap-2 mb-6">
  1579→        {archetype.traits.map(trait => (
  1580→          <span key={trait} className="px-3 py-1 rounded-full bg-zinc-800 text-zinc-300 text-sm">
  1581→            {trait}
  1582→          </span>
  1583→        ))}
  1584→      </div>
  1585→
  1586→      {/* Secondary */}
  1587→      {showSecondary && archetype.secondary && (
  1588→        <div className="p-4 rounded-lg bg-zinc-800/50 mb-4">
  1589→          <div className="text-sm text-zinc-400 mb-1">Secondary Match</div>
  1590→          <div className="text-lg text-white">
  1591→            {archetype.secondary.subArchetype}
  1592→            <span className="text-zinc-500 text-sm ml-2">
  1593→              ({(archetype.secondary.confidence * 100).toFixed(0)}%)
  1594→            </span>
  1595→          </div>
  1596→        </div>
  1597→      )}
  1598→
  1599→      {/* Transition Path */}
  1600→      {showTransition && archetype.transitionPath && (
  1601→        <div className="p-4 rounded-lg border border-dashed border-zinc-700">
  1602→          <div className="text-sm text-zinc-400 mb-2">Transition Potential</div>
  1603→          <div className="flex items-center gap-2">
  1604→            <span className="text-white">{archetype.primary.subArchetype}</span>
  1605→            <ArrowRight className="text-zinc-600" size={16} />
  1606→            <span className="text-cyan-400">{archetype.transitionPath.target}</span>
  1607→          </div>
  1608→          <div className="text-xs text-zinc-500 mt-2">
  1609→            Requirements: {archetype.transitionPath.requirements.join(', ')}
  1610→          </div>
  1611→        </div>
  1612→      )}
  1613→    </div>
  1614→  );
  1615→}
  1616→```
  1617→
  1618→---
  1619→
  1620→## 9. Implementation Phases
  1621→
  1622→### Phase 1: PSL Foundation (Week 1)
  1623→**Priority: Critical**
  1624→
  1625→- [ ] Add `height_cm` to users table
  1626→- [ ] Implement height input in onboarding/results
  1627→- [ ] Create `psl-calculator.ts` with formula
  1628→- [ ] Create `PSLScoreCard`, `PSLBreakdown`, `PSLTierBadge` components
  1629→- [ ] Add PSL tab to results page
  1630→- [ ] Create `/psl/calculate` endpoint
  1631→
  1632→### Phase 2: Archetype System (Week 2)
  1633→**Priority: High**
  1634→
  1635→- [ ] Create `archetypes.json` with full taxonomy
  1636→- [ ] Implement `archetype-classifier.ts`
  1637→- [ ] Create `archetype_service.py`
  1638→- [ ] Create `ArchetypeCard`, `ArchetypeTraits` components
  1639→- [ ] Add Archetype tab to results page
  1640→- [ ] Create `/archetype/classify` endpoint
  1641→
  1642→### Phase 3: AI Vision Integration (Week 3)
  1643→**Priority: High - Paid Feature**
  1644→
  1645→- [ ] Set up Claude API integration
  1646→- [ ] Implement `vision_service.py`
  1647→- [ ] Create `vision_extractions` table
  1648→- [ ] Create `/vision/extract` endpoint
  1649→- [ ] Add paywall for AI vision access
  1650→- [ ] Display extracted features in UI
  1651→
  1652→### Phase 4: Advice Engine (Week 4)
  1653→**Priority: High - Paid Feature**
  1654→
  1655→- [ ] Create `hairstyles.json` database
  1656→- [ ] Create `skincare.json` routines
  1657→- [ ] Create `style_guides.json`
  1658→- [ ] Implement `advice_service.py`
  1659→- [ ] Create advice components (`HairstyleRecommendations`, `SkincareRoutine`, etc.)
  1660→- [ ] Add Advice tab to results page
  1661→- [ ] Create `/advice/*` endpoints
  1662→
  1663→### Phase 5: Action Plan (Week 5)
  1664→**Priority: Medium**
  1665→
  1666→- [ ] Implement action plan generation logic
  1667→- [ ] Create `ActionPlan` component
  1668→- [ ] Integrate with existing recommendations
  1669→- [ ] Add cost/timeline estimates
  1670→- [ ] Link flaws to specific actions
  1671→
  1672→### Phase 6: Polish & Integration (Week 6)
  1673→**Priority: Medium**
  1674→
  1675→- [ ] End-to-end testing
  1676→- [ ] Performance optimization
  1677→- [ ] Caching for AI calls
  1678→- [ ] Error handling
  1679→- [ ] Mobile responsiveness
  1680→- [ ] Analytics integration
  1681→
  1682→---
  1683→
  1684→## 10. Cost & Pricing
  1685→
  1686→### 10.1 API Costs
  1687→
  1688→| Service | Cost per Call | Usage |
  1689→|---------|--------------|-------|
  1690→| Claude Vision (face) | ~$0.01-0.02 | Per face extraction |
  1691→| Claude Vision (body) | ~$0.01 | Per body extraction |
  1692→| Total per user | ~$0.02-0.03 | One-time per analysis |
  1693→
  1694→### 10.2 Suggested Pricing Tiers
  1695→
  1696→| Feature | Free | Pro ($X/mo) | Premium ($Y/mo) |
  1697→|---------|------|-------------|-----------------|
  1698→| Landmark Analysis | ✓ | ✓ | ✓ |
  1699→| Basic PSL (face + height) | ✓ | ✓ | ✓ |
  1700→| Archetype (rule-based) | ✓ | ✓ | ✓ |
  1701→| AI Vision Extraction | ✗ | ✓ | ✓ |
  1702→| Enhanced PSL (with body) | ✗ | ✓ | ✓ |
  1703→| Hairstyle Recommendations | ✗ | ✓ | ✓ |
  1704→| Skincare Routine | ✗ | ✓ | ✓ |
  1705→| Style Guide | ✗ | ✓ | ✓ |
  1706→| Action Plan | ✗ | ✓ | ✓ |
  1707→| Unlimited Re-analyses | ✗ | ✗ | ✓ |
  1708→
  1709→### 10.3 Margin Analysis
  1710→
  1711→- Cost per paid user: ~$0.03 (one-time AI call)
  1712→- If user pays $5/month: 99%+ margin
  1713→- If user pays $20 one-time: 99%+ margin
  1714→- AI costs are negligible relative to value provided
  1715→
  1716→---
  1717→
  1718→## Appendix A: Halos & Failos Reference
  1719→
  1720→### Halos (Positive Features)
  1721→
  1722→| Halo | Detection Method | Impact |
  1723→|------|------------------|--------|
  1724→| Hunter Eyes | Landmarks (canthal tilt, deep-set) | High |
  1725→| Hollow Cheeks | Vision AI | High |
  1726→| Strong Jawline | Landmarks (gonial angle, bigonial) | High |
  1727→| Clear Skin | Vision AI | High |
  1728→| NW0-1 Hairline | Vision AI | Medium |
  1729→| White Teeth | Vision AI | Medium |
  1730→| Compact Midface | Landmarks | High |
  1731→| Dense Eyebrows | Vision AI | Low |
  1732→| Golden/Tanned Skin | Vision AI | Low |
  1733→
  1734→### Failos (Negative Features)
  1735→
  1736→| Failo | Detection Method | Severity |
  1737→|-------|------------------|----------|
  1738→| Negative Canthal Tilt | Landmarks | Major |
  1739→| Receding Chin | Landmarks | Major |
  1740→| Long Philtrum | Landmarks | Moderate |
  1741→| Severe Acne/Scarring | Vision AI | Major |
  1742→| Asymmetry | Landmarks | Moderate-Major |
  1743→| NW3+ Hairline | Vision AI | Moderate |
  1744→| Scleral Show | Landmarks | Moderate |
  1745→| Thin Neck | Landmarks/Vision | Minor |
  1746→| Mouth Breathing Signs | Landmarks | Major |
  1747→| Narrow Palate | Landmarks | Moderate |
  1748→
  1749→---
  1750→
  1751→## Appendix B: Celebrity Calibration
  1752→
  1753→Use these known ratings for algorithm validation:
  1754→
  1755→| Celebrity | Expected PSL | Archetype | Key Features |
  1756→|-----------|--------------|-----------|--------------|
  1757→| Francisco Lachowski | 9.0+ | Prettyboy | Perfect harmony, no failos |
  1758→| Henry Cavill | 8.5-9.0 | Superman Chad | Strong jaw, dimorphism |
  1759→| Ian Somerhalder | 8.0-8.5 | Vampire Chad | Hunter eyes, hollow cheeks |
  1760→| Zac Efron (prime) | 8.0-8.5 | Jock Chad | Athletic, symmetrical |
  1761→| Timothée Chalamet | 7.5-8.0 | Softboy | Harmony, low dimorphism |
  1762→| Josh Hutcherson | 5.5-6.0 | HTN | Average height limits ceiling |
  1763→| Average man | 5.0 | MTN | By definition |
  1764→
  1765→---
  1766→
  1767→## Appendix C: File Paths Summary
  1768→
  1769→### Backend (looksmaxx-api)
  1770→
  1771→```
  1772→app/
  1773→├── services/
  1774→│   ├── psl_service.py           # NEW
  1775→│   ├── vision_service.py        # NEW
  1776→│   ├── archetype_service.py     # NEW
  1777→│   └── advice_service.py        # NEW
  1778→├── routers/
  1779→│   ├── psl.py                   # NEW
  1780→│   ├── vision.py                # NEW
  1781→│   └── advice.py                # NEW
  1782→├── models/
  1783→│   ├── vision_extraction.py     # NEW
  1784→│   ├── psl_score.py             # NEW
  1785→│   ├── archetype_result.py      # NEW
  1786→│   └── advice_result.py         # NEW
  1787→└── data/
  1788→    ├── archetypes.json          # NEW
  1789→    ├── hairstyles.json          # NEW
  1790→    ├── skincare.json            # NEW
  1791→    └── style_guides.json        # NEW
  1792→```
  1793→
  1794→### Frontend (looksmaxx-app)
  1795→
  1796→```
  1797→src/
  1798→├── components/
  1799→│   └── psl/                     # NEW (entire folder)
  1800→├── contexts/
  1801→│   └── PSLContext.tsx           # NEW
  1802→├── lib/
  1803→│   ├── psl-calculator.ts        # NEW
  1804→│   └── archetype-classifier.ts  # NEW
  1805→└── types/
  1806→    └── psl.ts                   # NEW
  1807→```
  1808→
  1809→---
  1810→
  1811→*Document Version: 1.0*
  1812→*Last Updated: 2025-01-XX*
  1813→*Author: LOOKSMAXX Team*
  1814→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
