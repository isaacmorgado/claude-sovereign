     1→# Build FaceIQ Clone - Complete Web App
     2→
     3→## Request
     4→
     5→Recreate FaceIQ Labs (https://beta.faceiqlabs.com) as a Next.js web app with:
     6→- Front face auto-detection using MediaPipe
     7→- Side profile landmark detection
     8→- Draggable landmark adjustment UI
     9→- Bell curve scoring & comparison
    10→- Complete user flow: Upload → Detect → Adjust → Results
    11→
    12→## Reference Data Location
    13→
    14→All reverse-engineered data is at `~/Desktop/reverse-engineer/`:
    15→
    16→```
    17→Key Files:
    18→├── landmark_data.json                    # 106 side profile coordinates
    19→├── captured_api/251_POST_api_side-landmarks.json  # Full API response format
    20→├── captured_api/ALL_FACEIQ_RESPONSES.json         # All API structures
    21→├── CALCULATION_ANALYSIS.md               # Formulas & measurements
    22→├── BUILD_CALCULATION_ENGINE_PROMPT.md    # Scoring engine specs
    23→└── FACEIQHAR/                           # Original JS/CSS/HTML from site
    24→    └── */\_next/static/chunks/*.js       # Their bundled code
    25→```
    26→
    27→## Tech Stack
    28→
    29→- Next.js 14 (App Router)
    30→- TypeScript
    31→- Tailwind CSS
    32→- MediaPipe Face Landmarker (478 front landmarks)
    33→- Canvas API for landmark visualization
    34→
    35→## Project Structure
    36→
    37→Create in `~/Desktop/reverse-engineer/faceiq-clone/`:
    38→
    39→```
    40→src/
    41→├── app/
    42→│   ├── page.tsx                 # Landing/upload
    43→│   ├── analyze/
    44→│   │   ├── front/page.tsx       # Front face detection
    45→│   │   ├── side/page.tsx        # Side profile detection
    46→│   │   └── results/page.tsx     # Scores & bell curves
    47→│   └── layout.tsx
    48→├── components/
    49→│   ├── ImageUploader.tsx        # Drag & drop upload
    50→│   ├── FaceDetector.tsx         # MediaPipe integration
    51→│   ├── LandmarkEditor.tsx       # Draggable points on canvas
    52→│   ├── LandmarkGuide.tsx        # Shows which point to place
    53→│   ├── BellCurveChart.tsx       # Score visualization
    54→│   └── ResultsCard.tsx          # Individual measurement display
    55→├── hooks/
    56→│   ├── useMediaPipe.ts          # MediaPipe Face Landmarker hook
    57→│   └── useLandmarkEditor.ts     # Drag & drop landmark logic
    58→├── lib/
    59→│   ├── landmarks.ts             # Index mappings (from landmark_data.json)
    60→│   ├── measurements.ts          # FWHR, angles, ratios calculations
    61→│   ├── scoring.ts               # Bell curve scoring
    62→│   └── constants.ts             # Ideal values by gender
    63→├── types/
    64→│   └── index.ts                 # TypeScript interfaces
    65→└── public/
    66→    └── landmarks/               # Guidance images for each landmark
    67→        ├── front/
    68→        │   ├── hairline.webp
    69→        │   ├── leftEyePupil.webp
    70→        │   ├── chinBottom.webp
    71→        │   └── ...
    72→        └── side/
    73→            ├── nasion.webp
    74→            ├── pronasale.webp
    75→            ├── menton.webp
    76→            └── ...
    77→```
    78→
    79→## Key Components
    80→
    81→### 1. MediaPipe Integration (`hooks/useMediaPipe.ts`)
    82→
    83→```typescript
    84→// Use @mediapipe/tasks-vision FaceLandmarker
    85→// Returns 478 normalized {x, y, z} coordinates
    86→// Key indices: see BUILD_CALCULATION_ENGINE_PROMPT.md
    87→```
    88→
    89→### 2. Landmark Editor (`components/LandmarkEditor.tsx`)
    90→
    91→- Canvas overlay on uploaded image
    92→- Render landmarks as draggable circles
    93→- Click to select, drag to move
    94→- Prev/Next buttons to cycle landmarks
    95→- Keyboard shortcuts (Arrow keys to nudge)
    96→
    97→### 3. User Flow
    98→
    99→```
   100→1. Upload Front Photo → MediaPipe auto-detects 478 points
   101→2. Show key landmarks for manual adjustment (20-30 points)
   102→3. Upload Side Photo → Auto-detect or manual placement (106 points)
   103→4. Calculate all measurements
   104→5. Score against ideal values
   105→6. Show bell curve percentile ranking
   106→```
   107→
   108→### 4. Landmark Guidance Images
   109→
   110→FaceIQ shows example images for each landmark. Create/source similar images showing:
   111→- Where on face to place the point
   112→- Clear visual indicator
   113→- Brief label (e.g., "Hairline", "Chin Bottom")
   114→
   115→URLs found in HAR:
   116→```
   117→/images/landmarks/male/white/hairline.webp
   118→/images/landmarks/male/white/leftEyePupil.webp
   119→/images/landmarks/male/white/chinBottom.webp
   120→/images/landmarks/male/white/leftEyeMedialCanthus.webp
   121→/images/landmarks/male/white/leftBrowArch.webp
   122→... (see CALCULATION_ANALYSIS.md for full list)
   123→```
   124→
   125→## Side Profile Detection Options
   126→
   127→Since MediaPipe is for front faces, for side profile either:
   128→
   129→1. **Manual placement** - User places 20-30 key points guided by images
   130→2. **Use face-api.js** - Has some side profile support
   131→3. **Custom API** - Build endpoint similar to FaceIQ's `/api/side-landmarks`
   132→4. **Dlib** - Python backend with 68-point model
   133→
   134→Recommend: Start with manual placement + guidance images.
   135→
   136→## Measurements to Calculate
   137→
   138→From `BUILD_CALCULATION_ENGINE_PROMPT.md`:
   139→
   140→**Front Face:**
   141→- FWHR, Facial Thirds, Canthal Tilt, Symmetry, Golden Ratios
   142→
   143→**Side Profile:**
   144→- Nasolabial Angle, Gonial Angle, Nose Projection, Chin Projection, Profile Type
   145→
   146→## Scoring
   147→
   148→Use bell curve from `BUILD_CALCULATION_ENGINE_PROMPT.md`:
   149→- Calculate measurement → Compare to ideal → Score 0-100
   150→- Show percentile on bell curve chart
   151→- Calculate overall Harmony Score (weighted average)
   152→
   153→## Build Instructions
   154→
   155→1. `npx create-next-app@latest faceiq-clone --typescript --tailwind --app`
   156→2. Install: `@mediapipe/tasks-vision`, `chart.js` or `recharts`
   157→3. Copy landmark indices from `landmark_data.json`
   158→4. Implement components in order: Uploader → Detector → Editor → Results
   159→5. Add measurement calculations from `BUILD_CALCULATION_ENGINE_PROMPT.md`
   160→6. Create guidance images or use placeholders
   161→
   162→## Reference the Captured Data
   163→
   164→Read these files to match FaceIQ's exact behavior:
   165→- `landmark_data.json` - Exact coordinate format
   166→- `captured_api/*.json` - API response structures
   167→- `FACEIQHAR/` - Their actual UI code (minified but readable)
   168→
   169→---
   170→
   171→Build a working MVP that detects landmarks, allows adjustment, and shows scores with bell curve comparison.
   172→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
