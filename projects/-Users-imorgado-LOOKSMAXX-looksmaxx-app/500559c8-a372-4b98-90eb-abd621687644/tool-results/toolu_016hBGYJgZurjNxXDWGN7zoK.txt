     1→"""
     2→User schemas for request/response validation
     3→"""
     4→
     5→import re
     6→from pydantic import BaseModel, EmailStr, field_validator
     7→from typing import Optional
     8→from datetime import datetime
     9→from uuid import UUID
    10→
    11→
    12→class UserCreate(BaseModel):
    13→    email: EmailStr
    14→    password: str
    15→    name: Optional[str] = None
    16→    username: str
    17→    terms_accepted: bool
    18→    referral_code: Optional[str] = None
    19→
    20→    @field_validator('username')
    21→    @classmethod
    22→    def validate_username(cls, v: str) -> str:
    23→        if len(v) < 3:
    24→            raise ValueError('Username must be at least 3 characters')
    25→        if len(v) > 30:
    26→            raise ValueError('Username must be 30 characters or less')
    27→        if not re.match(r'^[a-zA-Z0-9_]+$', v):
    28→            raise ValueError('Username can only contain letters, numbers, and underscores')
    29→        if v.lower().startswith('user_'):
    30→            raise ValueError('Username cannot start with "User_"')
    31→        return v
    32→
    33→    @field_validator('terms_accepted')
    34→    @classmethod
    35→    def validate_terms(cls, v: bool) -> bool:
    36→        if not v:
    37→            raise ValueError('You must accept the Terms & Conditions')
    38→        return v
    39→
    40→    @field_validator('referral_code')
    41→    @classmethod
    42→    def validate_referral_code(cls, v: Optional[str]) -> Optional[str]:
    43→        if v is not None:
    44→            v = v.strip().upper()
    45→            if len(v) < 3 or len(v) > 50:
    46→                raise ValueError('Invalid referral code format')
    47→        return v if v else None
    48→
    49→
    50→class UserLogin(BaseModel):
    51→    email: EmailStr
    52→    password: str
    53→
    54→
    55→class ForgotPasswordRequest(BaseModel):
    56→    email: EmailStr
    57→
    58→
    59→class ResetPasswordRequest(BaseModel):
    60→    token: str
    61→    new_password: str
    62→
    63→    @field_validator('new_password')
    64→    @classmethod
    65→    def validate_password(cls, v: str) -> str:
    66→        if len(v) < 8:
    67→            raise ValueError('Password must be at least 8 characters')
    68→        return v
    69→
    70→
    71→class UserResponse(BaseModel):
    72→    id: UUID
    73→    email: str
    74→    name: Optional[str]
    75→    username: str
    76→    plan: str
    77→    email_verified: bool = False
    78→    created_at: datetime
    79→
    80→    class Config:
    81→        from_attributes = True
    82→
    83→
    84→class Token(BaseModel):
    85→    access_token: str
    86→    token_type: str = "bearer"
    87→    user: UserResponse
    88→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
