     1→'use client';
     2→
     3→import { useState } from 'react';
     4→import { ChevronUp, ChevronDown, LogIn } from 'lucide-react';
     5→import { VoteType } from '@/types/forum';
     6→import { useAuth } from '@/contexts/AuthContext';
     7→import Link from 'next/link';
     8→
     9→interface VoteButtonsProps {
    10→  voteCount: number;
    11→  userVote: VoteType | null;
    12→  onVote: (voteType: VoteType) => void | Promise<void>;
    13→  size?: 'sm' | 'md';
    14→  horizontal?: boolean;
    15→}
    16→
    17→export function VoteButtons({
    18→  voteCount,
    19→  userVote,
    20→  onVote,
    21→  size = 'md',
    22→  horizontal = false,
    23→}: VoteButtonsProps) {
    24→  const [isVoting, setIsVoting] = useState(false);
    25→  const [showLoginPrompt, setShowLoginPrompt] = useState(false);
    26→  const { isAuthenticated } = useAuth();
    27→  const iconSize = size === 'sm' ? 16 : 20;
    28→  const buttonPadding = size === 'sm' ? 'p-1' : 'p-1.5';
    29→
    30→  const handleVote = async (voteType: VoteType) => {
    31→    if (isVoting) return;
    32→
    33→    // Show login prompt if not authenticated
    34→    if (!isAuthenticated) {
    35→      setShowLoginPrompt(true);
    36→      return;
    37→    }
    38→
    39→    setIsVoting(true);
    40→    try {
    41→      await onVote(voteType);
    42→    } catch (error) {
    43→      // Handle auth errors specifically
    44→      if (error instanceof Error && error.message.includes('Not authenticated')) {
    45→        setShowLoginPrompt(true);
    46→      }
    47→    } finally {
    48→      setIsVoting(false);
    49→    }
    50→  };
    51→
    52→  const formatCount = (count: number) => {
    53→    if (count >= 1000) {
    54→      return (count / 1000).toFixed(1).replace(/\.0$/, '') + 'k';
    55→    }
    56→    return count.toString();
    57→  };
    58→
    59→  return (
    60→    <div className="relative">
    61→      <div
    62→        className={`flex items-center ${
    63→          horizontal ? 'flex-row gap-1' : 'flex-col'
    64→        } ${isVoting ? 'opacity-50 pointer-events-none' : ''}`}
    65→      >
    66→        <button
    67→          onClick={() => handleVote('up')}
    68→          disabled={isVoting}
    69→          className={`${buttonPadding} rounded-lg hover:bg-cyan-500/10 transition-all ${
    70→            userVote === 'up' ? 'text-cyan-400 bg-cyan-500/10' : 'text-neutral-600 hover:text-cyan-400'
    71→          } disabled:cursor-not-allowed`}
    72→          title={isAuthenticated ? 'Upvote' : 'Login to vote'}
    73→          aria-label="Upvote"
    74→        >
    75→          <ChevronUp size={iconSize} strokeWidth={userVote === 'up' ? 3 : 2} />
    76→        </button>
    77→
    78→        <span
    79→          className={`text-xs font-black min-w-[2ch] text-center ${
    80→            userVote === 'up'
    81→              ? 'text-cyan-400'
    82→              : userVote === 'down'
    83→              ? 'text-neutral-600'
    84→              : 'text-neutral-400'
    85→          }`}
    86→        >
    87→          {formatCount(voteCount)}
    88→        </span>
    89→
    90→        <button
    91→          onClick={() => handleVote('down')}
    92→          disabled={isVoting}
    93→          className={`${buttonPadding} rounded-lg hover:bg-neutral-900 transition-all ${
    94→            userVote === 'down' ? 'text-neutral-500 bg-neutral-900' : 'text-neutral-600 hover:text-neutral-400'
    95→          } disabled:cursor-not-allowed`}
    96→          title={isAuthenticated ? 'Downvote' : 'Login to vote'}
    97→          aria-label="Downvote"
    98→        >
    99→          <ChevronDown size={iconSize} strokeWidth={userVote === 'down' ? 3 : 2} />
   100→        </button>
   101→      </div>
   102→
   103→      {/* Login Prompt Popup */}
   104→      {showLoginPrompt && (
   105→        <div className="absolute left-full ml-2 top-1/2 -translate-y-1/2 z-50 bg-neutral-900 border border-neutral-800 rounded-xl p-3 shadow-xl min-w-[180px]">
   106→          <button
   107→            onClick={() => setShowLoginPrompt(false)}
   108→            className="absolute top-1 right-1 text-neutral-600 hover:text-neutral-400 text-xs"
   109→            aria-label="Close"
   110→          >
   111→            ×
   112→          </button>
   113→          <div className="flex items-center gap-2 mb-2">
   114→            <LogIn size={14} className="text-cyan-400" />
   115→            <span className="text-xs font-bold text-white">Login to vote</span>
   116→          </div>
   117→          <p className="text-[10px] text-neutral-500 mb-3">
   118→            Join the community to upvote and downvote posts.
   119→          </p>
   120→          <div className="flex gap-2">
   121→            <Link
   122→              href="/login"
   123→              className="flex-1 text-center text-[10px] font-bold bg-cyan-500 hover:bg-cyan-600 text-black px-2 py-1.5 rounded-lg transition-colors"
   124→            >
   125→              Login
   126→            </Link>
   127→            <Link
   128→              href="/signup"
   129→              className="flex-1 text-center text-[10px] font-bold border border-neutral-700 hover:border-neutral-600 text-white px-2 py-1.5 rounded-lg transition-colors"
   130→            >
   131→              Sign Up
   132→            </Link>
   133→          </div>
   134→        </div>
   135→      )}
   136→    </div>
   137→  );
   138→}
   139→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
