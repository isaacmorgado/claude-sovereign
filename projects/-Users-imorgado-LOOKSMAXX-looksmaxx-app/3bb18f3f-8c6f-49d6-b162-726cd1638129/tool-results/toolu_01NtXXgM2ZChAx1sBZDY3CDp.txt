     1→'use client';
     2→
     3→import { useState, useEffect, useCallback } from 'react';
     4→import Link from 'next/link';
     5→import { motion } from 'framer-motion';
     6→import { api } from '@/lib/api';
     7→import { ForumHeader, PostCard } from '@/components/forum';
     8→import type { PostListItem, VoteType } from '@/types/forum';
     9→import {
    10→  Bookmark,
    11→  BookmarkX,
    12→  ArrowLeft,
    13→  Loader2,
    14→  ChevronDown,
    15→} from 'lucide-react';
    16→
    17→const PAGE_SIZE = 20;
    18→
    19→export default function SavedPostsPage() {
    20→  const [posts, setPosts] = useState<PostListItem[]>([]);
    21→  const [isLoading, setIsLoading] = useState(true);
    22→  const [isLoadingMore, setIsLoadingMore] = useState(false);
    23→  const [error, setError] = useState<string | null>(null);
    24→  const [totalCount, setTotalCount] = useState(0);
    25→  const [hasMore, setHasMore] = useState(false);
    26→  const [offset, setOffset] = useState(0);
    27→
    28→  const fetchBookmarks = useCallback(async (loadMore = false) => {
    29→    const currentOffset = loadMore ? offset : 0;
    30→
    31→    if (loadMore) {
    32→      setIsLoadingMore(true);
    33→    } else {
    34→      setIsLoading(true);
    35→    }
    36→    setError(null);
    37→
    38→    try {
    39→      const data = await api.getBookmarkedPosts({
    40→        limit: PAGE_SIZE,
    41→        offset: currentOffset,
    42→      });
    43→
    44→      if (loadMore) {
    45→        setPosts(prev => [...prev, ...data.posts]);
    46→      } else {
    47→        setPosts(data.posts);
    48→      }
    49→      setTotalCount(data.totalCount);
    50→      setHasMore(data.hasMore);
    51→      setOffset(currentOffset + PAGE_SIZE);
    52→    } catch (err) {
    53→      setError(err instanceof Error ? err.message : 'Failed to load bookmarks');
    54→    } finally {
    55→      setIsLoading(false);
    56→      setIsLoadingMore(false);
    57→    }
    58→  }, [offset]);
    59→
    60→  useEffect(() => {
    61→    fetchBookmarks(false);
    62→    // eslint-disable-next-line react-hooks/exhaustive-deps
    63→  }, []);
    64→
    65→  const handleVote = async (postId: string, voteType: VoteType) => {
    66→    try {
    67→      const result = await api.voteForumPost(postId, voteType);
    68→      setPosts(prev =>
    69→        prev.map(p =>
    70→          p.id === postId
    71→            ? { ...p, voteCount: result.newVoteCount, userVote: result.userVote }
    72→            : p
    73→        )
    74→      );
    75→    } catch (err) {
    76→      console.error('Failed to vote:', err);
    77→    }
    78→  };
    79→
    80→  const handleRemoveBookmark = async (postId: string) => {
    81→    try {
    82→      await api.toggleBookmark(postId);
    83→      // Remove from local state
    84→      setPosts(prev => prev.filter(p => p.id !== postId));
    85→      setTotalCount(prev => prev - 1);
    86→    } catch (err) {
    87→      console.error('Failed to remove bookmark:', err);
    88→    }
    89→  };
    90→
    91→  const handleLoadMore = () => {
    92→    if (hasMore && !isLoadingMore) {
    93→      fetchBookmarks(true);
    94→    }
    95→  };
    96→
    97→  return (
    98→    <div className="min-h-screen bg-black selection:bg-cyan-500/30">
    99→      <ForumHeader />
   100→
   101→      {/* Hero */}
   102→      <section className="border-b border-white/5">
   103→        <div className="max-w-4xl mx-auto px-6 pt-16 pb-12">
   104→          <Link
   105→            href="/forum"
   106→            className="inline-flex items-center gap-2 text-neutral-500 hover:text-white text-xs font-bold uppercase tracking-widest mb-8 transition-colors"
   107→          >
   108→            <ArrowLeft size={14} />
   109→            Back to Forum
   110→          </Link>
   111→
   112→          <div className="flex items-center gap-4 mb-4">
   113→            <div className="w-14 h-14 rounded-2xl bg-gradient-to-br from-cyan-500/20 to-blue-500/20 border border-white/5 flex items-center justify-center">
   114→              <Bookmark size={24} className="text-cyan-400" />
   115→            </div>
   116→            <div>
   117→              <h1 className="text-4xl md:text-5xl font-black tracking-tighter italic uppercase">
   118→                Saved <span className="text-cyan-400">Posts</span>
   119→              </h1>
   120→              <p className="text-neutral-500 font-medium uppercase text-xs tracking-[0.2em] mt-2">
   121→                {totalCount} {totalCount === 1 ? 'post' : 'posts'} bookmarked
   122→              </p>
   123→            </div>
   124→          </div>
   125→        </div>
   126→      </section>
   127→
   128→      {/* Main Content */}
   129→      <main className="max-w-4xl mx-auto px-6 py-12">
   130→        {/* Error State */}
   131→        {error && (
   132→          <div className="p-4 rounded-xl bg-red-500/10 border border-red-500/20 mb-6">
   133→            <p className="text-red-400 text-sm">{error}</p>
   134→          </div>
   135→        )}
   136→
   137→        {/* Loading State */}
   138→        {isLoading && (
   139→          <div className="flex flex-col items-center justify-center py-20">
   140→            <Loader2 size={32} className="text-cyan-400 animate-spin mb-4" />
   141→            <p className="text-neutral-500 text-sm">Loading your saved posts...</p>
   142→          </div>
   143→        )}
   144→
   145→        {/* Posts List */}
   146→        {!isLoading && posts.length > 0 && (
   147→          <div className="space-y-4">
   148→            {posts.map((post, index) => (
   149→              <motion.div
   150→                key={post.id}
   151→                initial={{ opacity: 0, y: 20 }}
   152→                animate={{ opacity: 1, y: 0 }}
   153→                transition={{ delay: index * 0.03 }}
   154→                className="relative group/card"
   155→              >
   156→                <PostCard
   157→                  post={post}
   158→                  onVote={handleVote}
   159→                  showSubForum
   160→                />
   161→                {/* Remove Bookmark Button - appears on hover */}
   162→                <button
   163→                  onClick={() => handleRemoveBookmark(post.id)}
   164→                  className="absolute top-3 right-3 z-10 opacity-0 group-hover/card:opacity-100 transition-opacity p-2 rounded-lg bg-neutral-900/90 border border-white/10 hover:border-red-500/30 hover:bg-red-500/10 text-neutral-400 hover:text-red-400"
   165→                  title="Remove bookmark"
   166→                >
   167→                  <BookmarkX size={16} />
   168→                </button>
   169→              </motion.div>
   170→            ))}
   171→
   172→            {/* Load More Button */}
   173→            {hasMore && (
   174→              <div className="flex justify-center pt-6">
   175→                <button
   176→                  onClick={handleLoadMore}
   177→                  disabled={isLoadingMore}
   178→                  className="flex items-center gap-2 px-6 py-3 rounded-xl bg-neutral-900/50 border border-white/10 text-white text-[10px] font-black uppercase tracking-widest hover:border-cyan-500/30 hover:bg-cyan-500/10 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
   179→                >
   180→                  {isLoadingMore ? (
   181→                    <>
   182→                      <Loader2 size={14} className="animate-spin" />
   183→                      Loading...
   184→                    </>
   185→                  ) : (
   186→                    <>
   187→                      <ChevronDown size={14} />
   188→                      Load More ({totalCount - posts.length} remaining)
   189→                    </>
   190→                  )}
   191→                </button>
   192→              </div>
   193→            )}
   194→          </div>
   195→        )}
   196→
   197→        {/* Empty State */}
   198→        {!isLoading && posts.length === 0 && !error && (
   199→          <div className="text-center py-20 rounded-2xl bg-neutral-900/30 border border-white/5">
   200→            <div className="w-20 h-20 rounded-2xl bg-neutral-900/50 flex items-center justify-center mx-auto mb-6">
   201→              <Bookmark size={32} className="text-neutral-600" />
   202→            </div>
   203→            <h3 className="text-lg font-bold text-white mb-2">No Saved Posts Yet</h3>
   204→            <p className="text-neutral-500 text-sm mb-6 max-w-sm mx-auto">
   205→              When you find posts worth keeping, click the bookmark icon to save them here for easy access.
   206→            </p>
   207→            <Link
   208→              href="/forum"
   209→              className="inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-cyan-500 text-black text-[10px] font-black uppercase tracking-widest hover:bg-cyan-400 transition-all"
   210→            >
   211→              Browse Forum
   212→            </Link>
   213→          </div>
   214→        )}
   215→      </main>
   216→    </div>
   217→  );
   218→}
   219→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
