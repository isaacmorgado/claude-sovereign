     1→'use client';
     2→
     3→import { useEffect, useRef } from 'react';
     4→import { useResults } from '@/contexts/ResultsContext';
     5→import { useLeaderboardOptional } from '@/contexts/LeaderboardContext';
     6→import { ResultsLayout } from './ResultsLayout';
     7→import { OverviewTab } from './tabs/OverviewTab';
     8→import { FrontRatiosTab, SideRatiosTab } from './tabs/RatiosTab';
     9→import { PlanTab } from './tabs/PlanTab';
    10→import { OptionsTab } from './tabs/OptionsTab';
    11→import { SupportTab } from './tabs/SupportTab';
    12→import { LeaderboardTab } from './tabs/LeaderboardTab';
    13→import { CommunityTab } from './tabs/CommunityTab';
    14→import { PSLTab } from './tabs/PSLTab';
    15→import { ArchetypeTab } from './tabs/ArchetypeTab';
    16→import { api } from '@/lib/api';
    17→
    18→export function Results() {
    19→  const { activeTab, overallScore, gender, ethnicity, frontPhoto, strengths, flaws } = useResults();
    20→  const leaderboard = useLeaderboardOptional();
    21→  const hasSubmittedRef = useRef(false);
    22→
    23→  // Auto-submit score to leaderboard on first render when score is available
    24→  useEffect(() => {
    25→    // Only submit once, when we have a valid score and haven't submitted yet
    26→    if (hasSubmittedRef.current || overallScore <= 0 || !leaderboard) return;
    27→
    28→    // Check if user is authenticated
    29→    const token = api.getToken();
    30→    if (!token) return;
    31→
    32→    // Mark as submitted to prevent duplicate submissions
    33→    hasSubmittedRef.current = true;
    34→
    35→    // Extract top 3 strengths and improvements
    36→    const topStrengths = strengths.slice(0, 3).map(s => s.strengthName);
    37→    const topImprovements = flaws.slice(0, 3).map(f => f.flawName);
    38→
    39→    // Submit to leaderboard
    40→    leaderboard.submitScore(overallScore, gender, {
    41→      ethnicity,
    42→      facePhotoUrl: frontPhoto,
    43→      topStrengths,
    44→      topImprovements,
    45→    }).catch(err => {
    46→      // Reset flag on error so user can retry
    47→      hasSubmittedRef.current = false;
    48→      console.error('[Leaderboard] Auto-submit failed:', err);
    49→    });
    50→  }, [overallScore, gender, ethnicity, frontPhoto, strengths, flaws, leaderboard]);
    51→
    52→  const renderTabContent = () => {
    53→    switch (activeTab) {
    54→      case 'overview':
    55→        return <OverviewTab />;
    56→      case 'front-ratios':
    57→        return <FrontRatiosTab />;
    58→      case 'side-ratios':
    59→        return <SideRatiosTab />;
    60→      case 'leaderboard':
    61→        return <LeaderboardTab />;
    62→      case 'psl':
    63→        return <PSLTab />;
    64→      case 'archetype':
    65→        return <ArchetypeTab />;
    66→      case 'plan':
    67→        return <PlanTab />;
    68→      case 'community':
    69→        return <CommunityTab />;
    70→      case 'options':
    71→        return <OptionsTab />;
    72→      case 'support':
    73→        return <SupportTab />;
    74→      default:
    75→        return <OverviewTab />;
    76→    }
    77→  };
    78→
    79→  return (
    80→    <ResultsLayout>
    81→      {renderTabContent()}
    82→    </ResultsLayout>
    83→  );
    84→}
    85→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
