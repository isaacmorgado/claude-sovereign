     1→"""
     2→Authentication router - register, login, profile, password reset
     3→"""
     4→
     5→import secrets
     6→from datetime import datetime, timedelta
     7→from fastapi import APIRouter, Depends, HTTPException, status
     8→from sqlalchemy.ext.asyncio import AsyncSession
     9→from sqlalchemy import select, func
    10→from uuid import uuid4
    11→
    12→from app.database import get_db
    13→from app.models.user import User, ReferralCode
    14→from app.schemas.user import (
    15→    UserCreate, UserLogin, UserResponse, Token,
    16→    ForgotPasswordRequest, ResetPasswordRequest
    17→)
    18→from app.services.auth import AuthService, get_current_user
    19→from app.services.email import email_service
    20→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
