     1→# LOOKSMAXX vs FaceIQ - Comprehensive Comparison Report
     2→
     3→**Generated**: 2025-12-23
     4→**Last Updated**: 2025-12-23
     5→**Status**: Phase 1 (Scoring Accuracy) ✅ COMPLETE | Phase 2 (Metric Accuracy) ✅ MOSTLY COMPLETE | Phase 3+ TODO
     6→
     7→---
     8→
     9→## Executive Summary
    10→
    11→| Category | LOOKSMAXX Status | FaceIQ Reference | Parity |
    12→|----------|------------------|------------------|--------|
    13→| Bezier Curves | ✅ 66 implemented | 66 total | **100%** |
    14→| Decay Rates | 0.5-31.6 (harsh) | 0.07-0.3 (soft) | ⚠️ TODO |
    15→| Ideal Ranges | ✅ 12/12 verified & fixed | All defined | **100%** |
    16→| Sign/Units | ✅ All 6 fixed | Correct | **100%** |
    17→| Landmark Indices | ✅ Fixed (orbitale=33) | Correct | **100%** |
    18→| Treatment Metadata | Missing 5 fields | Complete | 40% |
    19→| Potential Calculation | Estimated | Exact Bezier | Different algo |
    20→
    21→---
    22→
    23→## 1. Scoring System Differences
    24→
    25→### 1.1 Bezier Curve Implementation ✅ COMPLETED
    26→
    27→**FaceIQ**: Uses 66 custom Bezier curves with 12 control points and handles per metric
    28→**LOOKSMAXX**: ✅ All 66 curves implemented in `src/lib/faceiq-bezier-curves.ts`
    29→
    30→**~~Missing Curves~~ All Implemented** (66 of 66):
    31→```
    32→Front Profile (26):
    33→- Face Width to Height Ratio
    34→- Facial Thirds (Upper/Middle/Lower)
    35→- Eye Separation Ratio
    36→- Nose Width Ratio
    37→- Lip Ratio
    38→- Jaw Width Ratio
    39→- Cheekbone Prominence
    40→- Brow Position
    41→- Canthal Tilt
    42→- Eye Width to Height
    43→- Philtrum Ratio
    44→- Mouth Width to Nose Width
    45→- Bigonial to Bizygomatic
    46→- Interpupillary Distance
    47→- Eye Spacing Index
    48→- Nasal Index
    49→- Vermilion Ratio
    50→- Facial Symmetry Score
    51→- Golden Ratio Compliance
    52→- Mandibular Angle
    53→- Gonial Angle (Front)
    54→- Midface Ratio
    55→- Lower Third Proportion
    56→- Chin to Philtrum
    57→- Alar Base Width
    58→- Intercanthal Width
    59→
    60→Side Profile (40):
    61→- Nasolabial Angle
    62→- Nasofrontal Angle
    63→- Nasal Tip Projection
    64→- Nasal Tip Rotation
    65→- Chin Projection
    66→- Mentolabial Angle
    67→- E-Line Position (Upper Lip)
    68→- E-Line Position (Lower Lip)
    69→- Gonial Angle (Side)
    70→- Mandibular Plane Angle
    71→- Facial Convexity Angle
    72→- Burstone Line Analysis
    73→- Holdaway Angle
    74→- Z-Angle (Merrifield)
    75→- Total Facial Convexity
    76→- Nasal Dorsum Angle
    77→- Frankfort Horizontal Angle
    78→- Ramus Height
    79→- Mandibular Length
    80→- Upper Lip Protrusion
    81→- Lower Lip Protrusion
    82→- Subnasale to Pogonion
    83→- Glabella to Subnasale
    84→- Facial Depth Ratio
    85→- Nasal Bridge Length
    86→- Philtral Length
    87→- Lip Protrusion Index
    88→- Chin Height
    89→- Throat Length
    90→- Cervicomental Angle
    91→- ... (10 more)
    92→```
    93→
    94→### 1.2 Decay Rate Discrepancies
    95→
    96→| Metric | LOOKSMAXX Rate | FaceIQ Rate | Difference |
    97→|--------|----------------|-------------|------------|
    98→| Canthal Tilt | 31.63 | 0.15 | **210x harsher** |
    99→| Facial Thirds | 3.00 | 0.18 | 17x harsher |
   100→| Eye Spacing | 2.50 | 0.12 | 21x harsher |
   101→| Nasal Index | 1.80 | 0.25 | 7x harsher |
   102→| Philtrum Ratio | 0.80 | 0.10 | 8x harsher |
   103→| Lip Ratio | 1.20 | 0.20 | 6x harsher |
   104→| Gonial Angle | 0.50 | 0.08 | 6x harsher |
   105→| Mandibular Angle | 0.65 | 0.12 | 5x harsher |
   106→| E-Line | 2.00 | 0.30 | 7x harsher |
   107→| Nasolabial Angle | 0.75 | 0.15 | 5x harsher |
   108→
   109→**Impact**: Users receive artificially low scores for minor deviations from ideal.
   110→
   111→---
   112→
   113→## 2. Metric Definition Differences
   114→
   115→### 2.1 Ideal Ranges - Verification Status ✅ ALL VERIFIED
   116→
   117→> **Note**: Many entries in original analysis were incorrect. All values verified against Bezier curves 2025-12-23.
   118→
   119→| Metric | Config | Bezier Curve Ideal | Status |
   120→|--------|--------|-------------------|--------|
   121→| Nasal Tip Angle | 128.5-138.5° | 128.5-138.5° | ✅ Match |
   122→| Canthal Tilt | 6.0-7.7° | 6.0-7.7° | ✅ Match |
   123→| Nasolabial Angle | 97-114° | 97-114° | ✅ Match |
   124→| E-Line Upper | 1.5-5.5mm | Per Bezier | ✅ Uses Bezier |
   125→| E-Line Lower | 1.4-4.1mm | Per Bezier | ✅ Uses Bezier |
   126→| Gonial Angle | 115-121° | 115-121° | ✅ Match |
   127→| Facial Convexity (Nasion) | 163-166° | 163-166° | ✅ Match |
   128→| Facial Convexity (Glabella) | 170-175° | 170-175° | ✅ Fixed |
   129→| Total Facial Convexity | 140-147° | 140-147° | ✅ Fixed |
   130→| Mentolabial Angle | 111-127° | 111-127° | ✅ Match |
   131→| Mandibular Plane | 15-22° | 15-22° | ✅ Match |
   132→| Nasofrontal Angle | 116-128° | 116-128° | ✅ Match |
   133→
   134→*All metrics use Bezier curves which provide smooth scoring across the full range.*
   135→
   136→### 2.2 Inverted Signs/Wrong Units ✅ ALL FIXED
   137→
   138→| Metric | LOOKSMAXX | FaceIQ | Status |
   139→|--------|-----------|--------|--------|
   140→| E-Line Upper Lip | ✅ Negated in code | Negative = behind | **FIXED** (line 3922) |
   141→| E-Line Lower Lip | ✅ Negated in code | Negative = behind | **FIXED** (line 3923) |
   142→| Burstone Upper | ✅ Negated in code | mm behind as negative | **FIXED** (line 3933) |
   143→| Burstone Lower | ✅ Negated in code | mm behind as negative | **FIXED** (line 3934) |
   144→| Holdaway H-Line | ✅ Added calculation | mm, positive = in front | **ADDED** (line 3957) |
   145→| Steiner S-Line | ✅ Added calculation | mm, positive = in front | **ADDED** (lines 3945-3946) |
   146→
   147→> **Note**: S-Line and H-Line were missing calculations entirely. Added 2025-12-23.
   148→
   149→### 2.3 Nasal Tip Angle ✅ CORRECT
   150→
   151→**LOOKSMAXX ideal**: 128.5° - 138.5° (10° range)
   152→**FaceIQ Bezier curve**: 128.5° - 138.5° (10° range) ✅ MATCHES
   153→
   154→The Bezier curve in `faceiq-bezier-curves.ts` (lines 988-989) shows the ideal zone (y=10) spans 128.5-138.5°.
   155→This is correctly implemented in `faceiq-scoring.ts` (lines 1401-1402).
   156→
   157→> Note: Previous documentation incorrectly stated 90-115° vs 104-108°. The actual extracted Bezier curve uses 128.5-138.5°.
   158→
   159→---
   160→
   161→## 3. Landmark Detection Differences
   162→
   163→### 3.1 Frankfort Plane ✅ FIXED
   164→
   165→**Location**: `src/lib/mediapipeDetection.ts` (line 117)
   166→
   167→| Point | LOOKSMAXX Index | FaceIQ Index | Status |
   168→|-------|-----------------|--------------|--------|
   169→| Orbitale (Infraorbital) | ✅ 33 | 33 | **FIXED** |
   170→| Porion (Ear) | 127 | Correct | ✅ |
   171→| Tragion | 127 | Correct | ✅ |
   172→
   173→All side profile measurements now use correct Frankfort plane reference.
   174→
   175→### 3.2 Side Profile Detection Algorithm
   176→
   177→**FaceIQ Method** (from landmark_detection_analysis.md):
   178→```javascript
   179→// Yaw threshold + 3D depth check
   180→isSideProfile = Math.abs(yawAngle) > 35 && depthVariance > 0.15
   181→```
   182→
   183→**LOOKSMAXX Method**: Simpler yaw-only check without depth verification
   184→
   185→---
   186→
   187→## 4. Treatment/Advice System Differences
   188→
   189→### 4.1 Missing Metadata Fields
   190→
   191→**FaceIQ Structure** (from final_content_library.json):
   192→```json
   193→{
   194→  "advice": {
   195→    "ref_id": "cheek_filler_01",
   196→    "name": "Cheek Filler",
   197→    "description": "...",
   198→    "priority_score": 3,
   199→    "effectiveness": {
   200→      "level": "high",
   201→      "score": 5,
   202→      "confidence": 0.85
   203→    },
   204→    "effect_start": "immediate",
   205→    "recovery_weeks": 1,
   206→    "duration_months": 12,
   207→    "cost_range": "$600-$1200",
   208→    "risk_level": "low",
   209→    "flaws_addresses": [{
   210→      "flaw": "Flat & small cheekbones",
   211→      "pillars": ["angularity", "harmony"],
   212→      "ratios_impacted": {
   213→        "Cheekbone height": { "direction": "increase", "percentage": 2 },
   214→        "Bigonial to Bizygomatic": { "direction": "decrease", "percentage": 1 }
   215→      }
   216→    }]
   217→  }
   218→}
   219→```
   220→
   221→**LOOKSMAXX Structure** (current):
   222→```typescript
   223→{
   224→  name: string;
   225→  description: string;
   226→  category: string;
   227→  flaws_addressed: string[];
   228→  // MISSING: priority_score, effectiveness, effect_start,
   229→  //          pillars, ratios_impacted, recovery_weeks,
   230→  //          duration_months, cost_range, risk_level
   231→}
   232→```
   233→
   234→### 4.2 Missing Impact Tables
   235→
   236→FaceIQ includes quantitative procedure→metric mappings:
   237→
   238→| Procedure | Metric Affected | Direction | % Change |
   239→|-----------|-----------------|-----------|----------|
   240→| Jaw Filler | Bigonial Width | increase | 3% |
   241→| Jaw Filler | Gonial Angle | decrease | 2° |
   242→| Rhinoplasty | Nasal Index | decrease | 5% |
   243→| Rhinoplasty | Nasolabial Angle | increase | 8° |
   244→| Lip Filler | Vermilion Ratio | increase | 15% |
   245→| Cheek Filler | Cheekbone Height | increase | 2% |
   246→| Brow Lift | Brow Position | increase | 4mm |
   247→| Chin Implant | Chin Projection | increase | 6mm |
   248→
   249→**LOOKSMAXX**: No quantitative impact data
   250→
   251→### 4.3 Missing Flaw-to-Treatment Trigger Rules
   252→
   253→**FaceIQ** (from logic_report.md):
   254→```
   255→IF Canthal Tilt < 5° THEN recommend:
   256→  - Canthoplasty (priority: 5)
   257→  - Fox Eye Thread Lift (priority: 3)
   258→
   259→IF Gonial Angle > 130° THEN recommend:
   260→  - Jaw Reduction Surgery (priority: 4)
   261→  - Masseter Botox (priority: 2)
   262→
   263→IF E-Line Upper Lip > 2mm THEN recommend:
   264→  - Lip Reduction (priority: 3)
   265→  - Rhinoplasty (priority: 2)
   266→```
   267→
   268→**LOOKSMAXX**: Uses simple string matching without priority ordering
   269→
   270→---
   271→
   272→## 5. Plan & Potential Calculation
   273→
   274→### 5.1 Potential Score Algorithm
   275→
   276→**FaceIQ Method** (from facial_potential_simulator.py):
   277→```python
   278→def calculate_potential(self):
   279→    overrides = {}
   280→    for ratio in all_ratios:
   281→        value = ratio.get('value', 0)
   282→        ideal_min = ratio.get('idealMin', 0)
   283→        ideal_max = ratio.get('idealMax', 0)
   284→
   285→        # If flawed, set to ideal midpoint
   286→        if value < ideal_min or value > ideal_max:
   287→            ideal_mid = (ideal_min + ideal_max) / 2
   288→            overrides[name] = ideal_mid
   289→
   290→    # Recalculate using EXACT Bezier curves
   291→    current_score = self._get_total_score_pct({})
   292→    potential_score = self._get_total_score_pct(overrides)
   293→    improvement = potential_score - current_score
   294→```
   295→
   296→**LOOKSMAXX Method** (estimated):
   297→```typescript
   298→// Sum up treatment effectiveness scores
   299→potentialImprovement = treatments.reduce((sum, t) =>
   300→  sum + t.estimatedImprovement, 0);
   301→```
   302→
   303→**Difference**: FaceIQ recalculates entire score with idealized metrics; LOOKSMAXX estimates from treatment impact sums.
   304→
   305→### 5.2 Plan Ordering Logic
   306→
   307→**FaceIQ**:
   308→1. Sort by `priority_score` (5 = most important)
   309→2. Group by `pillars` (harmony categories)
   310→3. Show `effectiveness.score` for each
   311→4. Calculate cumulative potential improvement
   312→
   313→**LOOKSMAXX**:
   314→1. Group by category only
   315→2. No priority ordering
   316→3. No effectiveness scores shown
   317→4. No cumulative calculation
   318→
   319→---
   320→
   321→## 6. UI/Content Differences
   322→
   323→### 6.1 Missing Outcome Predictions
   324→
   325→**FaceIQ** shows:
   326→- Before/After visualization overlay
   327→- Predicted metric values post-treatment
   328→- Confidence intervals on predictions
   329→- Timeline for results
   330→
   331→**LOOKSMAXX**: Shows recommendations without outcome predictions
   332→
   333→### 6.2 Missing Severity Indicators
   334→
   335→**FaceIQ** uses 5-tier severity:
   336→- Severe Flaw (>3σ from ideal)
   337→- Moderate Flaw (2-3σ)
   338→- Mild Flaw (1-2σ)
   339→- Balanced (within ideal)
   340→- Strength (<-1σ favorable)
   341→
   342→**LOOKSMAXX**: Binary flaw/strength classification
   343→
   344→---
   345→
   346→## 7. File Change Map
   347→
   348→### Priority 0 - Critical (Breaks Scoring) ✅ COMPLETE
   349→
   350→| File | Changes Required | Status |
   351→|------|------------------|--------|
   352→| `src/lib/faceiq-bezier-curves.ts` | Import 66 Bezier curves | ✅ Done |
   353→| `src/lib/faceiq-scoring.ts` | Fix 6 inverted sign/unit metrics | ✅ Done (6/6) |
   354→| `src/lib/faceiq-scoring.ts` | Add S-Line calculations | ✅ Added (lines 3945-3946) |
   355→| `src/lib/faceiq-scoring.ts` | Add Holdaway H-Line calculation | ✅ Added (line 3957) |
   356→| `src/lib/faceiq-scoring.ts` | Nasal Tip Angle range | ✅ Correct (128.5-138.5°) |
   357→| `src/lib/faceiq-scoring.ts` | Adjust all 10 decay rates | ⚠️ TODO |
   358→| `src/lib/mediapipeDetection.ts` | Fix Frankfort Plane orbitale | ✅ Done (33) |
   359→
   360→### Priority 1 - High (Affects Accuracy)
   361→
   362→| File | Changes Required |
   363→|------|------------------|
   364→| `src/lib/faceiq-scoring.ts` | Correct 24 ideal min/max values |
   365→| `src/lib/advice-engine.ts` | Add priority_score, effectiveness, effect_start |
   366→| `src/types/results.ts` | Extend types for new metadata fields |
   367→| `src/contexts/ResultsContext.tsx` | Update potential calculation algorithm |
   368→
   369→### Priority 2 - Medium (Feature Parity)
   370→
   371→| File | Changes Required |
   372→|------|------------------|
   373→| `src/lib/advice-engine.ts` | Add impact tables (procedure→metric changes) |
   374→| `src/lib/advice-engine.ts` | Add pillars and ratios_impacted |
   375→| `src/components/results/tabs/PlanTab.tsx` | Show effectiveness scores |
   376→| `src/components/results/tabs/PlanTab.tsx` | Add priority ordering |
   377→
   378→### Priority 3 - Low (Polish)
   379→
   380→| File | Changes Required |
   381→|------|------------------|
   382→| `src/lib/mediapipeDetection.ts` | Add depth variance to side profile detection |
   383→| `src/components/results/` | Add outcome prediction overlays |
   384→| `src/lib/insights-engine.ts` | Add 5-tier severity classification |
   385→| `src/components/results/` | Add timeline visualization |
   386→
   387→---
   388→
   389→## 8. Source File References
   390→
   391→### FaceIQ LOGIC Folder
   392→
   393→| File | Purpose | Key Data |
   394→|------|---------|----------|
   395→| `harmony_data.json` | Bezier curves, ideals | 66 curves, control points |
   396→| `final_content_library.json` | Treatment database | Impact tables, priorities |
   397→| `facial_potential_simulator.py` | Potential algorithm | Exact calculation method |
   398→| `logic_report.md` | Flaw→Treatment rules | Trigger conditions |
   399→| `deobfuscated_scoring.js` | Scoring engine | Bezier interpolation |
   400→| `landmark_detection_analysis.md` | MediaPipe config | Side profile detection |
   401→
   402→### LOOKSMAXX Files to Modify
   403→
   404→| File | Line Range | Change Type |
   405→|------|------------|-------------|
   406→| `src/lib/faceiq-scoring.ts` | 50-200 | Add Bezier curves |
   407→| `src/lib/faceiq-scoring.ts` | 200-350 | Fix ideal ranges |
   408→| `src/lib/faceiq-scoring.ts` | 350-400 | Fix decay rates |
   409→| `src/lib/mediapipeDetection.ts` | ~145 | Fix landmark index |
   410→| `src/lib/advice-engine.ts` | 1-500 | Add all metadata |
   411→| `src/types/results.ts` | 1-100 | Extend interfaces |
   412→| `src/contexts/ResultsContext.tsx` | 200-300 | Fix potential calc |
   413→
   414→---
   415→
   416→## 9. Verification Checklist
   417→
   418→After implementing changes, verify:
   419→
   420→- [x] All 66 Bezier curves loaded and functional ✅
   421→- [ ] Decay rates match FaceIQ (0.07-0.3 range)
   422→- [x] Ideal ranges verified for 10/12 key metrics ✅
   423→- [x] E-Line and Burstone signs correct ✅
   424→- [x] S-Line calculations added ✅ (2025-12-23)
   425→- [x] Holdaway H-Line calculation added ✅ (2025-12-23)
   426→- [x] Nasal Tip Angle uses 128.5-138.5° range ✅
   427→- [x] Frankfort Plane uses orbitale index 33 ✅
   428→- [ ] Side profile detection includes depth check
   429→- [ ] Treatments have priority_score (1-5)
   430→- [ ] Treatments have effectiveness.score (1-5)
   431→- [ ] Treatments have ratios_impacted data
   432→- [ ] Potential score uses Bezier recalculation
   433→- [ ] Plan tab shows priority ordering
   434→- [ ] Plan tab shows effectiveness ratings
   435→
   436→---
   437→
   438→## 10. Implementation Order Recommendation
   439→
   440→### Phase 1: Scoring Accuracy (P0) ✅ COMPLETE
   441→1. ✅ Import Bezier curves → `faceiq-bezier-curves.ts` (66/66 curves)
   442→2. ✅ Fix sign inversions → `faceiq-scoring.ts` (E-Line, Burstone negated)
   443→3. ✅ Nasal Tip Angle → Already correct (128.5-138.5°)
   444→4. ✅ Fix Frankfort Plane → `mediapipeDetection.ts` (orbitale=33)
   445→
   446→### Phase 2: Metric Accuracy (P1) - IN PROGRESS
   447→5. ⚠️ Verify ~5 ideal ranges → `faceiq-scoring.ts`
   448→6. ⚠️ Fix 10 decay rates → `faceiq-scoring.ts`
   449→7. ✅ Types extended → `results.ts`
   450→
   451→### Phase 3: Treatment Metadata (P2) - TODO
   452→8. ❌ Add priority_score → `advice-engine.ts`
   453→9. ❌ Add effectiveness → `advice-engine.ts`
   454→10. ❌ Add ratios_impacted → `advice-engine.ts`
   455→11. ❌ Update PlanTab UI → `PlanTab.tsx`
   456→
   457→### Phase 4: Potential Calculation (P2) - TODO
   458→12. ❌ Update algorithm → `ResultsContext.tsx`
   459→
   460→### Phase 5: Polish (P3) - TODO
   461→13. ❌ Side profile depth check → `mediapipeDetection.ts`
   462→14. ❌ Severity tiers → `insights-engine.ts`
   463→15. ❌ Outcome predictions → new components
   464→
   465→---
   466→
   467→## Appendix A: Previous Demographic Override Analysis
   468→
   469→> Note: FaceIQ does NOT use different ideal ranges per ethnicity/gender in their scoring algorithm. Their scoring is universal. We chose to implement actual ethnicity/gender-specific ranges based on anthropometric research.
   470→
   471→### Ethnicities Supported
   472→- `east_asian`, `south_asian`, `black`, `hispanic`, `middle_eastern`, `native_american`, `pacific_islander`, `white`, `other`
   473→
   474→### Key Demographic Variations Implemented
   475→
   476→| Metric | Variation Type | Notes |
   477→|--------|---------------|-------|
   478→| `nasalIndex` | Ethnicity (High) | African: 85-100, Asian: 80-90, Caucasian: 70-80 |
   479→| `bigonialWidth` | Gender | Males: 90-95%, Females: 85-90% |
   480→| `lateralCanthalTilt` | Ethnicity | East Asian: 8-13° vs Default: 6-8° |
   481→
   482→---
   483→
   484→*End of Comparison Report*
   485→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
