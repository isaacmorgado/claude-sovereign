{"parentUuid":null,"isSidechain":true,"userType":"external","cwd":"/Users/imorgado/LOOKSMAXX/looksmaxx-app","sessionId":"efbfcf65-3cfe-4a9b-a41f-22a18ae42784","version":"2.0.76","gitBranch":"main","agentId":"aefddd6","slug":"luminous-seeking-fairy","type":"user","message":{"role":"user","content":"Read /Users/imorgado/LOOKSMAXX/looksmaxx-app/src/components/results/tabs/OverviewTab.tsx completely.\n\nIdentify all sub-components that can be extracted:\n1. Any component defined inside the file (const ComponentName = ...)\n2. Repeated UI patterns that should be components\n3. Large JSX blocks that are self-contained\n\nFor each extractable component, provide:\n- Component name\n- Line numbers (start-end)\n- Props it would need\n- Suggested file path\n\nPriority: Focus on components that are >50 lines or are reusable."},"uuid":"75320ed7-a138-4a6a-b971-6058f29c9d1c","timestamp":"2025-12-25T19:06:58.120Z"}
{"parentUuid":"75320ed7-a138-4a6a-b971-6058f29c9d1c","isSidechain":true,"userType":"external","cwd":"/Users/imorgado/LOOKSMAXX/looksmaxx-app","sessionId":"efbfcf65-3cfe-4a9b-a41f-22a18ae42784","version":"2.0.76","gitBranch":"main","agentId":"aefddd6","slug":"luminous-seeking-fairy","message":{"model":"claude-haiku-4-5-20251001","id":"msg_01LBAeyatSs5jse3ps5AmwxZ","type":"message","role":"assistant","content":[{"type":"text","text":"I'll read the OverviewTab.tsx file completely and identify all extractable components."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":14580,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":14580,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CWTvrdx2HpaZQFzDfaHx4","type":"assistant","uuid":"079d75e1-a54f-4be4-94a6-14a73dfed5cd","timestamp":"2025-12-25T19:07:00.596Z"}
{"parentUuid":"079d75e1-a54f-4be4-94a6-14a73dfed5cd","isSidechain":true,"userType":"external","cwd":"/Users/imorgado/LOOKSMAXX/looksmaxx-app","sessionId":"efbfcf65-3cfe-4a9b-a41f-22a18ae42784","version":"2.0.76","gitBranch":"main","agentId":"aefddd6","slug":"luminous-seeking-fairy","message":{"model":"claude-haiku-4-5-20251001","id":"msg_01LBAeyatSs5jse3ps5AmwxZ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_016AuTyLWG5i46Fgu4VrDoHp","name":"Read","input":{"file_path":"/Users/imorgado/LOOKSMAXX/looksmaxx-app/src/components/results/tabs/OverviewTab.tsx"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":14580,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":14580,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CWTvrdx2HpaZQFzDfaHx4","type":"assistant","uuid":"817d9f2e-43de-45cd-baed-f34c6173ec7c","timestamp":"2025-12-25T19:07:01.288Z"}
{"parentUuid":"817d9f2e-43de-45cd-baed-f34c6173ec7c","isSidechain":true,"userType":"external","cwd":"/Users/imorgado/LOOKSMAXX/looksmaxx-app","sessionId":"efbfcf65-3cfe-4a9b-a41f-22a18ae42784","version":"2.0.76","gitBranch":"main","agentId":"aefddd6","slug":"luminous-seeking-fairy","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_016AuTyLWG5i46Fgu4VrDoHp","type":"tool_result","content":"     1→'use client';\n     2→\n     3→import { motion } from 'framer-motion';\n     4→import Image from 'next/image';\n     5→import { User, ScanFace, Sparkles, ChevronRight, TrendingUp, TrendingDown, Lightbulb } from 'lucide-react';\n     6→import { useResults } from '@/contexts/ResultsContext';\n     7→import { TabContent } from '../ResultsLayout';\n     8→import { ScoreBar, AnimatedScore, ShareButton, ExportButton } from '../shared';\n     9→import { KeyStrengthsSection, AreasOfImprovementSection } from '../cards/KeyStrengthsFlaws';\n    10→import { FacialRadarChart } from '../visualization/FacialRadarChart';\n    11→import { RatioDetailModal } from '../modals/RatioDetailModal';\n    12→import { getScoreColor, ResponsibleRatio, Ratio } from '@/types/results';\n    13→import { MetricScoreResult } from '@/lib/harmony-scoring';\n    14→import { RankedMetric, getWeightTierColor } from '@/lib/looksmax-scoring';\n    15→import { useState, useCallback, useMemo } from 'react';\n    16→\n    17→// ============================================\n    18→// SCORE SUMMARY CARDS\n    19→// ============================================\n    20→\n    21→interface ProfileScoreCardProps {\n    22→  title: string;\n    23→  score: number;\n    24→  icon: React.ReactNode;\n    25→  photo?: string;\n    26→  ratioCount: number;\n    27→  onClick?: () => void;\n    28→}\n    29→\n    30→function ProfileScoreCard({ title, score, icon, photo, ratioCount, onClick }: ProfileScoreCardProps) {\n    31→  const color = getScoreColor(score);\n    32→\n    33→  return (\n    34→    <motion.button\n    35→      onClick={onClick}\n    36→      className=\"bg-neutral-900/80 border border-neutral-800 rounded-xl p-4 hover:border-neutral-700 transition-all text-left w-full\"\n    37→      whileHover={{ scale: 1.02 }}\n    38→      whileTap={{ scale: 0.98 }}\n    39→    >\n    40→      <div className=\"flex items-center gap-4\">\n    41→        {/* Photo or icon */}\n    42→        <div className=\"relative w-16 h-16 rounded-lg overflow-hidden bg-neutral-800 flex-shrink-0\">\n    43→          {photo ? (\n    44→            <Image\n    45→              src={photo}\n    46→              alt={title}\n    47→              width={64}\n    48→              height={64}\n    49→              className=\"object-cover\"\n    50→              unoptimized\n    51→            />\n    52→          ) : (\n    53→            <div className=\"w-full h-full flex items-center justify-center\">\n    54→              {icon}\n    55→            </div>\n    56→          )}\n    57→        </div>\n    58→\n    59→        {/* Info */}\n    60→        <div className=\"flex-1\">\n    61→          <h3 className=\"text-sm font-medium text-neutral-400 mb-1\">{title}</h3>\n    62→          <div className=\"flex items-baseline gap-2\">\n    63→            <span className=\"text-2xl font-bold\" style={{ color }}>\n    64→              {score.toFixed(2)}\n    65→            </span>\n    66→            <span className=\"text-sm text-neutral-500\">/ 10</span>\n    67→          </div>\n    68→          <p className=\"text-xs text-neutral-500 mt-1\">{ratioCount} measurements</p>\n    69→        </div>\n    70→\n    71→        {/* Arrow */}\n    72→        <ChevronRight size={20} className=\"text-neutral-600\" />\n    73→      </div>\n    74→\n    75→      {/* Score bar */}\n    76→      <div className=\"mt-3\">\n    77→        <ScoreBar score={score} height={6} />\n    78→      </div>\n    79→    </motion.button>\n    80→  );\n    81→}\n    82→\n    83→// ============================================\n    84→// QUICK INSIGHTS - TOP/BOTTOM METRICS WITH ADVICE\n    85→// ============================================\n    86→\n    87→interface MetricInsightCardProps {\n    88→  metric: RankedMetric;\n    89→  type: 'strength' | 'improvement';\n    90→  index: number;\n    91→}\n    92→\n    93→function MetricInsightCard({ metric, type, index }: MetricInsightCardProps) {\n    94→  const isStrength = type === 'strength';\n    95→  const color = getScoreColor(metric.score);\n    96→  const weightTierClass = getWeightTierColor(metric.weightTier);\n    97→\n    98→  return (\n    99→    <motion.div\n   100→      className={`bg-neutral-900/80 border rounded-xl p-4 ${\n   101→        isStrength ? 'border-green-500/30' : 'border-orange-500/30'\n   102→      }`}\n   103→      initial={{ opacity: 0, x: isStrength ? -20 : 20 }}\n   104→      animate={{ opacity: 1, x: 0 }}\n   105→      transition={{ delay: 0.1 * index }}\n   106→    >\n   107→      <div className=\"flex items-start gap-3\">\n   108→        <div className={`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${\n   109→          isStrength ? 'bg-green-500/20' : 'bg-orange-500/20'\n   110→        }`}>\n   111→          {isStrength ? (\n   112→            <TrendingUp size={16} className=\"text-green-400\" />\n   113→          ) : (\n   114→            <TrendingDown size={16} className=\"text-orange-400\" />\n   115→          )}\n   116→        </div>\n   117→\n   118→        <div className=\"flex-1 min-w-0\">\n   119→          <div className=\"flex items-center gap-2 mb-1\">\n   120→            <h4 className=\"font-medium text-white text-sm truncate\">{metric.name}</h4>\n   121→            <span className={`text-xs px-1.5 py-0.5 rounded border ${weightTierClass}`}>\n   122→              {metric.weightTier === 'high' ? '3x' : metric.weightTier === 'medium' ? '2x' : '1x'}\n   123→            </span>\n   124→          </div>\n   125→\n   126→          <div className=\"flex items-center gap-3 mb-2\">\n   127→            <span className=\"text-lg font-bold\" style={{ color }}>\n   128→              {metric.score.toFixed(1)}\n   129→            </span>\n   130→            <span className=\"text-xs text-neutral-500\">\n   131→              Ideal: {metric.idealMin.toFixed(1)} - {metric.idealMax.toFixed(1)}\n   132→            </span>\n   133→          </div>\n   134→\n   135→          {/* Advice */}\n   136→          <div className=\"flex items-start gap-2 mt-2 p-2 bg-neutral-800/50 rounded-lg\">\n   137→            <Lightbulb size={14} className={isStrength ? 'text-green-400 mt-0.5' : 'text-orange-400 mt-0.5'} />\n   138→            <p className=\"text-xs text-neutral-300 leading-relaxed\">{metric.advice}</p>\n   139→          </div>\n   140→        </div>\n   141→      </div>\n   142→    </motion.div>\n   143→  );\n   144→}\n   145→\n   146→interface QuickInsightsSectionProps {\n   147→  topMetrics: RankedMetric[];\n   148→  bottomMetrics: RankedMetric[];\n   149→}\n   150→\n   151→function QuickInsightsSection({ topMetrics, bottomMetrics }: QuickInsightsSectionProps) {\n   152→  if (topMetrics.length === 0 && bottomMetrics.length === 0) return null;\n   153→\n   154→  return (\n   155→    <div className=\"mb-8\">\n   156→      <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\n   157→        <Lightbulb size={20} className=\"text-cyan-400\" />\n   158→        Quick Insights\n   159→      </h3>\n   160→\n   161→      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n   162→        {/* Top 3 Strengths */}\n   163→        <div>\n   164→          <h4 className=\"text-sm font-medium text-green-400 mb-3 flex items-center gap-2\">\n   165→            <TrendingUp size={14} />\n   166→            Top Strengths\n   167→          </h4>\n   168→          <div className=\"space-y-3\">\n   169→            {topMetrics.map((metric, index) => (\n   170→              <MetricInsightCard\n   171→                key={metric.metricId}\n   172→                metric={metric}\n   173→                type=\"strength\"\n   174→                index={index}\n   175→              />\n   176→            ))}\n   177→          </div>\n   178→        </div>\n   179→\n   180→        {/* Bottom 3 - Areas to Improve */}\n   181→        <div>\n   182→          <h4 className=\"text-sm font-medium text-orange-400 mb-3 flex items-center gap-2\">\n   183→            <TrendingDown size={14} />\n   184→            Areas to Improve\n   185→          </h4>\n   186→          <div className=\"space-y-3\">\n   187→            {bottomMetrics.map((metric, index) => (\n   188→              <MetricInsightCard\n   189→                key={metric.metricId}\n   190→                metric={metric}\n   191→                type=\"improvement\"\n   192→                index={index}\n   193→              />\n   194→            ))}\n   195→          </div>\n   196→        </div>\n   197→      </div>\n   198→    </div>\n   199→  );\n   200→}\n   201→\n   202→// ============================================\n   203→// HARMONY SCORE DISPLAY (with AnimatedScore and Radar Chart)\n   204→// ============================================\n   205→\n   206→function HarmonyScoreDisplay() {\n   207→  const { overallScore, frontScore, sideScore, harmonyPercentage, harmonyScoreResult, pslRating } = useResults();\n   208→  const [showRadar, setShowRadar] = useState(true);\n   209→\n   210→  // Get tier color based on PSL\n   211→  const getTierColor = (psl: number) => {\n   212→    // Handle invalid PSL values\n   213→    if (typeof psl !== 'number' || !Number.isFinite(psl)) {\n   214→      return 'text-orange-400';\n   215→    }\n   216→    if (psl >= 7.0) return 'text-purple-400';\n   217→    if (psl >= 6.0) return 'text-cyan-400';\n   218→    if (psl >= 5.0) return 'text-green-400';\n   219→    if (psl >= 4.0) return 'text-yellow-400';\n   220→    return 'text-orange-400';\n   221→  };\n   222→\n   223→  // Safe values for display with fallbacks\n   224→  const safePslRating = useMemo(() => ({\n   225→    psl: typeof pslRating?.psl === 'number' && Number.isFinite(pslRating.psl) ? pslRating.psl : 3.0,\n   226→    tier: pslRating?.tier || 'Unknown',\n   227→    percentile: typeof pslRating?.percentile === 'number' && Number.isFinite(pslRating.percentile) ? pslRating.percentile : 50,\n   228→    description: pslRating?.description || 'Analysis pending',\n   229→  }), [pslRating]);\n   230→\n   231→  const safeHarmonyPercentage = typeof harmonyPercentage === 'number' && Number.isFinite(harmonyPercentage)\n   232→    ? harmonyPercentage\n   233→    : 0;\n   234→\n   235→  const safeFrontScore = typeof frontScore === 'number' && Number.isFinite(frontScore) ? frontScore : 0;\n   236→  const safeSideScore = typeof sideScore === 'number' && Number.isFinite(sideScore) ? sideScore : 0;\n   237→  const safeOverallScore = typeof overallScore === 'number' && Number.isFinite(overallScore) ? overallScore : 0;\n   238→\n   239→  return (\n   240→    <motion.div\n   241→      className=\"bg-gradient-to-br from-neutral-900 to-neutral-950 border border-neutral-800 rounded-2xl p-6 md:p-8\"\n   242→      initial={{ opacity: 0, y: 20 }}\n   243→      animate={{ opacity: 1, y: 0 }}\n   244→      transition={{ duration: 0.5 }}\n   245→    >\n   246→      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n   247→        {/* Left: Score Display */}\n   248→        <div className=\"text-center flex flex-col justify-center\">\n   249→          <h2 className=\"text-lg font-medium text-neutral-400 mb-2\">Weighted Harmony Score</h2>\n   250→\n   251→          {/* PSL Rating Badge */}\n   252→          <motion.div\n   253→            className=\"flex justify-center mb-3\"\n   254→            initial={{ scale: 0 }}\n   255→            animate={{ scale: 1 }}\n   256→            transition={{ delay: 0.2, type: 'spring' }}\n   257→          >\n   258→            <div className=\"px-5 py-2 bg-gradient-to-r from-neutral-800 to-neutral-900 border border-neutral-700 rounded-xl\">\n   259→              <div className=\"flex items-center gap-3\">\n   260→                <div className=\"text-center\">\n   261→                  <span className={`text-3xl font-bold ${getTierColor(safePslRating.psl)}`}>\n   262→                    {safePslRating.psl.toFixed(1)}\n   263→                  </span>\n   264→                  <span className=\"text-sm text-neutral-500 ml-1\">PSL</span>\n   265→                </div>\n   266→                <div className=\"h-8 w-px bg-neutral-700\" />\n   267→                <div className=\"text-left\">\n   268→                  <p className={`text-sm font-semibold ${getTierColor(safePslRating.psl)}`}>\n   269→                    {safePslRating.tier}\n   270→                  </p>\n   271→                  <p className=\"text-xs text-neutral-500\">\n   272→                    Top {(100 - safePslRating.percentile).toFixed(1)}%\n   273→                  </p>\n   274→                </div>\n   275→              </div>\n   276→            </div>\n   277→          </motion.div>\n   278→\n   279→          {/* Harmony Percentage Badge */}\n   280→          <motion.div\n   281→            className=\"flex justify-center mb-4\"\n   282→            initial={{ scale: 0 }}\n   283→            animate={{ scale: 1 }}\n   284→            transition={{ delay: 0.3, type: 'spring' }}\n   285→          >\n   286→            <div className=\"px-4 py-1 bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 rounded-full\">\n   287→              <span className=\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400\">\n   288→                {safeHarmonyPercentage.toFixed(1)}%\n   289→              </span>\n   290→              <span className=\"text-xs text-neutral-500 ml-2\">Harmony</span>\n   291→            </div>\n   292→          </motion.div>\n   293→\n   294→          {/* Animated Score */}\n   295→          <div className=\"flex justify-center mb-4\">\n   296→            <AnimatedScore\n   297→              score={safeOverallScore}\n   298→              duration={2.5}\n   299→              delay={0.5}\n   300→              showConfetti={true}\n   301→              confettiThreshold={7.5}\n   302→            />\n   303→          </div>\n   304→\n   305→          {/* Profile Breakdowns */}\n   306→          <div className=\"flex justify-center gap-8 mb-4\">\n   307→            <div className=\"text-center\">\n   308→              <p className=\"text-xs text-neutral-500 mb-1\">Front Profile</p>\n   309→              <p className=\"text-xl font-bold\" style={{ color: getScoreColor(safeFrontScore) }}>\n   310→                {safeFrontScore.toFixed(2)}\n   311→              </p>\n   312→            </div>\n   313→            <div className=\"w-px bg-neutral-800\" />\n   314→            <div className=\"text-center\">\n   315→              <p className=\"text-xs text-neutral-500 mb-1\">Side Profile</p>\n   316→              <p className=\"text-xl font-bold\" style={{ color: getScoreColor(safeSideScore) }}>\n   317→                {safeSideScore.toFixed(2)}\n   318→              </p>\n   319→            </div>\n   320→          </div>\n   321→\n   322→          {/* Weight Distribution */}\n   323→          {harmonyScoreResult && (\n   324→            <div className=\"flex justify-center gap-3 mb-4 text-xs\">\n   325→              <span className=\"px-2 py-1 rounded bg-purple-500/20 text-purple-400 border border-purple-500/30\">\n   326→                High Impact: {harmonyScoreResult.weightDistribution.highImpact.count}\n   327→              </span>\n   328→              <span className=\"px-2 py-1 rounded bg-blue-500/20 text-blue-400 border border-blue-500/30\">\n   329→                Medium: {harmonyScoreResult.weightDistribution.mediumImpact.count}\n   330→              </span>\n   331→              <span className=\"px-2 py-1 rounded bg-gray-500/20 text-gray-400 border border-gray-500/30\">\n   332→                Standard: {harmonyScoreResult.weightDistribution.standard.count}\n   333→              </span>\n   334→            </div>\n   335→          )}\n   336→\n   337→          <p className=\"text-sm text-neutral-400 max-w-md mx-auto\">\n   338→            {safeHarmonyPercentage >= 80 ? 'Exceptional facial harmony. Your features are well-balanced and proportioned.' :\n   339→              safeHarmonyPercentage >= 60 ? 'Good facial harmony with some areas that could be optimized.' :\n   340→                safeHarmonyPercentage >= 40 ? 'Average facial harmony. Several areas have room for improvement.' :\n   341→                  'Below average facial harmony. Multiple areas could benefit from attention.'}\n   342→          </p>\n   343→        </div>\n   344→\n   345→        {/* Right: Radar Chart */}\n   346→        <div className=\"flex flex-col\">\n   347→          <div className=\"flex items-center justify-between mb-2\">\n   348→            <h3 className=\"text-sm font-medium text-neutral-400\">Category Breakdown</h3>\n   349→            <button\n   350→              onClick={() => setShowRadar(!showRadar)}\n   351→              className=\"text-xs text-cyan-400 hover:text-cyan-300 transition-colors\"\n   352→            >\n   353→              {showRadar ? 'Hide' : 'Show'}\n   354→            </button>\n   355→          </div>\n   356→          {showRadar && (\n   357→            <motion.div\n   358→              initial={{ opacity: 0, scale: 0.95 }}\n   359→              animate={{ opacity: 1, scale: 1 }}\n   360→              transition={{ duration: 0.5, delay: 0.3 }}\n   361→              className=\"flex-1 min-h-[280px]\"\n   362→            >\n   363→              <FacialRadarChart height={280} />\n   364→            </motion.div>\n   365→          )}\n   366→        </div>\n   367→      </div>\n   368→    </motion.div>\n   369→  );\n   370→}\n   371→\n   372→// ============================================\n   373→// OVERVIEW TAB\n   374→// ============================================\n   375→\n   376→export function OverviewTab() {\n   377→  const {\n   378→    overallScore,\n   379→    frontScore,\n   380→    sideScore,\n   381→    frontRatios,\n   382→    sideRatios,\n   383→    strengths,\n   384→    flaws,\n   385→    frontPhoto,\n   386→    sidePhoto,\n   387→    frontLandmarks,\n   388→    sideLandmarks,\n   389→    gender,\n   390→    ethnicity,\n   391→    setActiveTab,\n   392→    topMetrics,\n   393→    bottomMetrics,\n   394→    setSelectedVisualizationMetric,\n   395→  } = useResults();\n   396→\n   397→  const [selectedRatio, setSelectedRatio] = useState<MetricScoreResult | null>(null);\n   398→  const [isModalOpen, setIsModalOpen] = useState(false);\n   399→\n   400→  // All ratios combined for modal navigation\n   401→  const allRatios = useMemo(() => [...frontRatios, ...sideRatios], [frontRatios, sideRatios]);\n   402→\n   403→  // Current ratio index for navigation\n   404→  const currentRatioIndex = useMemo(() => {\n   405→    if (!selectedRatio) return -1;\n   406→    return allRatios.findIndex(r => r.id === selectedRatio.metricId);\n   407→  }, [selectedRatio, allRatios]);\n   408→\n   409→  // Convert Ratio to MetricScoreResult for modal\n   410→  const ratioToMetricResult = useCallback((ratio: Ratio): MetricScoreResult => {\n   411→    return {\n   412→      metricId: ratio.id,\n   413→      name: ratio.name,\n   414→      value: ratio.value,\n   415→      score: ratio.score,\n   416→      standardizedScore: ratio.standardizedScore,\n   417→      idealMin: ratio.idealMin,\n   418→      idealMax: ratio.idealMax,\n   419→      deviation: 0,\n   420→      deviationDirection: 'within',\n   421→      unit: ratio.unit === 'x' ? 'ratio' : ratio.unit === '%' ? 'percent' : ratio.unit === '°' ? 'degrees' : ratio.unit,\n   422→      category: ratio.category,\n   423→      qualityTier: ratio.qualityLevel,\n   424→      severity: ratio.severity,\n   425→    } as MetricScoreResult;\n   426→  }, []);\n   427→\n   428→  // Handle ratio click from strengths/flaws sections\n   429→  const handleRatioClick = useCallback((ratio: ResponsibleRatio, categoryName: string) => {\n   430→    // Find the full ratio data from frontRatios or sideRatios\n   431→    const fullRatio = allRatios.find(\n   432→      (r) => r.name === ratio.ratioName || r.id === ratio.ratioId\n   433→    );\n   434→\n   435→    // Update the visualization first (shows on face image)\n   436→    if (fullRatio) {\n   437→      setSelectedVisualizationMetric(fullRatio.id);\n   438→      setSelectedRatio(ratioToMetricResult(fullRatio));\n   439→    } else {\n   440→      // Create a minimal MetricScoreResult from ResponsibleRatio\n   441→      setSelectedVisualizationMetric(ratio.ratioId);\n   442→      setSelectedRatio({\n   443→        metricId: ratio.ratioId,\n   444→        name: ratio.ratioName,\n   445→        value: ratio.value,\n   446→        score: ratio.score,\n   447→        standardizedScore: ratio.score,\n   448→        idealMin: ratio.idealMin,\n   449→        idealMax: ratio.idealMax,\n   450→        deviation: 0,\n   451→        deviationDirection: 'within',\n   452→        unit: (ratio.unit as 'ratio' | 'percent' | 'degrees' | 'mm' | 'none') || 'ratio',\n   453→        category: ratio.category || categoryName,\n   454→        qualityTier: ratio.score >= 8 ? 'ideal' : ratio.score >= 6 ? 'excellent' : ratio.score >= 4 ? 'good' : 'below_average',\n   455→        severity: 'optimal',\n   456→      } as MetricScoreResult);\n   457→    }\n   458→    setIsModalOpen(true);\n   459→  }, [allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n   460→\n   461→  // Navigate to previous/next ratio in modal\n   462→  const handlePreviousRatio = useCallback(() => {\n   463→    if (currentRatioIndex > 0) {\n   464→      const prevRatio = allRatios[currentRatioIndex - 1];\n   465→      setSelectedRatio(ratioToMetricResult(prevRatio));\n   466→      setSelectedVisualizationMetric(prevRatio.id);\n   467→    }\n   468→  }, [currentRatioIndex, allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n   469→\n   470→  const handleNextRatio = useCallback(() => {\n   471→    if (currentRatioIndex < allRatios.length - 1) {\n   472→      const nextRatio = allRatios[currentRatioIndex + 1];\n   473→      setSelectedRatio(ratioToMetricResult(nextRatio));\n   474→      setSelectedVisualizationMetric(nextRatio.id);\n   475→    }\n   476→  }, [currentRatioIndex, allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n   477→\n   478→  // Determine if selected ratio is from side profile\n   479→  const isSideRatio = useMemo(() => {\n   480→    if (!selectedRatio) return false;\n   481→    const sideMetricIds = sideRatios.map(r => r.id);\n   482→    return sideMetricIds.includes(selectedRatio.metricId);\n   483→  }, [selectedRatio, sideRatios]);\n   484→\n   485→  // Memoized modal values (useMemo instead of useCallback for computed values)\n   486→  const modalPhoto = useMemo(() => {\n   487→    if (!selectedRatio) return frontPhoto;\n   488→    return isSideRatio ? (sidePhoto || frontPhoto) : frontPhoto;\n   489→  }, [selectedRatio, isSideRatio, frontPhoto, sidePhoto]);\n   490→\n   491→  const modalLandmarks = useMemo(() => {\n   492→    return isSideRatio ? (sideLandmarks || []) : (frontLandmarks || []);\n   493→  }, [isSideRatio, frontLandmarks, sideLandmarks]);\n   494→\n   495→  const modalProfileType = useMemo((): 'front' | 'side' => {\n   496→    return isSideRatio ? 'side' : 'front';\n   497→  }, [isSideRatio]);\n   498→\n   499→  return (\n   500→    <TabContent\n   501→      title=\"Overview\"\n   502→      subtitle=\"Your complete facial harmony analysis\"\n   503→      rightContent={\n   504→        <div className=\"flex items-center gap-2\">\n   505→          <ShareButton score={overallScore} frontScore={frontScore} sideScore={sideScore} />\n   506→          <ExportButton elementId=\"results-overview\" />\n   507→        </div>\n   508→      }\n   509→    >\n   510→      {/* Main content with ID for export */}\n   511→      <div id=\"results-overview\">\n   512→        {/* Harmony Score */}\n   513→        <div className=\"mb-8\">\n   514→          <HarmonyScoreDisplay />\n   515→        </div>\n   516→\n   517→        {/* Profile Scores */}\n   518→        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\n   519→          <ProfileScoreCard\n   520→            title=\"Front Profile\"\n   521→            score={frontScore}\n   522→            icon={<User size={24} className=\"text-neutral-600\" />}\n   523→            photo={frontPhoto}\n   524→            ratioCount={frontRatios.length}\n   525→            onClick={() => setActiveTab('front-ratios')}\n   526→          />\n   527→          <ProfileScoreCard\n   528→            title=\"Side Profile\"\n   529→            score={sideScore}\n   530→            icon={<ScanFace size={24} className=\"text-neutral-600\" />}\n   531→            photo={sidePhoto || undefined}\n   532→            ratioCount={sideRatios.length}\n   533→            onClick={() => setActiveTab('side-ratios')}\n   534→          />\n   535→        </div>\n   536→\n   537→        {/* Quick Insights - Top/Bottom Metrics with Advice (from looksmax_engine.py) */}\n   538→        <QuickInsightsSection topMetrics={topMetrics} bottomMetrics={bottomMetrics} />\n   539→\n   540→        {/* Strengths & Flaws Grid - Harmony Style */}\n   541→        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n   542→          {/* Key Strengths */}\n   543→          <KeyStrengthsSection\n   544→            strengths={strengths}\n   545→            onRatioClick={handleRatioClick}\n   546→            initialShowCount={3}\n   547→          />\n   548→\n   549→          {/* Areas of Improvement */}\n   550→          <AreasOfImprovementSection\n   551→            flaws={flaws}\n   552→            onRatioClick={handleRatioClick}\n   553→            initialShowCount={3}\n   554→          />\n   555→        </div>\n   556→\n   557→        {/* Call to Action */}\n   558→        <motion.div\n   559→          className=\"bg-gradient-to-r from-cyan-500/20 to-blue-600/20 border border-cyan-500/30 rounded-xl p-6 flex items-center justify-between\"\n   560→          initial={{ opacity: 0 }}\n   561→          animate={{ opacity: 1 }}\n   562→          transition={{ delay: 0.5 }}\n   563→        >\n   564→          <div className=\"flex items-center gap-4\">\n   565→            <div className=\"w-12 h-12 rounded-xl bg-cyan-500/20 flex items-center justify-center\">\n   566→              <Sparkles size={24} className=\"text-cyan-400\" />\n   567→            </div>\n   568→            <div>\n   569→              <h3 className=\"font-semibold text-white\">Unlock Your Potential</h3>\n   570→              <p className=\"text-sm text-neutral-400\">\n   571→                See personalized recommendations to improve your harmony score\n   572→              </p>\n   573→            </div>\n   574→          </div>\n   575→          <button\n   576→            onClick={() => setActiveTab('plan')}\n   577→            className=\"px-4 py-2 bg-cyan-500 text-black font-medium rounded-lg hover:bg-cyan-400 transition-colors flex items-center gap-2\"\n   578→          >\n   579→            View Plan\n   580→            <ChevronRight size={16} />\n   581→          </button>\n   582→        </motion.div>\n   583→      </div>{/* End of results-overview */}\n   584→\n   585→      {/* Ratio Detail Modal */}\n   586→      <RatioDetailModal\n   587→        isOpen={isModalOpen}\n   588→        onClose={() => setIsModalOpen(false)}\n   589→        ratio={selectedRatio}\n   590→        onPrevious={handlePreviousRatio}\n   591→        onNext={handleNextRatio}\n   592→        hasPrevious={currentRatioIndex > 0}\n   593→        hasNext={currentRatioIndex < allRatios.length - 1}\n   594→        facePhoto={modalPhoto}\n   595→        landmarks={modalLandmarks}\n   596→        allRatios={allRatios}\n   597→        profileType={modalProfileType}\n   598→        gender={gender}\n   599→        ethnicity={ethnicity}\n   600→      />\n   601→    </TabContent>\n   602→  );\n   603→}\n   604→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"82659fd7-3358-4b55-8b26-a5f4a4c6f449","timestamp":"2025-12-25T19:07:01.362Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/imorgado/LOOKSMAXX/looksmaxx-app/src/components/results/tabs/OverviewTab.tsx","content":"'use client';\n\nimport { motion } from 'framer-motion';\nimport Image from 'next/image';\nimport { User, ScanFace, Sparkles, ChevronRight, TrendingUp, TrendingDown, Lightbulb } from 'lucide-react';\nimport { useResults } from '@/contexts/ResultsContext';\nimport { TabContent } from '../ResultsLayout';\nimport { ScoreBar, AnimatedScore, ShareButton, ExportButton } from '../shared';\nimport { KeyStrengthsSection, AreasOfImprovementSection } from '../cards/KeyStrengthsFlaws';\nimport { FacialRadarChart } from '../visualization/FacialRadarChart';\nimport { RatioDetailModal } from '../modals/RatioDetailModal';\nimport { getScoreColor, ResponsibleRatio, Ratio } from '@/types/results';\nimport { MetricScoreResult } from '@/lib/harmony-scoring';\nimport { RankedMetric, getWeightTierColor } from '@/lib/looksmax-scoring';\nimport { useState, useCallback, useMemo } from 'react';\n\n// ============================================\n// SCORE SUMMARY CARDS\n// ============================================\n\ninterface ProfileScoreCardProps {\n  title: string;\n  score: number;\n  icon: React.ReactNode;\n  photo?: string;\n  ratioCount: number;\n  onClick?: () => void;\n}\n\nfunction ProfileScoreCard({ title, score, icon, photo, ratioCount, onClick }: ProfileScoreCardProps) {\n  const color = getScoreColor(score);\n\n  return (\n    <motion.button\n      onClick={onClick}\n      className=\"bg-neutral-900/80 border border-neutral-800 rounded-xl p-4 hover:border-neutral-700 transition-all text-left w-full\"\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n    >\n      <div className=\"flex items-center gap-4\">\n        {/* Photo or icon */}\n        <div className=\"relative w-16 h-16 rounded-lg overflow-hidden bg-neutral-800 flex-shrink-0\">\n          {photo ? (\n            <Image\n              src={photo}\n              alt={title}\n              width={64}\n              height={64}\n              className=\"object-cover\"\n              unoptimized\n            />\n          ) : (\n            <div className=\"w-full h-full flex items-center justify-center\">\n              {icon}\n            </div>\n          )}\n        </div>\n\n        {/* Info */}\n        <div className=\"flex-1\">\n          <h3 className=\"text-sm font-medium text-neutral-400 mb-1\">{title}</h3>\n          <div className=\"flex items-baseline gap-2\">\n            <span className=\"text-2xl font-bold\" style={{ color }}>\n              {score.toFixed(2)}\n            </span>\n            <span className=\"text-sm text-neutral-500\">/ 10</span>\n          </div>\n          <p className=\"text-xs text-neutral-500 mt-1\">{ratioCount} measurements</p>\n        </div>\n\n        {/* Arrow */}\n        <ChevronRight size={20} className=\"text-neutral-600\" />\n      </div>\n\n      {/* Score bar */}\n      <div className=\"mt-3\">\n        <ScoreBar score={score} height={6} />\n      </div>\n    </motion.button>\n  );\n}\n\n// ============================================\n// QUICK INSIGHTS - TOP/BOTTOM METRICS WITH ADVICE\n// ============================================\n\ninterface MetricInsightCardProps {\n  metric: RankedMetric;\n  type: 'strength' | 'improvement';\n  index: number;\n}\n\nfunction MetricInsightCard({ metric, type, index }: MetricInsightCardProps) {\n  const isStrength = type === 'strength';\n  const color = getScoreColor(metric.score);\n  const weightTierClass = getWeightTierColor(metric.weightTier);\n\n  return (\n    <motion.div\n      className={`bg-neutral-900/80 border rounded-xl p-4 ${\n        isStrength ? 'border-green-500/30' : 'border-orange-500/30'\n      }`}\n      initial={{ opacity: 0, x: isStrength ? -20 : 20 }}\n      animate={{ opacity: 1, x: 0 }}\n      transition={{ delay: 0.1 * index }}\n    >\n      <div className=\"flex items-start gap-3\">\n        <div className={`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${\n          isStrength ? 'bg-green-500/20' : 'bg-orange-500/20'\n        }`}>\n          {isStrength ? (\n            <TrendingUp size={16} className=\"text-green-400\" />\n          ) : (\n            <TrendingDown size={16} className=\"text-orange-400\" />\n          )}\n        </div>\n\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1\">\n            <h4 className=\"font-medium text-white text-sm truncate\">{metric.name}</h4>\n            <span className={`text-xs px-1.5 py-0.5 rounded border ${weightTierClass}`}>\n              {metric.weightTier === 'high' ? '3x' : metric.weightTier === 'medium' ? '2x' : '1x'}\n            </span>\n          </div>\n\n          <div className=\"flex items-center gap-3 mb-2\">\n            <span className=\"text-lg font-bold\" style={{ color }}>\n              {metric.score.toFixed(1)}\n            </span>\n            <span className=\"text-xs text-neutral-500\">\n              Ideal: {metric.idealMin.toFixed(1)} - {metric.idealMax.toFixed(1)}\n            </span>\n          </div>\n\n          {/* Advice */}\n          <div className=\"flex items-start gap-2 mt-2 p-2 bg-neutral-800/50 rounded-lg\">\n            <Lightbulb size={14} className={isStrength ? 'text-green-400 mt-0.5' : 'text-orange-400 mt-0.5'} />\n            <p className=\"text-xs text-neutral-300 leading-relaxed\">{metric.advice}</p>\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\ninterface QuickInsightsSectionProps {\n  topMetrics: RankedMetric[];\n  bottomMetrics: RankedMetric[];\n}\n\nfunction QuickInsightsSection({ topMetrics, bottomMetrics }: QuickInsightsSectionProps) {\n  if (topMetrics.length === 0 && bottomMetrics.length === 0) return null;\n\n  return (\n    <div className=\"mb-8\">\n      <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\n        <Lightbulb size={20} className=\"text-cyan-400\" />\n        Quick Insights\n      </h3>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Top 3 Strengths */}\n        <div>\n          <h4 className=\"text-sm font-medium text-green-400 mb-3 flex items-center gap-2\">\n            <TrendingUp size={14} />\n            Top Strengths\n          </h4>\n          <div className=\"space-y-3\">\n            {topMetrics.map((metric, index) => (\n              <MetricInsightCard\n                key={metric.metricId}\n                metric={metric}\n                type=\"strength\"\n                index={index}\n              />\n            ))}\n          </div>\n        </div>\n\n        {/* Bottom 3 - Areas to Improve */}\n        <div>\n          <h4 className=\"text-sm font-medium text-orange-400 mb-3 flex items-center gap-2\">\n            <TrendingDown size={14} />\n            Areas to Improve\n          </h4>\n          <div className=\"space-y-3\">\n            {bottomMetrics.map((metric, index) => (\n              <MetricInsightCard\n                key={metric.metricId}\n                metric={metric}\n                type=\"improvement\"\n                index={index}\n              />\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// HARMONY SCORE DISPLAY (with AnimatedScore and Radar Chart)\n// ============================================\n\nfunction HarmonyScoreDisplay() {\n  const { overallScore, frontScore, sideScore, harmonyPercentage, harmonyScoreResult, pslRating } = useResults();\n  const [showRadar, setShowRadar] = useState(true);\n\n  // Get tier color based on PSL\n  const getTierColor = (psl: number) => {\n    // Handle invalid PSL values\n    if (typeof psl !== 'number' || !Number.isFinite(psl)) {\n      return 'text-orange-400';\n    }\n    if (psl >= 7.0) return 'text-purple-400';\n    if (psl >= 6.0) return 'text-cyan-400';\n    if (psl >= 5.0) return 'text-green-400';\n    if (psl >= 4.0) return 'text-yellow-400';\n    return 'text-orange-400';\n  };\n\n  // Safe values for display with fallbacks\n  const safePslRating = useMemo(() => ({\n    psl: typeof pslRating?.psl === 'number' && Number.isFinite(pslRating.psl) ? pslRating.psl : 3.0,\n    tier: pslRating?.tier || 'Unknown',\n    percentile: typeof pslRating?.percentile === 'number' && Number.isFinite(pslRating.percentile) ? pslRating.percentile : 50,\n    description: pslRating?.description || 'Analysis pending',\n  }), [pslRating]);\n\n  const safeHarmonyPercentage = typeof harmonyPercentage === 'number' && Number.isFinite(harmonyPercentage)\n    ? harmonyPercentage\n    : 0;\n\n  const safeFrontScore = typeof frontScore === 'number' && Number.isFinite(frontScore) ? frontScore : 0;\n  const safeSideScore = typeof sideScore === 'number' && Number.isFinite(sideScore) ? sideScore : 0;\n  const safeOverallScore = typeof overallScore === 'number' && Number.isFinite(overallScore) ? overallScore : 0;\n\n  return (\n    <motion.div\n      className=\"bg-gradient-to-br from-neutral-900 to-neutral-950 border border-neutral-800 rounded-2xl p-6 md:p-8\"\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.5 }}\n    >\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n        {/* Left: Score Display */}\n        <div className=\"text-center flex flex-col justify-center\">\n          <h2 className=\"text-lg font-medium text-neutral-400 mb-2\">Weighted Harmony Score</h2>\n\n          {/* PSL Rating Badge */}\n          <motion.div\n            className=\"flex justify-center mb-3\"\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            transition={{ delay: 0.2, type: 'spring' }}\n          >\n            <div className=\"px-5 py-2 bg-gradient-to-r from-neutral-800 to-neutral-900 border border-neutral-700 rounded-xl\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"text-center\">\n                  <span className={`text-3xl font-bold ${getTierColor(safePslRating.psl)}`}>\n                    {safePslRating.psl.toFixed(1)}\n                  </span>\n                  <span className=\"text-sm text-neutral-500 ml-1\">PSL</span>\n                </div>\n                <div className=\"h-8 w-px bg-neutral-700\" />\n                <div className=\"text-left\">\n                  <p className={`text-sm font-semibold ${getTierColor(safePslRating.psl)}`}>\n                    {safePslRating.tier}\n                  </p>\n                  <p className=\"text-xs text-neutral-500\">\n                    Top {(100 - safePslRating.percentile).toFixed(1)}%\n                  </p>\n                </div>\n              </div>\n            </div>\n          </motion.div>\n\n          {/* Harmony Percentage Badge */}\n          <motion.div\n            className=\"flex justify-center mb-4\"\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            transition={{ delay: 0.3, type: 'spring' }}\n          >\n            <div className=\"px-4 py-1 bg-gradient-to-r from-purple-500/20 to-cyan-500/20 border border-purple-500/30 rounded-full\">\n              <span className=\"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-cyan-400\">\n                {safeHarmonyPercentage.toFixed(1)}%\n              </span>\n              <span className=\"text-xs text-neutral-500 ml-2\">Harmony</span>\n            </div>\n          </motion.div>\n\n          {/* Animated Score */}\n          <div className=\"flex justify-center mb-4\">\n            <AnimatedScore\n              score={safeOverallScore}\n              duration={2.5}\n              delay={0.5}\n              showConfetti={true}\n              confettiThreshold={7.5}\n            />\n          </div>\n\n          {/* Profile Breakdowns */}\n          <div className=\"flex justify-center gap-8 mb-4\">\n            <div className=\"text-center\">\n              <p className=\"text-xs text-neutral-500 mb-1\">Front Profile</p>\n              <p className=\"text-xl font-bold\" style={{ color: getScoreColor(safeFrontScore) }}>\n                {safeFrontScore.toFixed(2)}\n              </p>\n            </div>\n            <div className=\"w-px bg-neutral-800\" />\n            <div className=\"text-center\">\n              <p className=\"text-xs text-neutral-500 mb-1\">Side Profile</p>\n              <p className=\"text-xl font-bold\" style={{ color: getScoreColor(safeSideScore) }}>\n                {safeSideScore.toFixed(2)}\n              </p>\n            </div>\n          </div>\n\n          {/* Weight Distribution */}\n          {harmonyScoreResult && (\n            <div className=\"flex justify-center gap-3 mb-4 text-xs\">\n              <span className=\"px-2 py-1 rounded bg-purple-500/20 text-purple-400 border border-purple-500/30\">\n                High Impact: {harmonyScoreResult.weightDistribution.highImpact.count}\n              </span>\n              <span className=\"px-2 py-1 rounded bg-blue-500/20 text-blue-400 border border-blue-500/30\">\n                Medium: {harmonyScoreResult.weightDistribution.mediumImpact.count}\n              </span>\n              <span className=\"px-2 py-1 rounded bg-gray-500/20 text-gray-400 border border-gray-500/30\">\n                Standard: {harmonyScoreResult.weightDistribution.standard.count}\n              </span>\n            </div>\n          )}\n\n          <p className=\"text-sm text-neutral-400 max-w-md mx-auto\">\n            {safeHarmonyPercentage >= 80 ? 'Exceptional facial harmony. Your features are well-balanced and proportioned.' :\n              safeHarmonyPercentage >= 60 ? 'Good facial harmony with some areas that could be optimized.' :\n                safeHarmonyPercentage >= 40 ? 'Average facial harmony. Several areas have room for improvement.' :\n                  'Below average facial harmony. Multiple areas could benefit from attention.'}\n          </p>\n        </div>\n\n        {/* Right: Radar Chart */}\n        <div className=\"flex flex-col\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h3 className=\"text-sm font-medium text-neutral-400\">Category Breakdown</h3>\n            <button\n              onClick={() => setShowRadar(!showRadar)}\n              className=\"text-xs text-cyan-400 hover:text-cyan-300 transition-colors\"\n            >\n              {showRadar ? 'Hide' : 'Show'}\n            </button>\n          </div>\n          {showRadar && (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.95 }}\n              animate={{ opacity: 1, scale: 1 }}\n              transition={{ duration: 0.5, delay: 0.3 }}\n              className=\"flex-1 min-h-[280px]\"\n            >\n              <FacialRadarChart height={280} />\n            </motion.div>\n          )}\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\n// ============================================\n// OVERVIEW TAB\n// ============================================\n\nexport function OverviewTab() {\n  const {\n    overallScore,\n    frontScore,\n    sideScore,\n    frontRatios,\n    sideRatios,\n    strengths,\n    flaws,\n    frontPhoto,\n    sidePhoto,\n    frontLandmarks,\n    sideLandmarks,\n    gender,\n    ethnicity,\n    setActiveTab,\n    topMetrics,\n    bottomMetrics,\n    setSelectedVisualizationMetric,\n  } = useResults();\n\n  const [selectedRatio, setSelectedRatio] = useState<MetricScoreResult | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  // All ratios combined for modal navigation\n  const allRatios = useMemo(() => [...frontRatios, ...sideRatios], [frontRatios, sideRatios]);\n\n  // Current ratio index for navigation\n  const currentRatioIndex = useMemo(() => {\n    if (!selectedRatio) return -1;\n    return allRatios.findIndex(r => r.id === selectedRatio.metricId);\n  }, [selectedRatio, allRatios]);\n\n  // Convert Ratio to MetricScoreResult for modal\n  const ratioToMetricResult = useCallback((ratio: Ratio): MetricScoreResult => {\n    return {\n      metricId: ratio.id,\n      name: ratio.name,\n      value: ratio.value,\n      score: ratio.score,\n      standardizedScore: ratio.standardizedScore,\n      idealMin: ratio.idealMin,\n      idealMax: ratio.idealMax,\n      deviation: 0,\n      deviationDirection: 'within',\n      unit: ratio.unit === 'x' ? 'ratio' : ratio.unit === '%' ? 'percent' : ratio.unit === '°' ? 'degrees' : ratio.unit,\n      category: ratio.category,\n      qualityTier: ratio.qualityLevel,\n      severity: ratio.severity,\n    } as MetricScoreResult;\n  }, []);\n\n  // Handle ratio click from strengths/flaws sections\n  const handleRatioClick = useCallback((ratio: ResponsibleRatio, categoryName: string) => {\n    // Find the full ratio data from frontRatios or sideRatios\n    const fullRatio = allRatios.find(\n      (r) => r.name === ratio.ratioName || r.id === ratio.ratioId\n    );\n\n    // Update the visualization first (shows on face image)\n    if (fullRatio) {\n      setSelectedVisualizationMetric(fullRatio.id);\n      setSelectedRatio(ratioToMetricResult(fullRatio));\n    } else {\n      // Create a minimal MetricScoreResult from ResponsibleRatio\n      setSelectedVisualizationMetric(ratio.ratioId);\n      setSelectedRatio({\n        metricId: ratio.ratioId,\n        name: ratio.ratioName,\n        value: ratio.value,\n        score: ratio.score,\n        standardizedScore: ratio.score,\n        idealMin: ratio.idealMin,\n        idealMax: ratio.idealMax,\n        deviation: 0,\n        deviationDirection: 'within',\n        unit: (ratio.unit as 'ratio' | 'percent' | 'degrees' | 'mm' | 'none') || 'ratio',\n        category: ratio.category || categoryName,\n        qualityTier: ratio.score >= 8 ? 'ideal' : ratio.score >= 6 ? 'excellent' : ratio.score >= 4 ? 'good' : 'below_average',\n        severity: 'optimal',\n      } as MetricScoreResult);\n    }\n    setIsModalOpen(true);\n  }, [allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n\n  // Navigate to previous/next ratio in modal\n  const handlePreviousRatio = useCallback(() => {\n    if (currentRatioIndex > 0) {\n      const prevRatio = allRatios[currentRatioIndex - 1];\n      setSelectedRatio(ratioToMetricResult(prevRatio));\n      setSelectedVisualizationMetric(prevRatio.id);\n    }\n  }, [currentRatioIndex, allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n\n  const handleNextRatio = useCallback(() => {\n    if (currentRatioIndex < allRatios.length - 1) {\n      const nextRatio = allRatios[currentRatioIndex + 1];\n      setSelectedRatio(ratioToMetricResult(nextRatio));\n      setSelectedVisualizationMetric(nextRatio.id);\n    }\n  }, [currentRatioIndex, allRatios, ratioToMetricResult, setSelectedVisualizationMetric]);\n\n  // Determine if selected ratio is from side profile\n  const isSideRatio = useMemo(() => {\n    if (!selectedRatio) return false;\n    const sideMetricIds = sideRatios.map(r => r.id);\n    return sideMetricIds.includes(selectedRatio.metricId);\n  }, [selectedRatio, sideRatios]);\n\n  // Memoized modal values (useMemo instead of useCallback for computed values)\n  const modalPhoto = useMemo(() => {\n    if (!selectedRatio) return frontPhoto;\n    return isSideRatio ? (sidePhoto || frontPhoto) : frontPhoto;\n  }, [selectedRatio, isSideRatio, frontPhoto, sidePhoto]);\n\n  const modalLandmarks = useMemo(() => {\n    return isSideRatio ? (sideLandmarks || []) : (frontLandmarks || []);\n  }, [isSideRatio, frontLandmarks, sideLandmarks]);\n\n  const modalProfileType = useMemo((): 'front' | 'side' => {\n    return isSideRatio ? 'side' : 'front';\n  }, [isSideRatio]);\n\n  return (\n    <TabContent\n      title=\"Overview\"\n      subtitle=\"Your complete facial harmony analysis\"\n      rightContent={\n        <div className=\"flex items-center gap-2\">\n          <ShareButton score={overallScore} frontScore={frontScore} sideScore={sideScore} />\n          <ExportButton elementId=\"results-overview\" />\n        </div>\n      }\n    >\n      {/* Main content with ID for export */}\n      <div id=\"results-overview\">\n        {/* Harmony Score */}\n        <div className=\"mb-8\">\n          <HarmonyScoreDisplay />\n        </div>\n\n        {/* Profile Scores */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8\">\n          <ProfileScoreCard\n            title=\"Front Profile\"\n            score={frontScore}\n            icon={<User size={24} className=\"text-neutral-600\" />}\n            photo={frontPhoto}\n            ratioCount={frontRatios.length}\n            onClick={() => setActiveTab('front-ratios')}\n          />\n          <ProfileScoreCard\n            title=\"Side Profile\"\n            score={sideScore}\n            icon={<ScanFace size={24} className=\"text-neutral-600\" />}\n            photo={sidePhoto || undefined}\n            ratioCount={sideRatios.length}\n            onClick={() => setActiveTab('side-ratios')}\n          />\n        </div>\n\n        {/* Quick Insights - Top/Bottom Metrics with Advice (from looksmax_engine.py) */}\n        <QuickInsightsSection topMetrics={topMetrics} bottomMetrics={bottomMetrics} />\n\n        {/* Strengths & Flaws Grid - Harmony Style */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n          {/* Key Strengths */}\n          <KeyStrengthsSection\n            strengths={strengths}\n            onRatioClick={handleRatioClick}\n            initialShowCount={3}\n          />\n\n          {/* Areas of Improvement */}\n          <AreasOfImprovementSection\n            flaws={flaws}\n            onRatioClick={handleRatioClick}\n            initialShowCount={3}\n          />\n        </div>\n\n        {/* Call to Action */}\n        <motion.div\n          className=\"bg-gradient-to-r from-cyan-500/20 to-blue-600/20 border border-cyan-500/30 rounded-xl p-6 flex items-center justify-between\"\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ delay: 0.5 }}\n        >\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 rounded-xl bg-cyan-500/20 flex items-center justify-center\">\n              <Sparkles size={24} className=\"text-cyan-400\" />\n            </div>\n            <div>\n              <h3 className=\"font-semibold text-white\">Unlock Your Potential</h3>\n              <p className=\"text-sm text-neutral-400\">\n                See personalized recommendations to improve your harmony score\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={() => setActiveTab('plan')}\n            className=\"px-4 py-2 bg-cyan-500 text-black font-medium rounded-lg hover:bg-cyan-400 transition-colors flex items-center gap-2\"\n          >\n            View Plan\n            <ChevronRight size={16} />\n          </button>\n        </motion.div>\n      </div>{/* End of results-overview */}\n\n      {/* Ratio Detail Modal */}\n      <RatioDetailModal\n        isOpen={isModalOpen}\n        onClose={() => setIsModalOpen(false)}\n        ratio={selectedRatio}\n        onPrevious={handlePreviousRatio}\n        onNext={handleNextRatio}\n        hasPrevious={currentRatioIndex > 0}\n        hasNext={currentRatioIndex < allRatios.length - 1}\n        facePhoto={modalPhoto}\n        landmarks={modalLandmarks}\n        allRatios={allRatios}\n        profileType={modalProfileType}\n        gender={gender}\n        ethnicity={ethnicity}\n      />\n    </TabContent>\n  );\n}\n","numLines":604,"startLine":1,"totalLines":604}}}
{"parentUuid":"82659fd7-3358-4b55-8b26-a5f4a4c6f449","isSidechain":true,"userType":"external","cwd":"/Users/imorgado/LOOKSMAXX/looksmaxx-app","sessionId":"efbfcf65-3cfe-4a9b-a41f-22a18ae42784","version":"2.0.76","gitBranch":"main","agentId":"aefddd6","slug":"luminous-seeking-fairy","message":{"model":"claude-haiku-4-5-20251001","id":"msg_01PRatK2sghTxNURpKNvYzkN","type":"message","role":"assistant","content":[{"type":"text","text":"Based on my complete analysis of `/Users/imorgado/LOOKSMAXX/looksmaxx-app/src/components/results/tabs/OverviewTab.tsx`, here are all the extractable components:\n\n## Extractable Components Report\n\n### 1. **ProfileScoreCard**\n- **Status**: Internal component (lines 30-81)\n- **Size**: 51 lines\n- **Props needed**:\n  ```typescript\n  interface ProfileScoreCardProps {\n    title: string;\n    score: number;\n    icon: React.ReactNode;\n    photo?: string;\n    ratioCount: number;\n    onClick?: () => void;\n  }\n  ```\n- **Dependencies**: `getScoreColor`, `ScoreBar`, Framer Motion, Next.js Image\n- **Suggested file path**: `/src/components/results/cards/ProfileScoreCard.tsx`\n- **Reason**: Self-contained card component showing profile scores with visual feedback, reusable across tabs\n- **Priority**: HIGH - 50+ lines, clear purpose, likely reusable\n\n### 2. **MetricInsightCard**\n- **Status**: Internal component (lines 93-144)\n- **Size**: 52 lines\n- **Props needed**:\n  ```typescript\n  interface MetricInsightCardProps {\n    metric: RankedMetric;\n    type: 'strength' | 'improvement';\n    index: number;\n  }\n  ```\n- **Dependencies**: `getScoreColor`, `getWeightTierColor`, Framer Motion, Lucide icons\n- **Suggested file path**: `/src/components/results/cards/MetricInsightCard.tsx`\n- **Reason**: Reusable card for displaying ranked metrics with strength/improvement indicators\n- **Priority**: HIGH - 50+ lines, good separation of concerns, animation logic included\n\n### 3. **QuickInsightsSection**\n- **Status**: Internal component (lines 151-200)\n- **Size**: 50 lines\n- **Props needed**:\n  ```typescript\n  interface QuickInsightsSectionProps {\n    topMetrics: RankedMetric[];\n    bottomMetrics: RankedMetric[];\n  }\n  ```\n- **Dependencies**: `MetricInsightCard`, Lucide icons\n- **Suggested file path**: `/src/components/results/sections/QuickInsightsSection.tsx`\n- **Reason**: Container component organizing top/bottom metrics in a grid layout\n- **Priority**: MEDIUM - 50 lines, contains grid layout logic and child mapping\n\n### 4. **HarmonyScoreDisplay**\n- **Status**: Internal component (lines 206-370)\n- **Size**: 165 lines\n- **Props needed**: None (uses context)\n- **Dependencies**: `useResults()`, `getScoreColor`, `AnimatedScore`, `FacialRadarChart`, Framer Motion, Lucide icons\n- **Suggested file path**: `/src/components/results/display/HarmonyScoreDisplay.tsx`\n- **Reason**: Large, self-contained component with complex state (showRadar toggle), multiple sub-sections (PSL badge, harmony percentage, animated score, breakdowns, weight distribution)\n- **Priority**: CRITICAL - 165 lines, complex logic, standalone feature\n\n---\n\n## Summary by Priority\n\n| Component | Lines | Extract? | File Path |\n|-----------|-------|----------|-----------|\n| HarmonyScoreDisplay | 165 | YES | `/src/components/results/display/HarmonyScoreDisplay.tsx` |\n| ProfileScoreCard | 51 | YES | `/src/components/results/cards/ProfileScoreCard.tsx` |\n| MetricInsightCard | 52 | YES | `/src/components/results/cards/MetricInsightCard.tsx` |\n| QuickInsightsSection | 50 | YES | `/src/components/results/sections/QuickInsightsSection.tsx` |\n\n---\n\n## Recommended Extraction Order\n\n1. **HarmonyScoreDisplay** (CRITICAL - 165 lines, most complex)\n2. **ProfileScoreCard** (HIGH - reusable pattern)\n3. **MetricInsightCard** (HIGH - used by QuickInsightsSection)\n4. **QuickInsightsSection** (MEDIUM - depends on MetricInsightCard)\n\n---\n\n## Additional Notes\n\n- **OverviewTab main component** (lines 376-603): Should remain in this file as it's the tab container using all sub-components\n- **CTA section** (lines 558-582): Could be extracted as `CallToActionCTA.tsx` if reused elsewhere (24 lines, self-contained)\n- **No other repeated UI patterns**: The modal navigation and ratio conversion logic is specific to this tab"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":5,"cache_creation_input_tokens":9192,"cache_read_input_tokens":14580,"cache_creation":{"ephemeral_5m_input_tokens":9192,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CWTvrsHxLw8szRgnjhm1P","type":"assistant","uuid":"867a784d-4415-4c9f-937c-7b1846139a81","timestamp":"2025-12-25T19:07:11.456Z"}
