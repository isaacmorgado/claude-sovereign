     1→'use client';
     2→
     3→import { useState } from 'react';
     4→import { formatDistanceToNow } from 'date-fns';
     5→import {
     6→  AlertTriangle,
     7→  MessageSquare,
     8→  FileText,
     9→  User,
    10→  Clock,
    11→  CheckCircle,
    12→  XCircle,
    13→  Ban,
    14→  Trash2,
    15→  Eye,
    16→  ChevronDown,
    17→  ChevronUp,
    18→} from 'lucide-react';
    19→import type {
    20→  ReportDetail,
    21→  ReportStatusEnum,
    22→  ActionTaken,
    23→  ResolveReportRequest,
    24→} from '@/types/forum';
    25→
    26→interface ReportCardProps {
    27→  report: ReportDetail;
    28→  onResolve: (reportId: string, data: ResolveReportRequest) => Promise<void>;
    29→  onRemoveContent: (targetType: 'post' | 'comment', targetId: string) => Promise<void>;
    30→  onBanUser: (userId: string) => Promise<void>;
    31→  onViewContent: (targetType: 'post' | 'comment', targetId: string) => void;
    32→  isLoading?: boolean;
    33→}
    34→
    35→const REASON_LABELS: Record<string, { label: string; color: string }> = {
    36→  spam: { label: 'Spam', color: 'bg-yellow-500/20 text-yellow-400' },
    37→  harassment: { label: 'Harassment', color: 'bg-red-500/20 text-red-400' },
    38→  misinformation: { label: 'Misinformation', color: 'bg-orange-500/20 text-orange-400' },
    39→  off_topic: { label: 'Off Topic', color: 'bg-blue-500/20 text-blue-400' },
    40→  inappropriate: { label: 'Inappropriate', color: 'bg-purple-500/20 text-purple-400' },
    41→  other: { label: 'Other', color: 'bg-gray-500/20 text-gray-400' },
    42→};
    43→
    44→const STATUS_LABELS: Record<ReportStatusEnum, { label: string; color: string; icon: React.ReactNode }> = {
    45→  pending: { label: 'Pending', color: 'bg-yellow-500/20 text-yellow-400', icon: <Clock className="w-3.5 h-3.5" /> },
    46→  reviewed: { label: 'Reviewed', color: 'bg-blue-500/20 text-blue-400', icon: <Eye className="w-3.5 h-3.5" /> },
    47→  resolved: { label: 'Resolved', color: 'bg-green-500/20 text-green-400', icon: <CheckCircle className="w-3.5 h-3.5" /> },
    48→  dismissed: { label: 'Dismissed', color: 'bg-gray-500/20 text-gray-400', icon: <XCircle className="w-3.5 h-3.5" /> },
    49→};
    50→
    51→export function ReportCard({
    52→  report,
    53→  onResolve,
    54→  onRemoveContent,
    55→  onBanUser,
    56→  onViewContent,
    57→  isLoading = false,
    58→}: ReportCardProps) {
    59→  const [isExpanded, setIsExpanded] = useState(false);
    60→  const [resolutionNotes, setResolutionNotes] = useState('');
    61→  const [selectedAction, setSelectedAction] = useState<ActionTaken | null>(null);
    62→  const [isSubmitting, setIsSubmitting] = useState(false);
    63→
    64→  const reasonInfo = REASON_LABELS[report.reason] || REASON_LABELS.other;
    65→  const statusInfo = STATUS_LABELS[report.status];
    66→  const isPending = report.status === 'pending';
    67→  const timeAgo = formatDistanceToNow(new Date(report.createdAt), { addSuffix: true });
    68→
    69→  const handleResolve = async (status: ReportStatusEnum) => {
    70→    setIsSubmitting(true);
    71→    try {
    72→      await onResolve(report.id, {
    73→        status,
    74→        resolutionNotes: resolutionNotes || undefined,
    75→        actionTaken: selectedAction || undefined,
    76→      });
    77→      setResolutionNotes('');
    78→      setSelectedAction(null);
    79→    } finally {
    80→      setIsSubmitting(false);
    81→    }
    82→  };
    83→
    84→  const handleRemoveContent = async () => {
    85→    setIsSubmitting(true);
    86→    try {
    87→      await onRemoveContent(report.targetType, report.targetId);
    88→      setSelectedAction('content_removed');
    89→    } finally {
    90→      setIsSubmitting(false);
    91→    }
    92→  };
    93→
    94→  const handleBanUser = async () => {
    95→    if (!report.contentAuthorId) return;
    96→    setIsSubmitting(true);
    97→    try {
    98→      await onBanUser(report.contentAuthorId);
    99→      setSelectedAction('user_banned');
   100→    } finally {
   101→      setIsSubmitting(false);
   102→    }
   103→  };
   104→
   105→  return (
   106→    <div
   107→      className={`bg-zinc-900 border rounded-lg overflow-hidden transition-colors ${
   108→        isPending ? 'border-yellow-500/30' : 'border-zinc-800'
   109→      }`}
   110→    >
   111→      {/* Header */}
   112→      <div className="p-4">
   113→        <div className="flex items-start justify-between gap-4">
   114→          <div className="flex-1 min-w-0">
   115→            {/* Type and Reason */}
   116→            <div className="flex items-center gap-2 mb-2">
   117→              {report.targetType === 'post' ? (
   118→                <FileText className="w-4 h-4 text-zinc-400" />
   119→              ) : (
   120→                <MessageSquare className="w-4 h-4 text-zinc-400" />
   121→              )}
   122→              <span className="text-sm text-zinc-400 capitalize">{report.targetType}</span>
   123→              <span className={`text-xs px-2 py-0.5 rounded-full ${reasonInfo.color}`}>
   124→                {reasonInfo.label}
   125→              </span>
   126→              <span className={`text-xs px-2 py-0.5 rounded-full flex items-center gap-1 ${statusInfo.color}`}>
   127→                {statusInfo.icon}
   128→                {statusInfo.label}
   129→              </span>
   130→            </div>
   131→
   132→            {/* Content Preview */}
   133→            {report.contentPreview && (
   134→              <p className="text-sm text-zinc-300 line-clamp-2 mb-2">
   135→                {report.contentPreview}
   136→              </p>
   137→            )}
   138→
   139→            {/* Meta info */}
   140→            <div className="flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-zinc-500">
   141→              <span className="flex items-center gap-1">
   142→                <User className="w-3 h-3" />
   143→                Reported by {report.reporterUsername}
   144→              </span>
   145→              <span className="flex items-center gap-1">
   146→                <Clock className="w-3 h-3" />
   147→                {timeAgo}
   148→              </span>
   149→              {report.contentAuthorUsername && (
   150→                <span className="flex items-center gap-1">
   151→                  <AlertTriangle className="w-3 h-3" />
   152→                  Author: {report.contentAuthorUsername}
   153→                </span>
   154→              )}
   155→            </div>
   156→          </div>
   157→
   158→          {/* Toggle button */}
   159→          <button
   160→            onClick={() => setIsExpanded(!isExpanded)}
   161→            className="p-2 text-zinc-400 hover:text-white hover:bg-zinc-800 rounded-lg transition-colors"
   162→          >
   163→            {isExpanded ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}
   164→          </button>
   165→        </div>
   166→      </div>
   167→
   168→      {/* Expanded content */}
   169→      {isExpanded && (
   170→        <div className="border-t border-zinc-800 p-4 space-y-4">
   171→          {/* Report details */}
   172→          {report.details && (
   173→            <div>
   174→              <h4 className="text-xs font-medium text-zinc-400 mb-1">Report Details</h4>
   175→              <p className="text-sm text-zinc-300 bg-zinc-800/50 p-3 rounded-lg">
   176→                {report.details}
   177→              </p>
   178→            </div>
   179→          )}
   180→
   181→          {/* View Content Button */}
   182→          <button
   183→            onClick={() => onViewContent(report.targetType, report.targetId)}
   184→            className="w-full flex items-center justify-center gap-2 px-4 py-2 bg-zinc-800 hover:bg-zinc-700 text-zinc-300 rounded-lg transition-colors"
   185→          >
   186→            <Eye className="w-4 h-4" />
   187→            View Full {report.targetType === 'post' ? 'Post' : 'Comment'}
   188→          </button>
   189→
   190→          {/* Quick Actions (only for pending reports) */}
   191→          {isPending && (
   192→            <div className="space-y-3">
   193→              <h4 className="text-xs font-medium text-zinc-400">Quick Actions</h4>
   194→              <div className="flex flex-wrap gap-2">
   195→                <button
   196→                  onClick={handleRemoveContent}
   197→                  disabled={isSubmitting || isLoading}
   198→                  className="flex items-center gap-2 px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-sm transition-colors disabled:opacity-50"
   199→                >
   200→                  <Trash2 className="w-4 h-4" />
   201→                  Remove Content
   202→                </button>
   203→                {report.contentAuthorId && (
   204→                  <button
   205→                    onClick={handleBanUser}
   206→                    disabled={isSubmitting || isLoading}
   207→                    className="flex items-center gap-2 px-3 py-1.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg text-sm transition-colors disabled:opacity-50"
   208→                  >
   209→                    <Ban className="w-4 h-4" />
   210→                    Ban User
   211→                  </button>
   212→                )}
   213→              </div>
   214→
   215→              {/* Resolution Notes */}
   216→              <div>
   217→                <label className="text-xs font-medium text-zinc-400 block mb-1">
   218→                  Resolution Notes (optional)
   219→                </label>
   220→                <textarea
   221→                  value={resolutionNotes}
   222→                  onChange={(e) => setResolutionNotes(e.target.value)}
   223→                  placeholder="Add notes about this resolution..."
   224→                  className="w-full px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-sm text-white placeholder-zinc-500 focus:outline-none focus:border-cyan-500 resize-none"
   225→                  rows={2}
   226→                />
   227→              </div>
   228→
   229→              {/* Resolution Buttons */}
   230→              <div className="flex gap-2">
   231→                <button
   232→                  onClick={() => handleResolve('resolved')}
   233→                  disabled={isSubmitting || isLoading}
   234→                  className="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-500/10 hover:bg-green-500/20 text-green-400 rounded-lg transition-colors disabled:opacity-50"
   235→                >
   236→                  <CheckCircle className="w-4 h-4" />
   237→                  Mark Resolved
   238→                </button>
   239→                <button
   240→                  onClick={() => handleResolve('dismissed')}
   241→                  disabled={isSubmitting || isLoading}
   242→                  className="flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-zinc-700 hover:bg-zinc-600 text-zinc-300 rounded-lg transition-colors disabled:opacity-50"
   243→                >
   244→                  <XCircle className="w-4 h-4" />
   245→                  Dismiss
   246→                </button>
   247→              </div>
   248→            </div>
   249→          )}
   250→
   251→          {/* Resolution info for resolved reports */}
   252→          {!isPending && report.reviewedAt && (
   253→            <div className="bg-zinc-800/50 p-3 rounded-lg text-sm">
   254→              <div className="flex items-center gap-2 text-zinc-400 mb-1">
   255→                <Clock className="w-3 h-3" />
   256→                Resolved {formatDistanceToNow(new Date(report.reviewedAt), { addSuffix: true })}
   257→              </div>
   258→              {report.actionTaken && (
   259→                <div className="text-zinc-300">
   260→                  Action: <span className="capitalize">{report.actionTaken.replace('_', ' ')}</span>
   261→                </div>
   262→              )}
   263→              {report.resolutionNotes && (
   264→                <div className="text-zinc-300 mt-1">
   265→                  Notes: {report.resolutionNotes}
   266→                </div>
   267→              )}
   268→            </div>
   269→          )}
   270→        </div>
   271→      )}
   272→    </div>
   273→  );
   274→}
   275→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
