     1→'use client';
     2→
     3→import { useMemo } from 'react';
     4→
     5→interface GradientRangeBarProps {
     6→  value: number;
     7→  idealMin: number;
     8→  idealMax: number;
     9→  rangeMin: number;
    10→  rangeMax: number;
    11→  unit?: string;
    12→}
    13→
    14→// Generate a color gradient from red -> yellow -> cyan -> yellow -> red
    15→function generateGradient(idealMin: number, idealMax: number, rangeMin: number, rangeMax: number): string {
    16→  const totalRange = rangeMax - rangeMin;
    17→
    18→  // Calculate positions as percentages
    19→  const idealMinPos = ((idealMin - rangeMin) / totalRange) * 100;
    20→  const idealMaxPos = ((idealMax - rangeMin) / totalRange) * 100;
    21→
    22→  // Build gradient stops
    23→  const stops: string[] = [];
    24→
    25→  for (let i = 0; i <= 100; i++) {
    26→    let color: string;
    27→
    28→    if (i < idealMinPos - 15) {
    29→      // Far below ideal - deep red
    30→      color = 'rgb(185, 28, 28)';
    31→    } else if (i < idealMinPos - 5) {
    32→      // Approaching ideal from below - transition red to orange to yellow
    33→      const t = (i - (idealMinPos - 15)) / 10;
    34→      color = interpolateColor([185, 28, 28], [249, 115, 22], t);
    35→    } else if (i < idealMinPos) {
    36→      // Close to ideal min - yellow to cyan
    37→      const t = (i - (idealMinPos - 5)) / 5;
    38→      color = interpolateColor([249, 115, 22], [34, 211, 238], t);
    39→    } else if (i <= idealMaxPos) {
    40→      // Within ideal range - cyan
    41→      color = 'rgb(6, 182, 212)';
    42→    } else if (i < idealMaxPos + 5) {
    43→      // Just above ideal - cyan to yellow
    44→      const t = (i - idealMaxPos) / 5;
    45→      color = interpolateColor([6, 182, 212], [249, 115, 22], t);
    46→    } else if (i < idealMaxPos + 15) {
    47→      // Above ideal - orange to red
    48→      const t = (i - (idealMaxPos + 5)) / 10;
    49→      color = interpolateColor([249, 115, 22], [185, 28, 28], t);
    50→    } else {
    51→      // Far above ideal - deep red
    52→      color = 'rgb(185, 28, 28)';
    53→    }
    54→
    55→    stops.push(`${color} ${i}%`);
    56→  }
    57→
    58→  return `linear-gradient(to right, ${stops.join(', ')})`;
    59→}
    60→
    61→function interpolateColor(c1: number[], c2: number[], t: number): string {
    62→  const r = Math.round(c1[0] + (c2[0] - c1[0]) * t);
    63→  const g = Math.round(c1[1] + (c2[1] - c1[1]) * t);
    64→  const b = Math.round(c1[2] + (c2[2] - c1[2]) * t);
    65→  return `rgb(${r}, ${g}, ${b})`;
    66→}
    67→
    68→export function GradientRangeBar({
    69→  value,
    70→  idealMin,
    71→  idealMax,
    72→  rangeMin,
    73→  rangeMax,
    74→  unit = '',
    75→}: GradientRangeBarProps) {
    76→  const gradient = useMemo(
    77→    () => generateGradient(idealMin, idealMax, rangeMin, rangeMax),
    78→    [idealMin, idealMax, rangeMin, rangeMax]
    79→  );
    80→
    81→  // Calculate marker position
    82→  const totalRange = rangeMax - rangeMin;
    83→  const markerPos = Math.max(0, Math.min(100, ((value - rangeMin) / totalRange) * 100));
    84→
    85→  // Format value with unit
    86→  const formatUnit = (v: number) => {
    87→    const formatted = v.toFixed(unit === 'percent' || unit === '%' ? 1 : 2);
    88→    const suffix = unit === 'percent' ? ' %' : unit === 'degrees' ? '°' : unit === 'x' || unit === 'ratio' ? ' x' : unit === 'mm' ? ' mm' : '';
    89→    return `${formatted}${suffix}`;
    90→  };
    91→
    92→  return (
    93→    <div className="rounded-xl bg-neutral-800/50 border border-neutral-700 p-4">
    94→      <div className="relative mb-4 px-2">
    95→        {/* Gradient bar */}
    96→        <div className="relative h-6 rounded-lg overflow-hidden mt-4">
    97→          <div
    98→            className="absolute inset-0 h-6"
    99→            style={{ background: gradient }}
   100→          />
   101→        </div>
   102→
   103→        {/* Value marker with tooltip */}
   104→        <div
   105→          className="absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 z-10 pointer-events-none"
   106→          style={{ left: `${markerPos}%`, top: 'calc(50% + 8px)' }}
   107→        >
   108→          <div className="relative">
   109→            {/* Marker dot */}
   110→            <div className="w-4 h-4 rounded-full bg-white shadow-lg ring-2 ring-neutral-900/30 flex items-center justify-center">
   111→              <div className="w-1.5 h-1.5 rounded-full bg-neutral-900" />
   112→            </div>
   113→
   114→            {/* Tooltip above */}
   115→            <div className="absolute -top-12 left-1/2 transform -translate-x-1/2 whitespace-nowrap">
   116→              <div className="px-3 py-1.5 rounded-lg shadow-lg bg-white border border-neutral-200">
   117→                <div className="text-sm font-semibold text-neutral-900">{formatUnit(value)}</div>
   118→              </div>
   119→              {/* Triangle pointer */}
   120→              <div className="absolute top-full left-1/2 transform -translate-x-1/2 -mt-px">
   121→                <div className="w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-transparent border-t-white" />
   122→              </div>
   123→            </div>
   124→          </div>
   125→        </div>
   126→      </div>
   127→
   128→      {/* Range labels */}
   129→      <div className="flex justify-between items-center text-xs text-neutral-500 px-2">
   130→        <span>{formatUnit(rangeMin)}</span>
   131→        <span className="text-cyan-400 font-medium">
   132→          Ideal: {formatUnit(idealMin)} - {formatUnit(idealMax)}
   133→        </span>
   134→        <span>{formatUnit(rangeMax)}</span>
   135→      </div>
   136→    </div>
   137→  );
   138→}
   139→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
