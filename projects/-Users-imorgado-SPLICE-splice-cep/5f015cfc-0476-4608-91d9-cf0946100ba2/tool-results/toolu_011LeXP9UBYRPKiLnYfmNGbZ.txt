  1730→        } catch (e) {
  1731→            addDiagnosticLog('✗ getActiveSequence() FAILED: ' + e.message);
  1732→        }
  1733→
  1734→        // Test 4: Check project sequences
  1735→        addDiagnosticLog('Test 4: Checking all project sequences...');
  1736→        try {
  1737→            const sequences = await jsx.call('getAllSequences');
  1738→            if (sequences && sequences.length > 0) {
  1739→                addDiagnosticLog('✓ Total sequences in project: ' + sequences.length);
  1740→                sequences.forEach((seq, i) => {
  1741→                    addDiagnosticLog('  - Sequence ' + i + ': ' + (seq.name || 'Unnamed'));
  1742→                });
  1743→            } else {
  1744→                addDiagnosticLog('✗ No sequences found in project');
  1745→            }
  1746→        } catch (e) {
  1747→            addDiagnosticLog('✗ getAllSequences() FAILED: ' + e.message);
  1748→        }
  1749→
  1750→        // Test 5: Check for active sequence via DOM
  1751→        addDiagnosticLog('Test 5: Checking app.project.activeSequence...');
  1752→        try {
  1753→            const result = await jsx.evalScript(`
  1754→                if (app && app.project && app.project.activeSequence) {
  1755→                    JSON.stringify({
  1756→                        success: true,
  1757→                        name: app.project.activeSequence.name,
  1758→                        id: app.project.activeSequence.sequenceID
  1759→                    });
  1760→                } else {
  1761→                    JSON.stringify({
  1762→                        success: false,
  1763→                        reason: app ? (app.project ? 'app.project.activeSequence is null' : 'app.project is null') : 'app is null'
  1764→                    });
  1765→                }
  1766→            `);
  1767→            const data = JSON.parse(result);
  1768→            if (data.success) {
  1769→                addDiagnosticLog('✓ app.project.activeSequence found: ' + data.name + ' (ID: ' + data.id + ')');
  1770→            } else {
  1771→                addDiagnosticLog('✗ app.project.activeSequence NOT found: ' + data.reason);
  1772→            }
  1773→        } catch (e) {
  1774→            addDiagnosticLog('✗ DOM check FAILED: ' + e.message);
  1775→        }
  1776→
  1777→        // Test 6: Check QE DOM availability
  1778→        addDiagnosticLog('Test 6: Checking QE DOM availability...');
  1779→        try {
  1780→            const qeResult = await jsx.evalScript(`
  1781→                if (typeof qe !== 'undefined' && qe !== null) {
  1782→                    JSON.stringify({ available: true });
  1783→                } else {
  1784→                    JSON.stringify({ available: false });
  1785→                }
  1786→            `);
  1787→            const qeData = JSON.parse(qeResult);
  1788→            if (qeData.available) {
  1789→                addDiagnosticLog('✓ QE DOM is available');
  1790→            } else {
  1791→                addDiagnosticLog('✗ QE DOM is NOT available');
  1792→            }
  1793→        } catch (e) {
  1794→            addDiagnosticLog('✗ QE DOM check FAILED: ' + e.message);
  1795→        }
  1796→
  1797→        // Display quick diagnosis
  1798→        updateQuickDiagnosis();
  1799→
  1800→        // Display all logs
  1801→        displayDiagnosticLogs();
  1802→
  1803→    } catch (error) {
  1804→        addDiagnosticLog('DIAGNOSTICS ERROR: ' + error.message);
  1805→        displayDiagnosticLogs();
  1806→    }
  1807→}
  1808→
  1809→function addDiagnosticLog(message) {

</system-reminder>
