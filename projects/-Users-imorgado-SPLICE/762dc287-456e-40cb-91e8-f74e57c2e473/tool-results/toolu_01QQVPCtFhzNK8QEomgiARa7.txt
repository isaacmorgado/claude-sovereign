     1→# SPLICE
     2→
     3→AI-powered Premiere Pro UXP plugin for detecting takes, removing silences, and accelerating video editing workflows.
     4→
     5→## Current Focus
     6→**Auto-Cutting v3.5** - Direct DOM Reconstruction (Zero Manual Steps)
     7→
     8→## Quick Reference
     9→
    10→### Pricing Tiers
    11→| Tier | Price | Hours | Isolation | Stripe Price ID |
    12→|------|-------|-------|-----------|-----------------|
    13→| Starter | $19/mo | 15 hrs | ❌ None | price_1SgH4m2L5BseYEbCih347qfr |
    14→| Pro | $49/mo | 50 hrs | 45 min included | price_1SgH4o2L5BseYEbCIoR19lhQ |
    15→| Team | $149/mo | 150 hrs | 3 hrs included | price_1SgH4q2L5BseYEbCYTlimb5M |
    16→| Overage | $1/hr | - | $0.10/min | price_1SgH4y2L5BseYEbClZuxNRu8 |
    17→
    18→### Isolation Pricing (v3.4)
    19→- **Starter**: No access (upgrade required)
    20→- **Pro**: 45 min included, then $0.10/min overage
    21→- **Team**: 3 hrs included, then $0.10/min overage
    22→- **Our cost**: $0.015/min → **85% margin on overage**
    23→- **Worst-case margin**: 80%+ (sized to maintain margins at full utilization)
    24→
    25→### Key Constraints
    26→- UXP requires Premiere Pro 25.6+
    27→- Use `127.0.0.1` not `localhost` in fetch URLs
    28→- Backend (prod): https://splice-api-production.up.railway.app
    29→
    30→## Key Files
    31→
    32→| File | Purpose |
    33→|------|---------|
    34→| `splice-backend/server.js` | Express + all endpoints + webhook handler |
    35→| `splice-backend/services/usageTracking.js` | Credit balance, usage logging |
    36→| `splice-backend/services/cutListGenerator.js` | v3.5 JSON cut list generator |
    37→| `splice-plugin/js/main.js` | Plugin initialization + workflows |
    38→| `splice-plugin/js/builder.js` | v3.5 Direct DOM sequence builder |
    39→| `splice-plugin/js/settings.js` | Settings + Persistent Token |
    40→| `splice-plugin/js/credits.js` | Fetch/display credit balance |
    41→| `splice-plugin/index.html` | UI with credit badge in header |
    42→
    43→## Implementation Phases
    44→
    45→- Phase 1: Backend billing ✅
    46→- Phase 2: Frontend credits ✅
    47→- Phase 3: Preview Mode ✅
    48→- Phase 4: v3.5 Direct DOM Reconstruction ✅
    49→
    50→## v3.5 Architecture (Implemented)
    51→
    52→**Zero-manual-step workflow using UXP DOM APIs:**
    53→
    54→1. Detect silences/takes (existing workflow)
    55→2. Backend generates JSON cut list via `/cut-list` endpoint
    56→3. Plugin builds sequence directly using `builder.js`
    57→4. New sequence created with `_SPLICE` suffix
    58→
    59→**Core UXP APIs:**
    60→- `SequenceEditor.createInsertProjectItemAction()` - Insert clips at timecode
    61→- `ProjectItem.createSetColorLabelAction(index)` - Color clips (set BEFORE insert)
    62→- `TrackItem.createSetInPointAction/OutPointAction()` - Set in/out points
    63→- `project.executeTransaction(actions)` - Batch execute atomically
    64→- `fs.createPersistentToken(folder)` - Silent file access
    65→
    66→**New Endpoints:**
    67→- `POST /cut-list` - Generate JSON cut list from silences/takes
    68→- `POST /cut-list/takes` - Generate cut list keeping only takes
    69→
    70→**Key Functions:**
    71→- `buildSequenceFromCutList(cutList)` - Build sequence from backend cut list
    72→- `buildSequenceFromDetection(silences, takes, source)` - Direct build from detection
    73→- `setupMediaFolder()` - Set up persistent token for media access
    74→- `generateCutList(options)` - Backend cut list generation
    75→
    76→**Legacy (Deprecated):**
    77→- `splice-plugin/js/slice9-razor.js` - Old XML workflow (still available)
    78→- `splice-backend/services/xmlProcessor.js` - Old XML processor
    79→
    80→## Last Session (2025-12-21)
    81→
    82→Fixed critical UXP API issues in v3.5 builder and prepared for testing.
    83→
    84→**What was done:**
    85→- Fixed 5 API issues: SequenceFactory → createCloneAction(), TickTime objects, action creation in transactions
    86→- Created comprehensive testing guide (TESTING_V3.5.md)
    87→- Started backend server (running on https://127.0.0.1:3847)
    88→
    89→**Files modified:**
    90→- `splice-plugin/js/builder.js` - Fixed all UXP API calls (builder.js:146-408)
    91→- `splice-plugin/manifest.json` - Version 3.5.0
    92→- `TESTING_V3.5.md` - Created testing guide
    93→
    94→**Stopped at:** Backend running, ready to test in Premiere Pro 25.6+. Need to load plugin and test buildSequenceV35() via UXP console.
    95→
    96→## Next Steps
    97→
    98→1. Load plugin in Premiere Pro 25.6+ and test v3.5 builder
    99→2. Add "Build New Sequence" button to UI
   100→3. Wire detection workflow to auto-trigger builder
   101→
   102→---
   103→*Last updated: 2025-12-21*
   104→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
