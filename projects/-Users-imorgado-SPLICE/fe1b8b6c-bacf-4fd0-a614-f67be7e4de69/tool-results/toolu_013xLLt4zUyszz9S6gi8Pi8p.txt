     1→# Apple Developer ID Signing Guide for SPLICE
     2→
     3→This guide explains how to set up Apple Developer ID signing for SPLICE installers so that macOS users can install without Gatekeeper warnings.
     4→
     5→## Why You Need This
     6→
     7→Without Apple Developer ID signing:
     8→- Users see "Apple could not verify this app is free of malware"
     9→- Users must go to System Preferences → Security → "Open Anyway"
    10→- Professional software should not require this workaround
    11→
    12→With Apple Developer ID signing:
    13→- Double-click to install works seamlessly
    14→- No security warnings
    15→- Professional, polished user experience
    16→
    17→## Prerequisites
    18→
    19→1. **Apple Developer Program Membership** ($99/year)
    20→   - Enroll at: https://developer.apple.com/programs/enroll/
    21→   - Approval typically takes 24-48 hours
    22→
    23→2. **macOS with Xcode Command Line Tools**
    24→   ```bash
    25→   xcode-select --install
    26→   ```
    27→
    28→3. **The SPLICE build system** (already set up)
    29→
    30→## Step 1: Create Developer ID Installer Certificate
    31→
    32→### Option A: Using Xcode
    33→
    34→1. Open Xcode → Preferences → Accounts
    35→2. Select your Apple ID → Manage Certificates
    36→3. Click + → Developer ID Installer
    37→4. Certificate is automatically installed in Keychain
    38→
    39→### Option B: Using developer.apple.com
    40→
    41→1. Go to https://developer.apple.com/account/resources/certificates
    42→2. Click the + button to create a new certificate
    43→3. Select **Developer ID Installer**
    44→4. Follow the Certificate Signing Request (CSR) instructions:
    45→   - Open Keychain Access → Certificate Assistant → Request a Certificate from a Certificate Authority
    46→   - Enter your email, select "Saved to disk"
    47→   - Upload the CSR file
    48→5. Download the certificate and double-click to install in Keychain
    49→
    50→### Verify Certificate Installation
    51→
    52→```bash
    53→security find-identity -v -p basic | grep "Developer ID Installer"
    54→```
    55→
    56→You should see something like:
    57→```
    58→1) ABC123... "Developer ID Installer: Your Name (TEAMID)"
    59→```
    60→
    61→## Step 2: Create App-Specific Password
    62→
    63→Notarization requires an app-specific password (not your regular Apple ID password):
    64→
    65→1. Go to https://appleid.apple.com
    66→2. Sign in with your Apple ID
    67→3. Navigate to **Security** → **App-Specific Passwords**
    68→4. Click **Generate** (or +)
    69→5. Name it: `SPLICE Notarization`
    70→6. **Save the password** (format: `xxxx-xxxx-xxxx-xxxx`)
    71→
    72→⚠️ You can only see this password once! Store it securely.
    73→
    74→## Step 3: Find Your Team ID
    75→
    76→1. Go to https://developer.apple.com/account
    77→2. Click **Membership** in the sidebar
    78→3. Find your **Team ID** (10-character alphanumeric code)
    79→
    80→## Step 4: Configure Environment Variables
    81→
    82→### Option A: Use the Setup Script (Recommended)
    83→
    84→```bash
    85→cd /Users/imorgado/SPLICE
    86→chmod +x build/scripts/setup-apple-signing.sh
    87→./build/scripts/setup-apple-signing.sh
    88→```
    89→
    90→This creates `.env.apple-signing` with your credentials.
    91→
    92→### Option B: Manual Configuration
    93→
    94→Create a file at `/Users/imorgado/SPLICE/.env.apple-signing`:
    95→
    96→```bash
    97→# Apple Developer Signing Configuration
    98→export APPLE_DEVELOPER_ID="Developer ID Installer: Your Name (TEAMID)"
    99→export APPLE_ID="your.email@example.com"
   100→export APPLE_TEAM_ID="ABCD1234XY"
   101→export APPLE_APP_PASSWORD="xxxx-xxxx-xxxx-xxxx"
   102→```
   103→
   104→Protect the file:
   105→```bash
   106→chmod 600 .env.apple-signing
   107→```
   108→
   109→Add to `.gitignore`:
   110→```bash
   111→echo ".env.apple-signing" >> .gitignore
   112→```
   113→
   114→## Step 5: Build Signed Installers
   115→
   116→```bash
   117→cd /Users/imorgado/SPLICE
   118→
   119→# Load credentials
   120→source .env.apple-signing
   121→
   122→# Build all installers (CEP + UXP, macOS + Windows)
   123→./build/scripts/build-all.sh
   124→```
   125→
   126→The build process will:
   127→1. ✅ Build the installer package
   128→2. ✅ Sign with Developer ID Installer certificate
   129→3. ✅ Submit to Apple for notarization
   130→4. ✅ Wait for notarization approval (usually 1-5 minutes)
   131→5. ✅ Staple the notarization ticket to the package
   132→
   133→## Step 6: Verify Signed Package
   134→
   135→```bash
   136→# Check code signature
   137→codesign -dv --verbose=4 build/output/SPLICE-v6.0.3.pkg
   138→
   139→# Verify notarization
   140→spctl -a -v build/output/SPLICE-v6.0.3.pkg
   141→
   142→# Check stapled ticket
   143→xcrun stapler validate build/output/SPLICE-v6.0.3.pkg
   144→```
   145→
   146→Expected output:
   147→```
   148→build/output/SPLICE-v6.0.3.pkg: accepted
   149→source=Notarized Developer ID
   150→```
   151→
   152→## Troubleshooting
   153→
   154→### "No identity found"
   155→Your certificate isn't in Keychain. Re-download from developer.apple.com and double-click to install.
   156→
   157→### "The software is not signed"
   158→Environment variables aren't loaded. Run `source .env.apple-signing` before building.
   159→
   160→### "Unable to upload to notarization service"
   161→- Check internet connection
   162→- Verify APPLE_APP_PASSWORD is correct
   163→- Ensure APPLE_ID and APPLE_TEAM_ID match
   164→
   165→### "Notarization failed"
   166→Check the detailed log:
   167→```bash
   168→xcrun notarytool log <submission-id> \
   169→  --apple-id "$APPLE_ID" \
   170→  --team-id "$APPLE_TEAM_ID" \
   171→  --password "$APPLE_APP_PASSWORD"
   172→```
   173→
   174→### Certificate Expired
   175→Certificates expire after 5 years. Create a new one at developer.apple.com.
   176→
   177→## Security Best Practices
   178→
   179→1. **Never commit `.env.apple-signing`** to git (it's in .gitignore)
   180→2. **Protect the file**: `chmod 600 .env.apple-signing`
   181→3. **Use app-specific password**, not your main Apple ID password
   182→4. **Revoke old app-specific passwords** if compromised
   183→
   184→## Build Script Reference
   185→
   186→| Script | Purpose |
   187→|--------|---------|
   188→| `build/scripts/setup-apple-signing.sh` | Interactive setup for credentials |
   189→| `build/scripts/build-all.sh` | Build all installers |
   190→| `build/scripts/build-macos.sh` | Build CEP macOS installer |
   191→| `build/scripts/build-uxp-macos.sh` | Build UXP macOS installer |
   192→| `build/scripts/build-windows.sh` | Build Windows installers |
   193→
   194→## Quick Reference
   195→
   196→```bash
   197→# One-time setup
   198→./build/scripts/setup-apple-signing.sh
   199→
   200→# Before each build session
   201→source .env.apple-signing
   202→
   203→# Build signed installers
   204→./build/scripts/build-all.sh
   205→
   206→# Verify signature
   207→spctl -a -v build/output/SPLICE-v6.0.3.pkg
   208→```
   209→
   210→## Cost Summary
   211→
   212→| Item | Cost |
   213→|------|------|
   214→| Apple Developer Program | $99/year |
   215→| Certificate creation | Included |
   216→| Notarization | Included |
   217→| **Total** | **$99/year** |
   218→
   219→## Timeline
   220→
   221→- Apple Developer Program enrollment: 24-48 hours
   222→- Certificate creation: Instant
   223→- Notarization per build: 1-5 minutes
   224→

</system-reminder>
