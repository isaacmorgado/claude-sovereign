   860→/**
   861→ * POST /profanity/generate-bleeps - Generate bleep audio files for profanity segments
   862→ *
   863→ * Creates WAV bleep files for each profanity segment that can be inserted into the timeline.
   864→ *
   865→ * Body:
   866→ * - segments: Array of {start, end} profanity segments (required)
   867→ * - bleepType: Type of bleep sound ('standard', 'tv', 'radio', 'duck', 'mute') (default: 'standard')
   868→ * - volume: Volume level 0-1 (default: 0.5)
   869→ *
   870→ * Returns:
   871→ * - bleeps: Array of generated bleep file info with paths
   872→ */
   873→app.post('/profanity/generate-bleeps', requireCredits({ endpoint: 'profanity-bleeps' }), async (req, res) => {
   874→  const { segments, bleepType = 'standard', volume = 0.5 } = req.body;
   875→
   876→  if (!segments || !Array.isArray(segments) || segments.length === 0) {
   877→    return res.status(400).json({ error: 'segments array is required and must not be empty' });
   878→  }
   879→
   880→  // Validate segments have start/end
   881→  for (let i = 0; i < segments.length; i++) {
   882→    if (typeof segments[i].start !== 'number' || typeof segments[i].end !== 'number') {
   883→      return res.status(400).json({ error: `Segment ${i} must have numeric start and end properties` });
   884→    }
   885→  }
   886→
   887→  console.log(`[SPLICE] Generating ${segments.length} bleep audio files (type: ${bleepType})`);
   888→
   889→  try {
   890→    const bleeps = await generateBleepsForSegments(segments, {
   891→      bleepType,
   892→      volume,
   893→      outputDir: '/tmp'
   894→    });
   895→
   896→    // Calculate total duration for usage tracking
   897→    const totalDuration = segments.reduce((sum, seg) => sum + (seg.end - seg.start), 0);
   898→    let balance = null;
   899→    if (totalDuration > 0 && req.deductUsage) {
   900→      balance = await req.deductUsage(totalDuration);
   901→    }
   902→
   903→    res.json({
   904→      success: true,
   905→      bleepCount: bleeps.length,
   906→      bleepType,
   907→      bleeps,
   908→      totalDuration,
   909→      balance: balance ? { hoursRemaining: balance.hoursRemaining, tier: balance.tier } : undefined
   910→    });
   911→  } catch (err) {
   912→    console.error('[SPLICE] Error generating bleeps:', err);
   913→    res.status(500).json({ error: err.message });
   914→  }
   915→});
   916→
   917→/**
   918→ * GET /profanity/list/:language - Get default profanity list for a language
   919→ */
   920→app.get('/profanity/list/:language', (req, res) => {
   921→  const { language } = req.params;
   922→  const list = getProfanityList(language);
   923→
   924→  res.json({
   925→    success: true,
   926→    language,
   927→    wordCount: list.length,
   928→    // Return first 50 words as sample (full list is large)
   929→    sample: list.slice(0, 50),
   930→    note: 'Full list available but truncated for response size'
   931→  });
   932→});
   933→
   934→// =============================================================================
   935→// Repetition/Stutter Detection Routes
   936→// =============================================================================
   937→
   938→/**
   939→ * POST /repetitions - Detect phrase repetitions and stutters
   940→ *
   941→ * Analyzes transcript for repeated phrases and stutters.
   942→ * Returns segments that can be removed to clean up the edit.
   943→ *
   944→ * Options:
   945→ * - wavPath: Path to audio file (required unless transcript provided)
   946→ * - transcript: Pre-existing transcript (optional)
   947→ * - phraseSize: Words per comparison window (default: 5)
   948→ * - tolerance: Similarity threshold 0-1 (default: 0.7)
   949→ * - searchRadius: Words to search ahead (default: 100)
   950→ * - useOpenAI: Use OpenAI for boundary refinement (default: false)
   951→ * - includeStutters: Also detect single-word stutters (default: true)
   952→ */
   953→app.post('/repetitions', requireCredits({ endpoint: 'repetitions' }), async (req, res) => {
   954→  const {
   955→    wavPath,
   956→    transcript: providedTranscript,
   957→    phraseSize = 5,
   958→    tolerance = 0.7,
   959→    searchRadius = 100,

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
