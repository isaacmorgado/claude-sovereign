     1→/**
     2→ * CSInterface - Adobe Common Extensibility Platform Interface
     3→ * Minimal implementation for SPLICE CEP panel
     4→ */
     5→
     6→function CSInterface() {
     7→    this.hostEnvironment = null;
     8→}
     9→
    10→/**
    11→ * Returns the host environment information
    12→ */
    13→CSInterface.prototype.getHostEnvironment = function() {
    14→    if (!this.hostEnvironment) {
    15→        try {
    16→            this.hostEnvironment = JSON.parse(window.__adobe_cep__.getHostEnvironment());
    17→        } catch (e) {
    18→            this.hostEnvironment = {
    19→                appName: 'PPRO',
    20→                appVersion: '25.0',
    21→                appLocale: 'en_US',
    22→                isAppOffline: false
    23→            };
    24→        }
    25→    }
    26→    return this.hostEnvironment;
    27→};
    28→
    29→/**
    30→ * Evaluates a script in the host application (Premiere Pro)
    31→ * @param {string} script - The ExtendScript to evaluate
    32→ * @param {function} callback - Callback function with result
    33→ */
    34→CSInterface.prototype.evalScript = function(script, callback) {
    35→    if (window.__adobe_cep__) {
    36→        window.__adobe_cep__.evalScript(script, callback || function() {});
    37→    } else {
    38→        // Development mode - mock responses
    39→        console.warn('[CSInterface] Running in development mode - no CEP runtime');
    40→        if (callback) {
    41→            callback(JSON.stringify({ error: 'CEP runtime not available' }));
    42→        }
    43→    }
    44→};
    45→
    46→/**
    47→ * Gets the system path for a given type
    48→ * @param {string} pathType - Type of path (EXTENSION, USER_DATA, etc.)
    49→ */
    50→CSInterface.prototype.getSystemPath = function(pathType) {
    51→    if (window.__adobe_cep__) {
    52→        return window.__adobe_cep__.getSystemPath(pathType);
    53→    }
    54→    return '';
    55→};
    56→
    57→/**
    58→ * Opens a URL in the default browser
    59→ * @param {string} url - URL to open
    60→ */
    61→CSInterface.prototype.openURLInDefaultBrowser = function(url) {
    62→    // Use the correct CEP API: window.cep.util.openURLInDefaultBrowser
    63→    if (window.cep && window.cep.util && typeof window.cep.util.openURLInDefaultBrowser === 'function') {
    64→        window.cep.util.openURLInDefaultBrowser(url);
    65→    } else {
    66→        // Fallback for development/browser testing
    67→        console.log('[CSInterface] Opening URL:', url);
    68→        window.open(url, '_blank');
    69→    }
    70→};
    71→
    72→/**
    73→ * Requests opening of an extension
    74→ * @param {string} extensionId - Extension ID to open
    75→ */
    76→CSInterface.prototype.requestOpenExtension = function(extensionId) {
    77→    if (window.__adobe_cep__) {
    78→        window.__adobe_cep__.requestOpenExtension(extensionId);
    79→    }
    80→};
    81→
    82→/**
    83→ * Closes the extension
    84→ */
    85→CSInterface.prototype.closeExtension = function() {
    86→    if (window.__adobe_cep__) {
    87→        window.__adobe_cep__.closeExtension();
    88→    }
    89→};
    90→
    91→/**
    92→ * Gets the extension ID
    93→ */
    94→CSInterface.prototype.getExtensionId = function() {
    95→    if (window.__adobe_cep__) {
    96→        return window.__adobe_cep__.getExtensionId();
    97→    }
    98→    return 'com.splice.panel.main';
    99→};
   100→
   101→/**
   102→ * Registers a callback for extension events
   103→ * @param {string} type - Event type
   104→ * @param {function} listener - Event listener
   105→ */
   106→CSInterface.prototype.addEventListener = function(type, listener) {
   107→    if (window.__adobe_cep__) {
   108→        window.__adobe_cep__.addEventListener(type, listener);
   109→    }
   110→};
   111→
   112→/**
   113→ * Removes an event listener
   114→ * @param {string} type - Event type
   115→ * @param {function} listener - Event listener
   116→ */
   117→CSInterface.prototype.removeEventListener = function(type, listener) {
   118→    if (window.__adobe_cep__) {
   119→        window.__adobe_cep__.removeEventListener(type, listener);
   120→    }
   121→};
   122→
   123→/**
   124→ * Dispatches an event
   125→ * @param {object} event - Event object
   126→ */
   127→CSInterface.prototype.dispatchEvent = function(event) {
   128→    if (window.__adobe_cep__) {
   129→        window.__adobe_cep__.dispatchEvent(event);
   130→    }
   131→};
   132→
   133→// System path constants
   134→CSInterface.prototype.EXTENSION_PATH = 'extension';
   135→CSInterface.prototype.USER_DATA_PATH = 'userData';
   136→CSInterface.prototype.COMMON_FILES_PATH = 'commonFiles';
   137→CSInterface.prototype.HOST_APPLICATION_PATH = 'hostApplication';
   138→
   139→// Color theme
   140→CSInterface.prototype.getTheme = function() {
   141→    var env = this.getHostEnvironment();
   142→    if (env && env.appSkinInfo) {
   143→        return env.appSkinInfo.baseFontSize > 12 ? 'dark' : 'light';
   144→    }
   145→    return 'dark';
   146→};
   147→
   148→// Export for use
   149→window.CSInterface = CSInterface;
   150→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
