     1→/**
     2→ * Slice 6: Backend Integration Utilities (CEP Port)
     3→ *
     4→ * Provides utility functions for takes data management.
     5→ * Port of UXP slice6-analyze.js for CEP compatibility.
     6→ */
     7→
     8→// Store takes data for applying to timeline
     9→let currentTakesData = null;
    10→
    11→/**
    12→ * Get current takes data (for use by other slices)
    13→ * @returns {Array|null} Current takes array
    14→ */
    15→function getCurrentTakes() {
    16→    // Check window.currentTakes first (set by main.js workflow)
    17→    if (window.currentTakes) {
    18→        return window.currentTakes;
    19→    }
    20→    return currentTakesData;
    21→}
    22→
    23→/**
    24→ * Set current takes data
    25→ * @param {Array} takes - Takes array
    26→ */
    27→function setCurrentTakes(takes) {
    28→    currentTakesData = takes;
    29→    window.currentTakes = takes;
    30→}
    31→
    32→/**
    33→ * Clear current takes data
    34→ */
    35→function clearCurrentTakes() {
    36→    currentTakesData = null;
    37→    window.currentTakes = null;
    38→}
    39→
    40→/**
    41→ * Get takes statistics
    42→ * @returns {Object} Statistics about current takes
    43→ */
    44→function getTakesStats() {
    45→    const takes = getCurrentTakes();
    46→    if (!takes || takes.length === 0) {
    47→        return {
    48→            count: 0,
    49→            bestCount: 0,
    50→            totalDuration: 0
    51→        };
    52→    }
    53→
    54→    let bestCount = 0;
    55→    let totalDuration = 0;
    56→
    57→    for (const take of takes) {
    58→        if (take.isBest || take.userMarkedBest) {
    59→            bestCount++;
    60→        }
    61→        const start = take.start || take.startTime || 0;
    62→        const end = take.end || take.endTime || 0;
    63→        totalDuration += (end - start);
    64→    }
    65→
    66→    return {
    67→        count: takes.length,
    68→        bestCount,
    69→        totalDuration
    70→    };
    71→}
    72→
    73→// Legacy init function - no longer needed
    74→function initAnalyzer() {
    75→    // Workflow is now handled by main.js initTakesWorkflow()
    76→}
    77→
    78→// Legacy render function - kept for compatibility
    79→function renderTakes() {
    80→    // Rendering is now handled by main.js showTakesResults()
    81→}
    82→
    83→// Export for window access
    84→window.getCurrentTakes = getCurrentTakes;
    85→window.setCurrentTakes = setCurrentTakes;
    86→window.clearCurrentTakes = clearCurrentTakes;
    87→window.getTakesStats = getTakesStats;
    88→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
