splice-backend/.env.template:10:GROQ_API_KEY=your_groq_api_key_here
splice-backend/.env.template:11:OPENAI_API_KEY=your_openai_api_key_here
splice-backend/.env.template:16:# Get these from https://dashboard.stripe.com/apikeys
splice-backend/.env.template:18:STRIPE_PUBLISHABLE_KEY=pk_test_your_publishable_key_here
splice-backend/.env.template:19:STRIPE_SECRET_KEY=sk_test_your_secret_key_here
splice-backend/.env.template:20:STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here
splice-backend/.env.template:45:DATABASE_URL=postgresql://user:password@host:port/database
splice-backend/.env.template:52:UPSTASH_REDIS_URL=rediss://default:your_password@your_endpoint.upstash.io:6379
splice-backend/.env.template:61:MUREKA_API_KEY=your_mureka_api_key_here
splice-backend/.env.template:68:R2_SECRET_ACCESS_KEY=your_r2_secret_access_key_here
splice-backend/.env.template:76:ACRCLOUD_ACCESS_SECRET=your_acrcloud_access_secret_here
splice-backend/.env.template:89:JWT_SECRET=your_secure_jwt_secret_here_CHANGE_IN_PRODUCTION
splice-backend/.env.template:100:SENDGRID_API_KEY=SG_your_sendgrid_api_key_here
splice-backend/.env.template:105:# AWS_SECRET_ACCESS_KEY=your_aws_secret_key
splice-backend/.env.example:6:# NEVER commit .env to version control - it contains sensitive secrets.
splice-backend/.env.example:9:# - Use strong, randomly generated secrets for all keys
splice-backend/.env.example:10:# - Rotate secrets regularly (at least every 90 days)
splice-backend/.env.example:33:# JWT Secret - REQUIRED
splice-backend/.env.example:37:JWT_SECRET=your-super-secret-jwt-key-here-at-least-64-chars-recommended
splice-backend/.env.example:53:# Format: postgresql://username:password@host:port/database?sslmode=require
splice-backend/.env.example:55:DATABASE_URL=postgresql://username:password@host:port/database
splice-backend/.env.example:81:# Format: redis://default:password@host:port
splice-backend/.env.example:83:UPSTASH_REDIS_URL=redis://default:password@host:port
splice-backend/.env.example:92:# Stripe Secret Key - REQUIRED
splice-backend/.env.example:93:# Get from: https://dashboard.stripe.com/apikeys
splice-backend/.env.example:94:# Use test key (sk_test_...) for development, live key (sk_live_...) for production
splice-backend/.env.example:95:STRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxxxxxxxxxxx
splice-backend/.env.example:97:# Stripe Webhook Secret - REQUIRED in production
splice-backend/.env.example:100:STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxx
splice-backend/.env.example:119:# Get from: https://platform.openai.com/api-keys
splice-backend/.env.example:121:OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx
splice-backend/.env.example:138:# Get from: https://app.sendgrid.com/settings/api_keys
splice-backend/.env.example:140:SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxx
splice-backend/.env.example:149:# Sign-in code template (passwordless authentication)
splice-backend/.env.example:167:R2_SECRET_ACCESS_KEY=your-secret-access-key
splice-backend/.env.example:344:# âœ… JWT_SECRET is set to a strong random value (not default)
splice-backend/.env.example:345:# âœ… STRIPE_SECRET_KEY is set to live key (sk_live_...)
splice-backend/.env.example:346:# âœ… STRIPE_WEBHOOK_SECRET is configured
splice-backend/.env.example:349:# âœ… OPENAI_API_KEY is set
splice-backend/.env.example:351:# âœ… SENDGRID_API_KEY is set (if using SendGrid)
splice-backend/.env.example:356:# âœ… Secrets are stored securely (Railway/Vercel environment variables)
splice-backend/.env.example:357:# âœ… Secrets are rotated regularly (every 90 days minimum)
splice-backend/.env.example:378:# ðŸ“‹ Schedule regular secret rotation (90-day cycle)
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:15:## 1. âœ… Environment Variable Validation & Secret Management
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:21:- Server fails fast with clear error messages if critical secrets are missing in production
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:22:- Validates required secrets: STRIPE_SECRET_KEY, JWT_SECRET, DATABASE_URL, OPENAI_API_KEY, UPSTASH_REDIS_URL, STRIPE_WEBHOOK_SECRET
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:23:- Conditional validation for SENDGRID_API_KEY when EMAIL_PROVIDER=sendgrid
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:24:- Prevents default JWT_SECRET values in production
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:34:  // Critical secrets validation
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:35:  if (!process.env.STRIPE_SECRET_KEY) {
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:36:    errors.push('STRIPE_SECRET_KEY is required for payment processing');
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:39:  if (!process.env.JWT_SECRET || process.env.JWT_SECRET === 'splice-dev-secret-change-in-production') {
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:40:    errors.push('JWT_SECRET must be set to a secure random value (not default)');
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:50:- **HIGH**: Prevents deployment with missing or default secrets
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:200:- âœ… JWT_SECRET validation prevents default values in production
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:206:// Lines 30-42: JWT secret validation
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:207:if (!JWT_SECRET || JWT_SECRET === 'splice-dev-secret-change-in-production') {
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:208:  console.error('[SECURITY] JWT_SECRET is not set or uses default value!');
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:230:- Secret validation prevents production deployment with defaults
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:357:- Security notes and best practices for each secret
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:358:- Conditional requirements documented (e.g., SENDGRID_API_KEY)
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:359:- Secret generation commands included
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:361:- Secret rotation recommendations
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:373:# CRITICAL REQUIRED SECRETS
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:377:STRIPE_SECRET_KEY=sk_live_xxxxx  # Production key
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:378:STRIPE_WEBHOOK_SECRET=whsec_xxxxx
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:382:JWT_SECRET=your_secure_random_secret_here_minimum_32_characters
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:385:DATABASE_URL=postgresql://user:password@host:5432/splice
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:393:- Provides security best practices for secret management
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:437:# Test missing JWT_SECRET
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:438:unset JWT_SECRET
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:441:# Test default JWT_SECRET in production
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:443:export JWT_SECRET=splice-dev-secret-change-in-production
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:492:- [ ] JWT_SECRET set to secure random value (not default)
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:493:- [ ] STRIPE_SECRET_KEY uses production key (sk_live_)
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:494:- [ ] STRIPE_WEBHOOK_SECRET configured for production webhook
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:497:- [ ] Email provider configured (SENDGRID_API_KEY or EMAIL_PROVIDER=console)
splice-backend/WEEK1_SECURITY_FIXES_SUMMARY.md:547:6. **Implement API key rotation** - Automated secret rotation
splice-backend/server.js:92:// Fail fast with clear error messages if critical secrets are missing
splice-backend/server.js:102:  // CRITICAL: Core infrastructure secrets
splice-backend/server.js:103:  if (!process.env.STRIPE_SECRET_KEY) {
splice-backend/server.js:104:    errors.push('STRIPE_SECRET_KEY is required (Stripe API key for billing)');
splice-backend/server.js:107:  if (!process.env.JWT_SECRET || process.env.JWT_SECRET === 'splice-dev-secret-change-in-production') {
splice-backend/server.js:108:    errors.push('JWT_SECRET must be set to a secure random value (not default)');
splice-backend/server.js:109:  } else if (process.env.JWT_SECRET.length < 32) {
splice-backend/server.js:111:    errors.push('JWT_SECRET must be at least 32 characters for cryptographic security');
splice-backend/server.js:118:  if (!process.env.OPENAI_API_KEY) {
splice-backend/server.js:119:    errors.push('OPENAI_API_KEY is required (OpenAI API for transcription)');
splice-backend/server.js:131:  // CRITICAL: Webhook secret required in production
splice-backend/server.js:132:  if (!process.env.STRIPE_WEBHOOK_SECRET) {
splice-backend/server.js:133:    errors.push('STRIPE_WEBHOOK_SECRET is required (Stripe webhook signature verification)');
splice-backend/server.js:138:  if (emailProvider === 'sendgrid' && !process.env.SENDGRID_API_KEY) {
splice-backend/server.js:139:    errors.push('SENDGRID_API_KEY is required when EMAIL_PROVIDER=sendgrid');
splice-backend/server.js:143:  if (!process.env.R2_ACCOUNT_ID || !process.env.R2_ACCESS_KEY_ID || !process.env.R2_SECRET_ACCESS_KEY) {
splice-backend/server.js:173:const stripe = new Stripe(process.env.STRIPE_SECRET_KEY, {
splice-backend/server.js:404:  const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;
splice-backend/server.js:409:    if (webhookSecret) {
splice-backend/server.js:410:      event = stripe.webhooks.constructEvent(req.body, sig, webhookSecret);
splice-backend/server.js:413:      console.error('[SPLICE] CRITICAL: STRIPE_WEBHOOK_SECRET not set in production');
splice-backend/server.js:414:      return res.status(500).json({ error: 'Webhook configuration error: secret not configured' });
splice-backend/migrations/001_music_generation.sql:32:  mureka_task_id VARCHAR(255),
splice-backend/middleware/auth.js:5: * Tokens are signed with a secret and contain the customer ID.
splice-backend/middleware/auth.js:34:const JWT_SECRET = process.env.JWT_SECRET || 'splice-dev-secret-change-in-production';
splice-backend/middleware/auth.js:44:// HIGH-001: Validate JWT_SECRET security requirements
splice-backend/middleware/auth.js:46:  if (JWT_SECRET === 'splice-dev-secret-change-in-production') {
splice-backend/middleware/auth.js:47:    console.error('[SECURITY] CRITICAL: JWT_SECRET not set in production! Set JWT_SECRET environment variable.');
splice-backend/middleware/auth.js:52:  if (JWT_SECRET.length < 32) {
splice-backend/middleware/auth.js:53:    console.error('[SECURITY] CRITICAL: JWT_SECRET must be at least 32 characters for cryptographic security.');
splice-backend/middleware/auth.js:54:    console.error('[SECURITY] Current length:', JWT_SECRET.length, 'characters');
splice-backend/middleware/auth.js:55:    console.error('[SECURITY] Generate a secure secret: openssl rand -base64 48');
splice-backend/middleware/auth.js:252:  const token = jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });
splice-backend/middleware/auth.js:278:  const refreshToken = jwt.sign(payload, JWT_SECRET, { expiresIn: JWT_REFRESH_EXPIRES_IN });
splice-backend/middleware/auth.js:299:    const decoded = jwt.verify(token, JWT_SECRET);
splice-backend/middleware/auth.js:336:    return jwt.verify(token, JWT_SECRET);
splice-backend/middleware/auth.js:591:  JWT_SECRET,
splice-backend/scripts/setup-stripe-live.js:8: *   STRIPE_SECRET_KEY=sk_live_xxx node scripts/setup-stripe-live.js
splice-backend/scripts/setup-stripe-live.js:10: * Or set STRIPE_SECRET_KEY in your .env file and run:
splice-backend/scripts/setup-stripe-live.js:21:const STRIPE_KEY = process.env.STRIPE_SECRET_KEY;
splice-backend/scripts/setup-stripe-live.js:24:  console.error('ERROR: STRIPE_SECRET_KEY environment variable is required');
splice-backend/scripts/setup-stripe-live.js:28:if (!STRIPE_KEY.startsWith('sk_live_')) {
splice-backend/scripts/setup-stripe-live.js:29:  console.error('ERROR: This script requires a LIVE mode secret key (sk_live_...)');
splice-backend/services/webhookService.js:47:   * @param {string} options.secret - HMAC secret for signature
splice-backend/services/webhookService.js:69:        const signature = this.sign(payload, options.secret);
splice-backend/services/webhookService.js:159:   * @param {string} secret - HMAC secret
splice-backend/services/webhookService.js:160:   * @returns {string} Hex-encoded signature or empty string if no secret
splice-backend/services/webhookService.js:162:  sign(payload, secret) {
splice-backend/services/webhookService.js:163:    if (!secret) {
splice-backend/services/webhookService.js:172:      .createHmac('sha256', secret)
splice-backend/services/webhookService.js:181:   * @param {string} secret - Expected HMAC secret
splice-backend/services/webhookService.js:184:  verify(payload, signature, secret) {
splice-backend/services/webhookService.js:185:    if (!signature || !secret) {
splice-backend/services/webhookService.js:189:    const expected = this.sign(payload, secret);
splice-backend/routes/health.js:124:      status: process.env.STRIPE_SECRET_KEY ? 'configured' : 'missing'
splice-backend/routes/health.js:127:      status: process.env.SENDGRID_API_KEY ? 'configured' : 'missing'
splice-backend/routes/health.js:130:      status: process.env.OPENAI_API_KEY ? 'configured' : 'missing'
splice-backend/scripts/create-beta-testers.js:51:function generateApiKey() {
splice-backend/scripts/create-beta-testers.js:137:      apiKey: generateApiKey(),
splice-backend/scripts/create-beta-testers.js:192:API Key:             ${tester.apiKey}
splice-backend/scripts/setup-beta-testers.js:15: *   STRIPE_SECRET_KEY=sk_test_xxx DATABASE_URL=xxx node scripts/setup-beta-testers.js
splice-backend/scripts/setup-beta-testers.js:33:const STRIPE_KEY = process.env.STRIPE_SECRET_KEY;
splice-backend/scripts/setup-beta-testers.js:36:  console.error('ERROR: STRIPE_SECRET_KEY environment variable is required');
splice-backend/scripts/setup-beta-testers.js:41:if (!STRIPE_KEY.startsWith('sk_test_')) {
splice-backend/scripts/setup-beta-testers.js:42:  console.error('ERROR: This script requires a TEST mode secret key (sk_test_...)');
splice-backend/scripts/setup-beta-testers.js:529:    console.log('To use in production, run setup with sk_live_ key.');
splice-backend/services/emailService.js:9: * - SENDGRID_API_KEY: SendGrid API key
splice-backend/services/emailService.js:14: * - AWS_SECRET_ACCESS_KEY: AWS secret (for SES)
splice-backend/services/emailService.js:101:    apiKey: process.env.SENDGRID_API_KEY
splice-backend/services/emailService.js:391:  // Sign-in code email (passwordless auth)
splice-backend/services/emailService.js:773:  if (!EMAIL_CONFIG.sendgrid.apiKey) {
splice-backend/services/emailService.js:774:    throw new Error('SENDGRID_API_KEY not configured');
splice-backend/services/emailService.js:782:        'Authorization': `Bearer ${EMAIL_CONFIG.sendgrid.apiKey}`,
splice-backend/services/emailService.js:840:  if (!EMAIL_CONFIG.sendgrid.apiKey) {
splice-backend/services/emailService.js:841:    throw new Error('SENDGRID_API_KEY not configured');
splice-backend/services/emailService.js:849:        'Authorization': `Bearer ${EMAIL_CONFIG.sendgrid.apiKey}`,
splice-backend/services/emailService.js:1042: * Send sign-in code email (passwordless authentication)
splice-backend/services/emailService.js:1051:  if (provider === 'sendgrid' && TEMPLATE_IDS.signinCode && EMAIL_CONFIG.sendgrid.apiKey) {
splice-backend/services/emailService.js:1082:  if (provider === 'sendgrid' && TEMPLATE_IDS.emailVerification && EMAIL_CONFIG.sendgrid.apiKey) {
splice-backend/services/emailService.js:1110:    return !!EMAIL_CONFIG.sendgrid.apiKey;
splice-backend/services/emailService.js:1114:    return !!(process.env.AWS_ACCESS_KEY_ID && process.env.AWS_SECRET_ACCESS_KEY);
splice-backend/tests/music-phase2-e2e.test.js:82:test('uses MUREKA_API_KEY environment variable', () => {
splice-backend/tests/music-phase2-e2e.test.js:83:  assert(musicGenCode.includes('MUREKA_API_KEY'), 'Should use MUREKA_API_KEY');
splice-backend/tests/music-phase2-e2e.test.js:84:  assert(musicGenCode.includes('process.env.MUREKA_API_KEY'), 'Should read from env');
splice-backend/services/songIdentification.js:19:const ACRCLOUD_ACCESS_SECRET = process.env.ACRCLOUD_ACCESS_SECRET;
splice-backend/services/songIdentification.js:170:    .createHmac('sha1', ACRCLOUD_ACCESS_SECRET)
splice-backend/services/songIdentification.js:182:  if (!ACRCLOUD_ACCESS_KEY || !ACRCLOUD_ACCESS_SECRET) {
splice-backend/services/songIdentification.js:183:    throw new Error('ACRCloud credentials not configured. Set ACRCLOUD_ACCESS_KEY and ACRCLOUD_ACCESS_SECRET');
splice-backend/services/songIdentification.js:474:  return !!(ACRCLOUD_ACCESS_KEY && ACRCLOUD_ACCESS_SECRET);
splice-backend/tests/endpoint-validator.js:573:    notes: 'DATABASE_URL, OPENAI_API_KEY, STRIPE_SECRET_KEY, JWT_SECRET validated' },
splice-backend/tests/endpoint-validator.js:595:    notes: 'Stripe webhook secret validated in production' },
splice-backend/tests/music-phase1-e2e.test.js:171:  assert(songIdCode.includes('ACRCLOUD_ACCESS_SECRET'), 'Should use ACRCLOUD_ACCESS_SECRET');
splice-backend/services/r2Storage.js:23:    const requiredEnvVars = ['R2_ACCOUNT_ID', 'R2_ACCESS_KEY_ID', 'R2_SECRET_ACCESS_KEY', 'R2_BUCKET_NAME'];
splice-backend/services/r2Storage.js:35:        secretAccessKey: process.env.R2_SECRET_ACCESS_KEY
splice-backend/services/transcription.js:20:const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
splice-backend/services/musicGeneration.js:24:const MUREKA_API_KEY = process.env.MUREKA_API_KEY;
splice-backend/services/musicGeneration.js:64:  return !!MUREKA_API_KEY;
splice-backend/services/musicGeneration.js:144:  if (!MUREKA_API_KEY) {
splice-backend/services/musicGeneration.js:145:    throw new Error('Mureka API key not configured. Set MUREKA_API_KEY environment variable.');
splice-backend/services/musicGeneration.js:154:        'Authorization': `Bearer ${MUREKA_API_KEY}`,
splice-backend/services/musicGeneration.js:229:  if (!response.task_id) {
splice-backend/services/musicGeneration.js:234:    taskId: response.task_id,
splice-backend/services/musicGeneration.js:406:    throw new Error('Mureka API key not configured. Set MUREKA_API_KEY environment variable.');
splice-backend/services/musicGeneration.js:533:    throw new Error('Mureka API key not configured. Set MUREKA_API_KEY environment variable.');
splice-backend/services/musicGeneration.js:769:    throw new Error('Mureka API key not configured. Set MUREKA_API_KEY environment variable.');
splice-backend/tests/music-final-e2e.test.js:372:  assert(r2Code.includes('R2_SECRET_ACCESS_KEY'), 'Should check R2_SECRET_ACCESS_KEY');
splice-backend/services/repetitionDetection.js:193:  const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
splice-backend/tests/security.test.js:123:test('should have JWT_SECRET configuration', () => {
splice-backend/tests/security.test.js:124:  assertIncludes(authSource, 'JWT_SECRET', 'Missing JWT_SECRET');
splice-backend/tests/security.test.js:125:  assertIncludes(authSource, 'process.env.JWT_SECRET', 'JWT_SECRET not from env');
splice-backend/tests/security.test.js:150:test('should warn about default JWT secret in production', () => {
splice-backend/tests/security.test.js:151:  assertIncludes(authSource, 'CRITICAL: JWT_SECRET not set in production', 'Missing production warning');
splice-backend/tests/security.test.js:438:  assertIncludes(serverSource, 'CRITICAL: STRIPE_WEBHOOK_SECRET not set in production', 'Missing webhook secret warning');
splice-backend/tests/stripe-webhook.test.js:110:test('should pass body, signature, and secret to constructEvent', () => {
splice-backend/tests/stripe-webhook.test.js:111:  assertIncludes(serverSource, 'constructEvent(req.body, sig, webhookSecret)', 'Should pass correct args');
splice-backend/tests/stripe-webhook.test.js:114:test('should check for STRIPE_WEBHOOK_SECRET', () => {
splice-backend/tests/stripe-webhook.test.js:115:  assertIncludes(serverSource, 'process.env.STRIPE_WEBHOOK_SECRET', 'Should use env secret');
splice-backend/tests/stripe-webhook.test.js:120:  assertIncludes(serverSource, 'STRIPE_WEBHOOK_SECRET not set in production', 'Should log critical error');
splice-backend/services/stripeUsageReporting.js:22:  if (!stripe && process.env.STRIPE_SECRET_KEY) {
splice-backend/services/stripeUsageReporting.js:23:    stripe = new Stripe(process.env.STRIPE_SECRET_KEY, {
splice-backend/services/musicQueue.js:80:      password: url.password,
splice-backend/tests/take-detection.test.js:91:test('should use OPENAI_API_KEY environment variable', () => {
splice-backend/tests/take-detection.test.js:92:  assertTrue(takeDetectionSource.includes('process.env.OPENAI_API_KEY'), 'Should use OPENAI_API_KEY');
splice-backend/tests/stress-test.js:41:  // Webhook secret for signature testing
splice-backend/tests/stress-test.js:42:  webhookSecret: 'whsec_test_secret',
splice-backend/services/sceneAnalysis.js:14:    if (!process.env.OPENAI_API_KEY) {
splice-backend/services/sceneAnalysis.js:15:      throw new Error('OPENAI_API_KEY environment variable is required for scene analysis');
splice-backend/services/sceneAnalysis.js:17:    openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
splice-backend/services/takeDetection.js:11:const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
splice-backend/tests/stripe-webhook-edge-cases.test.js:95:test('should use STRIPE_WEBHOOK_SECRET from environment', () => {
splice-backend/tests/stripe-webhook-edge-cases.test.js:96:  assertContains(serverSource, 'STRIPE_WEBHOOK_SECRET', 'Should use webhook secret env var');
splice-backend/tests/stripe-webhook-edge-cases.test.js:110:test('should return 500 when webhook secret not configured in production', () => {
splice-backend/tests/stripe-webhook-edge-cases.test.js:111:  assertContains(serverSource, "return res.status(500).json({ error: 'Webhook configuration error", 'Should return 500 for missing secret');
splice-backend/tests/stripe-webhook-edge-cases.test.js:464:    serverSource.includes('console.log(process.env.STRIPE_SECRET_KEY)'),
splice-backend/tests/stripe-webhook-edge-cases.test.js:465:    'Should not log secret key value directly'
splice-backend/tests/phase3-performance.test.js:360:  // Mock OPENAI_API_KEY to allow module load
splice-backend/tests/phase3-performance.test.js:361:  const originalKey = process.env.OPENAI_API_KEY;
splice-backend/tests/phase3-performance.test.js:362:  process.env.OPENAI_API_KEY = 'test-key-for-cache-test';
splice-backend/tests/phase3-performance.test.js:380:      process.env.OPENAI_API_KEY = originalKey;
splice-backend/tests/phase3-performance.test.js:382:      delete process.env.OPENAI_API_KEY;
splice-backend/tests/phase3-performance.test.js:388:  const originalKey = process.env.OPENAI_API_KEY;
splice-backend/tests/phase3-performance.test.js:389:  process.env.OPENAI_API_KEY = 'test-key-for-cache-test';
splice-backend/tests/phase3-performance.test.js:403:      process.env.OPENAI_API_KEY = originalKey;
splice-backend/tests/phase3-performance.test.js:405:      delete process.env.OPENAI_API_KEY;
splice-backend/tests/music-phase0-e2e.test.js:76:  assert(r2StorageCode.includes('R2_SECRET_ACCESS_KEY'), 'Should check R2_SECRET_ACCESS_KEY');
splice-backend/tests/music-phase0-e2e.test.js:331:    'mureka_task_id',