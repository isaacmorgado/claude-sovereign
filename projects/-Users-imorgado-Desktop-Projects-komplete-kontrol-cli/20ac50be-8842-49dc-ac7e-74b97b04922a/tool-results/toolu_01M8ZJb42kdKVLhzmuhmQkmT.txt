130:if(A.includes("Llama-3-8B-Instruct-abliterated"))return" Llama 8B (Uncensored)";if(a4()==="foundry")return;let Q=A.toLowerCase();if(Q.includes("claude-sonnet-4-5")&&Q.includes("[1m]"))return"Sonnet 4.5 (with 1M context)";if(Q.includes("claude-sonnet-4-5"))return"Sonnet 4.5";if(Q.includes("claude-sonnet-4")&&Q.includes("[1m]"))return"Sonnet 4 (with 1M context)";if(Q.includes("claude-sonnet-4"))return"Sonnet 4";if(Q.includes("claude-opus-4-5"))return"Opus 4.5";if(Q.includes("claude-opus-4-1"))return"Opus 4.1";if(Q.includes("claude-opus-4"))return"Opus 4";if(Q.includes("claude-3-7-sonnet"))return"Claude 3.7 Sonnet";if(Q.includes("claude-3-5-sonnet"))return"Claude 3.5 Sonnet";if(Q.includes("claude-haiku-4-5"))return"Haiku 4.5";if(Q.includes("claude-3-5-haiku"))return"Claude 3.5 Haiku";return}var OqA,MqA,RqA,_qA,v1A,LT1,jqA,TqA,PqA;var SqA=w(()=>{jD();OqA={firstParty:"claude-3-7-sonnet-20250219",bedrock:"us.anthropic.claude-3-7-sonnet-20250219-v1:0",vertex:"claude-3-7-sonnet@20250219",foundry:"claude-3-7-sonnet"},MqA={firstParty:"claude-3-5-sonnet-20241022",bedrock:"anthropic.claude-3-5-sonnet-20241022-v2:0",vertex:"claude-3-5-sonnet-v2@20241022",foundry:"claude-3-5-sonnet"},RqA={firstParty:"claude-3-5-haiku-20241022",bedrock:"us.anthropic.claude-3-5-haiku-20241022-v1:0",vertex:"claude-3-5-haiku@20241022",foundry:"claude-3-5-haiku"},_qA={firstParty:"claude-haiku-4-5-20251001",bedrock:"us.anthropic.claude-haiku-4-5-20251001-v1:0",vertex:"claude-haiku-4-5@20251001",foundry:"claude-haiku-4-5"},v1A={firstParty:"claude-sonnet-4-20250514",bedrock:"us.anthropic.claude-sonnet-4-20250514-v1:0",vertex:"claude-sonnet-4@20250514",foundry:"claude-sonnet-4"},LT1={firstParty:"claude-sonnet-4-5-20250929",bedrock:"us.anthropic.claude-sonnet-4-5-20250929-v1:0",vertex:"claude-sonnet-4-5@20250929",foundry:"claude-sonnet-4-5"},jqA={firstParty:"claude-opus-4-20250514",bedrock:"us.anthropic.claude-opus-4-20250514-v1:0",vertex:"claude-opus-4@20250514",foundry:"claude-opus-4"},TqA={firstParty:"claude-opus-4-1-20250805",bedrock:"us.anthropic.claude-opus-4-1-20250805-v1:0",vertex:"claude-opus-4-1@20250805",foundry:"claude-opus-4-1"},PqA={firstParty:"claude-opus-4-5-20251101",bedrock:"us.anthropic.claude-opus-4-5-20251101-v1:0",vertex:"claude-opus-4-5@20251101",foundry:"claude-opus-4-5"}
256:`);Cp1()};return process.on("exit",A),()=>{process.off("exit",A)}},[])}function XU3(A,Q){return Math.round(A*Q)/Q}function atA(A,Q,B){uv0(A,Q,B),ev0()?.add(A,{model:B}),cCA()?.add(Q.input_tokens,{type:"input",model:B}),cCA()?.add(Q.output_tokens,{type:"output",model:B}),cCA()?.add(Q.cache_read_input_tokens??0,{type:"cacheRead",model:B}),cCA()?.add(Q.cache_creation_input_tokens??0,{type:"cacheCreation",model:B})}var IsQ;var IR=w(()=>{t6();m2();IQ();q0();q0();q0();oj();q0();IsQ=c(JA(),1)});function IU3(A,Q){return Q.input_tokens/1e6*A.inputTokens+Q.output_tokens/1e6*A.outputTokens+(Q.cache_read_input_tokens??0)/1e6*A.promptCacheReadTokens+(Q.cache_creation_input_tokens??0)/1e6*A.promptCacheWriteTokens+(Q.server_tool_use?.web_search_requests??0)*A.webSearchRequests}function WU3(A){return A.input_tokens+(A.cache_read_input_tokens??0)+(A.cache_creation_input_tokens??0)}function DU3(A,Q){let B=Nz(A),G=DsQ[B];if(G===m0A&&WU3(Q)>200000)return Up1;if(!G)return p("tengu_unknown_model_cost",{model:A,shortName:B}),y$1(),DsQ[Nz(VsQ)];return G}function ttA(A,Q){let B=DU3(A,Q);return IU3(B,Q)}function KsQ(A){if(Number.isInteger(A))return`$${A}`;return`$${A.toFixed(2)}`}function Dn(A){return`${KsQ(A.inputTokens)}/${KsQ(A.outputTokens)} per Mtok`}var m0A,rtA,stA,Up1,qp1,Np1,DsQ;var etA=w(()=>{IR();Z0();SqA();m2();m0A={inputTokens:3,outputTokens:15,promptCacheWriteTokens:3.75,promptCacheReadTokens:0.3,webSearchRequests:0.01},rtA={inputTokens:15,outputTokens:75,promptCacheWriteTokens:18.75,promptCacheReadTokens:1.5,webSearchRequests:0.01},stA={inputTokens:5,outputTokens:25,promptCacheWriteTokens:6.25,promptCacheReadTokens:0.5,webSearchRequests:0.01},Up1={inputTokens:6,outputTokens:22.5,promptCacheWriteTokens:7.5,promptCacheReadTokens:0.6,webSearchRequests:0.01},qp1={inputTokens:0.8,outputTokens:4,promptCacheWriteTokens:1,promptCacheReadTokens:0.08,webSearchRequests:0.01},Np1={inputTokens:1,outputTokens:5,promptCacheWriteTokens:1.25,promptCacheReadTokens:0.1,webSearchRequests:0.01},DsQ={[Nz(RqA.firstParty)]:qp1,[Nz(_qA.firstParty)]:Np1,[Nz(MqA.firstParty)]:m0A,[Nz(OqA.firstParty)]:m0A,[Nz(v1A.firstParty)]:m0A,[Nz(jqA.firstParty)]:rtA,[Nz(TqA.firstParty)]:rtA,[Nz(PqA.firstParty)]:stA,...{}}});function Kn(){let A=process.env.CLAUDE_AGENT_SDK_VERSION?`, agent-sdk/${process.env.CLAUDE_AGENT_SDK_VERSION}`:"";return`claude-cli/${{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.VERSION} (external, ${process.env.CLAUDE_CODE_ENTRYPOINT}${A})`}function d0A(){return`claude-code/${{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.VERSION}`}function RW(){return`claude-code/${{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.VERSION}`}function HJ(){if(OB()){let Q=f4();if(!Q?.accessToken)return{headers:{},error:"No OAuth token available"};return{headers:{Authorization:`Bearer ${Q.accessToken}`,"anthropic-beta":dl}}}let A=uw();if(!A)return{headers:{},error:"No API key available"};return{headers:{"x-api-key":A}}}var wz=w(()=>{eB();ZX()});async function VU3(){let A=O3()?.organizationUuid;if(!A)throw Error("No organization ID available");let Q=HJ();if(Q.error)throw Error(`Auth error: ${Q.error}`);let B={"Content-Type":"application/json","User-Agent":RW(),...Q.headers};try{let G=`https://api.anthropic.com/api/organization/${A}/claude_code_sonnet_1m_access`,Z=await fQ.get(G,{headers:B,timeout:5000});return{hasAccess:Z.data.has_access,hasAccessNotAsDefault:Z.data.has_access_not_as_default,hasError:!1}}catch(G){return s(G),{hasAccess:!1,hasError:!0}}}async function HU3(){try{return await FU3()}catch(A){return k("Sonnet-1M access check failed, defaulting to no access"),{hasAccess:!1,hasError:!0}}}function Vn(){let A=O3()?.organizationUuid;if(!A)return{hasAccess:!1,wasPartOfDefaultRollout:!1,needsRefresh:!1};let Q=R1(),B=(OB()?Q.s1mAccessCache:Q.s1mNonSubscriberAccessCache)?.[A],G=Date.now();if(!B)return{hasAccess:!1,wasPartOfDefaultRollout:!1,needsRefresh:!0};let{hasAccess:Z,hasAccessNotAsDefault:Y,timestamp:J}=B,X=G-J>EU3;return{hasAccess:Z||(Y??!1),wasPartOfDefaultRollout:Z,needsRefresh:X}}async function FsQ(){let{needsRefresh:A}=Vn();if(A)zU3()}async function zU3(){let A=O3()?.organizationUuid;if(!A)return;if(!OB()){let Q=await liA();if(!Q)return;let{uuid:B,rate_limit_tier:G}=Q.organization,Z={hasAccess:G==="auto_prepaid_tier_3"||G==="manual_tier_3",timestamp:Date.now()};h0((Y)=>({...Y,s1mNonSubscriberAccessCache:{...Y.s1mNonSubscriberAccessCache,[B]:Z}}));return}try{let{hasAccess:Q,hasAccessNotAsDefault:B}=await HU3(),G={hasAccess:Q,hasAccessNotAsDefault:B,timestamp:Date.now()};h0((Z)=>({...Z,s1mAccessCache:{...Z.s1mAccessCache,[A]:G}}))}catch(Q){k("Failed to fetch and cache Sonnet-1M access"),s(Q)}}var KU3=3600000,FU3,EU3=3600000;var AeA=w(()=>{f5();miA();wz();y1();f1();IQ();eB();FqA();FU3=uiA(VU3,KU3)});function $U3(){return"inherit"}function _W(){return process.env.ANTHROPIC_SMALL_FAST_MODEL||Lp1()}function VJA(A){return A===rX().opus40||A===rX().opus41||A===rX().opus45}function BeA(A){return A.includes("opus")}function GeA(){let A,Q=nv0();if(Q!==void 0)A=Q;else{let B=NQ()||{};A=process.env.ANTHROPIC_MODEL||B.model||void 0}if(OB()&&!DR()&&A&&BeA(A))return;return A}function p0A(A={}){let Q=GeA();if(Q!==null&&Q!==void 0)return Q;let{forDisplay:B=!1}=A;return zsQ(B)}function d3(){let A=p0A();if(A!==void 0&&A!==null)return KX(A);return Bu()}function WR(){if(process.env.ANTHROPIC_DEFAULT_SONNET_MODEL)return process.env.ANTHROPIC_DEFAULT_SONNET_MODEL;return rX().sonnet45}function yLA(){return E6()==="max"}function vLA(){return E6()==="team"}function ZeA(){return E6()==="pro"}function c0A(){if(process.env.ANTHROPIC_DEFAULT_OPUS_MODEL)return process.env.ANTHROPIC_DEFAULT_OPUS_MODEL;if(a4()==="firstParty")return rX().opus45;return rX().opus41}function Lp1(){if(process.env.ANTHROPIC_DEFAULT_HAIKU_MODEL)return process.env.ANTHROPIC_DEFAULT_HAIKU_MODEL;return rX().haiku45}function FJA(){return AY("tengu_opus_default_pro_plan","opus_is_default",!1)}function l0A(A){let{permissionMode:Q,mainLoopModel:B,exceeds200kTokens:G=!1}=A;if(p0A()==="opusplan"&&Q==="plan"&&!G)return c0A();if(p0A()==="haiku"&&Q==="plan")return WR();return B}function Op1(){if(!OB())return!1;let{hasAccess:A}=Vn();if(!A)return!1;return AY("sonnet_1m_default","enabled",!1)}function zsQ(A){let Q=UU3();if(Q!==null&&Q.name)return A?Q.displayName??Q.name:Q.name;if(Op1())return"sonnet[1m]";return}function i0A(A={}){let{forDisplay:Q=!1}=A,B=zsQ(Q);if(B!==void 0)return B;if(yLA()||vLA())return c0A();if(ZeA()&&FJA())return c0A();return WR()}function Bu(A={}){return KX(i0A(A))}function Nz(A){if(A.includes("claude-opus-4-5"))return"claude-opus-4-5";if(A.includes("claude-opus-4-1"))return"claude-opus-4-1";if(A.includes("claude-opus-4"))return"claude-opus-4";let Q=A.match(/(claude-(\d+-\d+-)?\w+)/);if(Q&&Q[1])return Q[1];return A}async function CsQ(){try{if(R1().claudeCodeFirstTokenDate!==void 0)return;let Q=HJ();if(Q.error){s(Error(`Failed to get auth headers: ${Q.error}`));return}let G=`${b9().BASE_API_URL}/api/organization/claude_code_first_token_date`,Y=(await fQ.get(G,{headers:{...Q.headers,"User-Agent":RW()}})).data?.first_token_date??null;if(Y!==null){let J=new Date(Y).getTime();if(isNaN(J)){s(Error(`Received invalid first_token_date from API: ${Y}`));return}}h0((J)=>({...J,claudeCodeFirstTokenDate:Y}))}catch(A){s(A instanceof Error?A:Error(String(A)))}}function xLA(){if(Op1())return"Sonnet 4.5 with 1M context 路 Best for everyday tasks";if(yLA()||vLA())return"Opus 4.5 路 Most capable for complex work";if(ZeA()&&FJA())return"Opus 4.5 路 Most capable for complex work";return"Sonnet 4.5 路 Best for everyday tasks"}function qU3(A){if(A==="opusplan")return"Opus 4.5 in plan mode, else Sonnet 4.5";return B$(KX(A))}function $sQ(A){if(A==="opusplan")return"Opus Plan";if(Rp1(A))return A.charAt(0).toUpperCase()+A.slice(1);return B$(A)}function UsQ(A){switch(A){case rX().opus45:return"Opus 4.5";case rX().opus41:return"Opus 4.1";case rX().opus40:return"Opus 4";case rX().sonnet45+"[1m]":return"Sonnet 4.5 (1M context)";case rX().sonnet45:return"Sonnet 4.5";case rX().sonnet40:return"Sonnet 4";case rX().sonnet40+"[1m]":return"Sonnet 4 (1M context)";case rX().sonnet37:return"Sonnet 3.7";case rX().sonnet35:return"Sonnet 3.5";case rX().haiku45:return"Haiku 4.5";case rX().haiku35:return"Haiku 3.5";default:return null}}function B$(A){let Q=UsQ(A);if(Q)return Q;return A}function qsQ(A){let Q=UsQ(A);if(Q)return`Claude ${Q}`;return"Claude"}function Fn(){if(OB()){if(!DR())return{value:null,label:"Sonnet",description:Mp1.description};if(ZeA()&&FJA())return{value:null,label:"Opus",description:xLA()};return{value:null,label:"Default (recommended)",description:xLA()}}return{value:null,label:"Default (recommended)",description:`Use the default model (currently ${qU3(i0A({forDisplay:!0}))}) 路 ${Dn(m0A)}`}}function LU3(){return Lp1()===rX().haiku45?LsQ:wU3}function RU3(){let A=LsQ;if(OB()){if(!DR())return[Fn(),QeA];if(yLA()||vLA()){let G=[Fn(),EsQ];if(Vn().hasAccess)G.push(HsQ);return G.push(QeA),G}if(ZeA()&&FJA())return[Fn(),EsQ,QeA];let B=[Fn(),OU3];if(Op1())B.push({value:"sonnet",label:"Sonnet",description:"Sonnet 4.5 with 200K context"});else if(Vn().hasAccess)B.push(HsQ);return B.push(QeA),B}let Q=[Fn(),wsQ()];if(a4()!=="firstParty")Q.push(NU3());if(Vn().hasAccess)Q.push(NsQ);if(A)Q.push(A);return Q}function HJA(){let A=RU3(),Q=null,B=GeA(),G=OmA();if(B!==void 0&&B!==null)Q=B;else if(G!==null)Q=G;if(Q===null||A.some((Z)=>Z.value===Q))return A;if(Q==="opusplan")return[...A,MU3()];if(!OB()&&Rp1(Q))if(Q==="sonnet")A.push(Mp1);else if(Q==="sonnet[1m]")A.push(NsQ);else if(Q==="opus")A.push(wsQ());else if(Q==="haiku")A.push(LU3());else A.push({value:Q,label:Q,description:"Custom model"});else A.push({value:Q,label:Q,description:"Custom model"});return A}function Rp1(A){return DJA.includes(A)}function KX(A){let Q=A.trim(),B=Q.toLowerCase(),G=B.endsWith("[1m]"),Z=G?B.replace(/\[1m]$/i,"").trim():B;if(Rp1(Z))switch(Z){case"opusplan":return WR()+(G?"[1m]":"");case"sonnet":return WR()+(G?"[1m]":"");case"haiku":return Lp1()+(G?"[1m]":"");case"opus":return c0A();default:}if(G)return Q.replace(/\[1m\]$/i,"").trim()+"[1m]";return Q}function vT(A){if(A===null){if(OB()&&!DR())return`Sonnet (${Mp1.description})`;else if(OB())return`Default (${xLA()})`;return`Default (${Bu({forDisplay:!0})})`}let Q=KX(A);return A===Q?Q:`${A} (${Q})`}function EJA(A,Q,B,G){if(process.env.CLAUDE_CODE_SUBAGENT_MODEL)return process.env.CLAUDE_CODE_SUBAGENT_MODEL;let Z=Hp1(Q),Y=(X)=>{if(Z&&a4()==="bedrock")return JsQ(X,Z);return X};if(B)return Y(KX(B));let J=A??$U3();if(!J)return Y(KX(wp1));if(J==="inherit")return l0A({permissionMode:G??"default",mainLoopModel:Q,exceeds200kTokens:!1});return Y(KX(J))}function YeA(A){if(!A)return"Sonnet (default)";if(A==="inherit")return"Inherit from parent";return A.charAt(0).toUpperCase()+A.slice(1)}function OsQ(){let A=[{value:"sonnet",label:"Sonnet",description:"Balanced performance - best for most agents"}];if(DR())A.push({value:"opus",label:"Opus",description:"Most capable for complex reasoning tasks"});return A.push({value:"haiku",label:"Haiku",description:"Fast and efficient for simple tasks"},{value:"inherit",label:"Inherit from parent",description:"Use the same model as the main conversation"}),A}function Gu(A){return A.replace(/\[(1|2)m\]/gi,"")}var DJA,CU3,VsQ,KJA,wp1="sonnet",UU3,Mp1,NsQ,wsQ=()=>{let A=a4()!=="firstParty";return{value:"opus",label:A?"Opus 4.1":"Opus",description:`Opus ${A?"4.1":"4.5"} 路 ${A?"Legacy":"Most capable for complex work"} 路 ${Dn(A?rtA:stA)}`,descriptionForModel:A?"Opus 4.1 - legacy version":"Opus 4.5 - most capable for complex work"}},NU3=()=>{return{value:rX().opus45,label:"Opus 4.5",description:`Opus 4.5 路 Most capable for complex work 路 ${Dn(stA)}`,descriptionForModel:"Opus 4.5 - most capable for complex work"}},LsQ,wU3,OU3,HsQ,EsQ,QeA,MU3=()=>{return{value:"opusplan",label:"Opus Plan Mode",description:"Use Opus 4.5 in plan mode, Sonnet 4.5 otherwise"}};var m2=w(()=>{X9();IQ();q0();eB();SqA();Ep1();etA();GB();VX();Zu();f5();ZX();f1();wz();AeA();jD();jLA();M3();DJA=["sonnet","opus","haiku","sonnet[1m]","opusplan"],CU3=v1A,VsQ=CU3.firstParty,KJA=[...DJA,"inherit"];UU3=W0(()=>{return null});Mp1={value:"sonnet",label:"Sonnet",description:`Sonnet 4.5 路 Best for everyday tasks 路 ${Dn(m0A)}`,descriptionForModel:"Sonnet 4.5 - best for everyday tasks. Generally recommended for most coding tasks"},NsQ={value:"sonnet[1m]",label:"Sonnet (1M context)",description:`Sonnet 4.5 for long sessions 路 ${Dn(Up1)}`,descriptionForModel:"Sonnet 4.5 with 1M context window - for long sessions with large codebases"},LsQ={value:"haiku",label:"Haiku",description:`Haiku 4.5 路 Fastest for quick answers 路 ${Dn(Np1)}`,descriptionForModel:"Haiku 4.5 - fastest for quick answers. Lower cost but less capable than Sonnet 4.5."},wU3={value:"haiku",label:"Haiku",description:`Haiku 3.5 for simple tasks 路 ${Dn(qp1)}`,descriptionForModel:"Haiku 3.5 - faster and lower cost, but less capable than Sonnet. Use for simple tasks."};OU3={value:"opus",label:"Opus",description:"Opus 4.5 路 Most capable for complex work"},HsQ={value:"sonnet[1m]",label:"Sonnet (1M context)",description:"Sonnet 4.5 with 1M context 路 Uses rate limits faster"},EsQ={value:"sonnet",label:"Sonnet",description:"Sonnet 4.5 路 Best for everyday tasks"},QeA={value:"haiku",label:"Haiku",description:"Haiku 4.5 路 Fastest for quick answers"}});import{AsyncLocalStorage as _U3}from"async_hooks";function RsQ(){return MsQ.getStore()}function JeA(A,Q){return MsQ.run(A,Q)}var MsQ;var _p1=w(()=>{MsQ=new _U3});function f9(A){if(A.startsWith("mcp__"))return"mcp_tool";return A}function TU3(){let A=RsQ();if(A)return{agentId:A.agentId,parentSessionId:A.parentSessionId,agentType:A.agentType};return{...{},...process.env.CLAUDE_CODE_PARENT_SESSION_ID?{parentSessionId:process.env.CLAUDE_CODE_PARENT_SESSION_ID}:{}}}function xU3(){return}async function Hn(A={}){let Q=A.model?String(A.model):d3(),B=TH(Q),G=await SU3(),Z=xU3();return{model:Q,sessionId:E0(),userType:"external",...B.length>0?{betas:B.join(",")}:{},envContext:G,...process.env.CLAUDE_CODE_ENTRYPOINT&&{entrypoint:process.env.CLAUDE_CODE_ENTRYPOINT},...process.env.CLAUDE_AGENT_SDK_VERSION&&{agentSdkVersion:process.env.CLAUDE_AGENT_SDK_VERSION},isInteractive:String(jmA()),clientType:TmA(),...Z&&{processMetrics:Z},sweBenchRunId:process.env.SWE_BENCH_RUN_ID||"",sweBenchInstanceId:process.env.SWE_BENCH_INSTANCE_ID||"",sweBenchTaskId:process.env.SWE_BENCH_TASK_ID||"",...TU3()}}function _sQ(A,Q={}){let B={};for(let[G,Z]of Object.entries(Q))if(Z!==void 0)B[G]=String(Z);for(let[G,Z]of Object.entries(A)){if(Z===void 0)continue;if(G==="envContext")B.env=Q1(Z);else if(G==="processMetrics")B.process=Q1(Z);else B[G]=String(Z)}return B}function jsQ(A,Q={}){let{envContext:B,processMetrics:G,...Z}=A;return{...Q,...Z,env:B,...G&&{process:G},surface:jU3}}function TsQ(A,Q,B={}){let{envContext:G,processMetrics:Z,...Y}=A,J={platform:G.platform,arch:G.arch,node_version:G.nodeVersion,terminal:G.terminal||"unknown",package_managers:G.packageManagers,runtimes:G.runtimes,is_running_with_bun:G.isRunningWithBun,is_ci:G.isCi,is_claubbit:G.isClaubbit,is_claude_code_remote:G.isClaudeCodeRemote,is_local_agent_mode:G.isLocalAgentMode,is_conductor:G.isConductor,is_github_action:G.isGithubAction,is_claude_code_action:G.isClaudeCodeAction,is_claude_ai_auth:G.isClaudeAiAuth,version:G.version,build_time:G.buildTime,deployment_environment:G.deploymentEnvironment};if(G.remoteEnvironmentType)J.remote_environment_type=G.remoteEnvironmentType;if(G.claudeCodeContainerId)J.claude_code_container_id=G.claudeCodeContainerId;if(G.claudeCodeRemoteSessionId)J.claude_code_remote_session_id=G.claudeCodeRemoteSessionId;if(G.tags)J.tags=G.tags.split(",").map((I)=>I.trim()).filter(Boolean);if(G.githubEventName)J.github_event_name=G.githubEventName;if(G.githubActionsRunnerEnvironment)J.github_actions_runner_environment=G.githubActionsRunnerEnvironment;if(G.githubActionsRunnerOs)J.github_actions_runner_os=G.githubActionsRunnerOs;if(G.githubActionRef)J.github_action_ref=G.githubActionRef;if(G.wslVersion)J.wsl_version=G.wslVersion;if(G.versionBase)J.version_base=G.versionBase;let X={session_id:Y.sessionId,model:Y.model,user_type:Y.userType,is_interactive:Y.isInteractive==="true",client_type:Y.clientType};if(Y.betas)X.betas=Y.betas;if(Y.entrypoint)X.entrypoint=Y.entrypoint;if(Y.agentSdkVersion)X.agent_sdk_version=Y.agentSdkVersion;if(Y.sweBenchRunId)X.swe_bench_run_id=Y.sweBenchRunId;if(Y.sweBenchInstanceId)X.swe_bench_instance_id=Y.sweBenchInstanceId;if(Y.sweBenchTaskId)X.swe_bench_task_id=Y.sweBenchTaskId;if(Y.agentId)X.agent_id=Y.agentId;if(Y.parentSessionId)X.parent_session_id=Y.parentSessionId;if(Y.agentType)X.agent_type=Y.agentType;if(Q.githubActionsMetadata){let I=Q.githubActionsMetadata;J.github_actions_metadata={actor_id:I.actorId,repository_id:I.repositoryId,repository_owner_id:I.repositoryOwnerId}}return{env:J,...Z&&{process:Q1(Z)},core:X,additional:B}}var jU3="claude-code",PU3,SU3;var hD=w(()=>{X9();h3();y1A();Mq();m2();q0();bQ();eB();f3();_p1();e1();PU3=W0(()=>{let A={ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.VERSION.match(/^\d+\.\d+\.\d+(?:-[a-z]+)?/);return A?A[0]:void 0}),SU3=W0(async()=>{let[A,Q]=await Promise.all([n0.getPackageManagers(),n0.getRuntimes()]);return{platform:n0.platform,arch:n0.arch,nodeVersion:n0.nodeVersion,terminal:Yq.terminal,packageManagers:A.join(","),runtimes:Q.join(","),isRunningWithBun:n0.isRunningWithBun(),isCi:i1(!1),isClaubbit:process.env.CLAUBBIT==="true",isClaudeCodeRemote:process.env.CLAUDE_CODE_REMOTE==="true",isLocalAgentMode:process.env.CLAUDE_CODE_ENTRYPOINT==="local-agent",isConductor:n0.isConductor(),...process.env.CLAUDE_CODE_REMOTE_ENVIRONMENT_TYPE&&{remoteEnvironmentType:process.env.CLAUDE_CODE_REMOTE_ENVIRONMENT_TYPE},...process.env.CLAUDE_CODE_CONTAINER_ID&&{claudeCodeContainerId:process.env.CLAUDE_CODE_CONTAINER_ID},...process.env.CLAUDE_CODE_REMOTE_SESSION_ID&&{claudeCodeRemoteSessionId:process.env.CLAUDE_CODE_REMOTE_SESSION_ID},...process.env.CLAUDE_CODE_TAGS&&{tags:process.env.CLAUDE_CODE_TAGS},isGithubAction:process.env.GITHUB_ACTIONS==="true",isClaudeCodeAction:process.env.CLAUDE_CODE_ACTION==="1"||process.env.CLAUDE_CODE_ACTION==="true",isClaudeAiAuth:OB(),version:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.VERSION,versionBase:PU3(),buildTime:{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.BUILD_TIME,deploymentEnvironment:n0.detectDeploymentEnvironment(),...process.env.GITHUB_ACTIONS==="true"&&{githubEventName:process.env.GITHUB_EVENT_NAME,githubActionsRunnerEnvironment:process.env.RUNNER_ENVIRONMENT,githubActionsRunnerOs:process.env.RUNNER_OS,githubActionRef:process.env.GITHUB_ACTION_PATH?.includes("claude-code-action/")?process.env.GITHUB_ACTION_PATH.split("claude-code-action/")[1]:void 0},...vAA()&&{wslVersion:vAA()}}})});function gD(){return i1(process.env.CLAUDE_CODE_USE_BEDROCK)||i1(process.env.CLAUDE_CODE_USE_VERTEX)||i1(process.env.CLAUDE_CODE_USE_FOUNDRY)||!!process.env.DISABLE_TELEMETRY||!!process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC}var Yu=w(()=>{bQ()});import{createHash as yU3}from"crypto";function kU3(A){let Q=En(!0),B={networkConfig:{api:"https://statsig.anthropic.com/v1/",networkTimeoutMs:30000},environment:{tier:["test","dev"].includes("production")?"development":"production"},includeCurrentPageUrlWithEvents:!1,logLevel:XeA.LogLevel.None,storageProvider:new wT1,customUserCacheKeyFunc:(Y,J)=>{return yU3("sha1").update(Y).update(J.userID||"").digest("hex").slice(0,10)}},G=new XeA.StatsigClient(A,Q,B);G.on("error",()=>{fQ.head("https://api.anthropic.com/api/hello").catch(()=>{})});let Z=G.initializeAsync();return process.on("beforeExit",async()=>{await G.flush()}),process.on("exit",()=>{G.flush()}),{client:G,initialized:Z}}function SsQ(){IeA.cache?.clear?.(),Ju.cache?.clear?.(),WeA.cache?.clear?.()}async function n0A(){if(gD())return;try{let A=En(!0),Q=await Ju();if(Q)await Q.updateUserAsync(A)}catch(A){s(A instanceof Error?A:Error(`Statsig: Force refresh failed: ${A}`))}}function xsQ(){if(gD())return;let A=setInterval(()=>{n0A()},vU3);process.on("beforeExit",()=>{clearInterval(A)})}async function jp1(A,Q){if(gD())return;try{let[B,G]=await Promise.all([Ju(),Hn({model:Q.model})]);if(!B)return;let Z=_sQ(G,Q),Y={eventName:A,metadata:Z};B.logEvent(Y),await B.flush()}catch(B){}}function ysQ(A,Q){jp1(A,Q)}function vsQ(){return{...PsQ}}function AY(A,Q,B){let G=IeA();if(!G)return B;let Z=G.client.getExperiment(A);if(!Z)return B;return Z.get(Q,B)}function kLA(A){return bU3(A),R1().cachedStatsigGates[A]??!1}var XeA,vU3=21600000,PsQ,IeA,Ju,WeA,bU3;var VX=w(()=>{X9();f5();SzQ();yzQ();lpA();Zu();y1();f1();IQ();hD();Yu();e1();XeA=c(PzQ(),1),PsQ={};IeA=W0(()=>{if(gD())return null;return kU3(Y9Q)}),Ju=W0(async()=>{let A=IeA();if(!A)return null;return await A.initialized,A.client});WeA=W0(async(A)=>{if(gD())return!1;let Q=IeA();if(!Q)return!1;await Q.initialized;let B=Q.client.checkGate(A);return PsQ[A]=B,B});bU3=W0(async(A)=>{let Q=await WeA(A);h0((B)=>{if(B.cachedStatsigGates[A]===Q)return B;return{...B,cachedStatsigGates:{...B.cachedStatsigGates,[A]:Q}}})})});function fU3(A){let Q=[],B=[];for(let G of A)if(ksQ.includes(G))Q.push(G);else B.push(G);return{allowed:Q,disallowed:B}}function bsQ(A){if(!A||A.length===0)return;if(OB()){console.warn("Warning: Custom betas are only available for API key users. Ignoring provided betas.");return}let{allowed:Q,disallowed:B}=fU3(A);for(let G of B)console.warn(`Warning: Beta header '${G}' is not allowed. Only the following betas are supported: ${ksQ.join(", ")}`);return Q.length>0?Q:void 0}function hU3(A){let Q=a4();if(Q==="foundry")return!0;if(Q==="firstParty")return!A.includes("claude-3-");return A.includes("claude-opus-4")||A.includes("claude-sonnet-4")}function gU3(A){let Q=A.toLowerCase();return Q.includes("claude-opus-4")||Q.includes("claude-sonnet-4")||Q.includes("claude-haiku-4")}function Tp1(A){return A.includes("-structured-")}function fsQ(){let A=a4();if(A==="vertex"||A==="bedrock")return vv0;return yv0}function uU3(){return(a4()==="firstParty"||a4()==="foundry")&&!i1(process.env.CLAUDE_CODE_DISABLE_EXPERIMENTAL_BETAS)}function DeA(A){let Q=TH(A),B=Rw();if(!B||B.length===0)return Q;return[...Q,...B.filter((G)=>!Q.includes(G))]}function KeA(){Pp1.cache?.clear?.(),TH.cache?.clear?.(),Sp1.cache?.clear?.()}var ksQ,Pp1,TH,Sp1;var Mq=w(()=>{X9();q0();F5A();ZX();eB();bQ();jD();VX();M3();ksQ=[V5A];Pp1=W0((A)=>{let Q=[],B=A.includes("haiku"),G=a4(),Z=uU3();if(!B)Q.push(Pv0);if(OB())Q.push(dl);if(A.includes("[1m]"))Q.push(V5A);else if(A.includes("claude-sonnet-4-5")){if(AY("sonnet_45_1m_header","enabled",!1))Q.push(V5A)}if(!i1(process.env.DISABLE_INTERLEAVED_THINKING)&&hU3(A))Q.push(Sv0);let Y=Z&&AY("preserve_thinking","enabled",!1);if(i1(process.env.USE_API_CONTEXT_MANAGEMENT)&&!1||Y)Q.push(UmA);let J=y8("tengu_tool_pear");if(Tp1(A)&&J)Q.push(xv0);if(Z&&AY("tool_use_examples","enabled",!1))Q.push(qmA);if(G==="vertex"&&gU3(A))Q.push(_$1);if(G==="foundry")Q.push(_$1);if(process.env.ANTHROPIC_BETAS&&!B)Q.push(...process.env.ANTHROPIC_BETAS.split(",").map((X)=>X.trim()).filter(Boolean));return Q}),TH=W0((A)=>{let Q=Pp1(A);if(a4()==="bedrock")return Q.filter((B)=>!j$1.has(B));return Q}),Sp1=W0((A)=>{return Pp1(A).filter((B)=>j$1.has(B))})});var hp1=U((iU3)=>{iU3.HttpAuthLocation=void 0;(function(A){A.HEADER="header",A.QUERY="query"})(iU3.HttpAuthLocation||(iU3.HttpAuthLocation={}));iU3.HttpApiKeyAuthLocation=void 0;(function(A){A.HEADER="header",A.QUERY="query"})(iU3.HttpApiKeyAuthLocation||(iU3.HttpApiKeyAuthLocation={}));iU3.EndpointURLScheme=void 0;(function(A){A.HTTP="http",A.HTTPS="https"})(iU3.EndpointURLScheme||(iU3.EndpointURLScheme={}));iU3.AlgorithmId=void 0;(function(A){A.MD5="md5",A.CRC32="crc32",A.CRC32C="crc32c",A.SHA1="sha1",A.SHA256="sha256"})(iU3.AlgorithmId||(iU3.AlgorithmId={}));var mU3=(A)=>{let Q=[];if(A.sha256!==void 0)Q.push({algorithmId:()=>iU3.AlgorithmId.SHA256,checksumConstructor:()=>A.sha256});if(A.md5!=null)Q.push({algorithmId:()=>iU3.AlgorithmId.MD5,checksumConstructor:()=>A.md5});return{addChecksumAlgorithm(B){Q.push(B)},checksumAlgorithms(){return Q}}},dU3=(A)=>{let Q={};return A.checksumAlgorithms().forEach((B)=>{Q[B.algorithmId()]=B.checksumConstructor()}),Q},pU3=(A)=>{return mU3(A)},cU3=(A)=>{return dU3(A)};iU3.FieldPosition=void 0;(function(A){A[A.HEADER=0]="HEADER",A[A.TRAILER=1]="TRAILER"})(iU3.FieldPosition||(iU3.FieldPosition={}));var lU3="__smithy_context";iU3.IniSectionType=void 0;(function(A){A.PROFILE="profile",A.SSO_SESSION="sso-session",A.SERVICES="services"})(iU3.IniSectionType||(iU3.IniSectionType={}));iU3.RequestHandlerProtocol=void 0;(function(A){A.HTTP_0_9="http/0.9",A.HTTP_1_0="http/1.0",A.TDS_8_0="tds/8.0"})(iU3.RequestHandlerProtocol||(iU3.RequestHandlerProtocol={}));iU3.SMITHY_CONTEXT_KEY=lU3;iU3.getDefaultClientConfiguration=pU3;iU3.resolveDefaultRuntimeConfig=cU3});var a0A=U((CJA)=>{var usQ=Bv(),pp1=Iq(),up1=hp1(),rU3=IX(),hsQ=Xq();class msQ{config;middlewareStack=usQ.constructStack();initConfig;handlers;constructor(A){this.config=A}send(A,Q,B){let G=typeof Q!=="function"?Q:void 0,Z=typeof Q==="function"?Q:B,Y=G===void 0&&this.config.cacheMiddleware===!0,J;if(Y){if(!this.handlers)this.handlers=new WeakMap;let X=this.handlers;if(X.has(A.constructor))J=X.get(A.constructor);else J=A.resolveMiddleware(this.middlewareStack,this.config,G),X.set(A.constructor,J)}else delete this.handlers,J=A.resolveMiddleware(this.middlewareStack,this.config,G);if(Z)J(A).then((X)=>Z(null,X.output),(X)=>Z(X)).catch(()=>{});else return J(A).then((X)=>X.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}var gp1="***SensitiveInformation***";function mp1(A,Q){if(Q==null)return Q;let B=rU3.NormalizedSchema.of(A);if(B.getMergedTraits().sensitive)return gp1;if(B.isListSchema()){if(!!B.getValueSchema().getMergedTraits().sensitive)return gp1}else if(B.isMapSchema()){if(!!B.getKeySchema().getMergedTraits().sensitive||!!B.getValueSchema().getMergedTraits().sensitive)return gp1}else if(B.isStructSchema()&&typeof Q==="object"){let G=Q,Z={};for(let[Y,J]of B.structIterator())if(G[Y]!=null)Z[Y]=mp1(J,G[Y]);return Z}return Q}class cp1{middlewareStack=usQ.constructStack();schema;static classBuilder(){return new dsQ}resolveMiddlewareWithContext(A,Q,B,{middlewareFn:G,clientName:Z,commandName:Y,inputFilterSensitiveLog:J,outputFilterSensitiveLog:X,smithyContext:I,additionalContext:W,CommandCtor:D}){for(let E of G.bind(this)(D,A,Q,B))this.middlewareStack.use(E);let K=A.concat(this.middlewareStack),{logger:V}=Q,F={logger:V,clientName:Z,commandName:Y,inputFilterSensitiveLog:J,outputFilterSensitiveLog:X,[up1.SMITHY_CONTEXT_KEY]:{commandInstance:this,...I},...W},{requestHandler:H}=Q;return K.resolve((E)=>H.handle(E.request,B||{}),F)}}class dsQ{_init=()=>{};_ep={};_middlewareFn=()=>[];_commandName="";_clientName="";_additionalContext={};_smithyContext={};_inputFilterSensitiveLog=void 0;_outputFilterSensitiveLog=void 0;_serializer=null;_deserializer=null;_operationSchema;init(A){this._init=A}ep(A){return this._ep=A,this}m(A){return this._middlewareFn=A,this}s(A,Q,B={}){return this._smithyContext={service:A,operation:Q,...B},this}c(A={}){return this._additionalContext=A,this}n(A,Q){return this._clientName=A,this._commandName=Q,this}f(A=(B)=>B,Q=(B)=>B){return this._inputFilterSensitiveLog=A,this._outputFilterSensitiveLog=Q,this}ser(A){return this._serializer=A,this}de(A){return this._deserializer=A,this}sc(A){return this._operationSchema=A,this._smithyContext.operationSchema=A,this}build(){let A=this,Q;return Q=class extends cp1{input;static getEndpointParameterInstructions(){return A._ep}constructor(...[B]){super();this.input=B??{},A._init(this),this.schema=A._operationSchema}resolveMiddleware(B,G,Z){let Y=A._operationSchema,J=Y?.[4]??Y?.input,X=Y?.[5]??Y?.output;return this.resolveMiddlewareWithContext(B,G,Z,{CommandCtor:Q,middlewareFn:A._middlewareFn,clientName:A._clientName,commandName:A._commandName,inputFilterSensitiveLog:A._inputFilterSensitiveLog??(Y?mp1.bind(null,J):(I)=>I),outputFilterSensitiveLog:A._outputFilterSensitiveLog??(Y?mp1.bind(null,X):(I)=>I),smithyContext:A._smithyContext,additionalContext:A._additionalContext})}serialize=A._serializer;deserialize=A._deserializer}}}var sU3="***SensitiveInformation***",tU3=(A,Q)=>{for(let B of Object.keys(A)){let G=A[B],Z=async function(J,X,I){let W=new G(J);if(typeof X==="function")this.send(W,X);else if(typeof I==="function"){if(typeof X!=="object")throw Error(`Expected http options but got ${typeof X}`);this.send(W,X||{},I)}else return this.send(W,X)},Y=(B[0].toLowerCase()+B.slice(1)).replace(/Command$/,"");Q.prototype[Y]=Z}};class zJA extends Error{$fault;$response;$retryable;$metadata;constructor(A){super(A.message);Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=A.name,this.$fault=A.$fault,this.$metadata=A.$metadata}static isInstance(A){if(!A)return!1;let Q=A;return zJA.prototype.isPrototypeOf(Q)||Boolean(Q.$fault)&&Boolean(Q.$metadata)&&(Q.$fault==="client"||Q.$fault==="server")}static[Symbol.hasInstance](A){if(!A)return!1;let Q=A;if(this===zJA)return zJA.isInstance(A);if(zJA.isInstance(A)){if(Q.name&&this.name)return this.prototype.isPrototypeOf(A)||Q.name===this.name;return this.prototype.isPrototypeOf(A)}return!1}}var psQ=(A,Q={})=>{Object.entries(Q).filter(([,G])=>G!==void 0).forEach(([G,Z])=>{if(A[G]==null||A[G]==="")A[G]=Z});let B=A.message||A.Message||"UnknownError";return A.message=B,delete A.Message,A},csQ=({output:A,parsedBody:Q,exceptionCtor:B,errorCode:G})=>{let Z=Aq3(A),Y=Z.httpStatusCode?Z.httpStatusCode+"":void 0,J=new B({name:Q?.code||Q?.Code||G||Y||"UnknownError",$fault:"client",$metadata:Z});throw psQ(J,Q)},eU3=(A)=>{return({output:Q,parsedBody:B,errorCode:G})=>{csQ({output:Q,parsedBody:B,exceptionCtor:A,errorCode:G})}},Aq3=(A)=>({httpStatusCode:A.statusCode,requestId:A.headers["x-amzn-requestid"]??A.headers["x-amzn-request-id"]??A.headers["x-amz-request-id"],extendedRequestId:A.headers["x-amz-id-2"],cfId:A.headers["x-amz-cf-id"]}),Qq3=(A)=>{switch(A){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:30000};default:return{}}},gsQ=!1,Bq3=(A)=>{if(A&&!gsQ&&parseInt(A.substring(1,A.indexOf(".")))<16)gsQ=!0},Gq3=(A)=>{let Q=[];for(let B in up1.AlgorithmId){let G=up1.AlgorithmId[B];if(A[G]===void 0)continue;Q.push({algorithmId:()=>G,checksumConstructor:()=>A[G]})}return{addChecksumAlgorithm(B){Q.push(B)},checksumAlgorithms(){return Q}}},Zq3=(A)=>{let Q={};return A.checksumAlgorithms().forEach((B)=>{Q[B.algorithmId()]=B.checksumConstructor()}),Q},Yq3=(A)=>{return{setRetryStrategy(Q){A.retryStrategy=Q},retryStrategy(){return A.retryStrategy}}},Jq3=(A)=>{let Q={};return Q.retryStrategy=A.retryStrategy(),Q},lsQ=(A)=>{return Object.assign(Gq3(A),Yq3(A))},Xq3=lsQ,Iq3=(A)=>{return Object.assign(Zq3(A),Jq3(A))},Wq3=(A)=>Array.isArray(A)?A:[A],isQ=(A)=>{for(let B in A)if(A.hasOwnProperty(B)&&A[B]["#text"]!==void 0)A[B]=A[B]["#text"];else if(typeof A[B]==="object"&&A[B]!==null)A[B]=isQ(A[B]);return A},Dq3=(A)=>{return A!=null};class nsQ{trace(){}debug(){}info(){}warn(){}error(){}}function asQ(A,Q,B){let G,Z,Y;if(typeof Q>"u"&&typeof B>"u")G={},Y=A;else if(G=A,typeof Q==="function")return Z=Q,Y=B,Fq3(G,Z,Y);else Y=Q;for(let J of Object.keys(Y)){if(!Array.isArray(Y[J])){G[J]=Y[J];continue}osQ(G,null,Y,J)}return G}var Kq3=(A)=>{let Q={};for(let[B,G]of Object.entries(A||{}))Q[B]=[,G];return Q},Vq3=(A,Q)=>{let B={};for(let G in Q)osQ(B,A,Q,G);return B},Fq3=(A,Q,B)=>{return asQ(A,Object.entries(B).reduce((G,[Z,Y])=>{if(Array.isArray(Y))G[Z]=Y;else if(typeof Y==="function")G[Z]=[Q,Y()];else G[Z]=[Q,Y];return G},{}))},osQ=(A,Q,B,G)=>{if(Q!==null){let J=B[G];if(typeof J==="function")J=[,J];let[X=Hq3,I=Eq3,W=G]=J;if(typeof X==="function"&&X(Q[W])||typeof X!=="function"&&!!X)A[G]=I(Q[W]);return}let[Z,Y]=B[G];if(typeof Y==="function"){let J,X=Z===void 0&&(J=Y())!=null,I=typeof Z==="function"&&!!Z(void 0)||typeof Z!=="function"&&!!Z;if(X)A[G]=J;else if(I)A[G]=Y()}else{let J=Z===void 0&&Y!=null,X=typeof Z==="function"&&!!Z(Y)||typeof Z!=="function"&&!!Z;if(J||X)A[G]=Y}},Hq3=(A)=>A!=null,Eq3=(A)=>A,zq3=(A)=>{if(A!==A)return"NaN";switch(A){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return A}},Cq3=(A)=>A.toISOString().replace(".000Z","Z"),dp1=(A)=>{if(A==null)return{};if(Array.isArray(A))return A.filter((Q)=>Q!=null).map(dp1);if(typeof A==="object"){let Q={};for(let B of Object.keys(A)){if(A[B]==null)continue;Q[B]=dp1(A[B])}return Q}return A};Object.defineProperty(CJA,"collectBody",{enumerable:!0,get:function(){return pp1.collectBody}});Object.defineProperty(CJA,"extendedEncodeURIComponent",{enumerable:!0,get:function(){return pp1.extendedEncodeURIComponent}});Object.defineProperty(CJA,"resolvedPath",{enumerable:!0,get:function(){return pp1.resolvedPath}});CJA.Client=msQ;CJA.Command=cp1;CJA.NoOpLogger=nsQ;CJA.SENSITIVE_STRING=sU3;CJA.ServiceException=zJA;CJA._json=dp1;CJA.convertMap=Kq3;CJA.createAggregatedClient=tU3;CJA.decorateServiceException=psQ;CJA.emitWarningIfUnsupportedVersion=Bq3;CJA.getArrayIfSingleItem=Wq3;CJA.getDefaultClientConfiguration=Xq3;CJA.getDefaultExtensionConfiguration=lsQ;CJA.getValueFromTextNode=isQ;CJA.isSerializableHeaderValue=Dq3;CJA.loadConfigsForDefaultMode=Qq3;CJA.map=asQ;CJA.resolveDefaultRuntimeConfig=Iq3;CJA.serializeDateTime=Cq3;CJA.serializeFloat=zq3;CJA.take=Vq3;CJA.throwDefaultError=csQ;CJA.withBaseException=eU3;Object.keys(hsQ).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(CJA,A))Object.defineProperty(CJA,A,{enumerable:!0,get:function(){return hsQ[A]}})})});var ip1=U((ssQ)=>{Object.defineProperty(ssQ,"__esModule",{value:!0});ssQ.resolveHttpAuthSchemeConfig=ssQ.resolveStsAuthConfig=ssQ.defaultSTSHttpAuthSchemeProvider=ssQ.defaultSTSHttpAuthSchemeParametersProvider=void 0;var mq3=vY(),lp1=Iz(),dq3=np1(),pq3=async(A,Q,B)=>{return{operation:(0,lp1.getSmithyContext)(Q).operation,region:await(0,lp1.normalizeProvider)(A.region)()||(()=>{throw Error("expected `region` to be configured for `aws.auth#sigv4`")})()}};ssQ.defaultSTSHttpAuthSchemeParametersProvider=pq3;function cq3(A){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"sts",region:A.region},propertiesExtractor:(Q,B)=>({signingProperties:{config:Q,context:B}})}}function rsQ(A){return{schemeId:"smithy.api#noAuth"}}var lq3=(A)=>{let Q=[];switch(A.operation){case"AssumeRoleWithSAML":{Q.push(rsQ(A));break}case"AssumeRoleWithWebIdentity":{Q.push(rsQ(A));break}default:Q.push(cq3(A))}return Q};ssQ.defaultSTSHttpAuthSchemeProvider=lq3;var iq3=(A)=>Object.assign(A,{stsClientCtor:dq3.STSClient});ssQ.resolveStsAuthConfig=iq3;var nq3=(A)=>{let Q=ssQ.resolveStsAuthConfig(A),B=(0,mq3.resolveAwsSdkSigV4Config)(Q);return Object.assign(B,{authSchemePreference:(0,lp1.normalizeProvider)(A.authSchemePreference??[])})};ssQ.resolveHttpAuthSchemeConfig=nq3});var ap1=U((AtQ)=>{Object.defineProperty(AtQ,"__esModule",{value:!0});AtQ.commonParams=AtQ.resolveClientEndpointParameters=void 0;var rq3=(A)=>{return Object.assign(A,{useDualstackEndpoint:A.useDualstackEndpoint??!1,useFipsEndpoint:A.useFipsEndpoint??!1,useGlobalEndpoint:A.useGlobalEndpoint??!1,defaultSigningName:"sts"})};AtQ.resolveClientEndpointParameters=rq3;AtQ.commonParams={UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}});var BtQ=U((CJG,tq3)=>{tq3.exports={name:"@aws-sdk/client-sts",description:"AWS SDK for JavaScript Sts Client for Node.js, Browser and React Native",version:"3.936.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-sts","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"rimraf ./dist-types tsconfig.types.tsbuildinfo && tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo sts",test:"yarn g:vitest run","test:watch":"yarn g:vitest watch"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.936.0","@aws-sdk/credential-provider-node":"3.936.0","@aws-sdk/middleware-host-header":"3.936.0","@aws-sdk/middleware-logger":"3.936.0","@aws-sdk/middleware-recursion-detection":"3.936.0","@aws-sdk/middleware-user-agent":"3.936.0","@aws-sdk/region-config-resolver":"3.936.0","@aws-sdk/types":"3.936.0","@aws-sdk/util-endpoints":"3.936.0","@aws-sdk/util-user-agent-browser":"3.936.0","@aws-sdk/util-user-agent-node":"3.936.0","@smithy/config-resolver":"^4.4.3","@smithy/core":"^3.18.5","@smithy/fetch-http-handler":"^5.3.6","@smithy/hash-node":"^4.2.5","@smithy/invalid-dependency":"^4.2.5","@smithy/middleware-content-length":"^4.2.5","@smithy/middleware-endpoint":"^4.3.12","@smithy/middleware-retry":"^4.4.12","@smithy/middleware-serde":"^4.2.6","@smithy/middleware-stack":"^4.2.5","@smithy/node-config-provider":"^4.3.5","@smithy/node-http-handler":"^4.4.5","@smithy/protocol-http":"^5.3.5","@smithy/smithy-client":"^4.9.8","@smithy/types":"^4.9.0","@smithy/url-parser":"^4.2.5","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.11","@smithy/util-defaults-mode-node":"^4.2.14","@smithy/util-endpoints":"^3.2.5","@smithy/util-middleware":"^4.2.5","@smithy/util-retry":"^4.2.5","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-sts",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-sts"}}});var GtQ=U((AN3)=>{var eq3=(A)=>typeof ArrayBuffer==="function"&&A instanceof ArrayBuffer||Object.prototype.toString.call(A)==="[object ArrayBuffer]";AN3.isArrayBuffer=eq3});var rp1=U((YN3)=>{var BN3=GtQ(),op1=qA("buffer"),GN3=(A,Q=0,B=A.byteLength-Q)=>{if(!BN3.isArrayBuffer(A))throw TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof A} (${A})`);return op1.Buffer.from(A,Q,B)},ZN3=(A,Q)=>{if(typeof A!=="string")throw TypeError(`The "input" argument must be of type string. Received type ${typeof A} (${A})`);return Q?op1.Buffer.from(A,Q):op1.Buffer.from(A)};YN3.fromArrayBuffer=GN3;YN3.fromString=ZN3});var JtQ=U((ZtQ)=>{Object.defineProperty(ZtQ,"__esModule",{value:!0});ZtQ.fromBase64=void 0;var IN3=rp1(),WN3=/^[A-Za-z0-9+/]*={0,2}$/,DN3=(A)=>{if(A.length*3%4!==0)throw TypeError("Incorrect padding on base64 string.");if(!WN3.exec(A))throw TypeError("Invalid base64 string.");let Q=(0,IN3.fromString)(A,"base64");return new Uint8Array(Q.buffer,Q.byteOffset,Q.byteLength)};ZtQ.fromBase64=DN3});var WtQ=U((XtQ)=>{Object.defineProperty(XtQ,"__esModule",{value:!0});XtQ.toBase64=void 0;var KN3=rp1(),VN3=lG(),FN3=(A)=>{let Q;if(typeof A==="string")Q=(0,VN3.fromUtf8)(A);else Q=A;if(typeof Q!=="object"||typeof Q.byteOffset!=="number"||typeof Q.byteLength!=="number")throw Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return(0,KN3.fromArrayBuffer)(Q.buffer,Q.byteOffset,Q.byteLength).toString("base64")};XtQ.toBase64=FN3});var VtQ=U((fLA)=>{var DtQ=JtQ(),KtQ=WtQ();Object.keys(DtQ).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(fLA,A))Object.defineProperty(fLA,A,{enumerable:!0,get:function(){return DtQ[A]}})});Object.keys(KtQ).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(fLA,A))Object.defineProperty(fLA,A,{enumerable:!0,get:function(){return KtQ[A]}})})});var btQ=U((vtQ)=>{Object.defineProperty(vtQ,"__esModule",{value:!0});vtQ.ruleSet=void 0;var OtQ="required",p3="type",m7="fn",d7="argv",Cn="ref",FtQ=!1,sp1=!0,zn="booleanEquals",PH="stringEquals",MtQ="sigv4",RtQ="sts",_tQ="us-east-1",FX="endpoint",HtQ="https://sts.{Region}.{PartitionResult#dnsSuffix}",mv="tree",$JA="error",ep1="getAttr",EtQ={[OtQ]:!1,[p3]:"string"},tp1={[OtQ]:!0,default:!1,[p3]:"boolean"},jtQ={[Cn]:"Endpoint"},ztQ={[m7]:"isSet",[d7]:[{[Cn]:"Region"}]},SH={[Cn]:"Region"},CtQ={[m7]:"aws.partition",[d7]:[SH],assign:"PartitionResult"},TtQ={[Cn]:"UseFIPS"},PtQ={[Cn]:"UseDualStack"},Lz={url:"https://sts.amazonaws.com",properties:{authSchemes:[{name:MtQ,signingName:RtQ,signingRegion:_tQ}]},headers:{}},YL={},$tQ={conditions:[{[m7]:PH,[d7]:[SH,"aws-global"]}],[FX]:Lz,[p3]:FX},StQ={[m7]:zn,[d7]:[TtQ,!0]},xtQ={[m7]:zn,[d7]:[PtQ,!0]},UtQ={[m7]:ep1,[d7]:[{[Cn]:"PartitionResult"},"supportsFIPS"]},ytQ={[Cn]:"PartitionResult"},qtQ={[m7]:zn,[d7]:[!0,{[m7]:ep1,[d7]:[ytQ,"supportsDualStack"]}]},NtQ=[{[m7]:"isSet",[d7]:[jtQ]}],wtQ=[StQ],LtQ=[xtQ],HN3={version:"1.0",parameters:{Region:EtQ,UseDualStack:tp1,UseFIPS:tp1,Endpoint:EtQ,UseGlobalEndpoint:tp1},rules:[{conditions:[{[m7]:zn,[d7]:[{[Cn]:"UseGlobalEndpoint"},sp1]},{[m7]:"not",[d7]:NtQ},ztQ,CtQ,{[m7]:zn,[d7]:[TtQ,FtQ]},{[m7]:zn,[d7]:[PtQ,FtQ]}],rules:[{conditions:[{[m7]:PH,[d7]:[SH,"ap-northeast-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"ap-south-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"ap-southeast-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"ap-southeast-2"]}],endpoint:Lz,[p3]:FX},$tQ,{conditions:[{[m7]:PH,[d7]:[SH,"ca-central-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"eu-central-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"eu-north-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"eu-west-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"eu-west-2"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"eu-west-3"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"sa-east-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,_tQ]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"us-east-2"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"us-west-1"]}],endpoint:Lz,[p3]:FX},{conditions:[{[m7]:PH,[d7]:[SH,"us-west-2"]}],endpoint:Lz,[p3]:FX},{endpoint:{url:HtQ,properties:{authSchemes:[{name:MtQ,signingName:RtQ,signingRegion:"{Region}"}]},headers:YL},[p3]:FX}],[p3]:mv},{conditions:NtQ,rules:[{conditions:wtQ,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[p3]:$JA},{conditions:LtQ,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[p3]:$JA},{endpoint:{url:jtQ,properties:YL,headers:YL},[p3]:FX}],[p3]:mv},{conditions:[ztQ],rules:[{conditions:[CtQ],rules:[{conditions:[StQ,xtQ],rules:[{conditions:[{[m7]:zn,[d7]:[sp1,UtQ]},qtQ],rules:[{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:YL,headers:YL},[p3]:FX}],[p3]:mv},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[p3]:$JA}],[p3]:mv},{conditions:wtQ,rules:[{conditions:[{[m7]:zn,[d7]:[UtQ,sp1]}],rules:[{conditions:[{[m7]:PH,[d7]:[{[m7]:ep1,[d7]:[ytQ,"name"]},"aws-us-gov"]}],endpoint:{url:"https://sts.{Region}.amazonaws.com",properties:YL,headers:YL},[p3]:FX},{endpoint:{url:"https://sts-fips.{Region}.{PartitionResult#dnsSuffix}",properties:YL,headers:YL},[p3]:FX}],[p3]:mv},{error:"FIPS is enabled but this partition does not support FIPS",[p3]:$JA}],[p3]:mv},{conditions:LtQ,rules:[{conditions:[qtQ],rules:[{endpoint:{url:"https://sts.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:YL,headers:YL},[p3]:FX}],[p3]:mv},{error:"DualStack is enabled but this partition does not support DualStack",[p3]:$JA}],[p3]:mv},$tQ,{endpoint:{url:HtQ,properties:YL,headers:YL},[p3]:FX}],[p3]:mv}],[p3]:mv},{error:"Invalid Configuration: Missing Region",[p3]:$JA}]};vtQ.ruleSet=HN3});var gtQ=U((ftQ)=>{Object.defineProperty(ftQ,"__esModule",{value:!0});ftQ.defaultEndpointResolver=void 0;var EN3=Qv(),Ac1=FT(),zN3=btQ(),CN3=new Ac1.EndpointCache({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS","UseGlobalEndpoint"]}),$N3=(A,Q={})=>{return CN3.get(A,()=>(0,Ac1.resolveEndpoint)(zN3.ruleSet,{endpointParams:A,logger:Q.logger}))};ftQ.defaultEndpointResolver=$N3;Ac1.customEndpointFunctions.aws=EN3.awsEndpointFunctions});var ctQ=U((dtQ)=>{Object.defineProperty(dtQ,"__esModule",{value:!0});dtQ.getRuntimeConfig=void 0;var UN3=vY(),qN3=yg(),NN3=iG(),wN3=a0A(),LN3=vM(),utQ=VtQ(),mtQ=lG(),ON3=ip1(),MN3=gtQ(),RN3=(A)=>{return{apiVersion:"2011-06-15",base64Decoder:A?.base64Decoder??utQ.fromBase64,base64Encoder:A?.base64Encoder??utQ.toBase64,disableHostPrefix:A?.disableHostPrefix??!1,endpointProvider:A?.endpointProvider??MN3.defaultEndpointResolver,extensions:A?.extensions??[],httpAuthSchemeProvider:A?.httpAuthSchemeProvider??ON3.defaultSTSHttpAuthSchemeProvider,httpAuthSchemes:A?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:(Q)=>Q.getIdentityProvider("aws.auth#sigv4"),signer:new UN3.AwsSdkSigV4Signer},{schemeId:"smithy.api#noAuth",identityProvider:(Q)=>Q.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new NN3.NoAuthSigner}],logger:A?.logger??new wN3.NoOpLogger,protocol:A?.protocol??new qN3.AwsQueryProtocol({defaultNamespace:"com.amazonaws.sts",xmlNamespace:"https://sts.amazonaws.com/doc/2011-06-15/",version:"2011-06-15"}),serviceId:A?.serviceId??"STS",urlParser:A?.urlParser??LN3.parseUrl,utf8Decoder:A?.utf8Decoder??mtQ.fromUtf8,utf8Encoder:A?.utf8Encoder??mtQ.toUtf8}};dtQ.getRuntimeConfig=RN3});var stQ=U((otQ)=>{Object.defineProperty(otQ,"__esModule",{value:!0});otQ.getRuntimeConfig=void 0;var _N3=NZ(),jN3=_N3.__importDefault(BtQ()),Qc1=vY(),ltQ=G0A(),itQ=Tg(),VeA=wW(),TN3=iG(),PN3=Pg(),ntQ=wH(),o0A=Dq(),atQ=dw(),SN3=Sg(),xN3=Jv(),yN3=ctQ(),vN3=a0A(),kN3=kg(),bN3=a0A(),fN3=(A)=>{(0,bN3.emitWarningIfUnsupportedVersion)(process.version);let Q=(0,kN3.resolveDefaultsModeConfig)(A),B=()=>Q().then(vN3.loadConfigsForDefaultMode),G=(0,yN3.getRuntimeConfig)(A);(0,Qc1.emitWarningIfUnsupportedVersion)(process.version);let Z={profile:A?.profile,logger:G.logger};return{...G,...A,runtime:"node",defaultsMode:Q,authSchemePreference:A?.authSchemePreference??(0,o0A.loadConfig)(Qc1.NODE_AUTH_SCHEME_PREFERENCE_OPTIONS,Z),bodyLengthChecker:A?.bodyLengthChecker??SN3.calculateBodyLength,credentialDefaultProvider:A?.credentialDefaultProvider??ltQ.defaultProvider,defaultUserAgentProvider:A?.defaultUserAgentProvider??(0,itQ.createDefaultUserAgentProvider)({serviceId:G.serviceId,clientVersion:jN3.default.version}),httpAuthSchemes:A?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:(Y)=>Y.getIdentityProvider("aws.auth#sigv4")||(async(J)=>await(0,ltQ.defaultProvider)(J?.__config||{})()),signer:new Qc1.AwsSdkSigV4Signer},{schemeId:"smithy.api#noAuth",identityProvider:(Y)=>Y.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new TN3.NoAuthSigner}],maxAttempts:A?.maxAttempts??(0,o0A.loadConfig)(ntQ.NODE_MAX_ATTEMPT_CONFIG_OPTIONS,A),region:A?.region??(0,o0A.loadConfig)(VeA.NODE_REGION_CONFIG_OPTIONS,{...VeA.NODE_REGION_CONFIG_FILE_OPTIONS,...Z}),requestHandler:atQ.NodeHttpHandler.create(A?.requestHandler??B),retryMode:A?.retryMode??(0,o0A.loadConfig)({...ntQ.NODE_RETRY_MODE_CONFIG_OPTIONS,default:async()=>(await B()).retryMode||xN3.DEFAULT_RETRY_MODE},A),sha256:A?.sha256??PN3.Hash.bind(null,"sha256"),streamCollector:A?.streamCollector??atQ.streamCollector,useDualstackEndpoint:A?.useDualstackEndpoint??(0,o0A.loadConfig)(VeA.NODE_USE_DUALSTACK_ENDPOINT_CONFIG_OPTIONS,Z),useFipsEndpoint:A?.useFipsEndpoint??(0,o0A.loadConfig)(VeA.NODE_USE_FIPS_ENDPOINT_CONFIG_OPTIONS,Z),userAgentAppId:A?.userAgentAppId??(0,o0A.loadConfig)(itQ.NODE_APP_ID_CONFIG_OPTIONS,Z)}};otQ.getRuntimeConfig=fN3});var QeQ=U((pN3)=>{var hN3=hp1(),gN3=(A)=>{return{setHttpHandler(Q){A.httpHandler=Q},httpHandler(){return A.httpHandler},updateHttpClientConfig(Q,B){A.httpHandler?.updateHttpClientConfig(Q,B)},httpHandlerConfigs(){return A.httpHandler.httpHandlerConfigs()}}},uN3=(A)=>{return{httpHandler:A.httpHandler()}};class ttQ{name;kind;values;constructor({name:A,kind:Q=hN3.FieldPosition.HEADER,values:B=[]}){this.name=A,this.kind=Q,this.values=B}add(A){this.values.push(A)}set(A){this.values=A}remove(A){this.values=this.values.filter((Q)=>Q!==A)}toString(){return this.values.map((A)=>A.includes(",")||A.includes(" ")?`"${A}"`:A).join(", ")}get(){return this.values}}class etQ{entries={};encoding;constructor({fields:A=[],encoding:Q="utf-8"}){A.forEach(this.setField.bind(this)),this.encoding=Q}setField(A){this.entries[A.name.toLowerCase()]=A}getField(A){return this.entries[A.toLowerCase()]}removeField(A){delete this.entries[A.toLowerCase()]}getByType(A){return Object.values(this.entries).filter((Q)=>Q.kind===A)}}class FeA{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(A){this.method=A.method||"GET",this.hostname=A.hostname||"localhost",this.port=A.port,this.query=A.query||{},this.headers=A.headers||{},this.body=A.body,this.protocol=A.protocol?A.protocol.slice(-1)!==":"?`${A.protocol}:`:A.protocol:"https:",this.path=A.path?A.path.charAt(0)!=="/"?`/${A.path}`:A.path:"/",this.username=A.username,this.password=A.password,this.fragment=A.fragment}static clone(A){let Q=new FeA({...A,headers:{...A.headers}});if(Q.query)Q.query=mN3(Q.query);return Q}static isInstance(A){if(!A)return!1;let Q=A;return"method"in Q&&"protocol"in Q&&"hostname"in Q&&"path"in Q&&typeof Q.query==="object"&&typeof Q.headers==="object"}clone(){return FeA.clone(this)}}function mN3(A){return Object.keys(A).reduce((Q,B)=>{let G=A[B];return{...Q,[B]:Array.isArray(G)?[...G]:G}},{})}class AeQ{statusCode;reason;headers;body;constructor(A){this.statusCode=A.statusCode,this.reason=A.reason,this.headers=A.headers||{},this.body=A.body}static isInstance(A){if(!A)return!1;let Q=A;return typeof Q.statusCode==="number"&&typeof Q.headers==="object"}}function dN3(A){return/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/.test(A)}pN3.Field=ttQ;pN3.Fields=etQ;pN3.HttpRequest=FeA;pN3.HttpResponse=AeQ;pN3.getHttpHandlerExtensionConfiguration=gN3;pN3.isValidHostname=dN3;pN3.resolveHttpHandlerRuntimeConfig=uN3});var ZeQ=U((BeQ)=>{Object.defineProperty(BeQ,"__esModule",{value:!0});BeQ.resolveHttpAuthRuntimeConfig=BeQ.getHttpAuthExtensionConfiguration=void 0;var sN3=(A)=>{let{httpAuthSchemes:Q,httpAuthSchemeProvider:B,credentials:G}=A;return{setHttpAuthScheme(Z){let Y=Q.findIndex((J)=>J.schemeId===Z.schemeId);if(Y===-1)Q.push(Z);else Q.splice(Y,1,Z)},httpAuthSchemes(){return Q},setHttpAuthSchemeProvider(Z){B=Z},httpAuthSchemeProvider(){return B},setCredentials(Z){G=Z},credentials(){return G}}};BeQ.getHttpAuthExtensionConfiguration=sN3;var tN3=(A)=>{return{httpAuthSchemes:A.httpAuthSchemes(),httpAuthSchemeProvider:A.httpAuthSchemeProvider(),credentials:A.credentials()}};BeQ.resolveHttpAuthRuntimeConfig=tN3});var KeQ=U((WeQ)=>{Object.defineProperty(WeQ,"__esModule",{value:!0});WeQ.resolveRuntimeExtensions=void 0;var YeQ=ET(),JeQ=QeQ(),XeQ=a0A(),IeQ=ZeQ(),Aw3=(A,Q)=>{let B=Object.assign((0,YeQ.getAwsRegionExtensionConfiguration)(A),(0,XeQ.getDefaultExtensionConfiguration)(A),(0,JeQ.getHttpHandlerExtensionConfiguration)(A),(0,IeQ.getHttpAuthExtensionConfiguration)(A));return Q.forEach((G)=>G.configure(B)),Object.assign(A,(0,YeQ.resolveAwsRegionExtensionConfiguration)(B),(0,XeQ.resolveDefaultRuntimeConfig)(B),(0,JeQ.resolveHttpHandlerRuntimeConfig)(B),(0,IeQ.resolveHttpAuthRuntimeConfig)(B))};WeQ.resolveRuntimeExtensions=Aw3});var np1=U((Gc1)=>{Object.defineProperty(Gc1,"__esModule",{value:!0});Gc1.STSClient=Gc1.__Client=void 0;var VeQ=zg(),Qw3=Cg(),Bw3=$g(),FeQ=Zv(),Gw3=wW(),Bc1=iG(),Zw3=IX(),Yw3=jg(),Jw3=HT(),HeQ=wH(),zeQ=a0A();Object.defineProperty(Gc1,"__Client",{enumerable:!0,get:function(){return zeQ.Client}});var EeQ=ip1(),Xw3=ap1(),Iw3=stQ(),Ww3=KeQ();class CeQ extends zeQ.Client{config;constructor(...[A]){let Q=(0,Iw3.getRuntimeConfig)(A||{});super(Q);this.initConfig=Q;let B=(0,Xw3.resolveClientEndpointParameters)(Q),G=(0,FeQ.resolveUserAgentConfig)(B),Z=(0,HeQ.resolveRetryConfig)(G),Y=(0,Gw3.resolveRegionConfig)(Z),J=(0,VeQ.resolveHostHeaderConfig)(Y),X=(0,Jw3.resolveEndpointConfig)(J),I=(0,EeQ.resolveHttpAuthSchemeConfig)(X),W=(0,Ww3.resolveRuntimeExtensions)(I,A?.extensions||[]);this.config=W,this.middlewareStack.use((0,Zw3.getSchemaSerdePlugin)(this.config)),this.middlewareStack.use((0,FeQ.getUserAgentPlugin)(this.config)),this.middlewareStack.use((0,HeQ.getRetryPlugin)(this.config)),this.middlewareStack.use((0,Yw3.getContentLengthPlugin)(this.config)),this.middlewareStack.use((0,VeQ.getHostHeaderPlugin)(this.config)),this.middlewareStack.use((0,Qw3.getLoggerPlugin)(this.config)),this.middlewareStack.use((0,Bw3.getRecursionDetectionPlugin)(this.config)),this.middlewareStack.use((0,Bc1.getHttpAuthSchemeEndpointRuleSetPlugin)(this.config,{httpAuthSchemeParametersProvider:EeQ.defaultSTSHttpAuthSchemeParametersProvider,identityProviderConfigProvider:async(D)=>new Bc1.DefaultIdentityProviderConfig({"aws.auth#sigv4":D.credentials})})),this.middlewareStack.use((0,Bc1.getHttpSigningPlugin)(this.config))}destroy(){super.destroy()}}Gc1.STSClient=CeQ});var neQ=U((HeA)=>{var hLA=np1(),Rq=a0A(),kT=HT(),bT=ap1(),JL=IX(),Zc1=Wq(),Dw3=ET(),_q=class A extends Rq.ServiceException{constructor(Q){super(Q);Object.setPrototypeOf(this,A.prototype)}},UeQ=class A extends _q{name="ExpiredTokenException";$fault="client";constructor(Q){super({name:"ExpiredTokenException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},qeQ=class A extends _q{name="MalformedPolicyDocumentException";$fault="client";constructor(Q){super({name:"MalformedPolicyDocumentException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},NeQ=class A extends _q{name="PackedPolicyTooLargeException";$fault="client";constructor(Q){super({name:"PackedPolicyTooLargeException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},weQ=class A extends _q{name="RegionDisabledException";$fault="client";constructor(Q){super({name:"RegionDisabledException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},LeQ=class A extends _q{name="IDPRejectedClaimException";$fault="client";constructor(Q){super({name:"IDPRejectedClaimException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},OeQ=class A extends _q{name="InvalidIdentityTokenException";$fault="client";constructor(Q){super({name:"InvalidIdentityTokenException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},MeQ=class A extends _q{name="IDPCommunicationErrorException";$fault="client";constructor(Q){super({name:"IDPCommunicationErrorException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},ReQ=class A extends _q{name="InvalidAuthorizationMessageException";$fault="client";constructor(Q){super({name:"InvalidAuthorizationMessageException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},_eQ=class A extends _q{name="ExpiredTradeInTokenException";$fault="client";constructor(Q){super({name:"ExpiredTradeInTokenException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},jeQ=class A extends _q{name="JWTPayloadSizeExceededException";$fault="client";constructor(Q){super({name:"JWTPayloadSizeExceededException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},TeQ=class A extends _q{name="OutboundWebIdentityFederationDisabledException";$fault="client";constructor(Q){super({name:"OutboundWebIdentityFederationDisabledException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},PeQ=class A extends _q{name="SessionDurationEscalationException";$fault="client";constructor(Q){super({name:"SessionDurationEscalationException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},Yc1="Arn",SeQ="AccessKeyId",Kw3="AssumedPrincipal",Vw3="AssumeRole",Fw3="AssumedRoleId",Hw3="AssumeRoleRequest",Ew3="AssumeRoleResponse",zw3="AssumeRootRequest",Cw3="AssumeRootResponse",EeA="AssumedRoleUser",$w3="AssumeRoleWithSAML",Uw3="AssumeRoleWithSAMLRequest",qw3="AssumeRoleWithSAMLResponse",Nw3="AssumeRoleWithWebIdentity",ww3="AssumeRoleWithWebIdentityRequest",Lw3="AssumeRoleWithWebIdentityResponse",Ow3="AssumeRoot",xeQ="Account",Jc1="Audience",$n="Credentials",Mw3="ContextAssertion",Rw3="DecodeAuthorizationMessage",_w3="DecodeAuthorizationMessageRequest",jw3="DecodeAuthorizationMessageResponse",Tw3="DecodedMessage",r0A="DurationSeconds",yeQ="Expiration",Pw3="ExternalId",Sw3="EncodedMessage",xw3="ExpiredTokenException",yw3="ExpiredTradeInTokenException",veQ="FederatedUser",vw3="FederatedUserId",kw3="GetAccessKeyInfo",bw3="GetAccessKeyInfoRequest",fw3="GetAccessKeyInfoResponse",hw3="GetCallerIdentity",gw3="GetCallerIdentityRequest",uw3="GetCallerIdentityResponse",mw3="GetDelegatedAccessToken",dw3="GetDelegatedAccessTokenRequest",pw3="GetDelegatedAccessTokenResponse",cw3="GetFederationToken",lw3="GetFederationTokenRequest",iw3="GetFederationTokenResponse",nw3="GetSessionToken",aw3="GetSessionTokenRequest",ow3="GetSessionTokenResponse",rw3="GetWebIdentityToken",sw3="GetWebIdentityTokenRequest",tw3="GetWebIdentityTokenResponse",ew3="Issuer",AL3="InvalidAuthorizationMessageException",QL3="IDPCommunicationErrorException",BL3="IDPRejectedClaimException",GL3="InvalidIdentityTokenException",ZL3="JWTPayloadSizeExceededException",YL3="Key",JL3="MalformedPolicyDocumentException",XL3="Name",IL3="NameQualifier",WL3="OutboundWebIdentityFederationDisabledException",zeA="Policy",CeA="PolicyArns",DL3="PrincipalArn",KL3="ProviderArn",VL3="ProvidedContexts",FL3="ProvidedContextsListType",HL3="ProvidedContext",EL3="PolicyDescriptorType",zL3="ProviderId",gLA="PackedPolicySize",CL3="PackedPolicyTooLargeException",$L3="Provider",Xc1="RoleArn",UL3="RegionDisabledException",keQ="RoleSessionName",qL3="Subject",NL3="SigningAlgorithm",wL3="SecretAccessKey",LL3="SAMLAssertion",OL3="SAMLAssertionType",ML3="SessionDurationEscalationException",RL3="SubjectFromWebIdentityToken",uLA="SourceIdentity",beQ="SerialNumber",_L3="SubjectType",jL3="SessionToken",Ic1="Tags",feQ="TokenCode",TL3="TradeInToken",PL3="TargetPrincipal",SL3="TaskPolicyArn",xL3="TransitiveTagKeys",yL3="Tag",vL3="UserId",kL3="Value",heQ="WebIdentityToken",bL3="arn",fL3="accessKeySecretType",KR="awsQueryError",VR="client",hL3="clientTokenType",FR="error",HR="httpError",ER="message",gL3="policyDescriptorListType",geQ="smithy.ts.sdk.synthetic.com.amazonaws.sts",uL3="tradeInTokenType",mL3="tagListType",dL3="webIdentityTokenType",L2="com.amazonaws.sts",pL3=[0,L2,fL3,8,0],cL3=[0,L2,hL3,8,0],lL3=[0,L2,OL3,8,0],iL3=[0,L2,uL3,8,0],nL3=[0,L2,dL3,8,0],Wc1=[3,L2,EeA,0,[Fw3,Yc1],[0,0]],aL3=[3,L2,Hw3,0,[Xc1,keQ,CeA,zeA,r0A,Ic1,xL3,Pw3,beQ,feQ,uLA,VL3],[0,0,()=>$eA,0,1,()=>Dc1,64,0,0,0,0,()=>xO3]],oL3=[3,L2,Ew3,0,[$n,EeA,gLA,uLA],[[()=>s0A,0],()=>Wc1,1,0]],rL3=[3,L2,Uw3,0,[Xc1,DL3,LL3,CeA,zeA,r0A],[0,0,[()=>lL3,0],()=>$eA,0,1]],sL3=[3,L2,qw3,0,[$n,EeA,gLA,qL3,_L3,ew3,Jc1,IL3,uLA],[[()=>s0A,0],()=>Wc1,1,0,0,0,0,0,0]],tL3=[3,L2,ww3,0,[Xc1,keQ,heQ,zL3,CeA,zeA,r0A],[0,0,[()=>cL3,0],0,()=>$eA,0,1]],eL3=[3,L2,Lw3,0,[$n,RL3,EeA,gLA,$L3,Jc1,uLA],[[()=>s0A,0],0,()=>Wc1,1,0,0,0]],AO3=[3,L2,zw3,0,[PL3,SL3,r0A],[0,()=>ueQ,1]],QO3=[3,L2,Cw3,0,[$n,uLA],[[()=>s0A,0],0]],s0A=[3,L2,$n,0,[SeQ,wL3,jL3,yeQ],[0,[()=>pL3,0],0,4]],BO3=[3,L2,_w3,0,[Sw3],[0]],GO3=[3,L2,jw3,0,[Tw3],[0]],ZO3=[-3,L2,xw3,{[FR]:VR,[HR]:400,[KR]:["ExpiredTokenException",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(ZO3,UeQ);var YO3=[-3,L2,yw3,{[FR]:VR,[HR]:400,[KR]:["ExpiredTradeInTokenException",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(YO3,_eQ);var JO3=[3,L2,veQ,0,[vw3,Yc1],[0,0]],XO3=[3,L2,bw3,0,[SeQ],[0]],IO3=[3,L2,fw3,0,[xeQ],[0]],WO3=[3,L2,gw3,0,[],[]],DO3=[3,L2,uw3,0,[vL3,xeQ,Yc1],[0,0,0]],KO3=[3,L2,dw3,0,[TL3],[[()=>iL3,0]]],VO3=[3,L2,pw3,0,[$n,gLA,Kw3],[[()=>s0A,0],1,0]],FO3=[3,L2,lw3,0,[XL3,zeA,CeA,r0A,Ic1],[0,0,()=>$eA,1,()=>Dc1]],HO3=[3,L2,iw3,0,[$n,veQ,gLA],[[()=>s0A,0],()=>JO3,1]],EO3=[3,L2,aw3,0,[r0A,beQ,feQ],[1,0,0]],zO3=[3,L2,ow3,0,[$n],[[()=>s0A,0]]],CO3=[3,L2,sw3,0,[Jc1,r0A,NL3,Ic1],[64,1,0,()=>Dc1]],$O3=[3,L2,tw3,0,[heQ,yeQ],[[()=>nL3,0],4]],UO3=[-3,L2,QL3,{[FR]:VR,[HR]:400,[KR]:["IDPCommunicationError",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(UO3,MeQ);var qO3=[-3,L2,BL3,{[FR]:VR,[HR]:403,[KR]:["IDPRejectedClaim",403]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(qO3,LeQ);var NO3=[-3,L2,AL3,{[FR]:VR,[HR]:400,[KR]:["InvalidAuthorizationMessageException",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(NO3,ReQ);var wO3=[-3,L2,GL3,{[FR]:VR,[HR]:400,[KR]:["InvalidIdentityToken",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(wO3,OeQ);var LO3=[-3,L2,ZL3,{[FR]:VR,[HR]:400,[KR]:["JWTPayloadSizeExceededException",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(LO3,jeQ);var OO3=[-3,L2,JL3,{[FR]:VR,[HR]:400,[KR]:["MalformedPolicyDocument",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(OO3,qeQ);var MO3=[-3,L2,WL3,{[FR]:VR,[HR]:403,[KR]:["OutboundWebIdentityFederationDisabledException",403]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(MO3,TeQ);var RO3=[-3,L2,CL3,{[FR]:VR,[HR]:400,[KR]:["PackedPolicyTooLarge",400]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(RO3,NeQ);var ueQ=[3,L2,EL3,0,[bL3],[0]],_O3=[3,L2,HL3,0,[KL3,Mw3],[0,0]],jO3=[-3,L2,UL3,{[FR]:VR,[HR]:403,[KR]:["RegionDisabledException",403]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(jO3,weQ);var TO3=[-3,L2,ML3,{[FR]:VR,[HR]:403,[KR]:["SessionDurationEscalationException",403]},[ER],[0]];JL.TypeRegistry.for(L2).registerError(TO3,PeQ);var PO3=[3,L2,yL3,0,[YL3,kL3],[0,0]],SO3=[-3,geQ,"STSServiceException",0,[],[]];JL.TypeRegistry.for(geQ).registerError(SO3,_q);var $eA=[1,L2,gL3,0,()=>ueQ],xO3=[1,L2,FL3,0,()=>_O3],Dc1=[1,L2,mL3,0,()=>PO3],yO3=[9,L2,Vw3,0,()=>aL3,()=>oL3],vO3=[9,L2,$w3,0,()=>rL3,()=>sL3],kO3=[9,L2,Nw3,0,()=>tL3,()=>eL3],bO3=[9,L2,Ow3,0,()=>AO3,()=>QO3],fO3=[9,L2,Rw3,0,()=>BO3,()=>GO3],hO3=[9,L2,kw3,0,()=>XO3,()=>IO3],gO3=[9,L2,hw3,0,()=>WO3,()=>DO3],uO3=[9,L2,mw3,0,()=>KO3,()=>VO3],mO3=[9,L2,cw3,0,()=>FO3,()=>HO3],dO3=[9,L2,nw3,0,()=>EO3,()=>zO3],pO3=[9,L2,rw3,0,()=>CO3,()=>$O3];class UeA extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRole",{}).n("STSClient","AssumeRoleCommand").sc(yO3).build(){}class Kc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithSAML",{}).n("STSClient","AssumeRoleWithSAMLCommand").sc(vO3).build(){}class qeA extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoleWithWebIdentity",{}).n("STSClient","AssumeRoleWithWebIdentityCommand").sc(kO3).build(){}class Vc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","AssumeRoot",{}).n("STSClient","AssumeRootCommand").sc(bO3).build(){}class Fc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","DecodeAuthorizationMessage",{}).n("STSClient","DecodeAuthorizationMessageCommand").sc(fO3).build(){}class Hc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetAccessKeyInfo",{}).n("STSClient","GetAccessKeyInfoCommand").sc(hO3).build(){}class Ec1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetCallerIdentity",{}).n("STSClient","GetCallerIdentityCommand").sc(gO3).build(){}class zc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetDelegatedAccessToken",{}).n("STSClient","GetDelegatedAccessTokenCommand").sc(uO3).build(){}class Cc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetFederationToken",{}).n("STSClient","GetFederationTokenCommand").sc(mO3).build(){}class $c1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetSessionToken",{}).n("STSClient","GetSessionTokenCommand").sc(dO3).build(){}class Uc1 extends Rq.Command.classBuilder().ep(bT.commonParams).m(function(A,Q,B,G){return[kT.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSSecurityTokenServiceV20110615","GetWebIdentityToken",{}).n("STSClient","GetWebIdentityTokenCommand").sc(pO3).build(){}var cO3={AssumeRoleCommand:UeA,AssumeRoleWithSAMLCommand:Kc1,AssumeRoleWithWebIdentityCommand:qeA,AssumeRootCommand:Vc1,DecodeAuthorizationMessageCommand:Fc1,GetAccessKeyInfoCommand:Hc1,GetCallerIdentityCommand:Ec1,GetDelegatedAccessTokenCommand:zc1,GetFederationTokenCommand:Cc1,GetSessionTokenCommand:$c1,GetWebIdentityTokenCommand:Uc1};class qc1 extends hLA.STSClient{}Rq.createAggregatedClient(cO3,qc1);var meQ=(A)=>{if(typeof A?.Arn==="string"){let Q=A.Arn.split(":");if(Q.length>4&&Q[4]!=="")return Q[4]}return},deQ=async(A,Q,B,G={})=>{let Z=typeof A==="function"?await A():A,Y=typeof Q==="function"?await Q():Q,J=await Dw3.stsRegionDefaultResolver(G)();return B?.debug?.("@aws-sdk/client-sts::resolveRegion","accepting first of:",`${Z} (credential provider clientConfig)`,`${Y} (contextual client)`,`${J} (STS default: AWS_REGION, profile region, or us-east-1)`),Z??Y??J},lO3=(A,Q)=>{let B,G;return async(Z,Y)=>{if(G=Z,!B){let{logger:D=A?.parentClientConfig?.logger,profile:K=A?.parentClientConfig?.profile,region:V,requestHandler:F=A?.parentClientConfig?.requestHandler,credentialProviderLogger:H,userAgentAppId:E=A?.parentClientConfig?.userAgentAppId}=A,z=await deQ(V,A?.parentClientConfig?.region,H,{logger:D,profile:K}),C=!peQ(F);B=new Q({...A,userAgentAppId:E,profile:K,credentialDefaultProvider:()=>async()=>G,region:z,requestHandler:C?F:void 0,logger:D})}let{Credentials:J,AssumedRoleUser:X}=await B.send(new UeA(Y));if(!J||!J.AccessKeyId||!J.SecretAccessKey)throw Error(`Invalid response from STS.assumeRole call with role ${Y.RoleArn}`);let I=meQ(X),W={accessKeyId:J.AccessKeyId,secretAccessKey:J.SecretAccessKey,sessionToken:J.SessionToken,expiration:J.Expiration,...J.CredentialScope&&{credentialScope:J.CredentialScope},...I&&{accountId:I}};return Zc1.setCredentialFeature(W,"CREDENTIALS_STS_ASSUME_ROLE","i"),W}},iO3=(A,Q)=>{let B;return async(G)=>{if(!B){let{logger:I=A?.parentClientConfig?.logger,profile:W=A?.parentClientConfig?.profile,region:D,requestHandler:K=A?.parentClientConfig?.requestHandler,credentialProviderLogger:V,userAgentAppId:F=A?.parentClientConfig?.userAgentAppId}=A,H=await deQ(D,A?.parentClientConfig?.region,V,{logger:I,profile:W}),E=!peQ(K);B=new Q({...A,userAgentAppId:F,profile:W,region:H,requestHandler:E?K:void 0,logger:I})}let{Credentials:Z,AssumedRoleUser:Y}=await B.send(new qeA(G));if(!Z||!Z.AccessKeyId||!Z.SecretAccessKey)throw Error(`Invalid response from STS.assumeRoleWithWebIdentity call with role ${G.RoleArn}`);let J=meQ(Y),X={accessKeyId:Z.AccessKeyId,secretAccessKey:Z.SecretAccessKey,sessionToken:Z.SessionToken,expiration:Z.Expiration,...Z.CredentialScope&&{credentialScope:Z.CredentialScope},...J&&{accountId:J}};if(J)Zc1.setCredentialFeature(X,"RESOLVED_ACCOUNT_ID","T");return Zc1.setCredentialFeature(X,"CREDENTIALS_STS_ASSUME_ROLE_WEB_ID","k"),X}},peQ=(A)=>{return A?.metadata?.handlerProtocol==="h2"},ceQ=(A,Q)=>{if(!Q)return A;else return class extends A{constructor(G){super(G);for(let Z of Q)this.middlewareStack.use(Z)}}},leQ=(A={},Q)=>lO3(A,ceQ(hLA.STSClient,Q)),ieQ=(A={},Q)=>iO3(A,ceQ(hLA.STSClient,Q)),nO3=(A)=>(Q)=>A({roleAssumer:leQ(Q),roleAssumerWithWebIdentity:ieQ(Q),...Q});Object.defineProperty(HeA,"$Command",{enumerable:!0,get:function(){return Rq.Command}});HeA.AssumeRoleCommand=UeA;HeA.AssumeRoleWithSAMLCommand=Kc1;HeA.AssumeRoleWithWebIdentityCommand=qeA;HeA.AssumeRootCommand=Vc1;HeA.DecodeAuthorizationMessageCommand=Fc1;HeA.ExpiredTokenException=UeQ;HeA.ExpiredTradeInTokenException=_eQ;HeA.GetAccessKeyInfoCommand=Hc1;HeA.GetCallerIdentityCommand=Ec1;HeA.GetDelegatedAccessTokenCommand=zc1;HeA.GetFederationTokenCommand=Cc1;HeA.GetSessionTokenCommand=$c1;HeA.GetWebIdentityTokenCommand=Uc1;HeA.IDPCommunicationErrorException=MeQ;HeA.IDPRejectedClaimException=LeQ;HeA.InvalidAuthorizationMessageException=ReQ;HeA.InvalidIdentityTokenException=OeQ;HeA.JWTPayloadSizeExceededException=jeQ;HeA.MalformedPolicyDocumentException=qeQ;HeA.OutboundWebIdentityFederationDisabledException=TeQ;HeA.PackedPolicyTooLargeException=NeQ;HeA.RegionDisabledException=weQ;HeA.STS=qc1;HeA.STSServiceException=_q;HeA.SessionDurationEscalationException=PeQ;HeA.decorateDefaultCredentialProvider=nO3;HeA.getDefaultRoleAssumer=leQ;HeA.getDefaultRoleAssumerWithWebIdentity=ieQ;Object.keys(hLA).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(HeA,A))Object.defineProperty(HeA,A,{enumerable:!0,get:function(){return hLA[A]}})})});var oeQ=U((aeQ)=>{Object.defineProperty(aeQ,"__esModule",{value:!0});aeQ.propertyProviderChain=aeQ.createCredentialChain=void 0;var wM3=TD(),LM3=(...A)=>{let Q=-1,G=Object.assign(async(Z)=>{let Y=await aeQ.propertyProviderChain(...A)(Z);if(!Y.expiration&&Q!==-1)Y.expiration=new Date(Date.now()+Q);return Y},{expireAfter(Z){if(Z<300000)throw Error("@aws-sdk/credential-providers - createCredentialChain(...).expireAfter(ms) may not be called with a duration lower than five minutes.");return Q=Z,G}});return G};aeQ.createCredentialChain=LM3;var OM3=(...A)=>async(Q)=>{if(A.length===0)throw new wM3.ProviderError("No providers in chain",{tryNextLink:!1});let B;for(let G of A)try{return await G(Q)}catch(Z){if(B=Z,Z?.tryNextLink)continue;throw Z}throw B};aeQ.propertyProviderChain=OM3});var jc1=U((SM3)=>{SM3.HttpAuthLocation=void 0;(function(A){A.HEADER="header",A.QUERY="query"})(SM3.HttpAuthLocation||(SM3.HttpAuthLocation={}));SM3.HttpApiKeyAuthLocation=void 0;(function(A){A.HEADER="header",A.QUERY="query"})(SM3.HttpApiKeyAuthLocation||(SM3.HttpApiKeyAuthLocation={}));SM3.EndpointURLScheme=void 0;(function(A){A.HTTP="http",A.HTTPS="https"})(SM3.EndpointURLScheme||(SM3.EndpointURLScheme={}));SM3.AlgorithmId=void 0;(function(A){A.MD5="md5",A.CRC32="crc32",A.CRC32C="crc32c",A.SHA1="sha1",A.SHA256="sha256"})(SM3.AlgorithmId||(SM3.AlgorithmId={}));var RM3=(A)=>{let Q=[];if(A.sha256!==void 0)Q.push({algorithmId:()=>SM3.AlgorithmId.SHA256,checksumConstructor:()=>A.sha256});if(A.md5!=null)Q.push({algorithmId:()=>SM3.AlgorithmId.MD5,checksumConstructor:()=>A.md5});return{addChecksumAlgorithm(B){Q.push(B)},checksumAlgorithms(){return Q}}},_M3=(A)=>{let Q={};return A.checksumAlgorithms().forEach((B)=>{Q[B.algorithmId()]=B.checksumConstructor()}),Q},jM3=(A)=>{return RM3(A)},TM3=(A)=>{return _M3(A)};SM3.FieldPosition=void 0;(function(A){A[A.HEADER=0]="HEADER",A[A.TRAILER=1]="TRAILER"})(SM3.FieldPosition||(SM3.FieldPosition={}));var PM3="__smithy_context";SM3.IniSectionType=void 0;(function(A){A.PROFILE="profile",A.SSO_SESSION="sso-session",A.SERVICES="services"})(SM3.IniSectionType||(SM3.IniSectionType={}));SM3.RequestHandlerProtocol=void 0;(function(A){A.HTTP_0_9="http/0.9",A.HTTP_1_0="http/1.0",A.TDS_8_0="tds/8.0"})(SM3.RequestHandlerProtocol||(SM3.RequestHandlerProtocol={}));SM3.SMITHY_CONTEXT_KEY=PM3;SM3.getDefaultClientConfiguration=jM3;SM3.resolveDefaultRuntimeConfig=TM3});var dLA=U((qJA)=>{var teQ=Bv(),yc1=Iq(),Pc1=jc1(),kM3=IX(),reQ=Xq();class eeQ{config;middlewareStack=teQ.constructStack();initConfig;handlers;constructor(A){this.config=A}send(A,Q,B){let G=typeof Q!=="function"?Q:void 0,Z=typeof Q==="function"?Q:B,Y=G===void 0&&this.config.cacheMiddleware===!0,J;if(Y){if(!this.handlers)this.handlers=new WeakMap;let X=this.handlers;if(X.has(A.constructor))J=X.get(A.constructor);else J=A.resolveMiddleware(this.middlewareStack,this.config,G),X.set(A.constructor,J)}else delete this.handlers,J=A.resolveMiddleware(this.middlewareStack,this.config,G);if(Z)J(A).then((X)=>Z(null,X.output),(X)=>Z(X)).catch(()=>{});else return J(A).then((X)=>X.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}var Tc1="***SensitiveInformation***";function Sc1(A,Q){if(Q==null)return Q;let B=kM3.NormalizedSchema.of(A);if(B.getMergedTraits().sensitive)return Tc1;if(B.isListSchema()){if(!!B.getValueSchema().getMergedTraits().sensitive)return Tc1}else if(B.isMapSchema()){if(!!B.getKeySchema().getMergedTraits().sensitive||!!B.getValueSchema().getMergedTraits().sensitive)return Tc1}else if(B.isStructSchema()&&typeof Q==="object"){let G=Q,Z={};for(let[Y,J]of B.structIterator())if(G[Y]!=null)Z[Y]=Sc1(J,G[Y]);return Z}return Q}class vc1{middlewareStack=teQ.constructStack();schema;static classBuilder(){return new AAB}resolveMiddlewareWithContext(A,Q,B,{middlewareFn:G,clientName:Z,commandName:Y,inputFilterSensitiveLog:J,outputFilterSensitiveLog:X,smithyContext:I,additionalContext:W,CommandCtor:D}){for(let E of G.bind(this)(D,A,Q,B))this.middlewareStack.use(E);let K=A.concat(this.middlewareStack),{logger:V}=Q,F={logger:V,clientName:Z,commandName:Y,inputFilterSensitiveLog:J,outputFilterSensitiveLog:X,[Pc1.SMITHY_CONTEXT_KEY]:{commandInstance:this,...I},...W},{requestHandler:H}=Q;return K.resolve((E)=>H.handle(E.request,B||{}),F)}}class AAB{_init=()=>{};_ep={};_middlewareFn=()=>[];_commandName="";_clientName="";_additionalContext={};_smithyContext={};_inputFilterSensitiveLog=void 0;_outputFilterSensitiveLog=void 0;_serializer=null;_deserializer=null;_operationSchema;init(A){this._init=A}ep(A){return this._ep=A,this}m(A){return this._middlewareFn=A,this}s(A,Q,B={}){return this._smithyContext={service:A,operation:Q,...B},this}c(A={}){return this._additionalContext=A,this}n(A,Q){return this._clientName=A,this._commandName=Q,this}f(A=(B)=>B,Q=(B)=>B){return this._inputFilterSensitiveLog=A,this._outputFilterSensitiveLog=Q,this}ser(A){return this._serializer=A,this}de(A){return this._deserializer=A,this}sc(A){return this._operationSchema=A,this._smithyContext.operationSchema=A,this}build(){let A=this,Q;return Q=class extends vc1{input;static getEndpointParameterInstructions(){return A._ep}constructor(...[B]){super();this.input=B??{},A._init(this),this.schema=A._operationSchema}resolveMiddleware(B,G,Z){let Y=A._operationSchema,J=Y?.[4]??Y?.input,X=Y?.[5]??Y?.output;return this.resolveMiddlewareWithContext(B,G,Z,{CommandCtor:Q,middlewareFn:A._middlewareFn,clientName:A._clientName,commandName:A._commandName,inputFilterSensitiveLog:A._inputFilterSensitiveLog??(Y?Sc1.bind(null,J):(I)=>I),outputFilterSensitiveLog:A._outputFilterSensitiveLog??(Y?Sc1.bind(null,X):(I)=>I),smithyContext:A._smithyContext,additionalContext:A._additionalContext})}serialize=A._serializer;deserialize=A._deserializer}}}var bM3="***SensitiveInformation***",fM3=(A,Q)=>{for(let B of Object.keys(A)){let G=A[B],Z=async function(J,X,I){let W=new G(J);if(typeof X==="function")this.send(W,X);else if(typeof I==="function"){if(typeof X!=="object")throw Error(`Expected http options but got ${typeof X}`);this.send(W,X||{},I)}else return this.send(W,X)},Y=(B[0].toLowerCase()+B.slice(1)).replace(/Command$/,"");Q.prototype[Y]=Z}};class UJA extends Error{$fault;$response;$retryable;$metadata;constructor(A){super(A.message);Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=A.name,this.$fault=A.$fault,this.$metadata=A.$metadata}static isInstance(A){if(!A)return!1;let Q=A;return UJA.prototype.isPrototypeOf(Q)||Boolean(Q.$fault)&&Boolean(Q.$metadata)&&(Q.$fault==="client"||Q.$fault==="server")}static[Symbol.hasInstance](A){if(!A)return!1;let Q=A;if(this===UJA)return UJA.isInstance(A);if(UJA.isInstance(A)){if(Q.name&&this.name)return this.prototype.isPrototypeOf(A)||Q.name===this.name;return this.prototype.isPrototypeOf(A)}return!1}}var QAB=(A,Q={})=>{Object.entries(Q).filter(([,G])=>G!==void 0).forEach(([G,Z])=>{if(A[G]==null||A[G]==="")A[G]=Z});let B=A.message||A.Message||"UnknownError";return A.message=B,delete A.Message,A},BAB=({output:A,parsedBody:Q,exceptionCtor:B,errorCode:G})=>{let Z=gM3(A),Y=Z.httpStatusCode?Z.httpStatusCode+"":void 0,J=new B({name:Q?.code||Q?.Code||G||Y||"UnknownError",$fault:"client",$metadata:Z});throw QAB(J,Q)},hM3=(A)=>{return({output:Q,parsedBody:B,errorCode:G})=>{BAB({output:Q,parsedBody:B,exceptionCtor:A,errorCode:G})}},gM3=(A)=>({httpStatusCode:A.statusCode,requestId:A.headers["x-amzn-requestid"]??A.headers["x-amzn-request-id"]??A.headers["x-amz-request-id"],extendedRequestId:A.headers["x-amz-id-2"],cfId:A.headers["x-amz-cf-id"]}),uM3=(A)=>{switch(A){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:30000};default:return{}}},seQ=!1,mM3=(A)=>{if(A&&!seQ&&parseInt(A.substring(1,A.indexOf(".")))<16)seQ=!0},dM3=(A)=>{let Q=[];for(let B in Pc1.AlgorithmId){let G=Pc1.AlgorithmId[B];if(A[G]===void 0)continue;Q.push({algorithmId:()=>G,checksumConstructor:()=>A[G]})}return{addChecksumAlgorithm(B){Q.push(B)},checksumAlgorithms(){return Q}}},pM3=(A)=>{let Q={};return A.checksumAlgorithms().forEach((B)=>{Q[B.algorithmId()]=B.checksumConstructor()}),Q},cM3=(A)=>{return{setRetryStrategy(Q){A.retryStrategy=Q},retryStrategy(){return A.retryStrategy}}},lM3=(A)=>{let Q={};return Q.retryStrategy=A.retryStrategy(),Q},GAB=(A)=>{return Object.assign(dM3(A),cM3(A))},iM3=GAB,nM3=(A)=>{return Object.assign(pM3(A),lM3(A))},aM3=(A)=>Array.isArray(A)?A:[A],ZAB=(A)=>{for(let B in A)if(A.hasOwnProperty(B)&&A[B]["#text"]!==void 0)A[B]=A[B]["#text"];else if(typeof A[B]==="object"&&A[B]!==null)A[B]=ZAB(A[B]);return A},oM3=(A)=>{return A!=null};class YAB{trace(){}debug(){}info(){}warn(){}error(){}}function JAB(A,Q,B){let G,Z,Y;if(typeof Q>"u"&&typeof B>"u")G={},Y=A;else if(G=A,typeof Q==="function")return Z=Q,Y=B,tM3(G,Z,Y);else Y=Q;for(let J of Object.keys(Y)){if(!Array.isArray(Y[J])){G[J]=Y[J];continue}XAB(G,null,Y,J)}return G}var rM3=(A)=>{let Q={};for(let[B,G]of Object.entries(A||{}))Q[B]=[,G];return Q},sM3=(A,Q)=>{let B={};for(let G in Q)XAB(B,A,Q,G);return B},tM3=(A,Q,B)=>{return JAB(A,Object.entries(B).reduce((G,[Z,Y])=>{if(Array.isArray(Y))G[Z]=Y;else if(typeof Y==="function")G[Z]=[Q,Y()];else G[Z]=[Q,Y];return G},{}))},XAB=(A,Q,B,G)=>{if(Q!==null){let J=B[G];if(typeof J==="function")J=[,J];let[X=eM3,I=AR3,W=G]=J;if(typeof X==="function"&&X(Q[W])||typeof X!=="function"&&!!X)A[G]=I(Q[W]);return}let[Z,Y]=B[G];if(typeof Y==="function"){let J,X=Z===void 0&&(J=Y())!=null,I=typeof Z==="function"&&!!Z(void 0)||typeof Z!=="function"&&!!Z;if(X)A[G]=J;else if(I)A[G]=Y()}else{let J=Z===void 0&&Y!=null,X=typeof Z==="function"&&!!Z(Y)||typeof Z!=="function"&&!!Z;if(J||X)A[G]=Y}},eM3=(A)=>A!=null,AR3=(A)=>A,QR3=(A)=>{if(A!==A)return"NaN";switch(A){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return A}},BR3=(A)=>A.toISOString().replace(".000Z","Z"),xc1=(A)=>{if(A==null)return{};if(Array.isArray(A))return A.filter((Q)=>Q!=null).map(xc1);if(typeof A==="object"){let Q={};for(let B of Object.keys(A)){if(A[B]==null)continue;Q[B]=xc1(A[B])}return Q}return A};Object.defineProperty(qJA,"collectBody",{enumerable:!0,get:function(){return yc1.collectBody}});Object.defineProperty(qJA,"extendedEncodeURIComponent",{enumerable:!0,get:function(){return yc1.extendedEncodeURIComponent}});Object.defineProperty(qJA,"resolvedPath",{enumerable:!0,get:function(){return yc1.resolvedPath}});qJA.Client=eeQ;qJA.Command=vc1;qJA.NoOpLogger=YAB;qJA.SENSITIVE_STRING=bM3;qJA.ServiceException=UJA;qJA._json=xc1;qJA.convertMap=rM3;qJA.createAggregatedClient=fM3;qJA.decorateServiceException=QAB;qJA.emitWarningIfUnsupportedVersion=mM3;qJA.getArrayIfSingleItem=aM3;qJA.getDefaultClientConfiguration=iM3;qJA.getDefaultExtensionConfiguration=GAB;qJA.getValueFromTextNode=ZAB;qJA.isSerializableHeaderValue=oM3;qJA.loadConfigsForDefaultMode=uM3;qJA.map=JAB;qJA.resolveDefaultRuntimeConfig=nM3;qJA.serializeDateTime=BR3;qJA.serializeFloat=QR3;qJA.take=sM3;qJA.throwDefaultError=BAB;qJA.withBaseException=hM3;Object.keys(reQ).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(qJA,A))Object.defineProperty(qJA,A,{enumerable:!0,get:function(){return reQ[A]}})})});var bc1=U((IAB)=>{Object.defineProperty(IAB,"__esModule",{value:!0});IAB.resolveHttpAuthSchemeConfig=IAB.defaultCognitoIdentityHttpAuthSchemeProvider=IAB.defaultCognitoIdentityHttpAuthSchemeParametersProvider=void 0;var RR3=vY(),kc1=Iz(),_R3=async(A,Q,B)=>{return{operation:(0,kc1.getSmithyContext)(Q).operation,region:await(0,kc1.normalizeProvider)(A.region)()||(()=>{throw Error("expected `region` to be configured for `aws.auth#sigv4`")})()}};IAB.defaultCognitoIdentityHttpAuthSchemeParametersProvider=_R3;function jR3(A){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:A.region},propertiesExtractor:(Q,B)=>({signingProperties:{config:Q,context:B}})}}function NeA(A){return{schemeId:"smithy.api#noAuth"}}var TR3=(A)=>{let Q=[];switch(A.operation){case"GetCredentialsForIdentity":{Q.push(NeA(A));break}case"GetId":{Q.push(NeA(A));break}case"GetOpenIdToken":{Q.push(NeA(A));break}case"UnlinkIdentity":{Q.push(NeA(A));break}default:Q.push(jR3(A))}return Q};IAB.defaultCognitoIdentityHttpAuthSchemeProvider=TR3;var PR3=(A)=>{let Q=(0,RR3.resolveAwsSdkSigV4Config)(A);return Object.assign(Q,{authSchemePreference:(0,kc1.normalizeProvider)(A.authSchemePreference??[])})};IAB.resolveHttpAuthSchemeConfig=PR3});var DAB=U((hJG,yR3)=>{yR3.exports={name:"@aws-sdk/client-cognito-identity",description:"AWS SDK for JavaScript Cognito Identity Client for Node.js, Browser and React Native",version:"3.936.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-cognito-identity","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo cognito-identity","test:e2e":"yarn g:vitest run -c vitest.config.e2e.mts --mode development","test:e2e:watch":"yarn g:vitest watch -c vitest.config.e2e.mts"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.936.0","@aws-sdk/credential-provider-node":"3.936.0","@aws-sdk/middleware-host-header":"3.936.0","@aws-sdk/middleware-logger":"3.936.0","@aws-sdk/middleware-recursion-detection":"3.936.0","@aws-sdk/middleware-user-agent":"3.936.0","@aws-sdk/region-config-resolver":"3.936.0","@aws-sdk/types":"3.936.0","@aws-sdk/util-endpoints":"3.936.0","@aws-sdk/util-user-agent-browser":"3.936.0","@aws-sdk/util-user-agent-node":"3.936.0","@smithy/config-resolver":"^4.4.3","@smithy/core":"^3.18.5","@smithy/fetch-http-handler":"^5.3.6","@smithy/hash-node":"^4.2.5","@smithy/invalid-dependency":"^4.2.5","@smithy/middleware-content-length":"^4.2.5","@smithy/middleware-endpoint":"^4.3.12","@smithy/middleware-retry":"^4.4.12","@smithy/middleware-serde":"^4.2.6","@smithy/middleware-stack":"^4.2.5","@smithy/node-config-provider":"^4.3.5","@smithy/node-http-handler":"^4.4.5","@smithy/protocol-http":"^5.3.5","@smithy/smithy-client":"^4.9.8","@smithy/types":"^4.9.0","@smithy/url-parser":"^4.2.5","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.11","@smithy/util-defaults-mode-node":"^4.2.14","@smithy/util-endpoints":"^3.2.5","@smithy/util-middleware":"^4.2.5","@smithy/util-retry":"^4.2.5","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@aws-sdk/client-iam":"3.936.0","@tsconfig/node18":"18.2.4","@types/chai":"^4.2.11","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-cognito-identity",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-cognito-identity"}}});var KAB=U((kR3)=>{var vR3=(A)=>typeof ArrayBuffer==="function"&&A instanceof ArrayBuffer||Object.prototype.toString.call(A)==="[object ArrayBuffer]";kR3.isArrayBuffer=vR3});var hc1=U((uR3)=>{var fR3=KAB(),fc1=qA("buffer"),hR3=(A,Q=0,B=A.byteLength-Q)=>{if(!fR3.isArrayBuffer(A))throw TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof A} (${A})`);return fc1.Buffer.from(A,Q,B)},gR3=(A,Q)=>{if(typeof A!=="string")throw TypeError(`The "input" argument must be of type string. Received type ${typeof A} (${A})`);return Q?fc1.Buffer.from(A,Q):fc1.Buffer.from(A)};uR3.fromArrayBuffer=hR3;uR3.fromString=gR3});var HAB=U((VAB)=>{Object.defineProperty(VAB,"__esModule",{value:!0});VAB.fromBase64=void 0;var pR3=hc1(),cR3=/^[A-Za-z0-9+/]*={0,2}$/,lR3=(A)=>{if(A.length*3%4!==0)throw TypeError("Incorrect padding on base64 string.");if(!cR3.exec(A))throw TypeError("Invalid base64 string.");let Q=(0,pR3.fromString)(A,"base64");return new Uint8Array(Q.buffer,Q.byteOffset,Q.byteLength)};VAB.fromBase64=lR3});var CAB=U((EAB)=>{Object.defineProperty(EAB,"__esModule",{value:!0});EAB.toBase64=void 0;var iR3=hc1(),nR3=lG(),aR3=(A)=>{let Q;if(typeof A==="string")Q=(0,nR3.fromUtf8)(A);else Q=A;if(typeof Q!=="object"||typeof Q.byteOffset!=="number"||typeof Q.byteLength!=="number")throw Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return(0,iR3.fromArrayBuffer)(Q.buffer,Q.byteOffset,Q.byteLength).toString("base64")};EAB.toBase64=aR3});var qAB=U((pLA)=>{var $AB=HAB(),UAB=CAB();Object.keys($AB).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(pLA,A))Object.defineProperty(pLA,A,{enumerable:!0,get:function(){return $AB[A]}})});Object.keys(UAB).forEach(function(A){if(A!=="default"&&!Object.prototype.hasOwnProperty.call(pLA,A))Object.defineProperty(pLA,A,{enumerable:!0,get:function(){return UAB[A]}})})});var fAB=U((kAB)=>{Object.defineProperty(kAB,"__esModule",{value:!0});kAB.ruleSet=void 0;var SAB="required",Oz="fn",Mz="argv",wJA="ref",NAB=!0,wAB="isSet",iLA="booleanEquals",NJA="error",dv="endpoint",Xu="tree",gc1="PartitionResult",uc1="getAttr",cLA="stringEquals",LAB={[SAB]:!1,type:"string"},OAB={[SAB]:!0,default:!1,type:"boolean"},MAB={[wJA]:"Endpoint"},xAB={[Oz]:iLA,[Mz]:[{[wJA]:"UseFIPS"},!0]},yAB={[Oz]:iLA,[Mz]:[{[wJA]:"UseDualStack"},!0]},uD={},lLA={[wJA]:"Region"},RAB={[Oz]:uc1,[Mz]:[{[wJA]:gc1},"supportsFIPS"]},vAB={[wJA]:gc1},_AB={[Oz]:iLA,[Mz]:[!0,{[Oz]:uc1,[Mz]:[vAB,"supportsDualStack"]}]},jAB=[xAB],TAB=[yAB],PAB=[lLA],oR3={version:"1.0",parameters:{Region:LAB,UseDualStack:OAB,UseFIPS:OAB,Endpoint:LAB},rules:[{conditions:[{[Oz]:wAB,[Mz]:[MAB]}],rules:[{conditions:jAB,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:NJA},{conditions:TAB,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:NJA},{endpoint:{url:MAB,properties:uD,headers:uD},type:dv}],type:Xu},{conditions:[{[Oz]:wAB,[Mz]:PAB}],rules:[{conditions:[{[Oz]:"aws.partition",[Mz]:PAB,assign:gc1}],rules:[{conditions:[xAB,yAB],rules:[{conditions:[{[Oz]:iLA,[Mz]:[NAB,RAB]},_AB],rules:[{conditions:[{[Oz]:cLA,[Mz]:[lLA,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:uD,headers:uD},type:dv},{conditions:[{[Oz]:cLA,[Mz]:[lLA,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:uD,headers:uD},type:dv},{conditions:[{[Oz]:cLA,[Mz]:[lLA,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:uD,headers:uD},type:dv},{conditions:[{[Oz]:cLA,[Mz]:[lLA,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:uD,headers:uD},type:dv},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:uD,headers:uD},type:dv}],type:Xu},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:NJA}],type:Xu},{conditions:jAB,rules:[{conditions:[{[Oz]:iLA,[Mz]:[RAB,NAB]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:uD,headers:uD},type:dv}],type:Xu},{error:"FIPS is enabled but this partition does not support FIPS",type:NJA}],type:Xu},{conditions:TAB,rules:[{conditions:[_AB],rules:[{conditions:[{[Oz]:cLA,[Mz]:["aws",{[Oz]:uc1,[Mz]:[vAB,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:uD,headers:uD},type:dv},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:uD,headers:uD},type:dv}],type:Xu},{error:"DualStack is enabled but this partition does not support DualStack",type:NJA}],type:Xu},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:uD,headers:uD},type:dv}],type:Xu}],type:Xu},{error:"Invalid Configuration: Missing Region",type:NJA}]};kAB.ruleSet=oR3});var uAB=U((hAB)=>{Object.defineProperty(hAB,"__esModule",{value:!0});hAB.defaultEndpointResolver=void 0;var rR3=Qv(),mc1=FT(),sR3=fAB(),tR3=new mc1.EndpointCache({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),eR3=(A,Q={})=>{return tR3.get(A,()=>(0,mc1.resolveEndpoint)(sR3.ruleSet,{endpointParams:A,logger:Q.logger}))};hAB.defaultEndpointResolver=eR3;mc1.customEndpointFunctions.aws=rR3.awsEndpointFunctions});var lAB=U((pAB)=>{Object.defineProperty(pAB,"__esModule",{value:!0});pAB.getRuntimeConfig=void 0;var A_3=vY(),Q_3=yg(),B_3=iG(),G_3=dLA(),Z_3=vM(),mAB=qAB(),dAB=lG(),Y_3=bc1(),J_3=uAB(),X_3=(A)=>{return{apiVersion:"2014-06-30",base64Decoder:A?.base64Decoder??mAB.fromBase64,base64Encoder:A?.base64Encoder??mAB.toBase64,disableHostPrefix:A?.disableHostPrefix??!1,endpointProvider:A?.endpointProvider??J_3.defaultEndpointResolver,extensions:A?.extensions??[],httpAuthSchemeProvider:A?.httpAuthSchemeProvider??Y_3.defaultCognitoIdentityHttpAuthSchemeProvider,httpAuthSchemes:A?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:(Q)=>Q.getIdentityProvider("aws.auth#sigv4"),signer:new A_3.AwsSdkSigV4Signer},{schemeId:"smithy.api#noAuth",identityProvider:(Q)=>Q.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new B_3.NoAuthSigner}],logger:A?.logger??new G_3.NoOpLogger,protocol:A?.protocol??new Q_3.AwsJson1_1Protocol({defaultNamespace:"com.amazonaws.cognitoidentity",serviceTarget:"AWSCognitoIdentityService",awsQueryCompatible:!1}),serviceId:A?.serviceId??"Cognito Identity",urlParser:A?.urlParser??Z_3.parseUrl,utf8Decoder:A?.utf8Decoder??dAB.fromUtf8,utf8Encoder:A?.utf8Encoder??dAB.toUtf8}};pAB.getRuntimeConfig=X_3});var tAB=U((rAB)=>{Object.defineProperty(rAB,"__esModule",{value:!0});rAB.getRuntimeConfig=void 0;var I_3=NZ(),W_3=I_3.__importDefault(DAB()),iAB=vY(),D_3=G0A(),nAB=Tg(),weA=wW(),K_3=Pg(),aAB=wH(),t0A=Dq(),oAB=dw(),V_3=Sg(),F_3=Jv(),H_3=lAB(),E_3=dLA(),z_3=kg(),C_3=dLA(),$_3=(A)=>{(0,C_3.emitWarningIfUnsupportedVersion)(process.version);let Q=(0,z_3.resolveDefaultsModeConfig)(A),B=()=>Q().then(E_3.loadConfigsForDefaultMode),G=(0,H_3.getRuntimeConfig)(A);(0,iAB.emitWarningIfUnsupportedVersion)(process.version);let Z={profile:A?.profile,logger:G.logger};return{...G,...A,runtime:"node",defaultsMode:Q,authSchemePreference:A?.authSchemePreference??(0,t0A.loadConfig)(iAB.NODE_AUTH_SCHEME_PREFERENCE_OPTIONS,Z),bodyLengthChecker:A?.bodyLengthChecker??V_3.calculateBodyLength,credentialDefaultProvider:A?.credentialDefaultProvider??D_3.defaultProvider,defaultUserAgentProvider:A?.defaultUserAgentProvider??(0,nAB.createDefaultUserAgentProvider)({serviceId:G.serviceId,clientVersion:W_3.default.version}),maxAttempts:A?.maxAttempts??(0,t0A.loadConfig)(aAB.NODE_MAX_ATTEMPT_CONFIG_OPTIONS,A),region:A?.region??(0,t0A.loadConfig)(weA.NODE_REGION_CONFIG_OPTIONS,{...weA.NODE_REGION_CONFIG_FILE_OPTIONS,...Z}),requestHandler:oAB.NodeHttpHandler.create(A?.requestHandler??B),retryMode:A?.retryMode??(0,t0A.loadConfig)({...aAB.NODE_RETRY_MODE_CONFIG_OPTIONS,default:async()=>(await B()).retryMode||F_3.DEFAULT_RETRY_MODE},A),sha256:A?.sha256??K_3.Hash.bind(null,"sha256"),streamCollector:A?.streamCollector??oAB.streamCollector,useDualstackEndpoint:A?.useDualstackEndpoint??(0,t0A.loadConfig)(weA.NODE_USE_DUALSTACK_ENDPOINT_CONFIG_OPTIONS,Z),useFipsEndpoint:A?.useFipsEndpoint??(0,t0A.loadConfig)(weA.NODE_USE_FIPS_ENDPOINT_CONFIG_OPTIONS,Z),userAgentAppId:A?.userAgentAppId??(0,t0A.loadConfig)(nAB.NODE_APP_ID_CONFIG_OPTIONS,Z)}};rAB.getRuntimeConfig=$_3});var B1B=U((O_3)=>{var U_3=jc1(),q_3=(A)=>{return{setHttpHandler(Q){A.httpHandler=Q},httpHandler(){return A.httpHandler},updateHttpClientConfig(Q,B){A.httpHandler?.updateHttpClientConfig(Q,B)},httpHandlerConfigs(){return A.httpHandler.httpHandlerConfigs()}}},N_3=(A)=>{return{httpHandler:A.httpHandler()}};class eAB{name;kind;values;constructor({name:A,kind:Q=U_3.FieldPosition.HEADER,values:B=[]}){this.name=A,this.kind=Q,this.values=B}add(A){this.values.push(A)}set(A){this.values=A}remove(A){this.values=this.values.filter((Q)=>Q!==A)}toString(){return this.values.map((A)=>A.includes(",")||A.includes(" ")?`"${A}"`:A).join(", ")}get(){return this.values}}class A1B{entries={};encoding;constructor({fields:A=[],encoding:Q="utf-8"}){A.forEach(this.setField.bind(this)),this.encoding=Q}setField(A){this.entries[A.name.toLowerCase()]=A}getField(A){return this.entries[A.toLowerCase()]}removeField(A){delete this.entries[A.toLowerCase()]}getByType(A){return Object.values(this.entries).filter((Q)=>Q.kind===A)}}class LeA{method;protocol;hostname;port;path;query;headers;username;password;fragment;body;constructor(A){this.method=A.method||"GET",this.hostname=A.hostname||"localhost",this.port=A.port,this.query=A.query||{},this.headers=A.headers||{},this.body=A.body,this.protocol=A.protocol?A.protocol.slice(-1)!==":"?`${A.protocol}:`:A.protocol:"https:",this.path=A.path?A.path.charAt(0)!=="/"?`/${A.path}`:A.path:"/",this.username=A.username,this.password=A.password,this.fragment=A.fragment}static clone(A){let Q=new LeA({...A,headers:{...A.headers}});if(Q.query)Q.query=w_3(Q.query);return Q}static isInstance(A){if(!A)return!1;let Q=A;return"method"in Q&&"protocol"in Q&&"hostname"in Q&&"path"in Q&&typeof Q.query==="object"&&typeof Q.headers==="object"}clone(){return LeA.clone(this)}}function w_3(A){return Object.keys(A).reduce((Q,B)=>{let G=A[B];return{...Q,[B]:Array.isArray(G)?[...G]:G}},{})}class Q1B{statusCode;reason;headers;body;constructor(A){this.statusCode=A.statusCode,this.reason=A.reason,this.headers=A.headers||{},this.body=A.body}static isInstance(A){if(!A)return!1;let Q=A;return typeof Q.statusCode==="number"&&typeof Q.headers==="object"}}function L_3(A){return/^[a-z0-9][a-z0-9\.\-]*[a-z0-9]$/.test(A)}O_3.Field=eAB;O_3.Fields=A1B;O_3.HttpRequest=LeA;O_3.HttpResponse=Q1B;O_3.getHttpHandlerExtensionConfiguration=q_3;O_3.isValidHostname=L_3;O_3.resolveHttpHandlerRuntimeConfig=N_3});var h1B=U((El1)=>{var G1B=zg(),x_3=Cg(),y_3=$g(),Z1B=Zv(),v_3=wW(),OeA=iG(),XL=IX(),k_3=jg(),HX=HT(),Y1B=wH(),jG=dLA(),J1B=bc1(),b_3=tAB(),X1B=ET(),I1B=B1B(),f_3=(A)=>{return Object.assign(A,{useDualstackEndpoint:A.useDualstackEndpoint??!1,useFipsEndpoint:A.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"})},sX={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},h_3=(A)=>{let{httpAuthSchemes:Q,httpAuthSchemeProvider:B,credentials:G}=A;return{setHttpAuthScheme(Z){let Y=Q.findIndex((J)=>J.schemeId===Z.schemeId);if(Y===-1)Q.push(Z);else Q.splice(Y,1,Z)},httpAuthSchemes(){return Q},setHttpAuthSchemeProvider(Z){B=Z},httpAuthSchemeProvider(){return B},setCredentials(Z){G=Z},credentials(){return G}}},g_3=(A)=>{return{httpAuthSchemes:A.httpAuthSchemes(),httpAuthSchemeProvider:A.httpAuthSchemeProvider(),credentials:A.credentials()}},u_3=(A,Q)=>{let B=Object.assign(X1B.getAwsRegionExtensionConfiguration(A),jG.getDefaultExtensionConfiguration(A),I1B.getHttpHandlerExtensionConfiguration(A),h_3(A));return Q.forEach((G)=>G.configure(B)),Object.assign(A,X1B.resolveAwsRegionExtensionConfiguration(B),jG.resolveDefaultRuntimeConfig(B),I1B.resolveHttpHandlerRuntimeConfig(B),g_3(B))};class ReA extends jG.Client{config;constructor(...[A]){let Q=b_3.getRuntimeConfig(A||{});super(Q);this.initConfig=Q;let B=f_3(Q),G=Z1B.resolveUserAgentConfig(B),Z=Y1B.resolveRetryConfig(G),Y=v_3.resolveRegionConfig(Z),J=G1B.resolveHostHeaderConfig(Y),X=HX.resolveEndpointConfig(J),I=J1B.resolveHttpAuthSchemeConfig(X),W=u_3(I,A?.extensions||[]);this.config=W,this.middlewareStack.use(XL.getSchemaSerdePlugin(this.config)),this.middlewareStack.use(Z1B.getUserAgentPlugin(this.config)),this.middlewareStack.use(Y1B.getRetryPlugin(this.config)),this.middlewareStack.use(k_3.getContentLengthPlugin(this.config)),this.middlewareStack.use(G1B.getHostHeaderPlugin(this.config)),this.middlewareStack.use(x_3.getLoggerPlugin(this.config)),this.middlewareStack.use(y_3.getRecursionDetectionPlugin(this.config)),this.middlewareStack.use(OeA.getHttpAuthSchemeEndpointRuleSetPlugin(this.config,{httpAuthSchemeParametersProvider:J1B.defaultCognitoIdentityHttpAuthSchemeParametersProvider,identityProviderConfigProvider:async(D)=>new OeA.DefaultIdentityProviderConfig({"aws.auth#sigv4":D.credentials})})),this.middlewareStack.use(OeA.getHttpSigningPlugin(this.config))}destroy(){super.destroy()}}var IL=class A extends jG.ServiceException{constructor(Q){super(Q);Object.setPrototypeOf(this,A.prototype)}},W1B=class A extends IL{name="InternalErrorException";$fault="server";constructor(Q){super({name:"InternalErrorException",$fault:"server",...Q});Object.setPrototypeOf(this,A.prototype)}},D1B=class A extends IL{name="InvalidParameterException";$fault="client";constructor(Q){super({name:"InvalidParameterException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},K1B=class A extends IL{name="LimitExceededException";$fault="client";constructor(Q){super({name:"LimitExceededException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},V1B=class A extends IL{name="NotAuthorizedException";$fault="client";constructor(Q){super({name:"NotAuthorizedException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},F1B=class A extends IL{name="ResourceConflictException";$fault="client";constructor(Q){super({name:"ResourceConflictException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},H1B=class A extends IL{name="TooManyRequestsException";$fault="client";constructor(Q){super({name:"TooManyRequestsException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},E1B=class A extends IL{name="ResourceNotFoundException";$fault="client";constructor(Q){super({name:"ResourceNotFoundException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},z1B=class A extends IL{name="ExternalServiceException";$fault="client";constructor(Q){super({name:"ExternalServiceException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},C1B=class A extends IL{name="InvalidIdentityPoolConfigurationException";$fault="client";constructor(Q){super({name:"InvalidIdentityPoolConfigurationException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},$1B=class A extends IL{name="DeveloperUserAlreadyRegisteredException";$fault="client";constructor(Q){super({name:"DeveloperUserAlreadyRegisteredException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},U1B=class A extends IL{name="ConcurrentModificationException";$fault="client";constructor(Q){super({name:"ConcurrentModificationException",$fault:"client",...Q});Object.setPrototypeOf(this,A.prototype)}},q1B="AllowClassicFlow",m_3="AccountId",d_3="AccessKeyId",p_3="AmbiguousRoleResolution",N1B="AllowUnauthenticatedIdentities",w1B="Credentials",c_3="CreationDate",l_3="ClientId",i_3="CognitoIdentityProvider",n_3="CreateIdentityPoolInput",a_3="CognitoIdentityProviderList",L1B="CognitoIdentityProviders",o_3="CreateIdentityPool",r_3="ConcurrentModificationException",s_3="CustomRoleArn",t_3="Claim",e_3="DeleteIdentities",Aj3="DeleteIdentitiesInput",Qj3="DescribeIdentityInput",Bj3="DeleteIdentityPool",Gj3="DeleteIdentityPoolInput",Zj3="DescribeIdentityPoolInput",Yj3="DescribeIdentityPool",Jj3="DeleteIdentitiesResponse",Xj3="DescribeIdentity",_eA="DeveloperProviderName",Ij3="DeveloperUserAlreadyRegisteredException",O1B="DeveloperUserIdentifier",Wj3="DeveloperUserIdentifierList",Dj3="DestinationUserIdentifier",Kj3="Expiration",Vj3="ErrorCode",Fj3="ExternalServiceException",Hj3="GetCredentialsForIdentity",Ej3="GetCredentialsForIdentityInput",zj3="GetCredentialsForIdentityResponse",Cj3="GetId",$j3="GetIdInput",Uj3="GetIdentityPoolRoles",qj3="GetIdentityPoolRolesInput",Nj3="GetIdentityPoolRolesResponse",wj3="GetIdResponse",Lj3="GetOpenIdToken",Oj3="GetOpenIdTokenForDeveloperIdentity",Mj3="GetOpenIdTokenForDeveloperIdentityInput",Rj3="GetOpenIdTokenForDeveloperIdentityResponse",_j3="GetOpenIdTokenInput",jj3="GetOpenIdTokenResponse",Tj3="GetPrincipalTagAttributeMap",Pj3="GetPrincipalTagAttributeMapInput",Sj3="GetPrincipalTagAttributeMapResponse",xj3="HideDisabled",yj3="Identities",vj3="IdentityDescription",kj3="InternalErrorException",G$="IdentityId",bj3="InvalidIdentityPoolConfigurationException",fj3="IdentityIdsToDelete",hj3="IdentitiesList",gj3="IdentityPool",uj3="InvalidParameterException",GF="IdentityPoolId",mj3="IdentityPoolsList",dc1="IdentityPoolName",jeA="IdentityProviderName",dj3="IdentityPoolShortDescription",pj3="IdentityProviderToken",M1B="IdentityPoolTags",cj3="IdentityPools",LJA="Logins",lj3="LookupDeveloperIdentity",ij3="LookupDeveloperIdentityInput",nj3="LookupDeveloperIdentityResponse",aj3="LimitExceededException",oj3="ListIdentities",rj3="ListIdentitiesInput",sj3="ListIdentityPools",tj3="ListIdentityPoolsInput",ej3="ListIdentityPoolsResponse",AT3="ListIdentitiesResponse",QT3="LoginsMap",BT3="LastModifiedDate",GT3="ListTagsForResource",ZT3="ListTagsForResourceInput",YT3="ListTagsForResourceResponse",JT3="LoginsToRemove",XT3="MergeDeveloperIdentities",IT3="MergeDeveloperIdentitiesInput",WT3="MergeDeveloperIdentitiesResponse",pc1="MaxResults",DT3="MappingRulesList",KT3="MappingRule",VT3="MatchType",FT3="NotAuthorizedException",OJA="NextToken",R1B="OpenIdConnectProviderARNs",HT3="OIDCToken",ET3="ProviderName",TeA="PrincipalTags",_1B="Roles",cc1="ResourceArn",zT3="RoleARN",CT3="RulesConfiguration",$T3="ResourceConflictException",UT3="RulesConfigurationType",j1B="RoleMappings",qT3="RoleMappingMap",NT3="RoleMapping",wT3="ResourceNotFoundException",LT3="Rules",OT3="SetIdentityPoolRoles",MT3="SetIdentityPoolRolesInput",RT3="SecretKey",_T3="SecretKeyString",T1B="SupportedLoginProviders",P1B="SamlProviderARNs",jT3="SetPrincipalTagAttributeMap",TT3="SetPrincipalTagAttributeMapInput",PT3="SetPrincipalTagAttributeMapResponse",ST3="ServerSideTokenCheck",xT3="SessionToken",yT3="SourceUserIdentifier",S1B="Token",vT3="TokenDuration",kT3="TagKeys",bT3="TooManyRequestsException",fT3="TagResource",hT3="TagResourceInput",gT3="TagResourceResponse",x1B="Tags",uT3="Type",lc1="UseDefaults",mT3="UnlinkDeveloperIdentity",dT3="UnlinkDeveloperIdentityInput",pT3="UnlinkIdentity",cT3="UnprocessedIdentityIds",lT3="UnprocessedIdentityIdList",iT3="UnlinkIdentityInput",nT3="UnprocessedIdentityId",aT3="UpdateIdentityPool",oT3="UntagResource",rT3="UntagResourceInput",sT3="UntagResourceResponse",tT3="Value",pv="client",fT="error",cv="httpError",hT="message",eT3="server",y1B="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentity",nQ="com.amazonaws.cognitoidentity",AP3=[0,nQ,pj3,8,0],v1B=[0,nQ,HT3,8,0],QP3=[0,nQ,_T3,8,0],BP3=[3,nQ,i_3,0,[ET3,l_3,ST3],[0,0,2]],GP3=[-3,nQ,r_3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(GP3,U1B);var ZP3=[3,nQ,n_3,0,[dc1,N1B,q1B,T1B,_eA,R1B,L1B,P1B,M1B],[0,2,2,128,0,64,()=>b1B,64,128]],YP3=[3,nQ,w1B,0,[d_3,RT3,xT3,Kj3],[0,[()=>QP3,0],0,4]],JP3=[3,nQ,Aj3,0,[fj3],[64]],XP3=[3,nQ,Jj3,0,[cT3],[()=>XS3]],IP3=[3,nQ,Gj3,0,[GF],[0]],WP3=[3,nQ,Qj3,0,[G$],[0]],DP3=[3,nQ,Zj3,0,[GF],[0]],KP3=[-3,nQ,Ij3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(KP3,$1B);var VP3=[-3,nQ,Fj3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(VP3,z1B);var FP3=[3,nQ,Ej3,0,[G$,LJA,s_3],[0,[()=>nLA,0],0]],HP3=[3,nQ,zj3,0,[G$,w1B],[0,[()=>YP3,0]]],EP3=[3,nQ,qj3,0,[GF],[0]],zP3=[3,nQ,Nj3,0,[GF,_1B,j1B],[0,128,()=>f1B]],CP3=[3,nQ,$j3,0,[m_3,GF,LJA],[0,0,[()=>nLA,0]]],$P3=[3,nQ,wj3,0,[G$],[0]],UP3=[3,nQ,Mj3,0,[GF,G$,LJA,TeA,vT3],[0,0,[()=>nLA,0],128,1]],qP3=[3,nQ,Rj3,0,[G$,S1B],[0,[()=>v1B,0]]],NP3=[3,nQ,_j3,0,[G$,LJA],[0,[()=>nLA,0]]],wP3=[3,nQ,jj3,0,[G$,S1B],[0,[()=>v1B,0]]],LP3=[3,nQ,Pj3,0,[GF,jeA],[0,0]],OP3=[3,nQ,Sj3,0,[GF,jeA,lc1,TeA],[0,0,2,128]],k1B=[3,nQ,vj3,0,[G$,LJA,c_3,BT3],[0,64,4,4]],MeA=[3,nQ,gj3,0,[GF,dc1,N1B,q1B,T1B,_eA,R1B,L1B,P1B,M1B],[0,0,2,2,128,0,64,()=>b1B,64,128]],MP3=[3,nQ,dj3,0,[GF,dc1],[0,0]],RP3=[-3,nQ,kj3,{[fT]:eT3},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(RP3,W1B);var _P3=[-3,nQ,bj3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(_P3,C1B);var jP3=[-3,nQ,uj3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(jP3,D1B);var TP3=[-3,nQ,aj3,{[fT]:pv,[cv]:400},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(TP3,K1B);var PP3=[3,nQ,rj3,0,[GF,pc1,OJA,xj3],[0,1,0,2]],SP3=[3,nQ,AT3,0,[GF,yj3,OJA],[0,()=>ZS3,0]],xP3=[3,nQ,tj3,0,[pc1,OJA],[1,0]],yP3=[3,nQ,ej3,0,[cj3,OJA],[()=>YS3,0]],vP3=[3,nQ,ZT3,0,[cc1],[0]],kP3=[3,nQ,YT3,0,[x1B],[128]],bP3=[3,nQ,ij3,0,[GF,G$,O1B,pc1,OJA],[0,0,0,1,0]],fP3=[3,nQ,nj3,0,[G$,Wj3,OJA],[0,64,0]],hP3=[3,nQ,KT3,0,[t_3,VT3,tT3,zT3],[0,0,0,0]],gP3=[3,nQ,IT3,0,[yT3,Dj3,_eA,GF],[0,0,0,0]],uP3=[3,nQ,WT3,0,[G$],[0]],mP3=[-3,nQ,FT3,{[fT]:pv,[cv]:403},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(mP3,V1B);var dP3=[-3,nQ,$T3,{[fT]:pv,[cv]:409},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(dP3,F1B);var pP3=[-3,nQ,wT3,{[fT]:pv,[cv]:404},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(pP3,E1B);var cP3=[3,nQ,NT3,0,[uT3,p_3,CT3],[0,0,()=>lP3]],lP3=[3,nQ,UT3,0,[LT3],[()=>JS3]],iP3=[3,nQ,MT3,0,[GF,_1B,j1B],[0,128,()=>f1B]],nP3=[3,nQ,TT3,0,[GF,jeA,lc1,TeA],[0,0,2,128]],aP3=[3,nQ,PT3,0,[GF,jeA,lc1,TeA],[0,0,2,128]],oP3=[3,nQ,hT3,0,[cc1,x1B],[0,128]],rP3=[3,nQ,gT3,0,[],[]],sP3=[-3,nQ,bT3,{[fT]:pv,[cv]:429},[hT],[0]];XL.TypeRegistry.for(nQ).registerError(sP3,H1B);var tP3=[3,nQ,dT3,0,[G$,GF,_eA,O1B],[0,0,0,0]],eP3=[3,nQ,iT3,0,[G$,LJA,JT3],[0,[()=>nLA,0],64]],AS3=[3,nQ,nT3,0,[G$,Vj3],[0,0]],QS3=[3,nQ,rT3,0,[cc1,kT3],[0,64]],BS3=[3,nQ,sT3,0,[],[]],PeA="unit",GS3=[-3,y1B,"CognitoIdentityServiceException",0,[],[]];XL.TypeRegistry.for(y1B).registerError(GS3,IL);var b1B=[1,nQ,a_3,0,()=>BP3],ZS3=[1,nQ,hj3,0,()=>k1B],YS3=[1,nQ,mj3,0,()=>MP3],JS3=[1,nQ,DT3,0,()=>hP3],XS3=[1,nQ,lT3,0,()=>AS3],nLA=[2,nQ,QT3,0,[0,0],[()=>AP3,0]],f1B=[2,nQ,qT3,0,0,()=>cP3],IS3=[9,nQ,o_3,0,()=>ZP3,()=>MeA],WS3=[9,nQ,e_3,0,()=>JP3,()=>XP3],DS3=[9,nQ,Bj3,0,()=>IP3,()=>PeA],KS3=[9,nQ,Xj3,0,()=>WP3,()=>k1B],VS3=[9,nQ,Yj3,0,()=>DP3,()=>MeA],FS3=[9,nQ,Hj3,0,()=>FP3,()=>HP3],HS3=[9,nQ,Cj3,0,()=>CP3,()=>$P3],ES3=[9,nQ,Uj3,0,()=>EP3,()=>zP3],zS3=[9,nQ,Lj3,0,()=>NP3,()=>wP3],CS3=[9,nQ,Oj3,0,()=>UP3,()=>qP3],$S3=[9,nQ,Tj3,0,()=>LP3,()=>OP3],US3=[9,nQ,oj3,0,()=>PP3,()=>SP3],qS3=[9,nQ,sj3,0,()=>xP3,()=>yP3],NS3=[9,nQ,GT3,0,()=>vP3,()=>kP3],wS3=[9,nQ,lj3,0,()=>bP3,()=>fP3],LS3=[9,nQ,XT3,0,()=>gP3,()=>uP3],OS3=[9,nQ,OT3,0,()=>iP3,()=>PeA],MS3=[9,nQ,jT3,0,()=>nP3,()=>aP3],RS3=[9,nQ,fT3,0,()=>oP3,()=>rP3],_S3=[9,nQ,mT3,0,()=>tP3,()=>PeA],jS3=[9,nQ,pT3,0,()=>eP3,()=>PeA],TS3=[9,nQ,oT3,0,()=>QS3,()=>BS3],PS3=[9,nQ,aT3,0,()=>MeA,()=>MeA];class ic1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","CreateIdentityPool",{}).n("CognitoIdentityClient","CreateIdentityPoolCommand").sc(IS3).build(){}class nc1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","DeleteIdentities",{}).n("CognitoIdentityClient","DeleteIdentitiesCommand").sc(WS3).build(){}class ac1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","DeleteIdentityPool",{}).n("CognitoIdentityClient","DeleteIdentityPoolCommand").sc(DS3).build(){}class oc1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","DescribeIdentity",{}).n("CognitoIdentityClient","DescribeIdentityCommand").sc(KS3).build(){}class rc1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","DescribeIdentityPool",{}).n("CognitoIdentityClient","DescribeIdentityPoolCommand").sc(VS3).build(){}class sc1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetCredentialsForIdentity",{}).n("CognitoIdentityClient","GetCredentialsForIdentityCommand").sc(FS3).build(){}class tc1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetId",{}).n("CognitoIdentityClient","GetIdCommand").sc(HS3).build(){}class ec1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetIdentityPoolRoles",{}).n("CognitoIdentityClient","GetIdentityPoolRolesCommand").sc(ES3).build(){}class Al1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetOpenIdToken",{}).n("CognitoIdentityClient","GetOpenIdTokenCommand").sc(zS3).build(){}class Ql1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetOpenIdTokenForDeveloperIdentity",{}).n("CognitoIdentityClient","GetOpenIdTokenForDeveloperIdentityCommand").sc(CS3).build(){}class Bl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","GetPrincipalTagAttributeMap",{}).n("CognitoIdentityClient","GetPrincipalTagAttributeMapCommand").sc($S3).build(){}class Gl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","ListIdentities",{}).n("CognitoIdentityClient","ListIdentitiesCommand").sc(US3).build(){}class SeA extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","ListIdentityPools",{}).n("CognitoIdentityClient","ListIdentityPoolsCommand").sc(qS3).build(){}class Zl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","ListTagsForResource",{}).n("CognitoIdentityClient","ListTagsForResourceCommand").sc(NS3).build(){}class Yl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","LookupDeveloperIdentity",{}).n("CognitoIdentityClient","LookupDeveloperIdentityCommand").sc(wS3).build(){}class Jl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","MergeDeveloperIdentities",{}).n("CognitoIdentityClient","MergeDeveloperIdentitiesCommand").sc(LS3).build(){}class Xl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","SetIdentityPoolRoles",{}).n("CognitoIdentityClient","SetIdentityPoolRolesCommand").sc(OS3).build(){}class Il1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","SetPrincipalTagAttributeMap",{}).n("CognitoIdentityClient","SetPrincipalTagAttributeMapCommand").sc(MS3).build(){}class Wl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","TagResource",{}).n("CognitoIdentityClient","TagResourceCommand").sc(RS3).build(){}class Dl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","UnlinkDeveloperIdentity",{}).n("CognitoIdentityClient","UnlinkDeveloperIdentityCommand").sc(_S3).build(){}class Kl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","UnlinkIdentity",{}).n("CognitoIdentityClient","UnlinkIdentityCommand").sc(jS3).build(){}class Vl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","UntagResource",{}).n("CognitoIdentityClient","UntagResourceCommand").sc(TS3).build(){}class Fl1 extends jG.Command.classBuilder().ep(sX).m(function(A,Q,B,G){return[HX.getEndpointPlugin(B,A.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityService","UpdateIdentityPool",{}).n("CognitoIdentityClient","UpdateIdentityPoolCommand").sc(PS3).build(){}var SS3={CreateIdentityPoolCommand:ic1,DeleteIdentitiesCommand:nc1,DeleteIdentityPoolCommand:ac1,DescribeIdentityCommand:oc1,DescribeIdentityPoolCommand:rc1,GetCredentialsForIdentityCommand:sc1,GetIdCommand:tc1,GetIdentityPoolRolesCommand:ec1,GetOpenIdTokenCommand:Al1,GetOpenIdTokenForDeveloperIdentityCommand:Ql1,GetPrincipalTagAttributeMapCommand:Bl1,ListIdentitiesCommand:Gl1,ListIdentityPoolsCommand:SeA,ListTagsForResourceCommand:Zl1,LookupDeveloperIdentityCommand:Yl1,MergeDeveloperIdentitiesCommand:Jl1,SetIdentityPoolRolesCommand:Xl1,SetPrincipalTagAttributeMapCommand:Il1,TagResourceCommand:Wl1,UnlinkDeveloperIdentityCommand:Dl1,UnlinkIdentityCommand:Kl1,UntagResourceCommand:Vl1,UpdateIdentityPoolCommand:Fl1};class Hl1 extends ReA{}jG.createAggregatedClient(SS3,Hl1);var xS3=OeA.createPaginator(ReA,SeA,"NextToken","NextToken","MaxResults"),yS3={AUTHENTICATED_ROLE:"AuthenticatedRole",DENY:"Deny"},vS3={ACCESS_DENIED:"AccessDenied",INTERNAL_SERVER_ERROR:"InternalServerError"},kS3={CONTAINS:"Contains",EQUALS:"Equals",NOT_EQUAL:"NotEqual",STARTS_WITH:"StartsWith"},bS3={RULES:"Rules",TOKEN:"Token"};Object.defineProperty(El1,"$Command",{enumerable:!0,get:function(){return jG.Command}});Object.defineProperty(El1,"__Client",{enumerable:!0,get:function(){return jG.Client}});El1.AmbiguousRoleResolutionType=yS3;El1.CognitoIdentity=Hl1;El1.CognitoIdentityClient=ReA;El1.CognitoIdentityServiceException=IL;El1.ConcurrentModificationException=U1B;El1.CreateIdentityPoolCommand=ic1;El1.DeleteIdentitiesCommand=nc1;El1.DeleteIdentityPoolCommand=ac1;El1.DescribeIdentityCommand=oc1;El1.DescribeIdentityPoolCommand=rc1;El1.DeveloperUserAlreadyRegisteredException=$1B;El1.ErrorCode=vS3;El1.ExternalServiceException=z1B;El1.GetCredentialsForIdentityCommand=sc1;El1.GetIdCommand=tc1;El1.GetIdentityPoolRolesCommand=ec1;El1.GetOpenIdTokenCommand=Al1;El1.GetOpenIdTokenForDeveloperIdentityCommand=Ql1;El1.GetPrincipalTagAttributeMapCommand=Bl1;El1.InternalErrorException=W1B;El1.InvalidIdentityPoolConfigurationException=C1B;El1.InvalidParameterException=D1B;El1.LimitExceededException=K1B;El1.ListIdentitiesCommand=Gl1;El1.ListIdentityPoolsCommand=SeA;El1.ListTagsForResourceCommand=Zl1;El1.LookupDeveloperIdentityCommand=Yl1;El1.MappingRuleMatchType=kS3;El1.MergeDeveloperIdentitiesCommand=Jl1;El1.NotAuthorizedException=V1B;El1.ResourceConflictException=F1B;El1.ResourceNotFoundException=E1B;El1.RoleMappingType=bS3;El1.SetIdentityPoolRolesCommand=Xl1;El1.SetPrincipalTagAttributeMapCommand=Il1;El1.TagResourceCommand=Wl1;El1.TooManyRequestsException=H1B;El1.UnlinkDeveloperIdentityCommand=Dl1;El1.UnlinkIdentityCommand=Kl1;El1.UntagResourceCommand=Vl1;El1.UpdateIdentityPoolCommand=Fl1;El1.paginateListIdentityPools=xS3});var Cl1=U((xeA)=>{var zl1=h1B();Object.defineProperty(xeA,"CognitoIdentityClient",{enumerable:!0,get:function(){return zl1.CognitoIdentityClient}});Object.defineProperty(xeA,"GetCredentialsForIdentityCommand",{enumerable:!0,get:function(){return zl1.GetCredentialsForIdentityCommand}});Object.defineProperty(xeA,"GetIdCommand",{enumerable:!0,get:function(){return zl1.GetIdCommand}})});var Ul1=U((xx3)=>{var yeA=TD();function g1B(A){return Promise.all(Object.keys(A).reduce((Q,B)=>{let G=A[B];if(typeof G==="string")Q.push([B,G]);else Q.push(G().then((Z)=>[B,Z]));return Q},[])).then((Q)=>Q.reduce((B,[G,Z])=>{return B[G]=Z,B},{}))}function u1B(A){return async(Q)=>{A.logger?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");let{GetCredentialsForIdentityCommand:B,CognitoIdentityClient:G}=await Promise.resolve().then(function(){return Cl1()}),Z=(W)=>A.clientConfig?.[W]??A.parentClientConfig?.[W]??Q?.callerClientConfig?.[W],{Credentials:{AccessKeyId:Y=Mx3(A.logger),Expiration:J,SecretKey:X=_x3(A.logger),SessionToken:I}=Rx3(A.logger)}=await(A.client??new G(Object.assign({},A.clientConfig??{},{region:Z("region"),profile:Z("profile"),userAgentAppId:Z("userAgentAppId")}))).send(new B({CustomRoleArn:A.customRoleArn,IdentityId:A.identityId,Logins:A.logins?await g1B(A.logins):void 0}));return{identityId:A.identityId,accessKeyId:Y,secretAccessKey:X,sessionToken:I,expiration:J}}}function Mx3(A){throw new yeA.CredentialsProviderError("Response from Amazon Cognito contained no access key ID",{logger:A})}function Rx3(A){throw new yeA.CredentialsProviderError("Response from Amazon Cognito contained no credentials",{logger:A})}function _x3(A){throw new yeA.CredentialsProviderError("Response from Amazon Cognito contained no secret key",{logger:A})}var $l1="IdentityIds";class m1B{dbName;constructor(A="aws:cognito-identity-ids"){this.dbName=A}getItem(A){return this.withObjectStore("readonly",(Q)=>{let B=Q.get(A);return new Promise((G)=>{B.onerror=()=>G(null),B.onsuccess=()=>G(B.result?B.result.value:null)})}).catch(()=>null)}removeItem(A){return this.withObjectStore("readwrite",(Q)=>{let B=Q.delete(A);return new Promise((G,Z)=>{B.onerror=()=>Z(B.error),B.onsuccess=()=>G()})})}setItem(A,Q){return this.withObjectStore("readwrite",(B)=>{let G=B.put({id:A,value:Q});return new Promise((Z,Y)=>{G.onerror=()=>Y(G.error),G.onsuccess=()=>Z()})})}getDb(){let A=self.indexedDB.open(this.dbName,1);return new Promise((Q,B)=>{A.onsuccess=()=>{Q(A.result)},A.onerror=()=>{B(A.error)},A.onblocked=()=>{B(Error("Unable to access DB"))},A.onupgradeneeded=()=>{let G=A.result;G.onerror=()=>{B(Error("Failed to create object store"))},G.createObjectStore($l1,{keyPath:"id"})}})}withObjectStore(A,Q){return this.getDb().then((B)=>{let G=B.transaction($l1,A);return G.oncomplete=()=>B.close(),new Promise((Z,Y)=>{G.onerror=()=>Y(G.error),Z(Q(G.objectStore($l1)))}).catch((Z)=>{throw B.close(),Z})})}}class d1B{store;constructor(A={}){this.store=A}getItem(A){if(A in this.store)return this.store[A];return null}removeItem(A){delete this.store[A]}setItem(A,Q){this.store[A]=Q}}var jx3=new d1B;function Tx3(){if(typeof self==="object"&&self.indexedDB)return new m1B;if(typeof window==="object"&&window.localStorage)return window.localStorage;return jx3}function Px3({accountId:A,cache:Q=Tx3(),client:B,clientConfig:G,customRoleArn:Z,identityPoolId:Y,logins:J,userIdentifier:X=!J||Object.keys(J).length===0?"ANONYMOUS":void 0,logger:I,parentClientConfig:W}){I?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");let D=X?`aws:cognito-identity-credentials:${Y}:${X}`:void 0,K=async(V)=>{let{GetIdCommand:F,CognitoIdentityClient:H}=await Promise.resolve().then(function(){return Cl1()}),E=(O)=>G?.[O]??W?.[O]??V?.callerClientConfig?.[O],z=B??new H(Object.assign({},G??{},{region:E("region"),profile:E("profile"),userAgentAppId:E("userAgentAppId")})),C=D&&await Q.getItem(D);if(!C){let{IdentityId:O=Sx3(I)}=await z.send(new F({AccountId:A,IdentityPoolId:Y,Logins:J?await g1B(J):void 0}));if(C=O,D)Promise.resolve(Q.setItem(D,C)).catch(()=>{})}return K=u1B({client:z,customRoleArn:Z,logins:J,identityId:C}),K(V)};return(V)=>K(V).catch(async(F)=>{if(D)Promise.resolve(Q.removeItem(D)).catch(()=>{});throw F})}function Sx3(A){throw new yeA.CredentialsProviderError("Response from Amazon Cognito contained no identity ID",{logger:A})}xx3.fromCognitoIdentity=u1B;xx3.fromCognitoIdentityPool=Px3});var l1B=U((p1B)=>{Object.defineProperty(p1B,"__esModule",{value:!0});p1B.fromCognitoIdentity=void 0;var kx3=Ul1(),bx3=(A)=>(0,kx3.fromCognitoIdentity)({...A});p1B.fromCognitoIdentity=bx3});var a1B=U((i1B)=>{Object.defineProperty(i1B,"__esModule",{value:!0});i1B.fromCognitoIdentityPool=void 0;var fx3=Ul1(),hx3=(A)=>(0,fx3.fromCognitoIdentityPool)({...A});i1B.fromCognitoIdentityPool=hx3});var s1B=U((o1B)=>{Object.defineProperty(o1B,"__esModule",{value:!0});o1B.fromContainerMetadata=void 0;var gx3=c1A(),ux3=(A)=>{return A?.logger?.debug("@smithy/credential-provider-imds","fromContainerMetadata"),(0,gx3.fromContainerMetadata)(A)};o1B.fromContainerMetadata=ux3});var A0B=U((t1B)=>{Object.defineProperty(t1B,"__esModule",{value:!0});t1B.fromEnv=void 0;var mx3=vaA(),dx3=(A)=>(0,mx3.fromEnv)(A);t1B.fromEnv=dx3});var G0B=U((Q0B)=>{Object.defineProperty(Q0B,"__esModule",{value:!0});Q0B.fromIni=void 0;var px3=Xb1(),cx3=(A={})=>(0,px3.fromIni)({...A});Q0B.fromIni=cx3});var J0B=U((Z0B)=>{Object.defineProperty(Z0B,"__esModule",{value:!0});Z0B.fromInstanceMetadata=void 0;var lx3=Wq(),ix3=c1A(),nx3=(A)=>{return A?.logger?.debug("@smithy/credential-provider-imds","fromInstanceMetadata"),async()=>(0,ix3.fromInstanceMetadata)(A)().then((Q)=>(0,lx3.setCredentialFeature)(Q,"CREDENTIALS_IMDS","0"))};Z0B.fromInstanceMetadata=nx3});var W0B=U((X0B)=>{Object.defineProperty(X0B,"__esModule",{value:!0});X0B.fromLoginCredentials=void 0;var ax3=gk1(),ox3=(A)=>(0,ax3.fromLoginCredentials)({...A});X0B.fromLoginCredentials=ox3});var ql1=U((D0B)=>{Object.defineProperty(D0B,"__esModule",{value:!0});D0B.fromNodeProviderChain=void 0;var rx3=G0A(),sx3=(A={})=>(0,rx3.defaultProvider)({...A});D0B.fromNodeProviderChain=sx3});var H0B=U((V0B)=>{Object.defineProperty(V0B,"__esModule",{value:!0});V0B.fromProcess=void 0;var tx3=_oA(),ex3=(A)=>(0,tx3.fromProcess)(A);V0B.fromProcess=ex3});var C0B=U((E0B)=>{Object.defineProperty(E0B,"__esModule",{value:!0});E0B.fromSSO=void 0;var Ay3=FoA(),Qy3=(A={})=>{return(0,Ay3.fromSSO)({...A})};E0B.fromSSO=Qy3});var U0B=U((veA)=>{Object.defineProperty(veA,"__esModule",{value:!0});veA.STSClient=veA.AssumeRoleCommand=void 0;var $0B=RoA();Object.defineProperty(veA,"AssumeRoleCommand",{enumerable:!0,get:function(){return $0B.AssumeRoleCommand}});Object.defineProperty(veA,"STSClient",{enumerable:!0,get:function(){return $0B.STSClient}})});var w0B=U((lv)=>{var Gy3=lv&&lv.__createBinding||(Object.create?function(A,Q,B,G){if(G===void 0)G=B;var Z=Object.getOwnPropertyDescriptor(Q,B);if(!Z||("get"in Z?!Q.__esModule:Z.writable||Z.configurable))Z={enumerable:!0,get:function(){return Q[B]}};Object.defineProperty(A,G,Z)}:function(A,Q,B,G){if(G===void 0)G=B;A[G]=Q[B]}),Zy3=lv&&lv.__setModuleDefault||(Object.create?function(A,Q){Object.defineProperty(A,"default",{enumerable:!0,value:Q})}:function(A,Q){A.default=Q}),Yy3=lv&&lv.__importStar||function(){var A=function(Q){return A=Object.getOwnPropertyNames||function(B){var G=[];for(var Z in B)if(Object.prototype.hasOwnProperty.call(B,Z))G[G.length]=Z;return G},A(Q)};return function(Q){if(Q&&Q.__esModule)return Q;var B={};if(Q!=null){for(var G=A(Q),Z=0;Z<G.length;Z++)if(G[Z]!=="default")Gy3(B,Q,G[Z])}return Zy3(B,Q),B}}();Object.defineProperty(lv,"__esModule",{value:!0});lv.fromTemporaryCredentials=void 0;var Jy3=iG(),q0B=TD(),Xy3="us-east-1",Iy3=(A,Q,B)=>{let G;return async(Z={})=>{let{callerClientConfig:Y}=Z,J=A.clientConfig?.profile??Y?.profile,X=A.logger??Y?.logger;X?.debug("@aws-sdk/credential-providers - fromTemporaryCredentials (STS)");let I={...A.params,RoleSessionName:A.params.RoleSessionName??"aws-sdk-js-"+Date.now()};if(I?.SerialNumber){if(!A.mfaCodeProvider)throw new q0B.CredentialsProviderError("Temporary credential requires multi-factor authentication, but no MFA code callback was provided.",{tryNextLink:!1,logger:X});I.TokenCode=await A.mfaCodeProvider(I?.SerialNumber)}let{AssumeRoleCommand:W,STSClient:D}=await Promise.resolve().then(()=>Yy3(U0B()));if(!G){let V=typeof Q==="function"?Q():void 0,F=[A.masterCredentials,A.clientConfig?.credentials,void Y?.credentials,Y?.credentialDefaultProvider?.(),V],H="STS client default credentials";if(F[0])H="options.masterCredentials";else if(F[1])H="options.clientConfig.credentials";else if(F[2])throw H="caller client's credentials",Error("fromTemporaryCredentials recursion in callerClientConfig.credentials");else if(F[3])H="caller client's credentialDefaultProvider";else if(F[4])H="AWS SDK default credentials";let E=[A.clientConfig?.region,Y?.region,await B?.({profile:J}),Xy3],z="default partition's default region";if(E[0])z="options.clientConfig.region";else if(E[1])z="caller client's region";else if(E[2])z="file or env region";let C=[N0B(A.clientConfig?.requestHandler),N0B(Y?.requestHandler)],O="STS default requestHandler";if(C[0])O="options.clientConfig.requestHandler";else if(C[1])O="caller client's requestHandler";X?.debug?.(`@aws-sdk/credential-providers - fromTemporaryCredentials STS client init with ${z}=${await(0,Jy3.normalizeProvider)(keA(E))()}, ${H}, ${O}.`),G=new D({userAgentAppId:Y?.userAgentAppId,...A.clientConfig,credentials:keA(F),logger:X,profile:J,region:keA(E),requestHandler:keA(C)})}if(A.clientPlugins)for(let V of A.clientPlugins)G.middlewareStack.use(V);let{Credentials:K}=await G.send(new W(I));if(!K||!K.AccessKeyId||!K.SecretAccessKey)throw new q0B.CredentialsProviderError(`Invalid response from STS.assumeRole call with role ${I.RoleArn}`,{logger:X});return{accessKeyId:K.AccessKeyId,secretAccessKey:K.SecretAccessKey,sessionToken:K.SessionToken,expiration:K.Expiration,credentialScope:K.CredentialScope}}};lv.fromTemporaryCredentials=Iy3;var N0B=(A)=>{return A?.metadata?.handlerProtocol==="h2"?void 0:A},keA=(A)=>{for(let Q of A)if(Q!==void 0)return Q}});var M0B=U((L0B)=>{Object.defineProperty(L0B,"__esModule",{value:!0});L0B.fromTemporaryCredentials=void 0;var Wy3=wW(),Dy3=Dq(),Ky3=ql1(),Vy3=w0B(),Fy3=(A)=>{return(0,Vy3.fromTemporaryCredentials)(A,Ky3.fromNodeProviderChain,async({profile:Q=process.env.AWS_PROFILE})=>(0,Dy3.loadConfig)({environmentVariableSelector:(B)=>B.AWS_REGION,configFileSelector:(B)=>{return B.region},default:()=>{return}},{...Wy3.NODE_REGION_CONFIG_FILE_OPTIONS,profile:Q})())};L0B.fromTemporaryCredentials=Fy3});var j0B=U((R0B)=>{Object.defineProperty(R0B,"__esModule",{value:!0});R0B.fromTokenFile=void 0;var Hy3=mNA(),Ey3=(A={})=>(0,Hy3.fromTokenFile)({...A});R0B.fromTokenFile=Ey3});var S0B=U((T0B)=>{Object.defineProperty(T0B,"__esModule",{value:!0});T0B.fromWebToken=void 0;var zy3=mNA(),Cy3=(A)=>(0,zy3.fromWebToken)({...A});T0B.fromWebToken=Cy3});var Nl1=U((xH)=>{Object.defineProperty(xH,"__esModule",{value:!0});xH.fromHttp=void 0;var jq=NZ();jq.__exportStar(oeQ(),xH);jq.__exportStar(l1B(),xH);jq.__exportStar(a1B(),xH);jq.__exportStar(s1B(),xH);jq.__exportStar(A0B(),xH);var $y3=haA();Object.defineProperty(xH,"fromHttp",{enumerable:!0,get:function(){return $y3.fromHttp}});jq.__exportStar(G0B(),xH);jq.__exportStar(J0B(),xH);jq.__exportStar(W0B(),xH);jq.__exportStar(ql1(),xH);jq.__exportStar(H0B(),xH);jq.__exportStar(C0B(),xH);jq.__exportStar(M0B(),xH);jq.__exportStar(j0B(),xH);jq.__exportStar(S0B(),xH)});function y0B(A){return A?.name==="CredentialsProviderError"}function v0B(A){if(!A||typeof A!=="object")return!1;let Q=A;if(!Q.Credentials||typeof Q.Credentials!=="object")return!1;let B=Q.Credentials;return typeof B.AccessKeyId==="string"&&typeof B.SecretAccessKey==="string"&&typeof B.SessionToken==="string"&&B.AccessKeyId.length>0&&B.SecretAccessKey.length>0&&B.SessionToken.length>0}async function k0B(){try{k("Clearing AWS credential provider cache"),await x0B.fromIni({ignoreCache:!0})(),k("AWS credential provider cache refreshed")}catch(A){k("Failed to clear AWS credential cache (this is expected if no credentials are configured)")}}var beA,x0B,wl1=async()=>{await new beA.STSClient().send(new beA.GetCallerIdentityCommand({}))};var Ll1=w(()=>{y1();beA=c(neQ(),1),x0B=c(Nl1(),1)});async function b0B(){if(process.platform==="darwin"){let A=Yi();if((await QG(`security delete-generic-password -a $USER -s "${A}"`,{shell:!0,reject:!1})).exitCode!==0)throw Error("Failed to delete keychain entry")}}function WL(A){return A.slice(-20)}var aLA=w(()=>{VqA();oU()});class Tq{static instance=null;status={isAuthenticating:!1,output:[]};listeners=new Set;static getInstance(){if(!Tq.instance)Tq.instance=new Tq;return Tq.instance}getStatus(){return{...this.status,output:[...this.status.output]}}startAuthentication(){this.status={isAuthenticating:!0,output:[]},this.notifyListeners()}addOutput(A){this.status.output.push(A),this.notifyListeners()}setError(A){this.status.error=A,this.notifyListeners()}endAuthentication(A){if(A)this.status={isAuthenticating:!1,output:[]};else this.status.isAuthenticating=!1;this.notifyListeners()}subscribe(A){return this.listeners.add(A),()=>{this.listeners.delete(A)}}notifyListeners(){this.listeners.forEach((A)=>A(this.getStatus()))}static reset(){if(Tq.instance)Tq.instance.listeners.clear(),Tq.instance=null}}import{exec as qy3}from"child_process";function Pq(){let A=i1(process.env.CLAUDE_CODE_USE_BEDROCK)||i1(process.env.CLAUDE_CODE_USE_VERTEX)||i1(process.env.CLAUDE_CODE_USE_FOUNDRY),B=(NQ()||{}).apiKeyHelper,G=process.env.ANTHROPIC_AUTH_TOKEN||B||process.env.CLAUDE_CODE_API_KEY_FILE_DESCRIPTOR,{source:Z}=Rz({skipRetrievingKeyFromApiKeyHelper:!0});return!(A||G||(Z==="ANTHROPIC_API_KEY"||Z==="apiKeyHelper")&&!i1(process.env.CLAUDE_CODE_REMOTE))}function Un(){if(process.env.ANTHROPIC_AUTH_TOKEN)return{source:"ANTHROPIC_AUTH_TOKEN",hasToken:!0};if(process.env.CLAUDE_CODE_OAUTH_TOKEN)return{source:"CLAUDE_CODE_OAUTH_TOKEN",hasToken:!0};if(yj1())return{source:"CLAUDE_CODE_OAUTH_TOKEN_FILE_DESCRIPTOR",hasToken:!0};if(oLA())return{source:"apiKeyHelper",hasToken:!0};let B=f4();if(Vg(B?.scopes)&&B?.accessToken)return{source:"claude.ai",hasToken:!0};return{source:"none",hasToken:!1}}function uw(){let{key:A}=Rz();return A}function u0B(){let{key:A,source:Q}=Rz({skipRetrievingKeyFromApiKeyHelper:!0});return A!==null&&Q!=="none"}function Rz(A={}){if(Hk0()&&process.env.ANTHROPIC_API_KEY)return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};if(i1(!1)){let G=vj1();if(G)return{key:G,source:"ANTHROPIC_API_KEY"};if(!process.env.ANTHROPIC_API_KEY&&!process.env.CLAUDE_CODE_OAUTH_TOKEN&&!process.env.CLAUDE_CODE_OAUTH_TOKEN_FILE_DESCRIPTOR)throw Error("ANTHROPIC_API_KEY or CLAUDE_CODE_OAUTH_TOKEN env var is required");if(process.env.ANTHROPIC_API_KEY)return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};return{key:null,source:"none"}}if(process.env.ANTHROPIC_API_KEY&&R1().customApiKeyResponses?.approved?.includes(WL(process.env.ANTHROPIC_API_KEY)))return{key:process.env.ANTHROPIC_API_KEY,source:"ANTHROPIC_API_KEY"};let Q=vj1();if(Q)return{key:Q,source:"ANTHROPIC_API_KEY"};if(A.skipRetrievingKeyFromApiKeyHelper){if(oLA())return{key:null,source:"apiKeyHelper"}}else{let G=rLA(n2());if(G)return{key:G,source:"apiKeyHelper"}}let B=sLA();if(B)return B;return{key:null,source:"none"}}function oLA(){return(NQ()||{}).apiKeyHelper}function m0B(){let A=oLA();if(!A)return!1;let Q=dB("projectSettings"),B=dB("localSettings");return Q?.apiKeyHelper===A||B?.apiKeyHelper===A}function Ol1(){return(NQ()||{}).awsAuthRefresh}function d0B(){let A=Ol1();if(!A)return!1;let Q=dB("projectSettings"),B=dB("localSettings");return Q?.awsAuthRefresh===A||B?.awsAuthRefresh===A}function Ml1(){return(NQ()||{}).awsCredentialExport}function p0B(){let A=Ml1();if(!A)return!1;let Q=dB("projectSettings"),B=dB("localSettings");return Q?.awsCredentialExport===A||B?.awsCredentialExport===A}function wy3(){let A=process.env.CLAUDE_CODE_API_KEY_HELPER_TTL_MS;if(A){let Q=parseInt(A,10);if(!Number.isNaN(Q)&&Q>=0)return Q;k(`Found CLAUDE_CODE_API_KEY_HELPER_TTL_MS env var, but it was not a valid number. Got ${A}`,{level:"error"})}return Ny3}function heA(){rLA.cache.clear()}function c0B(A){if(oLA()){if(m0B()){if(!QY(!0))return}}rLA(A)}async function Oy3(){let A=Ol1();if(!A)return!1;if(d0B()){if(!QY(!0)&&!n2()){let B=Error(`Security: awsAuthRefresh executed before workspace trust is confirmed. If you see this message, post in ${{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.FEEDBACK_CHANNEL}.`);return zM("awsAuthRefresh invoked before trust check",B),p("tengu_awsAuthRefresh_missing_trust",{}),!1}}try{return k("Fetching AWS caller identity for AWS auth refresh command"),await wl1(),k("Fetched AWS caller identity, skipping AWS auth refresh command"),!1}catch{return Rl1(A)}}function Rl1(A){k("Running AWS auth refresh command");let Q=Tq.getInstance();return Q.startAuthentication(),new Promise((B)=>{let G=qy3(A);G.stdout.on("data",(Z)=>{let Y=Z.toString().trim();if(Y)Q.addOutput(Y),k(Y,{level:"debug"})}),G.stderr.on("data",(Z)=>{let Y=Z.toString().trim();if(Y)Q.setError(Y),k(Y,{level:"error"})}),G.on("close",(Z)=>{if(Z===0)k("AWS auth refresh completed successfully"),Q.endAuthentication(!0),B(!0);else{let Y=W1.red("Error running awsAuthRefresh (in settings or ~/.claude.json):");console.error(Y),Q.endAuthentication(!1),B(!1)}})})}async function My3(){let A=Ml1();if(!A)return null;if(p0B()){if(!QY(!0)&&!n2()){let B=Error(`Security: awsCredentialExport executed before workspace trust is confirmed. If you see this message, post in ${{ISSUES_EXPLAINER:"report the issue at https://github.com/anthropics/claude-code/issues",PACKAGE_URL:"@anthropic-ai/claude-code",README_URL:"https://code.claude.com/docs/en/overview",VERSION:"2.1.5",FEEDBACK_CHANNEL:"https://github.com/anthropics/claude-code/issues",BUILD_TIME:"2026-01-11T21:29:41Z"}.FEEDBACK_CHANNEL}.`);return zM("awsCredentialExport invoked before trust check",B),p("tengu_awsCredentialExport_missing_trust",{}),null}}try{return k("Fetching AWS caller identity for credential export command"),await wl1(),k("Fetched AWS caller identity, skipping AWS credential export command"),null}catch{try{k("Running AWS credential export command");let Q=await QG(A,{shell:!0,reject:!1});if(Q.exitCode!==0||!Q.stdout)throw Error("awsCredentialExport did not return a valid value");let B=QQ(Q.stdout.trim());if(!v0B(B))throw Error("awsCredentialExport did not return valid AWS STS output structure");return k("AWS credentials retrieved from awsCredentialExport"),{accessKeyId:B.Credentials.AccessKeyId,secretAccessKey:B.Credentials.SecretAccessKey,sessionToken:B.Credentials.SessionToken}}catch(Q){let B=W1.red("Error getting AWS credentials from awsCredentialExport (in settings or ~/.claude.json):");if(Q instanceof Error)console.error(B,Q.message);else console.error(B,Q);return null}}}function geA(){g0A.cache.clear()}function l0B(){let A=Ol1(),Q=Ml1();if(!A&&!Q)return;if(d0B()||p0B()){if(!QY(!0)&&!n2())return}g0A(),rX()}function Ry3(A){return/^[a-zA-Z0-9-_]+$/.test(A)}async function pFQ(A){if(!Ry3(A))throw Error("Invalid API key format. API key must contain only alphanumeric characters, dashes, and underscores.");await n0B();let Q=!1;if(process.platform==="darwin")try{let G=Yi(),Z=KqA(),Y=Buffer.from(A,"utf-8").toString("hex"),J=`add-generic-password -U -a "${Z}" -s "${G}" -X "${Y}"
1082:          `]]))[0];return kp8(Y)}throw Error("Unable to execute PowerShell. Ensure that it is installed in your system")}async getToken(A,Q={}){return qX.withSpan(`${this.constructor.name}.getToken`,Q,async()=>{let B=$$(this.tenantId,Q,this.additionallyAllowedTenantIds),G=typeof A==="string"?A:A[0];if(B)nq(vm,B);try{VDA(G,vm),vm.getToken.info(`Using the scope ${G}`);let Z=G81(G),Y=await this.getAzurePowerShellAccessToken(Z,B,this.timeout);return vm.getToken.info(HF(A)),{token:Y.Token,expiresOnTimestamp:new Date(Y.ExpiresOn).getTime(),tokenType:"Bearer"}}catch(Z){if(vp8(Z)){let J=new $4(G70.installed);throw vm.getToken.info(TG(G,J)),J}else if(yp8(Z)){let J=new $4(G70.login);throw vm.getToken.info(TG(G,J)),J}let Y=new $4(`${Z}. ${G70.troubleshoot}`);throw vm.getToken.info(TG(G,Y)),Y}})}}async function kp8(A){let Q=/{[^{}]*}/g,B=A.match(Q),G=A;if(B)try{for(let Z of B)try{let Y=JSON.parse(Z);if(Y===null||Y===void 0?void 0:Y.Token){if(G=G.replace(Z,""),G)vm.getToken.warning(G);return Y}}catch(Y){continue}}catch(Z){throw Error(`Unable to parse the output of PowerShell. Received output: ${A}`)}throw Error(`No access token found in the output. Received output: ${A}`)}var vm,yaB,kaB,G70,yp8=(A)=>A.message.match(`(.*)${kaB.login}(.*)`),vp8=(A)=>A.message.match(kaB.installed),Z70;var baB=w(()=>{xP();kW();FDA();C$();SaB();xL();vm=c7("AzurePowerShellCredential"),yaB=process.platform==="win32";kaB={login:"Run Connect-AzAccount to login",installed:"The specified module 'Az.Accounts' with version '2.2.0' was not loaded because no valid module file was found in any module directory"},G70={login:"Please run 'Connect-AzAccount' from PowerShell to authenticate before using this credential.",installed:`The 'Az.Account' module >= 2.2.0 is not installed. Install the Azure Az PowerShell module with: "Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force".`,troubleshoot:"To troubleshoot, visit https://aka.ms/azsdk/js/identity/powershellcredential/troubleshoot."},Z70=[vaB("pwsh")];if(yaB)Z70.push(vaB("powershell"))});class X70{constructor(...A){this._sources=[],this._sources=A}async getToken(A,Q={}){let{token:B}=await this.getTokenInternal(A,Q);return B}async getTokenInternal(A,Q={}){let B=null,G,Z=[];return qX.withSpan("ChainedTokenCredential.getToken",Q,async(Y)=>{for(let J=0;J<this._sources.length&&B===null;J++)try{B=await this._sources[J].getToken(A,Y),G=this._sources[J]}catch(X){if(X.name==="CredentialUnavailableError"||X.name==="AuthenticationRequiredError")Z.push(X);else throw J70.getToken.info(TG(A,X)),X}if(!B&&Z.length>0){let J=new Q60(Z,"ChainedTokenCredential authentication failed.");throw J70.getToken.info(TG(A,J)),J}if(J70.getToken.info(`Result for ${G.constructor.name}: ${HF(A)}`),B===null)throw new $4("Failed to retrieve a valid token");return{token:B,successfulCredential:G}})}}var J70;var faB=w(()=>{C$();kW();xL();J70=c7("ChainedTokenCredential")});import{createHash as haB,createPrivateKey as bp8}from"node:crypto";import{readFile as fp8}from"node:fs/promises";class I70{constructor(A,Q,B,G={}){if(!A||!Q)throw Error(`${fPA}: tenantId and clientId are required parameters.`);this.tenantId=A,this.additionallyAllowedTenantIds=aq(G===null||G===void 0?void 0:G.additionallyAllowedTenants),this.sendCertificateChain=G.sendCertificateChain,this.certificateConfiguration=Object.assign({},typeof B==="string"?{certificatePath:B}:B);let Z=this.certificateConfiguration.certificate,Y=this.certificateConfiguration.certificatePath;if(!this.certificateConfiguration||!(Z||Y))throw Error(`${fPA}: Provide either a PEM certificate in string form, or the path to that certificate in the filesystem. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);if(Z&&Y)throw Error(`${fPA}: To avoid unexpected behaviors, providing both the contents of a PEM certificate and the path to a PEM certificate is forbidden. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.`);this.msalClient=Uo(Q,A,Object.assign(Object.assign({},G),{logger:gaB,tokenCredentialOptions:G}))}async getToken(A,Q={}){return qX.withSpan(`${fPA}.getToken`,Q,async(B)=>{B.tenantId=$$(this.tenantId,B,this.additionallyAllowedTenantIds,gaB);let G=Array.isArray(A)?A:[A],Z=await this.buildClientCertificate();return this.msalClient.getTokenByClientCertificate(G,Z,B)})}async buildClientCertificate(){var A;let Q=await hp8(this.certificateConfiguration,(A=this.sendCertificateChain)!==null&&A!==void 0?A:!1),B;if(this.certificateConfiguration.certificatePassword!==void 0)B=bp8({key:Q.certificateContents,passphrase:this.certificateConfiguration.certificatePassword,format:"pem"}).export({format:"pem",type:"pkcs8"}).toString();else B=Q.certificateContents;return{thumbprint:Q.thumbprint,thumbprintSha256:Q.thumbprintSha256,privateKey:B,x5c:Q.x5c}}}async function hp8(A,Q){let{certificate:B,certificatePath:G}=A,Z=B||await fp8(G,"utf8"),Y=Q?Z:void 0,J=/(-+BEGIN CERTIFICATE-+)(\n\r?|\r\n?)([A-Za-z0-9+/\n\r]+=*)(\n\r?|\r\n?)(-+END CERTIFICATE-+)/g,X=[],I;do if(I=J.exec(Z),I)X.push(I[3]);while(I);if(X.length===0)throw Error("The file at the specified path does not contain a PEM-encoded certificate.");let W=haB("sha1").update(Buffer.from(X[0],"base64")).digest("hex").toUpperCase(),D=haB("sha256").update(Buffer.from(X[0],"base64")).digest("hex").toUpperCase();return{certificateContents:Z,thumbprintSha256:D,thumbprint:W,x5c:Y}}var fPA="ClientCertificateCredential",gaB;var uaB=w(()=>{kPA();xP();kW();xL();gaB=c7(fPA)});class W70{constructor(A,Q,B,G={}){if(!A)throw new $4("ClientSecretCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!Q)throw new $4("ClientSecretCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");if(!B)throw new $4("ClientSecretCredential: clientSecret is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/serviceprincipalauthentication/troubleshoot.");this.clientSecret=B,this.tenantId=A,this.additionallyAllowedTenantIds=aq(G===null||G===void 0?void 0:G.additionallyAllowedTenants),this.msalClient=Uo(Q,A,Object.assign(Object.assign({},G),{logger:maB,tokenCredentialOptions:G}))}async getToken(A,Q={}){return qX.withSpan(`${this.constructor.name}.getToken`,Q,async(B)=>{B.tenantId=$$(this.tenantId,B,this.additionallyAllowedTenantIds,maB);let G=B81(A);return this.msalClient.getTokenByClientSecret(G,this.clientSecret,B)})}}var maB;var daB=w(()=>{kPA();xP();C$();kW();FDA();xL();maB=c7("ClientSecretCredential")});class D70{constructor(A,Q,B,G,Z={}){if(!A)throw new $4("UsernamePasswordCredential: tenantId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!Q)throw new $4("UsernamePasswordCredential: clientId is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!B)throw new $4("UsernamePasswordCredential: username is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");if(!G)throw new $4("UsernamePasswordCredential: password is a required parameter. To troubleshoot, visit https://aka.ms/azsdk/js/identity/usernamepasswordcredential/troubleshoot.");this.tenantId=A,this.additionallyAllowedTenantIds=aq(Z===null||Z===void 0?void 0:Z.additionallyAllowedTenants),this.username=B,this.password=G,this.msalClient=Uo(Q,this.tenantId,Object.assign(Object.assign({},Z),{tokenCredentialOptions:Z!==null&&Z!==void 0?Z:{}}))}async getToken(A,Q={}){return qX.withSpan(`${this.constructor.name}.getToken`,Q,async(B)=>{B.tenantId=$$(this.tenantId,B,this.additionallyAllowedTenantIds,gp8);let G=B81(A);return this.msalClient.getTokenByUsernamePassword(G,this.username,this.password,B)})}}var gp8;var paB=w(()=>{kPA();xP();C$();kW();FDA();xL();gp8=c7("UsernamePasswordCredential")});function mp8(){var A;return((A=process.env.AZURE_ADDITIONALLY_ALLOWED_TENANTS)!==null&&A!==void 0?A:"").split(";")}function dp8(){var A;let Q=((A=process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN)!==null&&A!==void 0?A:"").toLowerCase(),B=Q==="true"||Q==="1";return km.verbose(`AZURE_CLIENT_SEND_CERTIFICATE_CHAIN: ${process.env.AZURE_CLIENT_SEND_CERTIFICATE_CHAIN}; sendCertificateChain: ${B}`),B}class K70{constructor(A){this._credential=void 0;let Q=l41(up8).assigned.join(", ");km.info(`Found the following environment variables: ${Q}`);let B=process.env.AZURE_TENANT_ID,G=process.env.AZURE_CLIENT_ID,Z=process.env.AZURE_CLIENT_SECRET,Y=mp8(),J=dp8(),X=Object.assign(Object.assign({},A),{additionallyAllowedTenantIds:Y,sendCertificateChain:J});if(B)nq(km,B);if(B&&G&&Z){km.info(`Invoking ClientSecretCredential with tenant ID: ${B}, clientId: ${G} and clientSecret: [REDACTED]`),this._credential=new W70(B,G,Z,X);return}let I=process.env.AZURE_CLIENT_CERTIFICATE_PATH,W=process.env.AZURE_CLIENT_CERTIFICATE_PASSWORD;if(B&&G&&I){km.info(`Invoking ClientCertificateCredential with tenant ID: ${B}, clientId: ${G} and certificatePath: ${I}`),this._credential=new I70(B,G,{certificatePath:I,certificatePassword:W},X);return}let D=process.env.AZURE_USERNAME,K=process.env.AZURE_PASSWORD;if(B&&G&&D&&K)km.info(`Invoking UsernamePasswordCredential with tenant ID: ${B}, clientId: ${G} and username: ${D}`),km.warning("Environment is configured to use username and password authentication. This authentication method is deprecated, as it doesn't support multifactor authentication (MFA). Use a more secure credential. For more details, see https://aka.ms/azsdk/identity/mfa."),this._credential=new D70(B,G,D,K,X)}async getToken(A,Q={}){return qX.withSpan(`${Z81}.getToken`,Q,async(B)=>{if(this._credential)try{let G=await this._credential.getToken(A,B);return km.getToken.info(HF(A)),G}catch(G){let Z=new kjA(400,{error:`${Z81} authentication failed. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`,error_description:G.message.toString().split("More details:").join("")});throw km.getToken.info(TG(A,Z)),Z}throw new $4(`${Z81} is unavailable. No underlying credential could be used. To troubleshoot, visit https://aka.ms/azsdk/js/identity/environmentcredential/troubleshoot.`)})}}var up8,Z81="EnvironmentCredential",km;var caB=w(()=>{C$();kW();uaB();daB();paB();xP();xL();up8=["AZURE_TENANT_ID","AZURE_CLIENT_ID","AZURE_CLIENT_SECRET","AZURE_CLIENT_CERTIFICATE_PATH","AZURE_CLIENT_CERTIFICATE_PASSWORD","AZURE_USERNAME","AZURE_PASSWORD","AZURE_ADDITIONALLY_ALLOWED_TENANTS","AZURE_CLIENT_SEND_CERTIFICATE_CHAIN"];km=c7(Z81)});function pp8(A={}){var Q,B,G,Z;(Q=A.retryOptions)!==null&&Q!==void 0||(A.retryOptions={maxRetries:5,retryDelayInMs:800});let Y=(B=A===null||A===void 0?void 0:A.managedIdentityClientId)!==null&&B!==void 0?B:process.env.AZURE_CLIENT_ID,J=(G=A===null||A===void 0?void 0:A.workloadIdentityClientId)!==null&&G!==void 0?G:Y,X=A===null||A===void 0?void 0:A.managedIdentityResourceId,I=process.env.AZURE_FEDERATED_TOKEN_FILE,W=(Z=A===null||A===void 0?void 0:A.tenantId)!==null&&Z!==void 0?Z:process.env.AZURE_TENANT_ID;if(X){let D=Object.assign(Object.assign({},A),{resourceId:X});return new KDA(D)}if(I&&J){let D=Object.assign(Object.assign({},A),{tenantId:W});return new KDA(J,D)}if(Y){let D=Object.assign(Object.assign({},A),{clientId:Y});return new KDA(D)}return new KDA(A)}function cp8(A){var Q,B,G;let Z=(Q=A===null||A===void 0?void 0:A.managedIdentityClientId)!==null&&Q!==void 0?Q:process.env.AZURE_CLIENT_ID,Y=(B=A===null||A===void 0?void 0:A.workloadIdentityClientId)!==null&&B!==void 0?B:Z,J=process.env.AZURE_FEDERATED_TOKEN_FILE,X=(G=A===null||A===void 0?void 0:A.tenantId)!==null&&G!==void 0?G:process.env.AZURE_TENANT_ID;if(J&&Y){let I=Object.assign(Object.assign({},A),{tenantId:X,clientId:Y,tokenFilePath:J});return new A9A(I)}if(X){let I=Object.assign(Object.assign({},A),{tenantId:X});return new A9A(I)}return new A9A(A)}function lp8(A={}){let Q=A.processTimeoutInMs;return new B70(Object.assign({processTimeoutInMs:Q},A))}function ip8(A={}){let Q=A.processTimeoutInMs;return new Q70(Object.assign({processTimeoutInMs:Q},A))}function np8(A={}){let Q=A.processTimeoutInMs;return new Y70(Object.assign({processTimeoutInMs:Q},A))}function ap8(A={}){return new K70(A)}class laB{constructor(A,Q){this.credentialName=A,this.credentialUnavailableErrorMessage=Q}getToken(){return V70.getToken.info(`Skipping ${this.credentialName}, reason: ${this.credentialUnavailableErrorMessage}`),Promise.resolve(null)}}var V70,Y81;var iaB=w(()=>{LaB();RaB();jaB();baB();faB();caB();t50();kW();V70=c7("DefaultAzureCredential");Y81=class Y81 extends X70{constructor(A){let Q=process.env.AZURE_TOKEN_CREDENTIALS?process.env.AZURE_TOKEN_CREDENTIALS.trim().toLowerCase():void 0,B=[ip8,np8,lp8],G=[ap8,cp8,pp8],Z=[];if(Q)switch(Q){case"dev":Z=B;break;case"prod":Z=G;break;default:{let J=`Invalid value for AZURE_TOKEN_CREDENTIALS = ${process.env.AZURE_TOKEN_CREDENTIALS}. Valid values are 'prod' or 'dev'.`;throw V70.warning(J),Error(J)}}else Z=[...G,...B];let Y=Z.map((J)=>{try{return J(A)}catch(X){return V70.warning(`Skipped ${J.name} because of an error creating the credential: ${X}`),new laB(J.name,X.message)}});super(...Y)}}});function F70(A,Q,B){let{abortSignal:G,tracingOptions:Z}=B||{},Y=cjA();Y.addPolicy(rjA({credential:A,scopes:Q}));async function J(){var X;let W=(X=(await Y.sendRequest({sendRequest:(D)=>Promise.resolve({request:D,status:200,headers:D.headers})},kP({url:"https://example.com",abortSignal:G,tracingOptions:Z}))).headers.get("authorization"))===null||X===void 0?void 0:X.split(" ")[1];if(!W)throw Error("Failed to get access token");return W}return J}var naB=w(()=>{Vm()});var aaB=w(()=>{iaB();naB();tmB()});function J81(){return{error:(A,...Q)=>console.error("[Anthropic SDK ERROR]",A,...Q),warn:(A,...Q)=>console.error("[Anthropic SDK WARN]",A,...Q),info:(A,...Q)=>console.error("[Anthropic SDK INFO]",A,...Q),debug:(A,...Q)=>console.error("[Anthropic SDK DEBUG]",A,...Q)}}async function nH({apiKey:A,maxRetries:Q,model:B,fetchOverride:G}){let Z=process.env.CLAUDE_CODE_CONTAINER_ID,Y=process.env.CLAUDE_CODE_REMOTE_SESSION_ID,J=rp8(),X={"x-app":"cli","User-Agent":Kn(),...J,...Z?{"x-claude-remote-container-id":Z}:{},...Y?{"x-claude-remote-session-id":Y}:{}};if(k(`[API:request] Creating client, ANTHROPIC_CUSTOM_HEADERS present: ${!!process.env.ANTHROPIC_CUSTOM_HEADERS}, has Authorization header: ${!!J.Authorization}`),i1(process.env.CLAUDE_CODE_ADDITIONAL_PROTECTION))X["x-anthropic-additional-protection"]="true";if(k("[API:auth] OAuth token check starting"),await zR(),k("[API:auth] OAuth token check complete"),!OB())op8(X,n2());let W={defaultHeaders:X,maxRetries:Q,timeout:parseInt(process.env.API_TIMEOUT_MS||String(600000),10),dangerouslyAllowBrowser:!0,fetchOptions:XJA(),...G&&{fetch:G}};if(i1(process.env.CLAUDE_CODE_USE_BEDROCK)){let K=B===_W()&&process.env.ANTHROPIC_SMALL_FAST_MODEL_AWS_REGION?process.env.ANTHROPIC_SMALL_FAST_MODEL_AWS_REGION:qAA(),V={...W,awsRegion:K,...i1(process.env.CLAUDE_CODE_SKIP_BEDROCK_AUTH)&&{skipAuth:!0},...$y()&&{logger:J81()}};if(process.env.AWS_BEARER_TOKEN_BEDROCK)V.skipAuth=!0,V.defaultHeaders={...V.defaultHeaders,Authorization:`Bearer ${process.env.AWS_BEARER_TOKEN_BEDROCK}`};else if(!i1(process.env.CLAUDE_CODE_SKIP_BEDROCK_AUTH)){let F=await g0A();if(F)V.awsAccessKey=F.accessKeyId,V.awsSecretKey=F.secretAccessKey,V.awsSessionToken=F.sessionToken}return new u91(V)}if(i1(process.env.CLAUDE_CODE_USE_FOUNDRY)){let K;if(!process.env.ANTHROPIC_FOUNDRY_API_KEY)if(i1(process.env.CLAUDE_CODE_SKIP_FOUNDRY_AUTH))K=()=>Promise.resolve("");else K=F70(new Y81,"https://cognitiveservices.azure.com/.default");let V={...W,...K&&{azureADTokenProvider:K},...$y()&&{logger:J81()}};return new c91(V)}if(i1(process.env.CLAUDE_CODE_USE_VERTEX)){let K=process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project,V=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials,F=i1(process.env.CLAUDE_CODE_SKIP_VERTEX_AUTH)?{getClient:()=>({getRequestHeaders:()=>({})})}:new oaB.GoogleAuth({scopes:["https://www.googleapis.com/auth/cloud-platform"],...K||V?{}:{projectId:process.env.ANTHROPIC_VERTEX_PROJECT_ID}}),H={...W,region:vmA(B),googleAuth:F,...$y()&&{logger:J81()}};return new h41(H)}let D={apiKey:OB()?null:A||uw(),authToken:OB()?f4()?.accessToken:void 0,...{},...W,...$y()&&{logger:J81()}};return new qP(D)}function op8(A,Q){let B=process.env.ANTHROPIC_AUTH_TOKEN||rLA(Q);if(B)A.Authorization=`Bearer ${B}`}function rp8(){let A={},Q=process.env.ANTHROPIC_CUSTOM_HEADERS;if(!Q)return A;let B=Q.split(/\n|\r\n/);for(let G of B){if(!G.trim())continue;let Z=G.match(/^\s*(.*?)\s*:\s*(.*?)\s*$/);if(Z){let[,Y,J]=Z;if(Y&&J!==void 0)A[Y]=J}}return A}var oaB;var qo=w(()=>{mSB();nSB();zk();ahB();aaB();eB();q0();wz();bQ();Wn();ZX();y1();m2();oaB=c(u40(),1)});function H70(A){if(cGA())return iFQ(A);return A}function HDA(A){return A||cGA()}function raB(A){return cGA()&&A.status===429}var hPA=w(()=>{aiA();zk();m2()});function saB(A){return sp8.some((Q)=>A.startsWith(Q))}function taB(A,Q){if(A.isUsingOverage){if(A.overageStatus==="allowed_warning")return{message:"You're close to your extra usage spending limit",severity:"warning"};return null}if(A.status==="rejected")return{message:tp8(A,Q),severity:"error"};if(A.status==="allowed_warning"){if(gT()){let G=E6(),Z=G==="team"||G==="enterprise",Y=O3()?.hasExtraUsageEnabled===!0;if(Z&&Y&&!nv())return null}let B=ep8(A);if(B)return{message:B,severity:"warning"}}return null}function E70(A,Q){let B=taB(A,Q);if(B&&B.severity==="error")return B.message;return null}function z70(A,Q){let B=taB(A,Q);if(B&&B.severity==="warning")return B.message;return null}function tp8(A,Q){let B=A.resetsAt,G=B?WJA(B,!0):void 0,Z=A.overageResetsAt?WJA(A.overageResetsAt,!0):void 0,Y=G?` 路 resets ${G}`:"";if(A.overageStatus==="rejected"){let J="";if(B&&A.overageResetsAt)if(B<A.overageResetsAt)J=` 路 resets ${G}`;else J=` 路 resets ${Z}`;else if(G)J=` 路 resets ${G}`;else if(Z)J=` 路 resets ${Z}`;if(A.overageDisabledReason==="out_of_credits")return`You're out of extra usage${J}`;return EDA("limit",J,Q)}if(A.rateLimitType==="seven_day_sonnet"){let J=E6();return EDA(J==="pro"||J==="enterprise"?"weekly limit":"Sonnet limit",Y,Q)}if(A.rateLimitType==="seven_day_opus")return EDA("Opus limit",Y,Q);if(A.rateLimitType==="seven_day")return EDA("weekly limit",Y,Q);if(A.rateLimitType==="five_hour")return EDA("session limit",Y,Q);return EDA("usage limit",Y,Q)}function ep8(A){let Q=null;switch(A.rateLimitType){case"seven_day":Q="weekly limit";break;case"five_hour":Q="session limit";break;case"seven_day_opus":Q="Opus limit";break;case"seven_day_sonnet":Q="Sonnet limit";break;case"overage":Q="extra usage";break;case void 0:return null}let B=A.utilization?Math.floor(A.utilization*100):void 0,G=A.resetsAt?WJA(A.resetsAt,!0):void 0,Z=Ac8(A.rateLimitType);if(B&&G){let J=`You've used ${B}% of your ${Q} 路 resets ${G}`;return Z?`${J} 路 ${Z}`:J}if(B){let J=`You've used ${B}% of your ${Q}`;return Z?`${J} 路 ${Z}`:J}if(A.rateLimitType==="overage")Q+=" limit";if(G){let J=`Approaching ${Q} 路 resets ${G}`;return Z?`${J} 路 ${Z}`:J}let Y=`Approaching ${Q}`;return Z?`${Y} 路 ${Z}`:Y}function Ac8(A){let Q=E6(),B=O3()?.hasExtraUsageEnabled===!0;if(A==="five_hour"){if(Q==="team"||Q==="enterprise"){if(!B&&Iu())return"/extra-usage to request more";return null}if(Q==="pro"||Q==="max")return"/upgrade to keep using Claude Code"}if(A==="overage"){if(Q==="team"||Q==="enterprise"){if(!B&&Iu())return"/extra-usage to request more"}}return null}function C70(A){let Q=A.resetsAt?WJA(A.resetsAt,!0):"",B="";if(A.rateLimitType==="five_hour")B="session limit";else if(A.rateLimitType==="seven_day")B="weekly limit";else if(A.rateLimitType==="seven_day_opus")B="Opus limit";else if(A.rateLimitType==="seven_day_sonnet"){let Z=E6();B=Z==="pro"||Z==="enterprise"?"weekly limit":"Sonnet limit"}if(!B)return"Now using extra usage";return`You're now using extra usage${Q?` 路 Your ${B} resets ${Q}`:""}`}function EDA(A,Q,B){return`You've hit your ${A}${Q}`}var sp8;var $70=w(()=>{eB();IQ();sp8=["You've hit your","You've used","You're now using extra usage","You're close to","You're out of extra usage"]});function Gc8(A,Q){let B=Date.now()/1000,G=A-Q,Z=B-G;return Math.max(0,Math.min(1,Z/Q))}function X81(A){K_=A,U70.forEach((B)=>B(A));let Q=Math.round((A.resetsAt?A.resetsAt-Date.now()/1000:0)/3600);p("tengu_claudeai_limits_status_changed",{status:A.status,unifiedRateLimitFallbackAvailable:A.unifiedRateLimitFallbackAvailable,hoursTillReset:Q})}async function Zc8(){let A=_W(),Q=await nH({maxRetries:0,model:A}),B=[{role:"user",content:"quota"}],G=TH(A);return Q.beta.messages.create({model:A,max_tokens:1,messages:B,metadata:No(),...G.length>0?{betas:G}:{}}).asResponse()}async function eaB(){if(!HDA(OB()))return;try{let A=await Zc8();q70(A.headers)}catch(A){if(A instanceof C9)N70(A)}}function zDA(){let[A,Q]=I81.useState({...K_});return I81.useEffect(()=>{let B=(G)=>{Q({...G})};return U70.add(B),()=>{U70.delete(B)}},[]),A}function Yc8(A,Q){for(let[B,G]of Object.entries(Bc8)){let Z=A.get(`anthropic-ratelimit-unified-${B}-surpassed-threshold`);if(Z!==null){let Y=A.get(`anthropic-ratelimit-unified-${B}-utilization`),J=A.get(`anthropic-ratelimit-unified-${B}-reset`),X=Y?Number(Y):void 0;return{status:"allowed_warning",resetsAt:J?Number(J):void 0,rateLimitType:G,utilization:X,unifiedRateLimitFallbackAvailable:Q,isUsingOverage:!1,surpassedThreshold:Number(Z)}}}return null}function Jc8(A,Q,B){let{rateLimitType:G,claimAbbrev:Z,windowSeconds:Y,thresholds:J}=Q,X=A.get(`anthropic-ratelimit-unified-${Z}-utilization`),I=A.get(`anthropic-ratelimit-unified-${Z}-reset`);if(X===null||I===null)return null;let W=Number(X),D=Number(I),K=Gc8(D,Y);if(!J.some((F)=>W>=F.utilization&&K<=F.timePct))return null;return{status:"allowed_warning",resetsAt:D,rateLimitType:G,utilization:W,unifiedRateLimitFallbackAvailable:B,isUsingOverage:!1}}function Xc8(A,Q){let B=Yc8(A,Q);if(B)return B;for(let G of Qc8){let Z=Jc8(A,G,Q);if(Z)return Z}return null}function AoB(A){let Q=A.get("anthropic-ratelimit-unified-status")||"allowed",B=A.get("anthropic-ratelimit-unified-reset"),G=B?Number(B):void 0,Z=A.get("anthropic-ratelimit-unified-fallback")==="available",Y=A.get("anthropic-ratelimit-unified-representative-claim"),J=A.get("anthropic-ratelimit-unified-overage-status"),X=A.get("anthropic-ratelimit-unified-overage-reset"),I=X?Number(X):void 0,W=A.get("anthropic-ratelimit-unified-overage-disabled-reason"),D=Q==="rejected"&&(J==="allowed"||J==="allowed_warning"),K=Q;if(Q==="allowed"||Q==="allowed_warning"){let V=Xc8(A,Z);if(V)return V;K="allowed"}return{status:K,resetsAt:G,unifiedRateLimitFallbackAvailable:Z,...Y&&{rateLimitType:Y},...J&&{overageStatus:J},...I&&{overageResetsAt:I},...W&&{overageDisabledReason:W},isUsingOverage:D}}function q70(A){let Q=OB();if(!HDA(Q)){if(K_.status!=="allowed"||K_.resetsAt)X81({status:"allowed",unifiedRateLimitFallbackAvailable:!1,isUsingOverage:!1});return}let B=H70(A),G=AoB(B);if(!fAA(K_,G))X81(G)}function N70(A){if(!HDA(OB())||A.status!==429)return;try{let Q={...K_};if(A.headers){let B=H70(A.headers);Q=AoB(B)}if(Q.status="rejected",!fAA(K_,Q))X81(Q)}catch(Q){s(Q)}}var I81,Qc8,Bc8,K_,U70;var gk=w(()=>{qo();f1();m2();Z0();eB();Mq();zk();WY();RL1();hPA();$70();I81=c(JA(),1),Qc8=[{rateLimitType:"five_hour",claimAbbrev:"5h",windowSeconds:18000,thresholds:[{utilization:0.9,timePct:0.72}]},{rateLimitType:"seven_day",claimAbbrev:"7d",windowSeconds:604800,thresholds:[{utilization:0.75,timePct:0.6},{utilization:0.5,timePct:0.35},{utilization:0.25,timePct:0.15}]}],Bc8={"5h":"five_hour","7d":"seven_day",overage:"overage"};K_={status:"allowed",unifiedRateLimitFallbackAvailable:!1,isUsingOverage:!1},U70=new Set});function gPA(A){if(!A||typeof A!=="object")return null;let Q=A,B=5,G=0;while(Q&&G<B){if(Q instanceof Error&&"code"in Q&&typeof Q.code==="string"){let Z=Q.code,Y=Ic8.has(Z);return{code:Z,message:Q.message,isSSLError:Y}}if(Q instanceof Error&&"cause"in Q&&Q.cause!==Q)Q=Q.cause,G++;else break}return null}function Wc8(A){let Q=A.message;if(!Q)return"";if(Q.includes("<!DOCTYPE html")||Q.includes("<html")){let B=Q.match(/<title>([^<]+)<\/title>/);if(B&&B[1])return B[1].trim();return""}return A.message}function QoB(A){let Q=gPA(A);if(Q){let{code:G,isSSLError:Z}=Q;if(G==="ETIMEDOUT")return"Request timed out. Check your internet connection and proxy settings";if(Z)switch(G){case"UNABLE_TO_VERIFY_LEAF_SIGNATURE":case"UNABLE_TO_GET_ISSUER_CERT":case"UNABLE_TO_GET_ISSUER_CERT_LOCALLY":return"Unable to connect to API: SSL certificate verification failed. Check your proxy or corporate SSL certificates";case"CERT_HAS_EXPIRED":return"Unable to connect to API: SSL certificate has expired";case"CERT_REVOKED":return"Unable to connect to API: SSL certificate has been revoked";case"DEPTH_ZERO_SELF_SIGNED_CERT":case"SELF_SIGNED_CERT_IN_CHAIN":return"Unable to connect to API: Self-signed certificate detected. Check your proxy or corporate SSL certificates";case"ERR_TLS_CERT_ALTNAME_INVALID":case"HOSTNAME_MISMATCH":return"Unable to connect to API: SSL certificate hostname mismatch";case"CERT_NOT_YET_VALID":return"Unable to connect to API: SSL certificate is not yet valid";default:return`Unable to connect to API: SSL error (${G})`}}if(A.message==="Connection error."){if(Q?.code)return`Unable to connect to API (${Q.code})`;return"Unable to connect to API. Check your internet connection"}let B=Wc8(A);return B!==A.message&&B.length>0?B:A.message}async function W81(A,Q){await new Promise((B,G)=>{let Z=setTimeout(B,A);if(Q){let Y=()=>{clearTimeout(Z),G(new BI)};if(Q.aborted){Y();return}Q.addEventListener("abort",Y,{once:!0}),setTimeout(()=>{Q?.removeEventListener("abort",Y)},A)}})}var Ic8;var CDA=w(()=>{zk();Ic8=new Set(["UNABLE_TO_VERIFY_LEAF_SIGNATURE","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","CERT_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CERT_REVOKED","CERT_REJECTED","CERT_UNTRUSTED","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","CERT_CHAIN_TOO_LONG","PATH_LENGTH_EXCEEDED","ERR_TLS_CERT_ALTNAME_INVALID","HOSTNAME_MISMATCH","ERR_TLS_HANDSHAKE_TIMEOUT","ERR_SSL_WRONG_VERSION_NUMBER","ERR_SSL_DECRYPTION_FAILED_OR_BAD_RECORD_MAC"])});var GoB={};U5(GoB,{sharp:()=>BoB,default:()=>Dc8});function BoB(A){let Q=null,B=[],G=0;async function Z(){if(!Q)Q=(async()=>{if(!D81)throw Error("Native image processor module not available");let{processImage:X}=D81;return X(A)})();return Q}function Y(X){for(let I=G;I<B.length;I++){let W=B[I];if(W)W(X)}G=B.length}let J={async metadata(){return(await Z()).metadata()},resize(X,I,W){return B.push((D)=>{D.resize(X,I,W)}),J},jpeg(X){return B.push((I)=>{I.jpeg(X?.quality)}),J},png(X){return B.push((I)=>{I.png(X)}),J},webp(X){return B.push((I)=>{I.webp(X?.quality)}),J},async toBuffer(){let X=await Z();return Y(X),X.toBuffer()}};return J}var D81,Dc8;var ZoB=w(()=>{try{D81=(()=>{throw new Error("Cannot require module "+"../../image-processor.node");})()}catch(A){D81=null}Dc8=BoB});var uk=U((h4Z,JoB)=>{var YoB=function(A){return typeof A<"u"&&A!==null},Kc8=function(A){return typeof A==="object"},Vc8=function(A){return Object.prototype.toString.call(A)==="[object Object]"},Fc8=function(A){return typeof A==="function"},Hc8=function(A){return typeof A==="boolean"},Ec8=function(A){return A instanceof Buffer},zc8=function(A){if(YoB(A))switch(A.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},Cc8=function(A){return A instanceof ArrayBuffer},$c8=function(A){return typeof A==="string"&&A.length>0},Uc8=function(A){return typeof A==="number"&&!Number.isNaN(A)},qc8=function(A){return Number.isInteger(A)},Nc8=function(A,Q,B){return A>=Q&&A<=B},wc8=function(A,Q){return Q.includes(A)},Lc8=function(A,Q,B){return Error(`Expected ${Q} for ${A} but received ${B} of type ${typeof B}`)},Oc8=function(A,Q){return Q.message=A.message,Q};JoB.exports={defined:YoB,object:Kc8,plainObject:Vc8,fn:Fc8,bool:Hc8,buffer:Ec8,typedArray:zc8,arrayBuffer:Cc8,string:$c8,number:Uc8,integer:qc8,inRange:Nc8,inArray:wc8,invalidParameterError:Lc8,nativeError:Oc8}});var WoB=U((g4Z,IoB)=>{var XoB=()=>process.platform==="linux",K81=null,Mc8=()=>{if(!K81)if(XoB()&&process.report){let A=process.report.excludeNetwork;process.report.excludeNetwork=!0,K81=process.report.getReport(),process.report.excludeNetwork=A}else K81={};return K81};IoB.exports={isLinux:XoB,getReport:Mc8}});var VoB=U((u4Z,KoB)=>{var DoB=qA("fs"),Rc8=(A)=>DoB.readFileSync(A,"utf-8"),_c8=(A)=>new Promise((Q,B)=>{DoB.readFile(A,"utf-8",(G,Z)=>{if(G)B(G);else Q(Z)})});KoB.exports={LDD_PATH:"/usr/bin/ldd",readFileSync:Rc8,readFile:_c8}});var F81=U((m4Z,joB)=>{var HoB=qA("child_process"),{isLinux:UDA,getReport:EoB}=WoB(),{LDD_PATH:V81,readFile:zoB,readFileSync:CoB}=VoB(),mk,dk,wo="",$oB=()=>{if(!wo)return new Promise((A)=>{HoB.exec("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",(Q,B)=>{wo=Q?" ":B,A(wo)})});return wo},UoB=()=>{if(!wo)try{wo=HoB.execSync("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",{encoding:"utf8"})}catch(A){wo=" "}return wo},Lo="glibc",qoB=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,$DA="musl",jc8=(A)=>A.includes("libc.musl-")||A.includes("ld-musl-"),NoB=()=>{let A=EoB();if(A.header&&A.header.glibcVersionRuntime)return Lo;if(Array.isArray(A.sharedObjects)){if(A.sharedObjects.some(jc8))return $DA}return null},woB=(A)=>{let[Q,B]=A.split(/[\r\n]+/);if(Q&&Q.includes(Lo))return Lo;if(B&&B.includes($DA))return $DA;return null},LoB=(A)=>{if(A.includes("musl"))return $DA;if(A.includes("GNU C Library"))return Lo;return null},Tc8=async()=>{if(mk!==void 0)return mk;mk=null;try{let A=await zoB(V81);mk=LoB(A)}catch(A){}return mk},Pc8=()=>{if(mk!==void 0)return mk;mk=null;try{let A=CoB(V81);mk=LoB(A)}catch(A){}return mk},OoB=async()=>{let A=null;if(UDA()){if(A=await Tc8(),!A)A=NoB();if(!A){let Q=await $oB();A=woB(Q)}}return A},MoB=()=>{let A=null;if(UDA()){if(A=Pc8(),!A)A=NoB();if(!A){let Q=UoB();A=woB(Q)}}return A},Sc8=async()=>UDA()&&await OoB()!==Lo,xc8=()=>UDA()&&MoB()!==Lo,yc8=async()=>{if(dk!==void 0)return dk;dk=null;try{let Q=(await zoB(V81)).match(qoB);if(Q)dk=Q[1]}catch(A){}return dk},vc8=()=>{if(dk!==void 0)return dk;dk=null;try{let Q=CoB(V81).match(qoB);if(Q)dk=Q[1]}catch(A){}return dk},RoB=()=>{let A=EoB();if(A.header&&A.header.glibcVersionRuntime)return A.header.glibcVersionRuntime;return null},FoB=(A)=>A.trim().split(/\s+/)[1],_oB=(A)=>{let[Q,B,G]=A.split(/[\r\n]+/);if(Q&&Q.includes(Lo))return FoB(Q);if(B&&G&&B.includes($DA))return FoB(G);return null},kc8=async()=>{let A=null;if(UDA()){if(A=await yc8(),!A)A=RoB();if(!A){let Q=await $oB();A=_oB(Q)}}return A},bc8=()=>{let A=null;if(UDA()){if(A=vc8(),!A)A=RoB();if(!A){let Q=UoB();A=_oB(Q)}}return A};joB.exports={GLIBC:Lo,MUSL:$DA,family:OoB,familySync:MoB,isNonGlibcLinux:Sc8,isNonGlibcLinuxSync:xc8,version:kc8,versionSync:bc8}});var uPA=U((d4Z,ToB)=>{var fc8=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...A)=>console.error("SEMVER",...A):()=>{};ToB.exports=fc8});var H81=U((p4Z,PoB)=>{var hc8=Number.MAX_SAFE_INTEGER||9007199254740991,gc8=["major","premajor","minor","preminor","patch","prepatch","prerelease"];PoB.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:hc8,RELEASE_TYPES:gc8,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var mPA=U((pk,SoB)=>{var{MAX_SAFE_COMPONENT_LENGTH:w70,MAX_SAFE_BUILD_LENGTH:uc8,MAX_LENGTH:mc8}=H81(),dc8=uPA();pk=SoB.exports={};var pc8=pk.re=[],cc8=pk.safeRe=[],f2=pk.src=[],lc8=pk.safeSrc=[],h2=pk.t={},ic8=0,L70="[a-zA-Z0-9-]",nc8=[["\\s",1],["\\d",mc8],[L70,uc8]],ac8=(A)=>{for(let[Q,B]of nc8)A=A.split(`${Q}*`).join(`${Q}{0,${B}}`).split(`${Q}+`).join(`${Q}{1,${B}}`);return A},V3=(A,Q,B)=>{let G=ac8(Q),Z=ic8++;dc8(A,Z,Q),h2[A]=Z,f2[Z]=Q,lc8[Z]=G,pc8[Z]=new RegExp(Q,B?"g":void 0),cc8[Z]=new RegExp(G,B?"g":void 0)};V3("NUMERICIDENTIFIER","0|[1-9]\\d*");V3("NUMERICIDENTIFIERLOOSE","\\d+");V3("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${L70}*`);V3("MAINVERSION",`(${f2[h2.NUMERICIDENTIFIER]})\\.(${f2[h2.NUMERICIDENTIFIER]})\\.(${f2[h2.NUMERICIDENTIFIER]})`);V3("MAINVERSIONLOOSE",`(${f2[h2.NUMERICIDENTIFIERLOOSE]})\\.(${f2[h2.NUMERICIDENTIFIERLOOSE]})\\.(${f2[h2.NUMERICIDENTIFIERLOOSE]})`);V3("PRERELEASEIDENTIFIER",`(?:${f2[h2.NUMERICIDENTIFIER]}|${f2[h2.NONNUMERICIDENTIFIER]})`);V3("PRERELEASEIDENTIFIERLOOSE",`(?:${f2[h2.NUMERICIDENTIFIERLOOSE]}|${f2[h2.NONNUMERICIDENTIFIER]})`);V3("PRERELEASE",`(?:-(${f2[h2.PRERELEASEIDENTIFIER]}(?:\\.${f2[h2.PRERELEASEIDENTIFIER]})*))`);V3("PRERELEASELOOSE",`(?:-?(${f2[h2.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${f2[h2.PRERELEASEIDENTIFIERLOOSE]})*))`);V3("BUILDIDENTIFIER",`${L70}+`);V3("BUILD",`(?:\\+(${f2[h2.BUILDIDENTIFIER]}(?:\\.${f2[h2.BUILDIDENTIFIER]})*))`);V3("FULLPLAIN",`v?${f2[h2.MAINVERSION]}${f2[h2.PRERELEASE]}?${f2[h2.BUILD]}?`);V3("FULL",`^${f2[h2.FULLPLAIN]}$`);V3("LOOSEPLAIN",`[v=\\s]*${f2[h2.MAINVERSIONLOOSE]}${f2[h2.PRERELEASELOOSE]}?${f2[h2.BUILD]}?`);V3("LOOSE",`^${f2[h2.LOOSEPLAIN]}$`);V3("GTLT","((?:<|>)?=?)");V3("XRANGEIDENTIFIERLOOSE",`${f2[h2.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);V3("XRANGEIDENTIFIER",`${f2[h2.NUMERICIDENTIFIER]}|x|X|\\*`);V3("XRANGEPLAIN",`[v=\\s]*(${f2[h2.XRANGEIDENTIFIER]})(?:\\.(${f2[h2.XRANGEIDENTIFIER]})(?:\\.(${f2[h2.XRANGEIDENTIFIER]})(?:${f2[h2.PRERELEASE]})?${f2[h2.BUILD]}?)?)?`);V3("XRANGEPLAINLOOSE",`[v=\\s]*(${f2[h2.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f2[h2.XRANGEIDENTIFIERLOOSE]})(?:\\.(${f2[h2.XRANGEIDENTIFIERLOOSE]})(?:${f2[h2.PRERELEASELOOSE]})?${f2[h2.BUILD]}?)?)?`);V3("XRANGE",`^${f2[h2.GTLT]}\\s*${f2[h2.XRANGEPLAIN]}$`);V3("XRANGELOOSE",`^${f2[h2.GTLT]}\\s*${f2[h2.XRANGEPLAINLOOSE]}$`);V3("COERCEPLAIN",`(^|[^\\d])(\\d{1,${w70}})(?:\\.(\\d{1,${w70}}))?(?:\\.(\\d{1,${w70}}))?`);V3("COERCE",`${f2[h2.COERCEPLAIN]}(?:$|[^\\d])`);V3("COERCEFULL",f2[h2.COERCEPLAIN]+`(?:${f2[h2.PRERELEASE]})?(?:${f2[h2.BUILD]})?(?:$|[^\\d])`);V3("COERCERTL",f2[h2.COERCE],!0);V3("COERCERTLFULL",f2[h2.COERCEFULL],!0);V3("LONETILDE","(?:~>?)");V3("TILDETRIM",`(\\s*)${f2[h2.LONETILDE]}\\s+`,!0);pk.tildeTrimReplace="$1~";V3("TILDE",`^${f2[h2.LONETILDE]}${f2[h2.XRANGEPLAIN]}$`);V3("TILDELOOSE",`^${f2[h2.LONETILDE]}${f2[h2.XRANGEPLAINLOOSE]}$`);V3("LONECARET","(?:\\^)");V3("CARETTRIM",`(\\s*)${f2[h2.LONECARET]}\\s+`,!0);pk.caretTrimReplace="$1^";V3("CARET",`^${f2[h2.LONECARET]}${f2[h2.XRANGEPLAIN]}$`);V3("CARETLOOSE",`^${f2[h2.LONECARET]}${f2[h2.XRANGEPLAINLOOSE]}$`);V3("COMPARATORLOOSE",`^${f2[h2.GTLT]}\\s*(${f2[h2.LOOSEPLAIN]})$|^$`);V3("COMPARATOR",`^${f2[h2.GTLT]}\\s*(${f2[h2.FULLPLAIN]})$|^$`);V3("COMPARATORTRIM",`(\\s*)${f2[h2.GTLT]}\\s*(${f2[h2.LOOSEPLAIN]}|${f2[h2.XRANGEPLAIN]})`,!0);pk.comparatorTrimReplace="$1$2$3";V3("HYPHENRANGE",`^\\s*(${f2[h2.XRANGEPLAIN]})\\s+-\\s+(${f2[h2.XRANGEPLAIN]})\\s*$`);V3("HYPHENRANGELOOSE",`^\\s*(${f2[h2.XRANGEPLAINLOOSE]})\\s+-\\s+(${f2[h2.XRANGEPLAINLOOSE]})\\s*$`);V3("STAR","(<|>)?=?\\s*\\*");V3("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");V3("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var E81=U((c4Z,xoB)=>{var oc8=Object.freeze({loose:!0}),rc8=Object.freeze({}),sc8=(A)=>{if(!A)return rc8;if(typeof A!=="object")return oc8;return A};xoB.exports=sc8});var boB=U((l4Z,koB)=>{var yoB=/^[0-9]+$/,voB=(A,Q)=>{let B=yoB.test(A),G=yoB.test(Q);if(B&&G)A=+A,Q=+Q;return A===Q?0:B&&!G?-1:G&&!B?1:A<Q?-1:1},tc8=(A,Q)=>voB(Q,A);koB.exports={compareIdentifiers:voB,rcompareIdentifiers:tc8}});var NDA=U((i4Z,uoB)=>{var z81=uPA(),{MAX_LENGTH:foB,MAX_SAFE_INTEGER:C81}=H81(),{safeRe:hoB,safeSrc:goB,t:$81}=mPA(),ec8=E81(),{compareIdentifiers:qDA}=boB();class pP{constructor(A,Q){if(Q=ec8(Q),A instanceof pP)if(A.loose===!!Q.loose&&A.includePrerelease===!!Q.includePrerelease)return A;else A=A.version;else if(typeof A!=="string")throw TypeError(`Invalid version. Must be a string. Got type "${typeof A}".`);if(A.length>foB)throw TypeError(`version is longer than ${foB} characters`);z81("SemVer",A,Q),this.options=Q,this.loose=!!Q.loose,this.includePrerelease=!!Q.includePrerelease;let B=A.trim().match(Q.loose?hoB[$81.LOOSE]:hoB[$81.FULL]);if(!B)throw TypeError(`Invalid Version: ${A}`);if(this.raw=A,this.major=+B[1],this.minor=+B[2],this.patch=+B[3],this.major>C81||this.major<0)throw TypeError("Invalid major version");if(this.minor>C81||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>C81||this.patch<0)throw TypeError("Invalid patch version");if(!B[4])this.prerelease=[];else this.prerelease=B[4].split(".").map((G)=>{if(/^[0-9]+$/.test(G)){let Z=+G;if(Z>=0&&Z<C81)return Z}return G});this.build=B[5]?B[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare(A){if(z81("SemVer.compare",this.version,this.options,A),!(A instanceof pP)){if(typeof A==="string"&&A===this.version)return 0;A=new pP(A,this.options)}if(A.version===this.version)return 0;return this.compareMain(A)||this.comparePre(A)}compareMain(A){if(!(A instanceof pP))A=new pP(A,this.options);return qDA(this.major,A.major)||qDA(this.minor,A.minor)||qDA(this.patch,A.patch)}comparePre(A){if(!(A instanceof pP))A=new pP(A,this.options);if(this.prerelease.length&&!A.prerelease.length)return-1;else if(!this.prerelease.length&&A.prerelease.length)return 1;else if(!this.prerelease.length&&!A.prerelease.length)return 0;let Q=0;do{let B=this.prerelease[Q],G=A.prerelease[Q];if(z81("prerelease compare",Q,B,G),B===void 0&&G===void 0)return 0;else if(G===void 0)return 1;else if(B===void 0)return-1;else if(B===G)continue;else return qDA(B,G)}while(++Q)}compareBuild(A){if(!(A instanceof pP))A=new pP(A,this.options);let Q=0;do{let B=this.build[Q],G=A.build[Q];if(z81("build compare",Q,B,G),B===void 0&&G===void 0)return 0;else if(G===void 0)return 1;else if(B===void 0)return-1;else if(B===G)continue;else return qDA(B,G)}while(++Q)}inc(A,Q,B){if(A.startsWith("pre")){if(!Q&&B===!1)throw Error("invalid increment argument: identifier is empty");if(Q){let G=new RegExp(`^${this.options.loose?goB[$81.PRERELEASELOOSE]:goB[$81.PRERELEASE]}$`),Z=`-${Q}`.match(G);if(!Z||Z[1]!==Q)throw Error(`invalid identifier: ${Q}`)}}switch(A){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",Q,B);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",Q,B);break;case"prepatch":this.prerelease.length=0,this.inc("patch",Q,B),this.inc("pre",Q,B);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",Q,B);this.inc("pre",Q,B);break;case"release":if(this.prerelease.length===0)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let G=Number(B)?1:0;if(this.prerelease.length===0)this.prerelease=[G];else{let Z=this.prerelease.length;while(--Z>=0)if(typeof this.prerelease[Z]==="number")this.prerelease[Z]++,Z=-2;if(Z===-1){if(Q===this.prerelease.join(".")&&B===!1)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(G)}}if(Q){let Z=[Q,G];if(B===!1)Z=[Q];if(qDA(this.prerelease[0],Q)===0){if(isNaN(this.prerelease[1]))this.prerelease=Z}else this.prerelease=Z}break}default:throw Error(`invalid increment argument: ${A}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}uoB.exports=pP});var poB=U((n4Z,doB)=>{var moB=NDA(),Al8=(A,Q,B=!1)=>{if(A instanceof moB)return A;try{return new moB(A,Q)}catch(G){if(!B)return null;throw G}};doB.exports=Al8});var loB=U((a4Z,coB)=>{var Ql8=NDA(),Bl8=poB(),{safeRe:U81,t:q81}=mPA(),Gl8=(A,Q)=>{if(A instanceof Ql8)return A;if(typeof A==="number")A=String(A);if(typeof A!=="string")return null;Q=Q||{};let B=null;if(!Q.rtl)B=A.match(Q.includePrerelease?U81[q81.COERCEFULL]:U81[q81.COERCE]);else{let I=Q.includePrerelease?U81[q81.COERCERTLFULL]:U81[q81.COERCERTL],W;while((W=I.exec(A))&&(!B||B.index+B[0].length!==A.length)){if(!B||W.index+W[0].length!==B.index+B[0].length)B=W;I.lastIndex=W.index+W[1].length+W[2].length}I.lastIndex=-1}if(B===null)return null;let G=B[2],Z=B[3]||"0",Y=B[4]||"0",J=Q.includePrerelease&&B[5]?`-${B[5]}`:"",X=Q.includePrerelease&&B[6]?`+${B[6]}`:"";return Bl8(`${G}.${Z}.${Y}${J}${X}`,Q)};coB.exports=Gl8});var Q9A=U((o4Z,noB)=>{var ioB=NDA(),Zl8=(A,Q,B)=>new ioB(A,B).compare(new ioB(Q,B));noB.exports=Zl8});var O70=U((r4Z,aoB)=>{var Yl8=Q9A(),Jl8=(A,Q,B)=>Yl8(A,Q,B)>=0;aoB.exports=Jl8});var soB=U((s4Z,roB)=>{class ooB{constructor(){this.max=1000,this.map=new Map}get(A){let Q=this.map.get(A);if(Q===void 0)return;else return this.map.delete(A),this.map.set(A,Q),Q}delete(A){return this.map.delete(A)}set(A,Q){if(!this.delete(A)&&Q!==void 0){if(this.map.size>=this.max){let G=this.map.keys().next().value;this.delete(G)}this.map.set(A,Q)}return this}}roB.exports=ooB});var eoB=U((t4Z,toB)=>{var Xl8=Q9A(),Il8=(A,Q,B)=>Xl8(A,Q,B)===0;toB.exports=Il8});var QrB=U((e4Z,ArB)=>{var Wl8=Q9A(),Dl8=(A,Q,B)=>Wl8(A,Q,B)!==0;ArB.exports=Dl8});var GrB=U((A6Z,BrB)=>{var Kl8=Q9A(),Vl8=(A,Q,B)=>Kl8(A,Q,B)>0;BrB.exports=Vl8});var YrB=U((Q6Z,ZrB)=>{var Fl8=Q9A(),Hl8=(A,Q,B)=>Fl8(A,Q,B)<0;ZrB.exports=Hl8});var XrB=U((B6Z,JrB)=>{var El8=Q9A(),zl8=(A,Q,B)=>El8(A,Q,B)<=0;JrB.exports=zl8});var WrB=U((G6Z,IrB)=>{var Cl8=eoB(),$l8=QrB(),Ul8=GrB(),ql8=O70(),Nl8=YrB(),wl8=XrB(),Ll8=(A,Q,B,G)=>{switch(Q){case"===":if(typeof A==="object")A=A.version;if(typeof B==="object")B=B.version;return A===B;case"!==":if(typeof A==="object")A=A.version;if(typeof B==="object")B=B.version;return A!==B;case"":case"=":case"==":return Cl8(A,B,G);case"!=":return $l8(A,B,G);case">":return Ul8(A,B,G);case">=":return ql8(A,B,G);case"<":return Nl8(A,B,G);case"<=":return wl8(A,B,G);default:throw TypeError(`Invalid operator: ${Q}`)}};IrB.exports=Ll8});var zrB=U((Z6Z,ErB)=>{var dPA=Symbol("SemVer ANY");class N81{static get ANY(){return dPA}constructor(A,Q){if(Q=DrB(Q),A instanceof N81)if(A.loose===!!Q.loose)return A;else A=A.value;if(A=A.trim().split(/\s+/).join(" "),R70("comparator",A,Q),this.options=Q,this.loose=!!Q.loose,this.parse(A),this.semver===dPA)this.value="";else this.value=this.operator+this.semver.version;R70("comp",this)}parse(A){let Q=this.options.loose?KrB[VrB.COMPARATORLOOSE]:KrB[VrB.COMPARATOR],B=A.match(Q);if(!B)throw TypeError(`Invalid comparator: ${A}`);if(this.operator=B[1]!==void 0?B[1]:"",this.operator==="=")this.operator="";if(!B[2])this.semver=dPA;else this.semver=new FrB(B[2],this.options.loose)}toString(){return this.value}test(A){if(R70("Comparator.test",A,this.options.loose),this.semver===dPA||A===dPA)return!0;if(typeof A==="string")try{A=new FrB(A,this.options)}catch(Q){return!1}return M70(A,this.operator,this.semver,this.options)}intersects(A,Q){if(!(A instanceof N81))throw TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new HrB(A.value,Q).test(this.value)}else if(A.operator===""){if(A.value==="")return!0;return new HrB(this.value,Q).test(A.semver)}if(Q=DrB(Q),Q.includePrerelease&&(this.value==="<0.0.0-0"||A.value==="<0.0.0-0"))return!1;if(!Q.includePrerelease&&(this.value.startsWith("<0.0.0")||A.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&A.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&A.operator.startsWith("<"))return!0;if(this.semver.version===A.semver.version&&this.operator.includes("=")&&A.operator.includes("="))return!0;if(M70(this.semver,"<",A.semver,Q)&&this.operator.startsWith(">")&&A.operator.startsWith("<"))return!0;if(M70(this.semver,">",A.semver,Q)&&this.operator.startsWith("<")&&A.operator.startsWith(">"))return!0;return!1}}ErB.exports=N81;var DrB=E81(),{safeRe:KrB,t:VrB}=mPA(),M70=WrB(),R70=uPA(),FrB=NDA(),HrB=_70()});var _70=U((Y6Z,qrB)=>{var Ol8=/\s+/g;class pPA{constructor(A,Q){if(Q=Rl8(Q),A instanceof pPA)if(A.loose===!!Q.loose&&A.includePrerelease===!!Q.includePrerelease)return A;else return new pPA(A.raw,Q);if(A instanceof j70)return this.raw=A.value,this.set=[[A]],this.formatted=void 0,this;if(this.options=Q,this.loose=!!Q.loose,this.includePrerelease=!!Q.includePrerelease,this.raw=A.trim().replace(Ol8," "),this.set=this.raw.split("||").map((B)=>this.parseRange(B.trim())).filter((B)=>B.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let B=this.set[0];if(this.set=this.set.filter((G)=>!$rB(G[0])),this.set.length===0)this.set=[B];else if(this.set.length>1){for(let G of this.set)if(G.length===1&&yl8(G[0])){this.set=[G];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let A=0;A<this.set.length;A++){if(A>0)this.formatted+="||";let Q=this.set[A];for(let B=0;B<Q.length;B++){if(B>0)this.formatted+=" ";this.formatted+=Q[B].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(A){let B=((this.options.includePrerelease&&Sl8)|(this.options.loose&&xl8))+":"+A,G=CrB.get(B);if(G)return G;let Z=this.options.loose,Y=Z?ZN[j$.HYPHENRANGELOOSE]:ZN[j$.HYPHENRANGE];A=A.replace(Y,pl8(this.options.includePrerelease)),wJ("hyphen replace",A),A=A.replace(ZN[j$.COMPARATORTRIM],jl8),wJ("comparator trim",A),A=A.replace(ZN[j$.TILDETRIM],Tl8),wJ("tilde trim",A),A=A.replace(ZN[j$.CARETTRIM],Pl8),wJ("caret trim",A);let J=A.split(" ").map((D)=>vl8(D,this.options)).join(" ").split(/\s+/).map((D)=>dl8(D,this.options));if(Z)J=J.filter((D)=>{return wJ("loose invalid filter",D,this.options),!!D.match(ZN[j$.COMPARATORLOOSE])});wJ("range list",J);let X=new Map,I=J.map((D)=>new j70(D,this.options));for(let D of I){if($rB(D))return[D];X.set(D.value,D)}if(X.size>1&&X.has(""))X.delete("");let W=[...X.values()];return CrB.set(B,W),W}intersects(A,Q){if(!(A instanceof pPA))throw TypeError("a Range is required");return this.set.some((B)=>{return UrB(B,Q)&&A.set.some((G)=>{return UrB(G,Q)&&B.every((Z)=>{return G.every((Y)=>{return Z.intersects(Y,Q)})})})})}test(A){if(!A)return!1;if(typeof A==="string")try{A=new _l8(A,this.options)}catch(Q){return!1}for(let Q=0;Q<this.set.length;Q++)if(cl8(this.set[Q],A,this.options))return!0;return!1}}qrB.exports=pPA;var Ml8=soB(),CrB=new Ml8,Rl8=E81(),j70=zrB(),wJ=uPA(),_l8=NDA(),{safeRe:ZN,t:j$,comparatorTrimReplace:jl8,tildeTrimReplace:Tl8,caretTrimReplace:Pl8}=mPA(),{FLAG_INCLUDE_PRERELEASE:Sl8,FLAG_LOOSE:xl8}=H81(),$rB=(A)=>A.value==="<0.0.0-0",yl8=(A)=>A.value==="",UrB=(A,Q)=>{let B=!0,G=A.slice(),Z=G.pop();while(B&&G.length)B=G.every((Y)=>{return Z.intersects(Y,Q)}),Z=G.pop();return B},vl8=(A,Q)=>{return wJ("comp",A,Q),A=fl8(A,Q),wJ("caret",A),A=kl8(A,Q),wJ("tildes",A),A=gl8(A,Q),wJ("xrange",A),A=ml8(A,Q),wJ("stars",A),A},T$=(A)=>!A||A.toLowerCase()==="x"||A==="*",kl8=(A,Q)=>{return A.trim().split(/\s+/).map((B)=>bl8(B,Q)).join(" ")},bl8=(A,Q)=>{let B=Q.loose?ZN[j$.TILDELOOSE]:ZN[j$.TILDE];return A.replace(B,(G,Z,Y,J,X)=>{wJ("tilde",A,G,Z,Y,J,X);let I;if(T$(Z))I="";else if(T$(Y))I=`>=${Z}.0.0 <${+Z+1}.0.0-0`;else if(T$(J))I=`>=${Z}.${Y}.0 <${Z}.${+Y+1}.0-0`;else if(X)wJ("replaceTilde pr",X),I=`>=${Z}.${Y}.${J}-${X} <${Z}.${+Y+1}.0-0`;else I=`>=${Z}.${Y}.${J} <${Z}.${+Y+1}.0-0`;return wJ("tilde return",I),I})},fl8=(A,Q)=>{return A.trim().split(/\s+/).map((B)=>hl8(B,Q)).join(" ")},hl8=(A,Q)=>{wJ("caret",A,Q);let B=Q.loose?ZN[j$.CARETLOOSE]:ZN[j$.CARET],G=Q.includePrerelease?"-0":"";return A.replace(B,(Z,Y,J,X,I)=>{wJ("caret",A,Z,Y,J,X,I);let W;if(T$(Y))W="";else if(T$(J))W=`>=${Y}.0.0${G} <${+Y+1}.0.0-0`;else if(T$(X))if(Y==="0")W=`>=${Y}.${J}.0${G} <${Y}.${+J+1}.0-0`;else W=`>=${Y}.${J}.0${G} <${+Y+1}.0.0-0`;else if(I)if(wJ("replaceCaret pr",I),Y==="0")if(J==="0")W=`>=${Y}.${J}.${X}-${I} <${Y}.${J}.${+X+1}-0`;else W=`>=${Y}.${J}.${X}-${I} <${Y}.${+J+1}.0-0`;else W=`>=${Y}.${J}.${X}-${I} <${+Y+1}.0.0-0`;else if(wJ("no pr"),Y==="0")if(J==="0")W=`>=${Y}.${J}.${X}${G} <${Y}.${J}.${+X+1}-0`;else W=`>=${Y}.${J}.${X}${G} <${Y}.${+J+1}.0-0`;else W=`>=${Y}.${J}.${X} <${+Y+1}.0.0-0`;return wJ("caret return",W),W})},gl8=(A,Q)=>{return wJ("replaceXRanges",A,Q),A.split(/\s+/).map((B)=>ul8(B,Q)).join(" ")},ul8=(A,Q)=>{A=A.trim();let B=Q.loose?ZN[j$.XRANGELOOSE]:ZN[j$.XRANGE];return A.replace(B,(G,Z,Y,J,X,I)=>{wJ("xRange",A,G,Z,Y,J,X,I);let W=T$(Y),D=W||T$(J),K=D||T$(X),V=K;if(Z==="="&&V)Z="";if(I=Q.includePrerelease?"-0":"",W)if(Z===">"||Z==="<")G="<0.0.0-0";else G="*";else if(Z&&V){if(D)J=0;if(X=0,Z===">")if(Z=">=",D)Y=+Y+1,J=0,X=0;else J=+J+1,X=0;else if(Z==="<=")if(Z="<",D)Y=+Y+1;else J=+J+1;if(Z==="<")I="-0";G=`${Z+Y}.${J}.${X}${I}`}else if(D)G=`>=${Y}.0.0${I} <${+Y+1}.0.0-0`;else if(K)G=`>=${Y}.${J}.0${I} <${Y}.${+J+1}.0-0`;return wJ("xRange return",G),G})},ml8=(A,Q)=>{return wJ("replaceStars",A,Q),A.trim().replace(ZN[j$.STAR],"")},dl8=(A,Q)=>{return wJ("replaceGTE0",A,Q),A.trim().replace(ZN[Q.includePrerelease?j$.GTE0PRE:j$.GTE0],"")},pl8=(A)=>(Q,B,G,Z,Y,J,X,I,W,D,K,V)=>{if(T$(G))B="";else if(T$(Z))B=`>=${G}.0.0${A?"-0":""}`;else if(T$(Y))B=`>=${G}.${Z}.0${A?"-0":""}`;else if(J)B=`>=${B}`;else B=`>=${B}${A?"-0":""}`;if(T$(W))I="";else if(T$(D))I=`<${+W+1}.0.0-0`;else if(T$(K))I=`<${W}.${+D+1}.0-0`;else if(V)I=`<=${W}.${D}.${K}-${V}`;else if(A)I=`<${W}.${D}.${+K+1}-0`;else I=`<=${I}`;return`${B} ${I}`.trim()},cl8=(A,Q,B)=>{for(let G=0;G<A.length;G++)if(!A[G].test(Q))return!1;if(Q.prerelease.length&&!B.includePrerelease){for(let G=0;G<A.length;G++){if(wJ(A[G].semver),A[G].semver===j70.ANY)continue;if(A[G].semver.prerelease.length>0){let Z=A[G].semver;if(Z.major===Q.major&&Z.minor===Q.minor&&Z.patch===Q.patch)return!0}}return!1}return!0}});var wrB=U((J6Z,NrB)=>{var ll8=_70(),il8=(A,Q,B)=>{try{Q=new ll8(Q,B)}catch(G){return!1}return Q.test(A)};NrB.exports=il8});var T70=U((X6Z,nl8)=>{nl8.exports={name:"sharp",description:"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",version:"0.33.5",author:"Lovell Fuller <npm@lovell.info>",homepage:"https://sharp.pixelplumbing.com",contributors:["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb盲ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B眉nemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J茅r茅my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot拧ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci帽o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu茅 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],scripts:{install:"node install/check",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run test-lint && npm run test-unit && npm run test-licensing && npm run test-types","test-lint":"semistandard && cpplint","test-unit":"nyc --reporter=lcov --reporter=text --check-coverage --branches=100 mocha","test-licensing":'license-checker --production --summary --onlyAllow="Apache-2.0;BSD;ISC;LGPL-3.0-or-later;MIT"',"test-leak":"./test/leak/leak.sh","test-types":"tsd","package-from-local-build":"node npm/from-local-build","package-from-github-release":"node npm/from-github-release","docs-build":"node docs/build && node docs/search-index/build","docs-serve":"cd docs && npx serve","docs-publish":"cd docs && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},type:"commonjs",main:"lib/index.js",types:"lib/index.d.ts",files:["install","lib","src/*.{cc,h,gyp}"],repository:{type:"git",url:"git://github.com/lovell/sharp.git"},keywords:["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dependencies:{color:"^4.2.3","detect-libc":"^2.0.3",semver:"^7.6.3"},optionalDependencies:{"@img/sharp-darwin-arm64":"0.33.5","@img/sharp-darwin-x64":"0.33.5","@img/sharp-libvips-darwin-arm64":"1.0.4","@img/sharp-libvips-darwin-x64":"1.0.4","@img/sharp-libvips-linux-arm":"1.0.5","@img/sharp-libvips-linux-arm64":"1.0.4","@img/sharp-libvips-linux-s390x":"1.0.4","@img/sharp-libvips-linux-x64":"1.0.4","@img/sharp-libvips-linuxmusl-arm64":"1.0.4","@img/sharp-libvips-linuxmusl-x64":"1.0.4","@img/sharp-linux-arm":"0.33.5","@img/sharp-linux-arm64":"0.33.5","@img/sharp-linux-s390x":"0.33.5","@img/sharp-linux-x64":"0.33.5","@img/sharp-linuxmusl-arm64":"0.33.5","@img/sharp-linuxmusl-x64":"0.33.5","@img/sharp-wasm32":"0.33.5","@img/sharp-win32-ia32":"0.33.5","@img/sharp-win32-x64":"0.33.5"},devDependencies:{"@emnapi/runtime":"^1.2.0","@img/sharp-libvips-dev":"1.0.4","@img/sharp-libvips-dev-wasm32":"1.0.5","@img/sharp-libvips-win32-ia32":"1.0.4","@img/sharp-libvips-win32-x64":"1.0.4","@types/node":"*",async:"^3.2.5",cc:"^3.0.1",emnapi:"^1.2.0","exif-reader":"^2.0.1","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^8.0.3","license-checker":"^25.0.1",mocha:"^10.7.3","node-addon-api":"^8.1.0",nyc:"^17.0.0",prebuild:"^13.0.1",semistandard:"^17.0.0","tar-fs":"^3.0.6",tsd:"^0.31.1"},license:"Apache-2.0",engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.15.3"},funding:{url:"https://opencollective.com/libvips"},binary:{napi_versions:[9]},semistandard:{env:["mocha"]},cc:{linelength:"120",filter:["build/include"]},nyc:{include:["lib"]},tsd:{directory:"test/types/"}}});var S70=U((I6Z,xrB)=>{var{spawnSync:w81}=qA("node:child_process"),{createHash:al8}=qA("node:crypto"),RrB=loB(),ol8=O70(),rl8=wrB(),LrB=F81(),{config:sl8,engines:OrB,optionalDependencies:tl8}=T70(),el8=process.env.npm_package_config_libvips||sl8.libvips,_rB=RrB(el8).version,Ai8=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-ia32","win32-x64"],L81={encoding:"utf8",shell:!0},Qi8=(A)=>{if(A instanceof Error)console.error(`sharp: Installation error: ${A.message}`);else console.log(`sharp: ${A}`)},jrB=()=>LrB.isNonGlibcLinuxSync()?LrB.familySync():"",Bi8=()=>`${process.platform}${jrB()}-${process.arch}`,wDA=()=>{if(TrB())return"wasm32";let{npm_config_arch:A,npm_config_platform:Q,npm_config_libc:B}=process.env,G=typeof B==="string"?B:jrB();return`${Q||process.platform}${G}-${A||process.arch}`},Gi8=()=>{try{return qA(`@img/sharp-libvips-dev-${wDA()}/include`)}catch{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/include");})()}catch{}}return""},Zi8=()=>{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/cplusplus");})()}catch{}return""},Yi8=()=>{try{return qA(`@img/sharp-libvips-dev-${wDA()}/lib`)}catch{try{return qA(`@img/sharp-libvips-${wDA()}/lib`)}catch{}}return""},Ji8=()=>{if(process.release?.name==="node"&&process.versions){if(!rl8(process.versions.node,OrB.node))return{found:process.versions.node,expected:OrB.node}}},TrB=()=>{let{CC:A}=process.env;return Boolean(A&&A.endsWith("/emcc"))},Xi8=()=>{if(process.platform==="darwin"&&process.arch==="x64")return(w81("sysctl sysctl.proc_translated",L81).stdout||"").trim()==="sysctl.proc_translated: 1";return!1},MrB=(A)=>al8("sha512").update(A).digest("hex"),Ii8=()=>{try{let A=MrB(`imgsharp-libvips-${wDA()}`),Q=RrB(tl8[`@img/sharp-libvips-${wDA()}`]).version;return MrB(`${A}npm:${Q}`).slice(0,10)}catch{}return""},Wi8=()=>w81(`node-gyp rebuild --directory=src ${TrB()?"--nodedir=emscripten":""}`,{...L81,stdio:"inherit"}).status,PrB=()=>{if(process.platform!=="win32")return(w81("pkg-config --modversion vips-cpp",{...L81,env:{...process.env,PKG_CONFIG_PATH:SrB()}}).stdout||"").trim();else return""},SrB=()=>{if(process.platform!=="win32")return[(w81('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',L81).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":");else return""},P70=(A,Q,B)=>{if(B)B(`Detected ${Q}, skipping search for globally-installed libvips`);return A},Di8=(A)=>{if(Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)===!0)return P70(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",A);if(Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)===!0)return P70(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",A);if(Xi8())return P70(!1,"Rosetta",A);let Q=PrB();return!!Q&&ol8(Q,_rB)};xrB.exports={minimumLibvipsVersion:_rB,prebuiltPlatforms:Ai8,buildPlatformArch:wDA,buildSharpLibvipsIncludeDir:Gi8,buildSharpLibvipsCPlusPlusDir:Zi8,buildSharpLibvipsLibDir:Yi8,isUnsupportedNodeRuntime:Ji8,runtimePlatformArch:Bi8,log:Qi8,yarnLocator:Ii8,spawnRebuild:Wi8,globalLibvipsVersion:PrB,pkgConfigPath:SrB,useGlobalLibvips:Di8}});var cPA=U((D6Z,vrB)=>{var{familySync:Ki8,versionSync:Vi8}=F81(),{runtimePlatformArch:Fi8,isUnsupportedNodeRuntime:yrB,prebuiltPlatforms:Hi8,minimumLibvipsVersion:Ei8}=S70(),B9A=Fi8(),zi8=[`../src/build/Release/sharp-${B9A}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${B9A}/sharp.node`,"@img/sharp-wasm32/sharp.node"],x70,O81=[];for(let A of zi8)try{x70=qA(A);break}catch(Q){O81.push(Q)}if(x70)vrB.exports=x70;else{let[A,Q,B]=["linux","darwin","win32"].map((Y)=>B9A.startsWith(Y)),G=[`Could not load the "sharp" module using the ${B9A} runtime`];O81.forEach((Y)=>{if(Y.code!=="MODULE_NOT_FOUND")G.push(`${Y.code}: ${Y.message}`)});let Z=O81.map((Y)=>Y.message).join(" ");if(G.push("Possible solutions:"),yrB()){let{found:Y,expected:J}=yrB();G.push("- Please upgrade Node.js:",`    Found ${Y}`,`    Requires ${J}`)}else if(Hi8.includes(B9A)){let[Y,J]=B9A.split("-"),X=Y.endsWith("musl")?" --libc=musl":"";G.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${Y.replace("musl","")}${X} --cpu=${J} sharp`)}else G.push(`- Manually install libvips >= ${Ei8}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if(A&&/(symbol not found|CXXABI_)/i.test(Z))try{let{config:Y}=qA(`@img/sharp-libvips-${B9A}/package`),J=`${Ki8()} ${Vi8()}`,X=`${Y.musl?"musl":"glibc"} ${Y.musl||Y.glibc}`;G.push("- Update your OS:",`    Found ${J}`,`    Requires ${X}`)}catch(Y){}if(A&&/\/snap\/core[0-9]{2}/.test(Z))G.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node");if(Q&&/Incompatible library version/.test(Z))G.push("- Update Homebrew:","    brew update && brew upgrade vips");if(O81.some((Y)=>Y.code==="ERR_DLOPEN_DISABLED"))G.push("- Run Node.js without using the --no-addons flag");if(B&&/The specified procedure could not be found/.test(Z))G.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp");throw G.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),Error(G.join(`
1083:`))}});var brB=U((V6Z,krB)=>{var Ci8=qA("node:util"),y70=qA("node:stream"),$i8=uk();cPA();var Ui8=Ci8.debuglog("sharp"),G9A=function(A,Q){if(arguments.length===1&&!$i8.defined(A))throw Error("Invalid input");if(!(this instanceof G9A))return new G9A(A,Q);return y70.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],useExifOrientation:!1,angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBeforePreExtract:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:0.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,resolveWithObject:!1,jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],debuglog:(B)=>{this.emit("warning",B),Ui8(B)},queueListener:function(B){G9A.queue.emit("change",B)}},this.options.input=this._createInputDescriptor(A,Q,{allowStream:!0}),this};Object.setPrototypeOf(G9A.prototype,y70.Duplex.prototype);Object.setPrototypeOf(G9A,y70.Duplex);function qi8(){let A=this.constructor.call(),{debuglog:Q,queueListener:B,...G}=this.options;if(A.options=structuredClone(G),A.options.debuglog=Q,A.options.queueListener=B,this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),A.options.input.buffer=this.options.input.buffer,A.emit("finish")});return A}Object.assign(G9A.prototype,{clone:qi8});krB.exports=G9A});var v70=U((F6Z,frB)=>{frB.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var grB=U((H6Z,hrB)=>{hrB.exports=function(Q){if(!Q||typeof Q==="string")return!1;return Q instanceof Array||Array.isArray(Q)||Q.length>=0&&(Q.splice instanceof Function||Object.getOwnPropertyDescriptor(Q,Q.length-1)&&Q.constructor.name!=="String")}});var drB=U((E6Z,mrB)=>{var Ni8=grB(),wi8=Array.prototype.concat,Li8=Array.prototype.slice,urB=mrB.exports=function(Q){var B=[];for(var G=0,Z=Q.length;G<Z;G++){var Y=Q[G];if(Ni8(Y))B=wi8.call(B,Li8.call(Y));else B.push(Y)}return B};urB.wrap=function(A){return function(){return A(urB(arguments))}}});var irB=U((z6Z,lrB)=>{var iPA=v70(),nPA=drB(),prB=Object.hasOwnProperty,crB=Object.create(null);for(lPA in iPA)if(prB.call(iPA,lPA))crB[iPA[lPA]]=lPA;var lPA,hL=lrB.exports={to:{},get:{}};hL.get=function(A){var Q=A.substring(0,3).toLowerCase(),B,G;switch(Q){case"hsl":B=hL.get.hsl(A),G="hsl";break;case"hwb":B=hL.get.hwb(A),G="hwb";break;default:B=hL.get.rgb(A),G="rgb";break}if(!B)return null;return{model:G,value:B}};hL.get.rgb=function(A){if(!A)return null;var Q=/^#([a-f0-9]{3,4})$/i,B=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,G=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Z=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,Y=/^(\w+)$/,J=[0,0,0,1],X,I,W;if(X=A.match(B)){W=X[2],X=X[1];for(I=0;I<3;I++){var D=I*2;J[I]=parseInt(X.slice(D,D+2),16)}if(W)J[3]=parseInt(W,16)/255}else if(X=A.match(Q)){X=X[1],W=X[3];for(I=0;I<3;I++)J[I]=parseInt(X[I]+X[I],16);if(W)J[3]=parseInt(W+W,16)/255}else if(X=A.match(G)){for(I=0;I<3;I++)J[I]=parseInt(X[I+1],0);if(X[4])if(X[5])J[3]=parseFloat(X[4])*0.01;else J[3]=parseFloat(X[4])}else if(X=A.match(Z)){for(I=0;I<3;I++)J[I]=Math.round(parseFloat(X[I+1])*2.55);if(X[4])if(X[5])J[3]=parseFloat(X[4])*0.01;else J[3]=parseFloat(X[4])}else if(X=A.match(Y)){if(X[1]==="transparent")return[0,0,0,0];if(!prB.call(iPA,X[1]))return null;return J=iPA[X[1]],J[3]=1,J}else return null;for(I=0;I<3;I++)J[I]=Oo(J[I],0,255);return J[3]=Oo(J[3],0,1),J};hL.get.hsl=function(A){if(!A)return null;var Q=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,B=A.match(Q);if(B){var G=parseFloat(B[4]),Z=(parseFloat(B[1])%360+360)%360,Y=Oo(parseFloat(B[2]),0,100),J=Oo(parseFloat(B[3]),0,100),X=Oo(isNaN(G)?1:G,0,1);return[Z,Y,J,X]}return null};hL.get.hwb=function(A){if(!A)return null;var Q=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,B=A.match(Q);if(B){var G=parseFloat(B[4]),Z=(parseFloat(B[1])%360+360)%360,Y=Oo(parseFloat(B[2]),0,100),J=Oo(parseFloat(B[3]),0,100),X=Oo(isNaN(G)?1:G,0,1);return[Z,Y,J,X]}return null};hL.to.hex=function(){var A=nPA(arguments);return"#"+M81(A[0])+M81(A[1])+M81(A[2])+(A[3]<1?M81(Math.round(A[3]*255)):"")};hL.to.rgb=function(){var A=nPA(arguments);return A.length<4||A[3]===1?"rgb("+Math.round(A[0])+", "+Math.round(A[1])+", "+Math.round(A[2])+")":"rgba("+Math.round(A[0])+", "+Math.round(A[1])+", "+Math.round(A[2])+", "+A[3]+")"};hL.to.rgb.percent=function(){var A=nPA(arguments),Q=Math.round(A[0]/255*100),B=Math.round(A[1]/255*100),G=Math.round(A[2]/255*100);return A.length<4||A[3]===1?"rgb("+Q+"%, "+B+"%, "+G+"%)":"rgba("+Q+"%, "+B+"%, "+G+"%, "+A[3]+")"};hL.to.hsl=function(){var A=nPA(arguments);return A.length<4||A[3]===1?"hsl("+A[0]+", "+A[1]+"%, "+A[2]+"%)":"hsla("+A[0]+", "+A[1]+"%, "+A[2]+"%, "+A[3]+")"};hL.to.hwb=function(){var A=nPA(arguments),Q="";if(A.length>=4&&A[3]!==1)Q=", "+A[3];return"hwb("+A[0]+", "+A[1]+"%, "+A[2]+"%"+Q+")"};hL.to.keyword=function(A){return crB[A.slice(0,3)]};function Oo(A,Q,B){return Math.min(Math.max(Q,A),B)}function M81(A){var Q=Math.round(A).toString(16).toUpperCase();return Q.length<2?"0"+Q:Q}});var k70=U((C6Z,arB)=>{var aPA=v70(),nrB={};for(let A of Object.keys(aPA))nrB[aPA[A]]=A;var q9={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};arB.exports=q9;for(let A of Object.keys(q9)){if(!("channels"in q9[A]))throw Error("missing channels property: "+A);if(!("labels"in q9[A]))throw Error("missing channel labels property: "+A);if(q9[A].labels.length!==q9[A].channels)throw Error("channel and label counts mismatch: "+A);let{channels:Q,labels:B}=q9[A];delete q9[A].channels,delete q9[A].labels,Object.defineProperty(q9[A],"channels",{value:Q}),Object.defineProperty(q9[A],"labels",{value:B})}q9.rgb.hsl=function(A){let Q=A[0]/255,B=A[1]/255,G=A[2]/255,Z=Math.min(Q,B,G),Y=Math.max(Q,B,G),J=Y-Z,X,I;if(Y===Z)X=0;else if(Q===Y)X=(B-G)/J;else if(B===Y)X=2+(G-Q)/J;else if(G===Y)X=4+(Q-B)/J;if(X=Math.min(X*60,360),X<0)X+=360;let W=(Z+Y)/2;if(Y===Z)I=0;else if(W<=0.5)I=J/(Y+Z);else I=J/(2-Y-Z);return[X,I*100,W*100]};q9.rgb.hsv=function(A){let Q,B,G,Z,Y,J=A[0]/255,X=A[1]/255,I=A[2]/255,W=Math.max(J,X,I),D=W-Math.min(J,X,I),K=function(V){return(W-V)/6/D+0.5};if(D===0)Z=0,Y=0;else{if(Y=D/W,Q=K(J),B=K(X),G=K(I),J===W)Z=G-B;else if(X===W)Z=0.3333333333333333+Q-G;else if(I===W)Z=0.6666666666666666+B-Q;if(Z<0)Z+=1;else if(Z>1)Z-=1}return[Z*360,Y*100,W*100]};q9.rgb.hwb=function(A){let Q=A[0],B=A[1],G=A[2],Z=q9.rgb.hsl(A)[0],Y=0.00392156862745098*Math.min(Q,Math.min(B,G));return G=1-0.00392156862745098*Math.max(Q,Math.max(B,G)),[Z,Y*100,G*100]};q9.rgb.cmyk=function(A){let Q=A[0]/255,B=A[1]/255,G=A[2]/255,Z=Math.min(1-Q,1-B,1-G),Y=(1-Q-Z)/(1-Z)||0,J=(1-B-Z)/(1-Z)||0,X=(1-G-Z)/(1-Z)||0;return[Y*100,J*100,X*100,Z*100]};function Oi8(A,Q){return(A[0]-Q[0])**2+(A[1]-Q[1])**2+(A[2]-Q[2])**2}q9.rgb.keyword=function(A){let Q=nrB[A];if(Q)return Q;let B=1/0,G;for(let Z of Object.keys(aPA)){let Y=aPA[Z],J=Oi8(A,Y);if(J<B)B=J,G=Z}return G};q9.keyword.rgb=function(A){return aPA[A]};q9.rgb.xyz=function(A){let Q=A[0]/255,B=A[1]/255,G=A[2]/255;Q=Q>0.04045?((Q+0.055)/1.055)**2.4:Q/12.92,B=B>0.04045?((B+0.055)/1.055)**2.4:B/12.92,G=G>0.04045?((G+0.055)/1.055)**2.4:G/12.92;let Z=Q*0.4124+B*0.3576+G*0.1805,Y=Q*0.2126+B*0.7152+G*0.0722,J=Q*0.0193+B*0.1192+G*0.9505;return[Z*100,Y*100,J*100]};q9.rgb.lab=function(A){let Q=q9.rgb.xyz(A),B=Q[0],G=Q[1],Z=Q[2];B/=95.047,G/=100,Z/=108.883,B=B>0.008856?B**0.3333333333333333:7.787*B+0.13793103448275862,G=G>0.008856?G**0.3333333333333333:7.787*G+0.13793103448275862,Z=Z>0.008856?Z**0.3333333333333333:7.787*Z+0.13793103448275862;let Y=116*G-16,J=500*(B-G),X=200*(G-Z);return[Y,J,X]};q9.hsl.rgb=function(A){let Q=A[0]/360,B=A[1]/100,G=A[2]/100,Z,Y,J;if(B===0)return J=G*255,[J,J,J];if(G<0.5)Z=G*(1+B);else Z=G+B-G*B;let X=2*G-Z,I=[0,0,0];for(let W=0;W<3;W++){if(Y=Q+0.3333333333333333*-(W-1),Y<0)Y++;if(Y>1)Y--;if(6*Y<1)J=X+(Z-X)*6*Y;else if(2*Y<1)J=Z;else if(3*Y<2)J=X+(Z-X)*(0.6666666666666666-Y)*6;else J=X;I[W]=J*255}return I};q9.hsl.hsv=function(A){let Q=A[0],B=A[1]/100,G=A[2]/100,Z=B,Y=Math.max(G,0.01);G*=2,B*=G<=1?G:2-G,Z*=Y<=1?Y:2-Y;let J=(G+B)/2,X=G===0?2*Z/(Y+Z):2*B/(G+B);return[Q,X*100,J*100]};q9.hsv.rgb=function(A){let Q=A[0]/60,B=A[1]/100,G=A[2]/100,Z=Math.floor(Q)%6,Y=Q-Math.floor(Q),J=255*G*(1-B),X=255*G*(1-B*Y),I=255*G*(1-B*(1-Y));switch(G*=255,Z){case 0:return[G,I,J];case 1:return[X,G,J];case 2:return[J,G,I];case 3:return[J,X,G];case 4:return[I,J,G];case 5:return[G,J,X]}};q9.hsv.hsl=function(A){let Q=A[0],B=A[1]/100,G=A[2]/100,Z=Math.max(G,0.01),Y,J;J=(2-B)*G;let X=(2-B)*Z;return Y=B*Z,Y/=X<=1?X:2-X,Y=Y||0,J/=2,[Q,Y*100,J*100]};q9.hwb.rgb=function(A){let Q=A[0]/360,B=A[1]/100,G=A[2]/100,Z=B+G,Y;if(Z>1)B/=Z,G/=Z;let J=Math.floor(6*Q),X=1-G;if(Y=6*Q-J,(J&1)!==0)Y=1-Y;let I=B+Y*(X-B),W,D,K;switch(J){default:case 6:case 0:W=X,D=I,K=B;break;case 1:W=I,D=X,K=B;break;case 2:W=B,D=X,K=I;break;case 3:W=B,D=I,K=X;break;case 4:W=I,D=B,K=X;break;case 5:W=X,D=B,K=I;break}return[W*255,D*255,K*255]};q9.cmyk.rgb=function(A){let Q=A[0]/100,B=A[1]/100,G=A[2]/100,Z=A[3]/100,Y=1-Math.min(1,Q*(1-Z)+Z),J=1-Math.min(1,B*(1-Z)+Z),X=1-Math.min(1,G*(1-Z)+Z);return[Y*255,J*255,X*255]};q9.xyz.rgb=function(A){let Q=A[0]/100,B=A[1]/100,G=A[2]/100,Z,Y,J;return Z=Q*3.2406+B*-1.5372+G*-0.4986,Y=Q*-0.9689+B*1.8758+G*0.0415,J=Q*0.0557+B*-0.204+G*1.057,Z=Z>0.0031308?1.055*Z**0.4166666666666667-0.055:Z*12.92,Y=Y>0.0031308?1.055*Y**0.4166666666666667-0.055:Y*12.92,J=J>0.0031308?1.055*J**0.4166666666666667-0.055:J*12.92,Z=Math.min(Math.max(0,Z),1),Y=Math.min(Math.max(0,Y),1),J=Math.min(Math.max(0,J),1),[Z*255,Y*255,J*255]};q9.xyz.lab=function(A){let Q=A[0],B=A[1],G=A[2];Q/=95.047,B/=100,G/=108.883,Q=Q>0.008856?Q**0.3333333333333333:7.787*Q+0.13793103448275862,B=B>0.008856?B**0.3333333333333333:7.787*B+0.13793103448275862,G=G>0.008856?G**0.3333333333333333:7.787*G+0.13793103448275862;let Z=116*B-16,Y=500*(Q-B),J=200*(B-G);return[Z,Y,J]};q9.lab.xyz=function(A){let Q=A[0],B=A[1],G=A[2],Z,Y,J;Y=(Q+16)/116,Z=B/500+Y,J=Y-G/200;let X=Y**3,I=Z**3,W=J**3;return Y=X>0.008856?X:(Y-0.13793103448275862)/7.787,Z=I>0.008856?I:(Z-0.13793103448275862)/7.787,J=W>0.008856?W:(J-0.13793103448275862)/7.787,Z*=95.047,Y*=100,J*=108.883,[Z,Y,J]};q9.lab.lch=function(A){let Q=A[0],B=A[1],G=A[2],Z;if(Z=Math.atan2(G,B)*360/2/Math.PI,Z<0)Z+=360;let J=Math.sqrt(B*B+G*G);return[Q,J,Z]};q9.lch.lab=function(A){let Q=A[0],B=A[1],Z=A[2]/360*2*Math.PI,Y=B*Math.cos(Z),J=B*Math.sin(Z);return[Q,Y,J]};q9.rgb.ansi16=function(A,Q=null){let[B,G,Z]=A,Y=Q===null?q9.rgb.hsv(A)[2]:Q;if(Y=Math.round(Y/50),Y===0)return 30;let J=30+(Math.round(Z/255)<<2|Math.round(G/255)<<1|Math.round(B/255));if(Y===2)J+=60;return J};q9.hsv.ansi16=function(A){return q9.rgb.ansi16(q9.hsv.rgb(A),A[2])};q9.rgb.ansi256=function(A){let Q=A[0],B=A[1],G=A[2];if(Q===B&&B===G){if(Q<8)return 16;if(Q>248)return 231;return Math.round((Q-8)/247*24)+232}return 16+36*Math.round(Q/255*5)+6*Math.round(B/255*5)+Math.round(G/255*5)};q9.ansi16.rgb=function(A){let Q=A%10;if(Q===0||Q===7){if(A>50)Q+=3.5;return Q=Q/10.5*255,[Q,Q,Q]}let B=(~~(A>50)+1)*0.5,G=(Q&1)*B*255,Z=(Q>>1&1)*B*255,Y=(Q>>2&1)*B*255;return[G,Z,Y]};q9.ansi256.rgb=function(A){if(A>=232){let Y=(A-232)*10+8;return[Y,Y,Y]}A-=16;let Q,B=Math.floor(A/36)/5*255,G=Math.floor((Q=A%36)/6)/5*255,Z=Q%6/5*255;return[B,G,Z]};q9.rgb.hex=function(A){let B=(((Math.round(A[0])&255)<<16)+((Math.round(A[1])&255)<<8)+(Math.round(A[2])&255)).toString(16).toUpperCase();return"000000".substring(B.length)+B};q9.hex.rgb=function(A){let Q=A.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!Q)return[0,0,0];let B=Q[0];if(Q[0].length===3)B=B.split("").map((X)=>{return X+X}).join("");let G=parseInt(B,16),Z=G>>16&255,Y=G>>8&255,J=G&255;return[Z,Y,J]};q9.rgb.hcg=function(A){let Q=A[0]/255,B=A[1]/255,G=A[2]/255,Z=Math.max(Math.max(Q,B),G),Y=Math.min(Math.min(Q,B),G),J=Z-Y,X,I;if(J<1)X=Y/(1-J);else X=0;if(J<=0)I=0;else if(Z===Q)I=(B-G)/J%6;else if(Z===B)I=2+(G-Q)/J;else I=4+(Q-B)/J;return I/=6,I%=1,[I*360,J*100,X*100]};q9.hsl.hcg=function(A){let Q=A[1]/100,B=A[2]/100,G=B<0.5?2*Q*B:2*Q*(1-B),Z=0;if(G<1)Z=(B-0.5*G)/(1-G);return[A[0],G*100,Z*100]};q9.hsv.hcg=function(A){let Q=A[1]/100,B=A[2]/100,G=Q*B,Z=0;if(G<1)Z=(B-G)/(1-G);return[A[0],G*100,Z*100]};q9.hcg.rgb=function(A){let Q=A[0]/360,B=A[1]/100,G=A[2]/100;if(B===0)return[G*255,G*255,G*255];let Z=[0,0,0],Y=Q%1*6,J=Y%1,X=1-J,I=0;switch(Math.floor(Y)){case 0:Z[0]=1,Z[1]=J,Z[2]=0;break;case 1:Z[0]=X,Z[1]=1,Z[2]=0;break;case 2:Z[0]=0,Z[1]=1,Z[2]=J;break;case 3:Z[0]=0,Z[1]=X,Z[2]=1;break;case 4:Z[0]=J,Z[1]=0,Z[2]=1;break;default:Z[0]=1,Z[1]=0,Z[2]=X}return I=(1-B)*G,[(B*Z[0]+I)*255,(B*Z[1]+I)*255,(B*Z[2]+I)*255]};q9.hcg.hsv=function(A){let Q=A[1]/100,B=A[2]/100,G=Q+B*(1-Q),Z=0;if(G>0)Z=Q/G;return[A[0],Z*100,G*100]};q9.hcg.hsl=function(A){let Q=A[1]/100,G=A[2]/100*(1-Q)+0.5*Q,Z=0;if(G>0&&G<0.5)Z=Q/(2*G);else if(G>=0.5&&G<1)Z=Q/(2*(1-G));return[A[0],Z*100,G*100]};q9.hcg.hwb=function(A){let Q=A[1]/100,B=A[2]/100,G=Q+B*(1-Q);return[A[0],(G-Q)*100,(1-G)*100]};q9.hwb.hcg=function(A){let Q=A[1]/100,G=1-A[2]/100,Z=G-Q,Y=0;if(Z<1)Y=(G-Z)/(1-Z);return[A[0],Z*100,Y*100]};q9.apple.rgb=function(A){return[A[0]/65535*255,A[1]/65535*255,A[2]/65535*255]};q9.rgb.apple=function(A){return[A[0]/255*65535,A[1]/255*65535,A[2]/255*65535]};q9.gray.rgb=function(A){return[A[0]/100*255,A[0]/100*255,A[0]/100*255]};q9.gray.hsl=function(A){return[0,0,A[0]]};q9.gray.hsv=q9.gray.hsl;q9.gray.hwb=function(A){return[0,100,A[0]]};q9.gray.cmyk=function(A){return[0,0,0,A[0]]};q9.gray.lab=function(A){return[A[0],0,0]};q9.gray.hex=function(A){let Q=Math.round(A[0]/100*255)&255,G=((Q<<16)+(Q<<8)+Q).toString(16).toUpperCase();return"000000".substring(G.length)+G};q9.rgb.gray=function(A){return[(A[0]+A[1]+A[2])/3/255*100]}});var rrB=U(($6Z,orB)=>{var R81=k70();function Mi8(){let A={},Q=Object.keys(R81);for(let B=Q.length,G=0;G<B;G++)A[Q[G]]={distance:-1,parent:null};return A}function Ri8(A){let Q=Mi8(),B=[A];Q[A].distance=0;while(B.length){let G=B.pop(),Z=Object.keys(R81[G]);for(let Y=Z.length,J=0;J<Y;J++){let X=Z[J],I=Q[X];if(I.distance===-1)I.distance=Q[G].distance+1,I.parent=G,B.unshift(X)}}return Q}function _i8(A,Q){return function(B){return Q(A(B))}}function ji8(A,Q){let B=[Q[A].parent,A],G=R81[Q[A].parent][A],Z=Q[A].parent;while(Q[Z].parent)B.unshift(Q[Z].parent),G=_i8(R81[Q[Z].parent][Z],G),Z=Q[Z].parent;return G.conversion=B,G}orB.exports=function(A){let Q=Ri8(A),B={},G=Object.keys(Q);for(let Z=G.length,Y=0;Y<Z;Y++){let J=G[Y];if(Q[J].parent===null)continue;B[J]=ji8(J,Q)}return B}});var f70=U((U6Z,srB)=>{var b70=k70(),Ti8=rrB(),LDA={},Pi8=Object.keys(b70);function Si8(A){let Q=function(...B){let G=B[0];if(G===void 0||G===null)return G;if(G.length>1)B=G;return A(B)};if("conversion"in A)Q.conversion=A.conversion;return Q}function xi8(A){let Q=function(...B){let G=B[0];if(G===void 0||G===null)return G;if(G.length>1)B=G;let Z=A(B);if(typeof Z==="object")for(let Y=Z.length,J=0;J<Y;J++)Z[J]=Math.round(Z[J]);return Z};if("conversion"in A)Q.conversion=A.conversion;return Q}Pi8.forEach((A)=>{LDA[A]={},Object.defineProperty(LDA[A],"channels",{value:b70[A].channels}),Object.defineProperty(LDA[A],"labels",{value:b70[A].labels});let Q=Ti8(A);Object.keys(Q).forEach((G)=>{let Z=Q[G];LDA[A][G]=xi8(Z),LDA[A][G].raw=Si8(Z)})});srB.exports=LDA});var j81=U((q6Z,erB)=>{var ODA=irB(),gL=f70(),trB=["keyword","gray","hex"],h70={};for(let A of Object.keys(gL))h70[[...gL[A].labels].sort().join("")]=A;var _81={};function EF(A,Q){if(!(this instanceof EF))return new EF(A,Q);if(Q&&Q in trB)Q=null;if(Q&&!(Q in gL))throw Error("Unknown model: "+Q);let B,G;if(A==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(A instanceof EF)this.model=A.model,this.color=[...A.color],this.valpha=A.valpha;else if(typeof A==="string"){let Z=ODA.get(A);if(Z===null)throw Error("Unable to parse color from string: "+A);this.model=Z.model,G=gL[this.model].channels,this.color=Z.value.slice(0,G),this.valpha=typeof Z.value[G]==="number"?Z.value[G]:1}else if(A.length>0){this.model=Q||"rgb",G=gL[this.model].channels;let Z=Array.prototype.slice.call(A,0,G);this.color=g70(Z,G),this.valpha=typeof A[G]==="number"?A[G]:1}else if(typeof A==="number")this.model="rgb",this.color=[A>>16&255,A>>8&255,A&255],this.valpha=1;else{this.valpha=1;let Z=Object.keys(A);if("alpha"in A)Z.splice(Z.indexOf("alpha"),1),this.valpha=typeof A.alpha==="number"?A.alpha:0;let Y=Z.sort().join("");if(!(Y in h70))throw Error("Unable to parse color from object: "+JSON.stringify(A));this.model=h70[Y];let{labels:J}=gL[this.model],X=[];for(B=0;B<J.length;B++)X.push(A[J[B]]);this.color=g70(X)}if(_81[this.model]){G=gL[this.model].channels;for(B=0;B<G;B++){let Z=_81[this.model][B];if(Z)this.color[B]=Z(this.color[B])}}if(this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze)Object.freeze(this)}EF.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(A){let Q=this.model in ODA.to?this:this.rgb();Q=Q.round(typeof A==="number"?A:1);let B=Q.valpha===1?Q.color:[...Q.color,this.valpha];return ODA.to[Q.model](B)},percentString(A){let Q=this.rgb().round(typeof A==="number"?A:1),B=Q.valpha===1?Q.color:[...Q.color,this.valpha];return ODA.to.rgb.percent(B)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let A={},{channels:Q}=gL[this.model],{labels:B}=gL[this.model];for(let G=0;G<Q;G++)A[B[G]]=this.color[G];if(this.valpha!==1)A.alpha=this.valpha;return A},unitArray(){let A=this.rgb().color;if(A[0]/=255,A[1]/=255,A[2]/=255,this.valpha!==1)A.push(this.valpha);return A},unitObject(){let A=this.rgb().object();if(A.r/=255,A.g/=255,A.b/=255,this.valpha!==1)A.alpha=this.valpha;return A},round(A){return A=Math.max(A||0,0),new EF([...this.color.map(vi8(A)),this.valpha],this.model)},alpha(A){if(A!==void 0)return new EF([...this.color,Math.max(0,Math.min(1,A))],this.model);return this.valpha},red:aI("rgb",0,iK(255)),green:aI("rgb",1,iK(255)),blue:aI("rgb",2,iK(255)),hue:aI(["hsl","hsv","hsl","hwb","hcg"],0,(A)=>(A%360+360)%360),saturationl:aI("hsl",1,iK(100)),lightness:aI("hsl",2,iK(100)),saturationv:aI("hsv",1,iK(100)),value:aI("hsv",2,iK(100)),chroma:aI("hcg",1,iK(100)),gray:aI("hcg",2,iK(100)),white:aI("hwb",1,iK(100)),wblack:aI("hwb",2,iK(100)),cyan:aI("cmyk",0,iK(100)),magenta:aI("cmyk",1,iK(100)),yellow:aI("cmyk",2,iK(100)),black:aI("cmyk",3,iK(100)),x:aI("xyz",0,iK(95.047)),y:aI("xyz",1,iK(100)),z:aI("xyz",2,iK(108.833)),l:aI("lab",0,iK(100)),a:aI("lab",1),b:aI("lab",2),keyword(A){if(A!==void 0)return new EF(A);return gL[this.model].keyword(this.color)},hex(A){if(A!==void 0)return new EF(A);return ODA.to.hex(this.rgb().round().color)},hexa(A){if(A!==void 0)return new EF(A);let Q=this.rgb().round().color,B=Math.round(this.valpha*255).toString(16).toUpperCase();if(B.length===1)B="0"+B;return ODA.to.hex(Q)+B},rgbNumber(){let A=this.rgb().color;return(A[0]&255)<<16|(A[1]&255)<<8|A[2]&255},luminosity(){let A=this.rgb().color,Q=[];for(let[B,G]of A.entries()){let Z=G/255;Q[B]=Z<=0.04045?Z/12.92:((Z+0.055)/1.055)**2.4}return 0.2126*Q[0]+0.7152*Q[1]+0.0722*Q[2]},contrast(A){let Q=this.luminosity(),B=A.luminosity();if(Q>B)return(Q+0.05)/(B+0.05);return(B+0.05)/(Q+0.05)},level(A){let Q=this.contrast(A);if(Q>=7)return"AAA";return Q>=4.5?"AA":""},isDark(){let A=this.rgb().color;return(A[0]*2126+A[1]*7152+A[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let A=this.rgb();for(let Q=0;Q<3;Q++)A.color[Q]=255-A.color[Q];return A},lighten(A){let Q=this.hsl();return Q.color[2]+=Q.color[2]*A,Q},darken(A){let Q=this.hsl();return Q.color[2]-=Q.color[2]*A,Q},saturate(A){let Q=this.hsl();return Q.color[1]+=Q.color[1]*A,Q},desaturate(A){let Q=this.hsl();return Q.color[1]-=Q.color[1]*A,Q},whiten(A){let Q=this.hwb();return Q.color[1]+=Q.color[1]*A,Q},blacken(A){let Q=this.hwb();return Q.color[2]+=Q.color[2]*A,Q},grayscale(){let A=this.rgb().color,Q=A[0]*0.3+A[1]*0.59+A[2]*0.11;return EF.rgb(Q,Q,Q)},fade(A){return this.alpha(this.valpha-this.valpha*A)},opaquer(A){return this.alpha(this.valpha+this.valpha*A)},rotate(A){let Q=this.hsl(),B=Q.color[0];return B=(B+A)%360,B=B<0?360+B:B,Q.color[0]=B,Q},mix(A,Q){if(!A||!A.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof A);let B=A.rgb(),G=this.rgb(),Z=Q===void 0?0.5:Q,Y=2*Z-1,J=B.alpha()-G.alpha(),X=((Y*J===-1?Y:(Y+J)/(1+Y*J))+1)/2,I=1-X;return EF.rgb(X*B.red()+I*G.red(),X*B.green()+I*G.green(),X*B.blue()+I*G.blue(),B.alpha()*Z+G.alpha()*(1-Z))}};for(let A of Object.keys(gL)){if(trB.includes(A))continue;let{channels:Q}=gL[A];EF.prototype[A]=function(...B){if(this.model===A)return new EF(this);if(B.length>0)return new EF(B,A);return new EF([...ki8(gL[this.model][A].raw(this.color)),this.valpha],A)},EF[A]=function(...B){let G=B[0];if(typeof G==="number")G=g70(B,Q);return new EF(G,A)}}function yi8(A,Q){return Number(A.toFixed(Q))}function vi8(A){return function(Q){return yi8(Q,A)}}function aI(A,Q,B){A=Array.isArray(A)?A:[A];for(let G of A)(_81[G]||(_81[G]=[]))[Q]=B;return A=A[0],function(G){let Z;if(G!==void 0){if(B)G=B(G);return Z=this[A](),Z.color[Q]=G,Z}if(Z=this[A]().color[Q],B)Z=B(Z);return Z}}function iK(A){return function(Q){return Math.max(0,Math.min(A,Q))}}function ki8(A){return Array.isArray(A)?A:[A]}function g70(A,Q){for(let B=0;B<Q;B++)if(typeof A[B]!=="number")A[B]=0;return A}erB.exports=EF});var BsB=U((N6Z,QsB)=>{var bi8=j81(),AQ=uk(),Mo=cPA(),fi8={left:"low",center:"centre",centre:"centre",right:"high"};function AsB(A){let{raw:Q,density:B,limitInputPixels:G,ignoreIcc:Z,unlimited:Y,sequentialRead:J,failOn:X,failOnError:I,animated:W,page:D,pages:K,subifd:V}=A;return[Q,B,G,Z,Y,J,X,I,W,D,K,V].some(AQ.defined)?{raw:Q,density:B,limitInputPixels:G,ignoreIcc:Z,unlimited:Y,sequentialRead:J,failOn:X,failOnError:I,animated:W,page:D,pages:K,subifd:V}:void 0}function hi8(A,Q,B){let G={failOn:"warning",limitInputPixels:Math.pow(16383,2),ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(AQ.string(A))G.file=A;else if(AQ.buffer(A)){if(A.length===0)throw Error("Input Buffer is empty");G.buffer=A}else if(AQ.arrayBuffer(A)){if(A.byteLength===0)throw Error("Input bit Array is empty");G.buffer=Buffer.from(A,0,A.byteLength)}else if(AQ.typedArray(A)){if(A.length===0)throw Error("Input Bit Array is empty");G.buffer=Buffer.from(A.buffer,A.byteOffset,A.byteLength)}else if(AQ.plainObject(A)&&!AQ.defined(Q)){if(Q=A,AsB(Q))G.buffer=[]}else if(!AQ.defined(A)&&!AQ.defined(Q)&&AQ.object(B)&&B.allowStream)G.buffer=[];else throw Error(`Unsupported input '${A}' of type ${typeof A}${AQ.defined(Q)?` when also providing options of type ${typeof Q}`:""}`);if(AQ.object(Q)){if(AQ.defined(Q.failOnError))if(AQ.bool(Q.failOnError))G.failOn=Q.failOnError?"warning":"none";else throw AQ.invalidParameterError("failOnError","boolean",Q.failOnError);if(AQ.defined(Q.failOn))if(AQ.string(Q.failOn)&&AQ.inArray(Q.failOn,["none","truncated","error","warning"]))G.failOn=Q.failOn;else throw AQ.invalidParameterError("failOn","one of: none, truncated, error, warning",Q.failOn);if(AQ.defined(Q.density))if(AQ.inRange(Q.density,1,1e5))G.density=Q.density;else throw AQ.invalidParameterError("density","number between 1 and 100000",Q.density);if(AQ.defined(Q.ignoreIcc))if(AQ.bool(Q.ignoreIcc))G.ignoreIcc=Q.ignoreIcc;else throw AQ.invalidParameterError("ignoreIcc","boolean",Q.ignoreIcc);if(AQ.defined(Q.limitInputPixels))if(AQ.bool(Q.limitInputPixels))G.limitInputPixels=Q.limitInputPixels?Math.pow(16383,2):0;else if(AQ.integer(Q.limitInputPixels)&&AQ.inRange(Q.limitInputPixels,0,Number.MAX_SAFE_INTEGER))G.limitInputPixels=Q.limitInputPixels;else throw AQ.invalidParameterError("limitInputPixels","positive integer",Q.limitInputPixels);if(AQ.defined(Q.unlimited))if(AQ.bool(Q.unlimited))G.unlimited=Q.unlimited;else throw AQ.invalidParameterError("unlimited","boolean",Q.unlimited);if(AQ.defined(Q.sequentialRead))if(AQ.bool(Q.sequentialRead))G.sequentialRead=Q.sequentialRead;else throw AQ.invalidParameterError("sequentialRead","boolean",Q.sequentialRead);if(AQ.defined(Q.raw))if(AQ.object(Q.raw)&&AQ.integer(Q.raw.width)&&Q.raw.width>0&&AQ.integer(Q.raw.height)&&Q.raw.height>0&&AQ.integer(Q.raw.channels)&&AQ.inRange(Q.raw.channels,1,4))switch(G.rawWidth=Q.raw.width,G.rawHeight=Q.raw.height,G.rawChannels=Q.raw.channels,G.rawPremultiplied=!!Q.raw.premultiplied,A.constructor){case Uint8Array:case Uint8ClampedArray:G.rawDepth="uchar";break;case Int8Array:G.rawDepth="char";break;case Uint16Array:G.rawDepth="ushort";break;case Int16Array:G.rawDepth="short";break;case Uint32Array:G.rawDepth="uint";break;case Int32Array:G.rawDepth="int";break;case Float32Array:G.rawDepth="float";break;case Float64Array:G.rawDepth="double";break;default:G.rawDepth="uchar";break}else throw Error("Expected width, height and channels for raw pixel input");if(AQ.defined(Q.animated))if(AQ.bool(Q.animated))G.pages=Q.animated?-1:1;else throw AQ.invalidParameterError("animated","boolean",Q.animated);if(AQ.defined(Q.pages))if(AQ.integer(Q.pages)&&AQ.inRange(Q.pages,-1,1e5))G.pages=Q.pages;else throw AQ.invalidParameterError("pages","integer between -1 and 100000",Q.pages);if(AQ.defined(Q.page))if(AQ.integer(Q.page)&&AQ.inRange(Q.page,0,1e5))G.page=Q.page;else throw AQ.invalidParameterError("page","integer between 0 and 100000",Q.page);if(AQ.defined(Q.level))if(AQ.integer(Q.level)&&AQ.inRange(Q.level,0,256))G.level=Q.level;else throw AQ.invalidParameterError("level","integer between 0 and 256",Q.level);if(AQ.defined(Q.subifd))if(AQ.integer(Q.subifd)&&AQ.inRange(Q.subifd,-1,1e5))G.subifd=Q.subifd;else throw AQ.invalidParameterError("subifd","integer between -1 and 100000",Q.subifd);if(AQ.defined(Q.create))if(AQ.object(Q.create)&&AQ.integer(Q.create.width)&&Q.create.width>0&&AQ.integer(Q.create.height)&&Q.create.height>0&&AQ.integer(Q.create.channels)){if(G.createWidth=Q.create.width,G.createHeight=Q.create.height,G.createChannels=Q.create.channels,AQ.defined(Q.create.noise)){if(!AQ.object(Q.create.noise))throw Error("Expected noise to be an object");if(!AQ.inArray(Q.create.noise.type,["gaussian"]))throw Error("Only gaussian noise is supported at the moment");if(!AQ.inRange(Q.create.channels,1,4))throw AQ.invalidParameterError("create.channels","number between 1 and 4",Q.create.channels);if(G.createNoiseType=Q.create.noise.type,AQ.number(Q.create.noise.mean)&&AQ.inRange(Q.create.noise.mean,0,1e4))G.createNoiseMean=Q.create.noise.mean;else throw AQ.invalidParameterError("create.noise.mean","number between 0 and 10000",Q.create.noise.mean);if(AQ.number(Q.create.noise.sigma)&&AQ.inRange(Q.create.noise.sigma,0,1e4))G.createNoiseSigma=Q.create.noise.sigma;else throw AQ.invalidParameterError("create.noise.sigma","number between 0 and 10000",Q.create.noise.sigma)}else if(AQ.defined(Q.create.background)){if(!AQ.inRange(Q.create.channels,3,4))throw AQ.invalidParameterError("create.channels","number between 3 and 4",Q.create.channels);let Z=bi8(Q.create.background);G.createBackground=[Z.red(),Z.green(),Z.blue(),Math.round(Z.alpha()*255)]}else throw Error("Expected valid noise or background to create a new input image");delete G.buffer}else throw Error("Expected valid width, height and channels to create a new input image");if(AQ.defined(Q.text))if(AQ.object(Q.text)&&AQ.string(Q.text.text)){if(G.textValue=Q.text.text,AQ.defined(Q.text.height)&&AQ.defined(Q.text.dpi))throw Error("Expected only one of dpi or height");if(AQ.defined(Q.text.font))if(AQ.string(Q.text.font))G.textFont=Q.text.font;else throw AQ.invalidParameterError("text.font","string",Q.text.font);if(AQ.defined(Q.text.fontfile))if(AQ.string(Q.text.fontfile))G.textFontfile=Q.text.fontfile;else throw AQ.invalidParameterError("text.fontfile","string",Q.text.fontfile);if(AQ.defined(Q.text.width))if(AQ.integer(Q.text.width)&&Q.text.width>0)G.textWidth=Q.text.width;else throw AQ.invalidParameterError("text.width","positive integer",Q.text.width);if(AQ.defined(Q.text.height))if(AQ.integer(Q.text.height)&&Q.text.height>0)G.textHeight=Q.text.height;else throw AQ.invalidParameterError("text.height","positive integer",Q.text.height);if(AQ.defined(Q.text.align))if(AQ.string(Q.text.align)&&AQ.string(this.constructor.align[Q.text.align]))G.textAlign=this.constructor.align[Q.text.align];else throw AQ.invalidParameterError("text.align","valid alignment",Q.text.align);if(AQ.defined(Q.text.justify))if(AQ.bool(Q.text.justify))G.textJustify=Q.text.justify;else throw AQ.invalidParameterError("text.justify","boolean",Q.text.justify);if(AQ.defined(Q.text.dpi))if(AQ.integer(Q.text.dpi)&&AQ.inRange(Q.text.dpi,1,1e6))G.textDpi=Q.text.dpi;else throw AQ.invalidParameterError("text.dpi","integer between 1 and 1000000",Q.text.dpi);if(AQ.defined(Q.text.rgba))if(AQ.bool(Q.text.rgba))G.textRgba=Q.text.rgba;else throw AQ.invalidParameterError("text.rgba","bool",Q.text.rgba);if(AQ.defined(Q.text.spacing))if(AQ.integer(Q.text.spacing)&&AQ.inRange(Q.text.spacing,-1e6,1e6))G.textSpacing=Q.text.spacing;else throw AQ.invalidParameterError("text.spacing","integer between -1000000 and 1000000",Q.text.spacing);if(AQ.defined(Q.text.wrap))if(AQ.string(Q.text.wrap)&&AQ.inArray(Q.text.wrap,["word","char","word-char","none"]))G.textWrap=Q.text.wrap;else throw AQ.invalidParameterError("text.wrap","one of: word, char, word-char, none",Q.text.wrap);delete G.buffer}else throw Error("Expected a valid string to create an image with text.")}else if(AQ.defined(Q))throw Error("Invalid input options "+Q);return G}function gi8(A,Q,B){if(Array.isArray(this.options.input.buffer))if(AQ.buffer(A)){if(this.options.input.buffer.length===0)this.on("finish",()=>{this.streamInFinished=!0});this.options.input.buffer.push(A),B()}else B(Error("Non-Buffer data on Writable Stream"));else B(Error("Unexpected data on Writable Stream"))}function ui8(){if(this._isStreamInput())this.options.input.buffer=Buffer.concat(this.options.input.buffer)}function mi8(){return Array.isArray(this.options.input.buffer)}function di8(A){let Q=Error();if(AQ.fn(A)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),Mo.metadata(this.options,(B,G)=>{if(B)A(AQ.nativeError(B,Q));else A(null,G)})});else Mo.metadata(this.options,(B,G)=>{if(B)A(AQ.nativeError(B,Q));else A(null,G)});return this}else if(this._isStreamInput())return new Promise((B,G)=>{let Z=()=>{this._flattenBufferIn(),Mo.metadata(this.options,(Y,J)=>{if(Y)G(AQ.nativeError(Y,Q));else B(J)})};if(this.writableFinished)Z();else this.once("finish",Z)});else return new Promise((B,G)=>{Mo.metadata(this.options,(Z,Y)=>{if(Z)G(AQ.nativeError(Z,Q));else B(Y)})})}function pi8(A){let Q=Error();if(AQ.fn(A)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),Mo.stats(this.options,(B,G)=>{if(B)A(AQ.nativeError(B,Q));else A(null,G)})});else Mo.stats(this.options,(B,G)=>{if(B)A(AQ.nativeError(B,Q));else A(null,G)});return this}else if(this._isStreamInput())return new Promise((B,G)=>{this.on("finish",function(){this._flattenBufferIn(),Mo.stats(this.options,(Z,Y)=>{if(Z)G(AQ.nativeError(Z,Q));else B(Y)})})});else return new Promise((B,G)=>{Mo.stats(this.options,(Z,Y)=>{if(Z)G(AQ.nativeError(Z,Q));else B(Y)})})}QsB.exports=function(A){Object.assign(A.prototype,{_inputOptionsFromObject:AsB,_createInputDescriptor:hi8,_write:gi8,_flattenBufferIn:ui8,_isStreamInput:mi8,metadata:di8,stats:pi8}),A.align=fi8}});var IsB=U((w6Z,XsB)=>{var h9=uk(),ZsB={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},YsB={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},GsB={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},JsB={entropy:16,attention:17},u70={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3"},ci8={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},li8={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function m70(A){return A.angle%360!==0||A.useExifOrientation===!0||A.rotationAngle!==0}function T81(A){return A.width!==-1||A.height!==-1}function ii8(A,Q,B){if(T81(this.options))this.options.debuglog("ignoring previous resize options");if(this.options.widthPost!==-1)this.options.debuglog("operation order will be: extract, resize, extract");if(h9.defined(A))if(h9.object(A)&&!h9.defined(B))B=A;else if(h9.integer(A)&&A>0)this.options.width=A;else throw h9.invalidParameterError("width","positive integer",A);else this.options.width=-1;if(h9.defined(Q))if(h9.integer(Q)&&Q>0)this.options.height=Q;else throw h9.invalidParameterError("height","positive integer",Q);else this.options.height=-1;if(h9.object(B)){if(h9.defined(B.width))if(h9.integer(B.width)&&B.width>0)this.options.width=B.width;else throw h9.invalidParameterError("width","positive integer",B.width);if(h9.defined(B.height))if(h9.integer(B.height)&&B.height>0)this.options.height=B.height;else throw h9.invalidParameterError("height","positive integer",B.height);if(h9.defined(B.fit)){let G=li8[B.fit];if(h9.string(G))this.options.canvas=G;else throw h9.invalidParameterError("fit","valid fit",B.fit)}if(h9.defined(B.position)){let G=h9.integer(B.position)?B.position:JsB[B.position]||YsB[B.position]||ZsB[B.position];if(h9.integer(G)&&(h9.inRange(G,0,8)||h9.inRange(G,16,17)))this.options.position=G;else throw h9.invalidParameterError("position","valid position/gravity/strategy",B.position)}if(this._setBackgroundColourOption("resizeBackground",B.background),h9.defined(B.kernel))if(h9.string(u70[B.kernel]))this.options.kernel=u70[B.kernel];else throw h9.invalidParameterError("kernel","valid kernel name",B.kernel);if(h9.defined(B.withoutEnlargement))this._setBooleanOption("withoutEnlargement",B.withoutEnlargement);if(h9.defined(B.withoutReduction))this._setBooleanOption("withoutReduction",B.withoutReduction);if(h9.defined(B.fastShrinkOnLoad))this._setBooleanOption("fastShrinkOnLoad",B.fastShrinkOnLoad)}if(m70(this.options)&&T81(this.options))this.options.rotateBeforePreExtract=!0;return this}function ni8(A){if(h9.integer(A)&&A>0)this.options.extendTop=A,this.options.extendBottom=A,this.options.extendLeft=A,this.options.extendRight=A;else if(h9.object(A)){if(h9.defined(A.top))if(h9.integer(A.top)&&A.top>=0)this.options.extendTop=A.top;else throw h9.invalidParameterError("top","positive integer",A.top);if(h9.defined(A.bottom))if(h9.integer(A.bottom)&&A.bottom>=0)this.options.extendBottom=A.bottom;else throw h9.invalidParameterError("bottom","positive integer",A.bottom);if(h9.defined(A.left))if(h9.integer(A.left)&&A.left>=0)this.options.extendLeft=A.left;else throw h9.invalidParameterError("left","positive integer",A.left);if(h9.defined(A.right))if(h9.integer(A.right)&&A.right>=0)this.options.extendRight=A.right;else throw h9.invalidParameterError("right","positive integer",A.right);if(this._setBackgroundColourOption("extendBackground",A.background),h9.defined(A.extendWith))if(h9.string(GsB[A.extendWith]))this.options.extendWith=GsB[A.extendWith];else throw h9.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",A.extendWith)}else throw h9.invalidParameterError("extend","integer or object",A);return this}function ai8(A){let Q=T81(this.options)||this.options.widthPre!==-1?"Post":"Pre";if(this.options[`width${Q}`]!==-1)this.options.debuglog("ignoring previous extract options");if(["left","top","width","height"].forEach(function(B){let G=A[B];if(h9.integer(G)&&G>=0)this.options[B+(B==="left"||B==="top"?"Offset":"")+Q]=G;else throw h9.invalidParameterError(B,"integer",G)},this),m70(this.options)&&!T81(this.options)){if(this.options.widthPre===-1||this.options.widthPost===-1)this.options.rotateBeforePreExtract=!0}return this}function oi8(A){if(this.options.trimThreshold=10,h9.defined(A))if(h9.object(A)){if(h9.defined(A.background))this._setBackgroundColourOption("trimBackground",A.background);if(h9.defined(A.threshold))if(h9.number(A.threshold)&&A.threshold>=0)this.options.trimThreshold=A.threshold;else throw h9.invalidParameterError("threshold","positive number",A.threshold);if(h9.defined(A.lineArt))this._setBooleanOption("trimLineArt",A.lineArt)}else throw h9.invalidParameterError("trim","object",A);if(m70(this.options))this.options.rotateBeforePreExtract=!0;return this}XsB.exports=function(A){Object.assign(A.prototype,{resize:ii8,extend:ni8,extract:ai8,trim:oi8}),A.gravity=ZsB,A.strategy=JsB,A.kernel=u70,A.fit=ci8,A.position=YsB}});var DsB=U((L6Z,WsB)=>{var xZ=uk(),d70={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function ri8(A){if(!Array.isArray(A))throw xZ.invalidParameterError("images to composite","array",A);return this.options.composite=A.map((Q)=>{if(!xZ.object(Q))throw xZ.invalidParameterError("image to composite","object",Q);let B=this._inputOptionsFromObject(Q),G={input:this._createInputDescriptor(Q.input,B,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(xZ.defined(Q.blend))if(xZ.string(d70[Q.blend]))G.blend=d70[Q.blend];else throw xZ.invalidParameterError("blend","valid blend name",Q.blend);if(xZ.defined(Q.tile))if(xZ.bool(Q.tile))G.tile=Q.tile;else throw xZ.invalidParameterError("tile","boolean",Q.tile);if(xZ.defined(Q.left))if(xZ.integer(Q.left))G.left=Q.left;else throw xZ.invalidParameterError("left","integer",Q.left);if(xZ.defined(Q.top))if(xZ.integer(Q.top))G.top=Q.top;else throw xZ.invalidParameterError("top","integer",Q.top);if(xZ.defined(Q.top)!==xZ.defined(Q.left))throw Error("Expected both left and top to be set");else G.hasOffset=xZ.integer(Q.top)&&xZ.integer(Q.left);if(xZ.defined(Q.gravity))if(xZ.integer(Q.gravity)&&xZ.inRange(Q.gravity,0,8))G.gravity=Q.gravity;else if(xZ.string(Q.gravity)&&xZ.integer(this.constructor.gravity[Q.gravity]))G.gravity=this.constructor.gravity[Q.gravity];else throw xZ.invalidParameterError("gravity","valid gravity",Q.gravity);if(xZ.defined(Q.premultiplied))if(xZ.bool(Q.premultiplied))G.premultiplied=Q.premultiplied;else throw xZ.invalidParameterError("premultiplied","boolean",Q.premultiplied);return G}),this}WsB.exports=function(A){A.prototype.composite=ri8,A.blend=d70}});var FsB=U((O6Z,VsB)=>{var si8=j81(),w0=uk(),KsB={integer:"integer",float:"float",approximate:"approximate"};function ti8(A,Q){if(this.options.useExifOrientation||this.options.angle||this.options.rotationAngle)this.options.debuglog("ignoring previous rotate options");if(!w0.defined(A))this.options.useExifOrientation=!0;else if(w0.integer(A)&&!(A%90))this.options.angle=A;else if(w0.number(A)){if(this.options.rotationAngle=A,w0.object(Q)&&Q.background){let B=si8(Q.background);this.options.rotationBackground=[B.red(),B.green(),B.blue(),Math.round(B.alpha()*255)]}}else throw w0.invalidParameterError("angle","numeric",A);return this}function ei8(A){return this.options.flip=w0.bool(A)?A:!0,this}function An8(A){return this.options.flop=w0.bool(A)?A:!0,this}function Qn8(A,Q){let B=[].concat(...A);if(B.length===4&&B.every(w0.number))this.options.affineMatrix=B;else throw w0.invalidParameterError("matrix","1x4 or 2x2 array",A);if(w0.defined(Q))if(w0.object(Q)){if(this._setBackgroundColourOption("affineBackground",Q.background),w0.defined(Q.idx))if(w0.number(Q.idx))this.options.affineIdx=Q.idx;else throw w0.invalidParameterError("options.idx","number",Q.idx);if(w0.defined(Q.idy))if(w0.number(Q.idy))this.options.affineIdy=Q.idy;else throw w0.invalidParameterError("options.idy","number",Q.idy);if(w0.defined(Q.odx))if(w0.number(Q.odx))this.options.affineOdx=Q.odx;else throw w0.invalidParameterError("options.odx","number",Q.odx);if(w0.defined(Q.ody))if(w0.number(Q.ody))this.options.affineOdy=Q.ody;else throw w0.invalidParameterError("options.ody","number",Q.ody);if(w0.defined(Q.interpolator))if(w0.inArray(Q.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=Q.interpolator;else throw w0.invalidParameterError("options.interpolator","valid interpolator name",Q.interpolator)}else throw w0.invalidParameterError("options","object",Q);return this}function Bn8(A,Q,B){if(!w0.defined(A))this.options.sharpenSigma=-1;else if(w0.bool(A))this.options.sharpenSigma=A?-1:0;else if(w0.number(A)&&w0.inRange(A,0.01,1e4)){if(this.options.sharpenSigma=A,w0.defined(Q))if(w0.number(Q)&&w0.inRange(Q,0,1e4))this.options.sharpenM1=Q;else throw w0.invalidParameterError("flat","number between 0 and 10000",Q);if(w0.defined(B))if(w0.number(B)&&w0.inRange(B,0,1e4))this.options.sharpenM2=B;else throw w0.invalidParameterError("jagged","number between 0 and 10000",B)}else if(w0.plainObject(A)){if(w0.number(A.sigma)&&w0.inRange(A.sigma,0.000001,10))this.options.sharpenSigma=A.sigma;else throw w0.invalidParameterError("options.sigma","number between 0.000001 and 10",A.sigma);if(w0.defined(A.m1))if(w0.number(A.m1)&&w0.inRange(A.m1,0,1e6))this.options.sharpenM1=A.m1;else throw w0.invalidParameterError("options.m1","number between 0 and 1000000",A.m1);if(w0.defined(A.m2))if(w0.number(A.m2)&&w0.inRange(A.m2,0,1e6))this.options.sharpenM2=A.m2;else throw w0.invalidParameterError("options.m2","number between 0 and 1000000",A.m2);if(w0.defined(A.x1))if(w0.number(A.x1)&&w0.inRange(A.x1,0,1e6))this.options.sharpenX1=A.x1;else throw w0.invalidParameterError("options.x1","number between 0 and 1000000",A.x1);if(w0.defined(A.y2))if(w0.number(A.y2)&&w0.inRange(A.y2,0,1e6))this.options.sharpenY2=A.y2;else throw w0.invalidParameterError("options.y2","number between 0 and 1000000",A.y2);if(w0.defined(A.y3))if(w0.number(A.y3)&&w0.inRange(A.y3,0,1e6))this.options.sharpenY3=A.y3;else throw w0.invalidParameterError("options.y3","number between 0 and 1000000",A.y3)}else throw w0.invalidParameterError("sigma","number between 0.01 and 10000",A);return this}function Gn8(A){if(!w0.defined(A))this.options.medianSize=3;else if(w0.integer(A)&&w0.inRange(A,1,1000))this.options.medianSize=A;else throw w0.invalidParameterError("size","integer between 1 and 1000",A);return this}function Zn8(A){let Q;if(w0.number(A))Q=A;else if(w0.plainObject(A)){if(!w0.number(A.sigma))throw w0.invalidParameterError("options.sigma","number between 0.3 and 1000",Q);if(Q=A.sigma,"precision"in A)if(w0.string(KsB[A.precision]))this.options.precision=KsB[A.precision];else throw w0.invalidParameterError("precision","one of: integer, float, approximate",A.precision);if("minAmplitude"in A)if(w0.number(A.minAmplitude)&&w0.inRange(A.minAmplitude,0.001,1))this.options.minAmpl=A.minAmplitude;else throw w0.invalidParameterError("minAmplitude","number between 0.001 and 1",A.minAmplitude)}if(!w0.defined(A))this.options.blurSigma=-1;else if(w0.bool(A))this.options.blurSigma=A?-1:0;else if(w0.number(Q)&&w0.inRange(Q,0.3,1000))this.options.blurSigma=Q;else throw w0.invalidParameterError("sigma","number between 0.3 and 1000",Q);return this}function Yn8(A){if(this.options.flatten=w0.bool(A)?A:!0,w0.object(A))this._setBackgroundColourOption("flattenBackground",A.background);return this}function Jn8(){return this.options.unflatten=!0,this}function Xn8(A,Q){if(!w0.defined(A))this.options.gamma=2.2;else if(w0.number(A)&&w0.inRange(A,1,3))this.options.gamma=A;else throw w0.invalidParameterError("gamma","number between 1.0 and 3.0",A);if(!w0.defined(Q))this.options.gammaOut=this.options.gamma;else if(w0.number(Q)&&w0.inRange(Q,1,3))this.options.gammaOut=Q;else throw w0.invalidParameterError("gammaOut","number between 1.0 and 3.0",Q);return this}function In8(A){if(this.options.negate=w0.bool(A)?A:!0,w0.plainObject(A)&&"alpha"in A)if(!w0.bool(A.alpha))throw w0.invalidParameterError("alpha","should be boolean value",A.alpha);else this.options.negateAlpha=A.alpha;return this}function Wn8(A){if(w0.plainObject(A)){if(w0.defined(A.lower))if(w0.number(A.lower)&&w0.inRange(A.lower,0,99))this.options.normaliseLower=A.lower;else throw w0.invalidParameterError("lower","number between 0 and 99",A.lower);if(w0.defined(A.upper))if(w0.number(A.upper)&&w0.inRange(A.upper,1,100))this.options.normaliseUpper=A.upper;else throw w0.invalidParameterError("upper","number between 1 and 100",A.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw w0.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function Dn8(A){return this.normalise(A)}function Kn8(A){if(w0.plainObject(A)){if(w0.integer(A.width)&&A.width>0)this.options.claheWidth=A.width;else throw w0.invalidParameterError("width","integer greater than zero",A.width);if(w0.integer(A.height)&&A.height>0)this.options.claheHeight=A.height;else throw w0.invalidParameterError("height","integer greater than zero",A.height);if(w0.defined(A.maxSlope))if(w0.integer(A.maxSlope)&&w0.inRange(A.maxSlope,0,100))this.options.claheMaxSlope=A.maxSlope;else throw w0.invalidParameterError("maxSlope","integer between 0 and 100",A.maxSlope)}else throw w0.invalidParameterError("options","plain object",A);return this}function Vn8(A){if(!w0.object(A)||!Array.isArray(A.kernel)||!w0.integer(A.width)||!w0.integer(A.height)||!w0.inRange(A.width,3,1001)||!w0.inRange(A.height,3,1001)||A.height*A.width!==A.kernel.length)throw Error("Invalid convolution kernel");if(!w0.integer(A.scale))A.scale=A.kernel.reduce(function(Q,B){return Q+B},0);if(A.scale<1)A.scale=1;if(!w0.integer(A.offset))A.offset=0;return this.options.convKernel=A,this}function Fn8(A,Q){if(!w0.defined(A))this.options.threshold=128;else if(w0.bool(A))this.options.threshold=A?128:0;else if(w0.integer(A)&&w0.inRange(A,0,255))this.options.threshold=A;else throw w0.invalidParameterError("threshold","integer between 0 and 255",A);if(!w0.object(Q)||Q.greyscale===!0||Q.grayscale===!0)this.options.thresholdGrayscale=!0;else this.options.thresholdGrayscale=!1;return this}function Hn8(A,Q,B){if(this.options.boolean=this._createInputDescriptor(A,B),w0.string(Q)&&w0.inArray(Q,["and","or","eor"]))this.options.booleanOp=Q;else throw w0.invalidParameterError("operator","one of: and, or, eor",Q);return this}function En8(A,Q){if(!w0.defined(A)&&w0.number(Q))A=1;else if(w0.number(A)&&!w0.defined(Q))Q=0;if(!w0.defined(A))this.options.linearA=[];else if(w0.number(A))this.options.linearA=[A];else if(Array.isArray(A)&&A.length&&A.every(w0.number))this.options.linearA=A;else throw w0.invalidParameterError("a","number or array of numbers",A);if(!w0.defined(Q))this.options.linearB=[];else if(w0.number(Q))this.options.linearB=[Q];else if(Array.isArray(Q)&&Q.length&&Q.every(w0.number))this.options.linearB=Q;else throw w0.invalidParameterError("b","number or array of numbers",Q);if(this.options.linearA.length!==this.options.linearB.length)throw Error("Expected a and b to be arrays of the same length");return this}function zn8(A){if(!Array.isArray(A))throw w0.invalidParameterError("inputMatrix","array",A);if(A.length!==3&&A.length!==4)throw w0.invalidParameterError("inputMatrix","3x3 or 4x4 array",A.length);let Q=A.flat().map(Number);if(Q.length!==9&&Q.length!==16)throw w0.invalidParameterError("inputMatrix","cardinality of 9 or 16",Q.length);return this.options.recombMatrix=Q,this}function Cn8(A){if(!w0.plainObject(A))throw w0.invalidParameterError("options","plain object",A);if("brightness"in A)if(w0.number(A.brightness)&&A.brightness>=0)this.options.brightness=A.brightness;else throw w0.invalidParameterError("brightness","number above zero",A.brightness);if("saturation"in A)if(w0.number(A.saturation)&&A.saturation>=0)this.options.saturation=A.saturation;else throw w0.invalidParameterError("saturation","number above zero",A.saturation);if("hue"in A)if(w0.integer(A.hue))this.options.hue=A.hue%360;else throw w0.invalidParameterError("hue","number",A.hue);if("lightness"in A)if(w0.number(A.lightness))this.options.lightness=A.lightness;else throw w0.invalidParameterError("lightness","number",A.lightness);return this}VsB.exports=function(A){Object.assign(A.prototype,{rotate:ti8,flip:ei8,flop:An8,affine:Qn8,sharpen:Bn8,median:Gn8,blur:Zn8,flatten:Yn8,unflatten:Jn8,gamma:Xn8,negate:In8,normalise:Wn8,normalize:Dn8,clahe:Kn8,convolve:Vn8,threshold:Fn8,boolean:Hn8,linear:En8,recomb:zn8,modulate:Cn8})}});var zsB=U((M6Z,EsB)=>{var $n8=j81(),bm=uk(),HsB={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function Un8(A){return this._setBackgroundColourOption("tint",A),this}function qn8(A){return this.options.greyscale=bm.bool(A)?A:!0,this}function Nn8(A){return this.greyscale(A)}function wn8(A){if(!bm.string(A))throw bm.invalidParameterError("colourspace","string",A);return this.options.colourspacePipeline=A,this}function Ln8(A){return this.pipelineColourspace(A)}function On8(A){if(!bm.string(A))throw bm.invalidParameterError("colourspace","string",A);return this.options.colourspace=A,this}function Mn8(A){return this.toColourspace(A)}function Rn8(A,Q){if(bm.defined(Q))if(bm.object(Q)||bm.string(Q)){let B=$n8(Q);this.options[A]=[B.red(),B.green(),B.blue(),Math.round(B.alpha()*255)]}else throw bm.invalidParameterError("background","object or string",Q)}EsB.exports=function(A){Object.assign(A.prototype,{tint:Un8,greyscale:qn8,grayscale:Nn8,pipelineColourspace:wn8,pipelineColorspace:Ln8,toColourspace:On8,toColorspace:Mn8,_setBackgroundColourOption:Rn8}),A.colourspace=HsB,A.colorspace=HsB}});var $sB=U((R6Z,CsB)=>{var ck=uk(),_n8={and:"and",or:"or",eor:"eor"};function jn8(){return this.options.removeAlpha=!0,this}function Tn8(A){if(ck.defined(A))if(ck.number(A)&&ck.inRange(A,0,1))this.options.ensureAlpha=A;else throw ck.invalidParameterError("alpha","number between 0 and 1",A);else this.options.ensureAlpha=1;return this}function Pn8(A){let Q={red:0,green:1,blue:2,alpha:3};if(Object.keys(Q).includes(A))A=Q[A];if(ck.integer(A)&&ck.inRange(A,0,4))this.options.extractChannel=A;else throw ck.invalidParameterError("channel","integer or one of: red, green, blue, alpha",A);return this}function Sn8(A,Q){if(Array.isArray(A))A.forEach(function(B){this.options.joinChannelIn.push(this._createInputDescriptor(B,Q))},this);else this.options.joinChannelIn.push(this._createInputDescriptor(A,Q));return this}function xn8(A){if(ck.string(A)&&ck.inArray(A,["and","or","eor"]))this.options.bandBoolOp=A;else throw ck.invalidParameterError("boolOp","one of: and, or, eor",A);return this}CsB.exports=function(A){Object.assign(A.prototype,{removeAlpha:jn8,ensureAlpha:Tn8,extractChannel:Pn8,joinChannel:Sn8,bandbool:xn8}),A.bool=_n8}});var OsB=U((_6Z,LsB)=>{var p70=qA("node:path"),X1=uk(),MDA=cPA(),UsB=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),yn8=/\.(jp[2x]|j2[kc])$/i,qsB=()=>Error("JP2 output requires libvips with support for OpenJPEG"),NsB=(A)=>1<<31-Math.clz32(Math.ceil(Math.log2(A)));function vn8(A,Q){let B;if(!X1.string(A))B=Error("Missing output file path");else if(X1.string(this.options.input.file)&&p70.resolve(this.options.input.file)===p70.resolve(A))B=Error("Cannot use same file for input and output");else if(yn8.test(p70.extname(A))&&!this.constructor.format.jp2k.output.file)B=qsB();if(B)if(X1.fn(Q))Q(B);else return Promise.reject(B);else{this.options.fileOut=A;let G=Error();return this._pipeline(Q,G)}return this}function kn8(A,Q){if(X1.object(A))this._setBooleanOption("resolveWithObject",A.resolveWithObject);else if(this.options.resolveWithObject)this.options.resolveWithObject=!1;this.options.fileOut="";let B=Error();return this._pipeline(X1.fn(A)?A:Q,B)}function bn8(){return this.options.keepMetadata|=1,this}function fn8(A){if(X1.object(A))for(let[Q,B]of Object.entries(A))if(X1.object(B))for(let[G,Z]of Object.entries(B))if(X1.string(Z))this.options.withExif[`exif-${Q.toLowerCase()}-${G}`]=Z;else throw X1.invalidParameterError(`${Q}.${G}`,"string",Z);else throw X1.invalidParameterError(Q,"object",B);else throw X1.invalidParameterError("exif","object",A);return this.options.withExifMerge=!1,this.keepExif()}function hn8(A){return this.withExif(A),this.options.withExifMerge=!0,this}function gn8(){return this.options.keepMetadata|=8,this}function un8(A,Q){if(X1.string(A))this.options.withIccProfile=A;else throw X1.invalidParameterError("icc","string",A);if(this.keepIccProfile(),X1.object(Q)){if(X1.defined(Q.attach))if(X1.bool(Q.attach)){if(!Q.attach)this.options.keepMetadata&=-9}else throw X1.invalidParameterError("attach","boolean",Q.attach)}return this}function mn8(){return this.options.keepMetadata=31,this}function dn8(A){if(this.keepMetadata(),this.withIccProfile("srgb"),X1.object(A)){if(X1.defined(A.orientation))if(X1.integer(A.orientation)&&X1.inRange(A.orientation,1,8))this.options.withMetadataOrientation=A.orientation;else throw X1.invalidParameterError("orientation","integer between 1 and 8",A.orientation);if(X1.defined(A.density))if(X1.number(A.density)&&A.density>0)this.options.withMetadataDensity=A.density;else throw X1.invalidParameterError("density","positive number",A.density);if(X1.defined(A.icc))this.withIccProfile(A.icc);if(X1.defined(A.exif))this.withExifMerge(A.exif)}return this}function pn8(A,Q){let B=UsB.get((X1.object(A)&&X1.string(A.id)?A.id:A).toLowerCase());if(!B)throw X1.invalidParameterError("format",`one of: ${[...UsB.keys()].join(", ")}`,A);return this[B](Q)}function cn8(A){if(X1.object(A)){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.jpegQuality=A.quality;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);if(X1.defined(A.progressive))this._setBooleanOption("jpegProgressive",A.progressive);if(X1.defined(A.chromaSubsampling))if(X1.string(A.chromaSubsampling)&&X1.inArray(A.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=A.chromaSubsampling;else throw X1.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",A.chromaSubsampling);let Q=X1.bool(A.optimizeCoding)?A.optimizeCoding:A.optimiseCoding;if(X1.defined(Q))this._setBooleanOption("jpegOptimiseCoding",Q);if(X1.defined(A.mozjpeg))if(X1.bool(A.mozjpeg)){if(A.mozjpeg)this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3}else throw X1.invalidParameterError("mozjpeg","boolean",A.mozjpeg);let B=X1.bool(A.trellisQuantization)?A.trellisQuantization:A.trellisQuantisation;if(X1.defined(B))this._setBooleanOption("jpegTrellisQuantisation",B);if(X1.defined(A.overshootDeringing))this._setBooleanOption("jpegOvershootDeringing",A.overshootDeringing);let G=X1.bool(A.optimizeScans)?A.optimizeScans:A.optimiseScans;if(X1.defined(G)){if(this._setBooleanOption("jpegOptimiseScans",G),G)this.options.jpegProgressive=!0}let Z=X1.number(A.quantizationTable)?A.quantizationTable:A.quantisationTable;if(X1.defined(Z))if(X1.integer(Z)&&X1.inRange(Z,0,8))this.options.jpegQuantisationTable=Z;else throw X1.invalidParameterError("quantisationTable","integer between 0 and 8",Z)}return this._updateFormatOut("jpeg",A)}function ln8(A){if(X1.object(A)){if(X1.defined(A.progressive))this._setBooleanOption("pngProgressive",A.progressive);if(X1.defined(A.compressionLevel))if(X1.integer(A.compressionLevel)&&X1.inRange(A.compressionLevel,0,9))this.options.pngCompressionLevel=A.compressionLevel;else throw X1.invalidParameterError("compressionLevel","integer between 0 and 9",A.compressionLevel);if(X1.defined(A.adaptiveFiltering))this._setBooleanOption("pngAdaptiveFiltering",A.adaptiveFiltering);let Q=A.colours||A.colors;if(X1.defined(Q))if(X1.integer(Q)&&X1.inRange(Q,2,256))this.options.pngBitdepth=NsB(Q);else throw X1.invalidParameterError("colours","integer between 2 and 256",Q);if(X1.defined(A.palette))this._setBooleanOption("pngPalette",A.palette);else if([A.quality,A.effort,A.colours,A.colors,A.dither].some(X1.defined))this._setBooleanOption("pngPalette",!0);if(this.options.pngPalette){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,0,100))this.options.pngQuality=A.quality;else throw X1.invalidParameterError("quality","integer between 0 and 100",A.quality);if(X1.defined(A.effort))if(X1.integer(A.effort)&&X1.inRange(A.effort,1,10))this.options.pngEffort=A.effort;else throw X1.invalidParameterError("effort","integer between 1 and 10",A.effort);if(X1.defined(A.dither))if(X1.number(A.dither)&&X1.inRange(A.dither,0,1))this.options.pngDither=A.dither;else throw X1.invalidParameterError("dither","number between 0.0 and 1.0",A.dither)}}return this._updateFormatOut("png",A)}function in8(A){if(X1.object(A)){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.webpQuality=A.quality;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);if(X1.defined(A.alphaQuality))if(X1.integer(A.alphaQuality)&&X1.inRange(A.alphaQuality,0,100))this.options.webpAlphaQuality=A.alphaQuality;else throw X1.invalidParameterError("alphaQuality","integer between 0 and 100",A.alphaQuality);if(X1.defined(A.lossless))this._setBooleanOption("webpLossless",A.lossless);if(X1.defined(A.nearLossless))this._setBooleanOption("webpNearLossless",A.nearLossless);if(X1.defined(A.smartSubsample))this._setBooleanOption("webpSmartSubsample",A.smartSubsample);if(X1.defined(A.preset))if(X1.string(A.preset)&&X1.inArray(A.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=A.preset;else throw X1.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",A.preset);if(X1.defined(A.effort))if(X1.integer(A.effort)&&X1.inRange(A.effort,0,6))this.options.webpEffort=A.effort;else throw X1.invalidParameterError("effort","integer between 0 and 6",A.effort);if(X1.defined(A.minSize))this._setBooleanOption("webpMinSize",A.minSize);if(X1.defined(A.mixed))this._setBooleanOption("webpMixed",A.mixed)}return wsB(A,this.options),this._updateFormatOut("webp",A)}function nn8(A){if(X1.object(A)){if(X1.defined(A.reuse))this._setBooleanOption("gifReuse",A.reuse);if(X1.defined(A.progressive))this._setBooleanOption("gifProgressive",A.progressive);let Q=A.colours||A.colors;if(X1.defined(Q))if(X1.integer(Q)&&X1.inRange(Q,2,256))this.options.gifBitdepth=NsB(Q);else throw X1.invalidParameterError("colours","integer between 2 and 256",Q);if(X1.defined(A.effort))if(X1.number(A.effort)&&X1.inRange(A.effort,1,10))this.options.gifEffort=A.effort;else throw X1.invalidParameterError("effort","integer between 1 and 10",A.effort);if(X1.defined(A.dither))if(X1.number(A.dither)&&X1.inRange(A.dither,0,1))this.options.gifDither=A.dither;else throw X1.invalidParameterError("dither","number between 0.0 and 1.0",A.dither);if(X1.defined(A.interFrameMaxError))if(X1.number(A.interFrameMaxError)&&X1.inRange(A.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=A.interFrameMaxError;else throw X1.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",A.interFrameMaxError);if(X1.defined(A.interPaletteMaxError))if(X1.number(A.interPaletteMaxError)&&X1.inRange(A.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=A.interPaletteMaxError;else throw X1.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",A.interPaletteMaxError)}return wsB(A,this.options),this._updateFormatOut("gif",A)}function an8(A){if(!this.constructor.format.jp2k.output.buffer)throw qsB();if(X1.object(A)){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.jp2Quality=A.quality;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);if(X1.defined(A.lossless))if(X1.bool(A.lossless))this.options.jp2Lossless=A.lossless;else throw X1.invalidParameterError("lossless","boolean",A.lossless);if(X1.defined(A.tileWidth))if(X1.integer(A.tileWidth)&&X1.inRange(A.tileWidth,1,32768))this.options.jp2TileWidth=A.tileWidth;else throw X1.invalidParameterError("tileWidth","integer between 1 and 32768",A.tileWidth);if(X1.defined(A.tileHeight))if(X1.integer(A.tileHeight)&&X1.inRange(A.tileHeight,1,32768))this.options.jp2TileHeight=A.tileHeight;else throw X1.invalidParameterError("tileHeight","integer between 1 and 32768",A.tileHeight);if(X1.defined(A.chromaSubsampling))if(X1.string(A.chromaSubsampling)&&X1.inArray(A.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=A.chromaSubsampling;else throw X1.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",A.chromaSubsampling)}return this._updateFormatOut("jp2",A)}function wsB(A,Q){if(X1.object(A)&&X1.defined(A.loop))if(X1.integer(A.loop)&&X1.inRange(A.loop,0,65535))Q.loop=A.loop;else throw X1.invalidParameterError("loop","integer between 0 and 65535",A.loop);if(X1.object(A)&&X1.defined(A.delay))if(X1.integer(A.delay)&&X1.inRange(A.delay,0,65535))Q.delay=[A.delay];else if(Array.isArray(A.delay)&&A.delay.every(X1.integer)&&A.delay.every((B)=>X1.inRange(B,0,65535)))Q.delay=A.delay;else throw X1.invalidParameterError("delay","integer or an array of integers between 0 and 65535",A.delay)}function on8(A){if(X1.object(A)){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.tiffQuality=A.quality;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);if(X1.defined(A.bitdepth))if(X1.integer(A.bitdepth)&&X1.inArray(A.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=A.bitdepth;else throw X1.invalidParameterError("bitdepth","1, 2, 4 or 8",A.bitdepth);if(X1.defined(A.tile))this._setBooleanOption("tiffTile",A.tile);if(X1.defined(A.tileWidth))if(X1.integer(A.tileWidth)&&A.tileWidth>0)this.options.tiffTileWidth=A.tileWidth;else throw X1.invalidParameterError("tileWidth","integer greater than zero",A.tileWidth);if(X1.defined(A.tileHeight))if(X1.integer(A.tileHeight)&&A.tileHeight>0)this.options.tiffTileHeight=A.tileHeight;else throw X1.invalidParameterError("tileHeight","integer greater than zero",A.tileHeight);if(X1.defined(A.miniswhite))this._setBooleanOption("tiffMiniswhite",A.miniswhite);if(X1.defined(A.pyramid))this._setBooleanOption("tiffPyramid",A.pyramid);if(X1.defined(A.xres))if(X1.number(A.xres)&&A.xres>0)this.options.tiffXres=A.xres;else throw X1.invalidParameterError("xres","number greater than zero",A.xres);if(X1.defined(A.yres))if(X1.number(A.yres)&&A.yres>0)this.options.tiffYres=A.yres;else throw X1.invalidParameterError("yres","number greater than zero",A.yres);if(X1.defined(A.compression))if(X1.string(A.compression)&&X1.inArray(A.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=A.compression;else throw X1.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",A.compression);if(X1.defined(A.predictor))if(X1.string(A.predictor)&&X1.inArray(A.predictor,["none","horizontal","float"]))this.options.tiffPredictor=A.predictor;else throw X1.invalidParameterError("predictor","one of: none, horizontal, float",A.predictor);if(X1.defined(A.resolutionUnit))if(X1.string(A.resolutionUnit)&&X1.inArray(A.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=A.resolutionUnit;else throw X1.invalidParameterError("resolutionUnit","one of: inch, cm",A.resolutionUnit)}return this._updateFormatOut("tiff",A)}function rn8(A){return this.heif({...A,compression:"av1"})}function sn8(A){if(X1.object(A)){if(X1.string(A.compression)&&X1.inArray(A.compression,["av1","hevc"]))this.options.heifCompression=A.compression;else throw X1.invalidParameterError("compression","one of: av1, hevc",A.compression);if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.heifQuality=A.quality;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);if(X1.defined(A.lossless))if(X1.bool(A.lossless))this.options.heifLossless=A.lossless;else throw X1.invalidParameterError("lossless","boolean",A.lossless);if(X1.defined(A.effort))if(X1.integer(A.effort)&&X1.inRange(A.effort,0,9))this.options.heifEffort=A.effort;else throw X1.invalidParameterError("effort","integer between 0 and 9",A.effort);if(X1.defined(A.chromaSubsampling))if(X1.string(A.chromaSubsampling)&&X1.inArray(A.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=A.chromaSubsampling;else throw X1.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",A.chromaSubsampling);if(X1.defined(A.bitdepth))if(X1.integer(A.bitdepth)&&X1.inArray(A.bitdepth,[8,10,12])){if(A.bitdepth!==8&&this.constructor.versions.heif)throw X1.invalidParameterError("bitdepth when using prebuilt binaries",8,A.bitdepth);this.options.heifBitdepth=A.bitdepth}else throw X1.invalidParameterError("bitdepth","8, 10 or 12",A.bitdepth)}else throw X1.invalidParameterError("options","Object",A);return this._updateFormatOut("heif",A)}function tn8(A){if(X1.object(A)){if(X1.defined(A.quality))if(X1.integer(A.quality)&&X1.inRange(A.quality,1,100))this.options.jxlDistance=A.quality>=30?0.1+(100-A.quality)*0.09:0.017666666666666667*A.quality*A.quality-1.15*A.quality+25;else throw X1.invalidParameterError("quality","integer between 1 and 100",A.quality);else if(X1.defined(A.distance))if(X1.number(A.distance)&&X1.inRange(A.distance,0,15))this.options.jxlDistance=A.distance;else throw X1.invalidParameterError("distance","number between 0.0 and 15.0",A.distance);if(X1.defined(A.decodingTier))if(X1.integer(A.decodingTier)&&X1.inRange(A.decodingTier,0,4))this.options.jxlDecodingTier=A.decodingTier;else throw X1.invalidParameterError("decodingTier","integer between 0 and 4",A.decodingTier);if(X1.defined(A.lossless))if(X1.bool(A.lossless))this.options.jxlLossless=A.lossless;else throw X1.invalidParameterError("lossless","boolean",A.lossless);if(X1.defined(A.effort))if(X1.integer(A.effort)&&X1.inRange(A.effort,3,9))this.options.jxlEffort=A.effort;else throw X1.invalidParameterError("effort","integer between 3 and 9",A.effort)}return this._updateFormatOut("jxl",A)}function en8(A){if(X1.object(A)){if(X1.defined(A.depth))if(X1.string(A.depth)&&X1.inArray(A.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=A.depth;else throw X1.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",A.depth)}return this._updateFormatOut("raw")}function Aa8(A){if(X1.object(A)){if(X1.defined(A.size))if(X1.integer(A.size)&&X1.inRange(A.size,1,8192))this.options.tileSize=A.size;else throw X1.invalidParameterError("size","integer between 1 and 8192",A.size);if(X1.defined(A.overlap))if(X1.integer(A.overlap)&&X1.inRange(A.overlap,0,8192)){if(A.overlap>this.options.tileSize)throw X1.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,A.overlap);this.options.tileOverlap=A.overlap}else throw X1.invalidParameterError("overlap","integer between 0 and 8192",A.overlap);if(X1.defined(A.container))if(X1.string(A.container)&&X1.inArray(A.container,["fs","zip"]))this.options.tileContainer=A.container;else throw X1.invalidParameterError("container","one of: fs, zip",A.container);if(X1.defined(A.layout))if(X1.string(A.layout)&&X1.inArray(A.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=A.layout;else throw X1.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",A.layout);if(X1.defined(A.angle))if(X1.integer(A.angle)&&!(A.angle%90))this.options.tileAngle=A.angle;else throw X1.invalidParameterError("angle","positive/negative multiple of 90",A.angle);if(this._setBackgroundColourOption("tileBackground",A.background),X1.defined(A.depth))if(X1.string(A.depth)&&X1.inArray(A.depth,["onepixel","onetile","one"]))this.options.tileDepth=A.depth;else throw X1.invalidParameterError("depth","one of: onepixel, onetile, one",A.depth);if(X1.defined(A.skipBlanks))if(X1.integer(A.skipBlanks)&&X1.inRange(A.skipBlanks,-1,65535))this.options.tileSkipBlanks=A.skipBlanks;else throw X1.invalidParameterError("skipBlanks","integer between -1 and 255/65535",A.skipBlanks);else if(X1.defined(A.layout)&&A.layout==="google")this.options.tileSkipBlanks=5;let Q=X1.bool(A.center)?A.center:A.centre;if(X1.defined(Q))this._setBooleanOption("tileCentre",Q);if(X1.defined(A.id))if(X1.string(A.id))this.options.tileId=A.id;else throw X1.invalidParameterError("id","string",A.id);if(X1.defined(A.basename))if(X1.string(A.basename))this.options.tileBasename=A.basename;else throw X1.invalidParameterError("basename","string",A.basename)}if(X1.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw X1.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function Qa8(A){if(!X1.plainObject(A))throw X1.invalidParameterError("options","object",A);if(X1.integer(A.seconds)&&X1.inRange(A.seconds,0,3600))this.options.timeoutSeconds=A.seconds;else throw X1.invalidParameterError("seconds","integer between 0 and 3600",A.seconds);return this}function Ba8(A,Q){if(!(X1.object(Q)&&Q.force===!1))this.options.formatOut=A;return this}function Ga8(A,Q){if(X1.bool(Q))this.options[A]=Q;else throw X1.invalidParameterError(A,"boolean",Q)}function Za8(){if(!this.options.streamOut){this.options.streamOut=!0;let A=Error();this._pipeline(void 0,A)}}function Ya8(A,Q){if(typeof A==="function"){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),MDA.pipeline(this.options,(B,G,Z)=>{if(B)A(X1.nativeError(B,Q));else A(null,G,Z)})});else MDA.pipeline(this.options,(B,G,Z)=>{if(B)A(X1.nativeError(B,Q));else A(null,G,Z)});return this}else if(this.options.streamOut){if(this._isStreamInput()){if(this.once("finish",()=>{this._flattenBufferIn(),MDA.pipeline(this.options,(B,G,Z)=>{if(B)this.emit("error",X1.nativeError(B,Q));else this.emit("info",Z),this.push(G);this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished)this.emit("finish")}else MDA.pipeline(this.options,(B,G,Z)=>{if(B)this.emit("error",X1.nativeError(B,Q));else this.emit("info",Z),this.push(G);this.push(null),this.on("end",()=>this.emit("close"))});return this}else if(this._isStreamInput())return new Promise((B,G)=>{this.once("finish",()=>{this._flattenBufferIn(),MDA.pipeline(this.options,(Z,Y,J)=>{if(Z)G(X1.nativeError(Z,Q));else if(this.options.resolveWithObject)B({data:Y,info:J});else B(Y)})})});else return new Promise((B,G)=>{MDA.pipeline(this.options,(Z,Y,J)=>{if(Z)G(X1.nativeError(Z,Q));else if(this.options.resolveWithObject)B({data:Y,info:J});else B(Y)})})}LsB.exports=function(A){Object.assign(A.prototype,{toFile:vn8,toBuffer:kn8,keepExif:bn8,withExif:fn8,withExifMerge:hn8,keepIccProfile:gn8,withIccProfile:un8,keepMetadata:mn8,withMetadata:dn8,toFormat:pn8,jpeg:cn8,jp2:an8,png:ln8,webp:in8,tiff:on8,avif:rn8,heif:sn8,jxl:tn8,gif:nn8,raw:en8,tile:Aa8,timeout:Qa8,_updateFormatOut:Ba8,_setBooleanOption:Ga8,_read:Za8,_pipeline:Ya8})}});var jsB=U((j6Z,_sB)=>{var Ja8=qA("node:events"),P81=F81(),V_=uk(),{runtimePlatformArch:Xa8}=S70(),P$=cPA(),MsB=Xa8(),c70=P$.libvipsVersion(),Ro=P$.format();Ro.heif.output.alias=["avif","heic"];Ro.jpeg.output.alias=["jpe","jpg"];Ro.tiff.output.alias=["tif"];Ro.jp2k.output.alias=["j2c","j2k","jp2","jpx"];var Ia8={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"},RDA={vips:c70.semver};if(!c70.isGlobal)if(!c70.isWasm)try{RDA=qA(`@img/sharp-${MsB}/versions`)}catch(A){try{RDA=qA(`@img/sharp-libvips-${MsB}/versions`)}catch(Q){}}else try{RDA=(()=>{throw new Error("Cannot require module "+"@img/sharp-wasm32/versions");})()}catch(A){}RDA.sharp=T70().version;if(RDA.heif&&Ro.heif)Ro.heif.input.fileSuffix=[".avif"],Ro.heif.output.alias=["avif"];function RsB(A){if(V_.bool(A))if(A)return P$.cache(50,20,100);else return P$.cache(0,0,0);else if(V_.object(A))return P$.cache(A.memory,A.files,A.items);else return P$.cache()}RsB(!0);function Wa8(A){return P$.concurrency(V_.integer(A)?A:null)}if(P81.familySync()===P81.GLIBC&&!P$._isUsingJemalloc())P$.concurrency(1);else if(P81.familySync()===P81.MUSL&&P$.concurrency()===1024)P$.concurrency(qA("node:os").availableParallelism());var Da8=new Ja8.EventEmitter;function Ka8(){return P$.counters()}function Va8(A){return P$.simd(V_.bool(A)?A:null)}function Fa8(A){if(V_.object(A))if(Array.isArray(A.operation)&&A.operation.every(V_.string))P$.block(A.operation,!0);else throw V_.invalidParameterError("operation","Array<string>",A.operation);else throw V_.invalidParameterError("options","object",A)}function Ha8(A){if(V_.object(A))if(Array.isArray(A.operation)&&A.operation.every(V_.string))P$.block(A.operation,!1);else throw V_.invalidParameterError("operation","Array<string>",A.operation);else throw V_.invalidParameterError("options","object",A)}_sB.exports=function(A){A.cache=RsB,A.concurrency=Wa8,A.counters=Ka8,A.simd=Va8,A.format=Ro,A.interpolators=Ia8,A.versions=RDA,A.queue=Da8,A.block=Fa8,A.unblock=Ha8}});var l70=U((P6Z,TsB)=>{var fm=brB();BsB()(fm);IsB()(fm);DsB()(fm);FsB()(fm);zsB()(fm);$sB()(fm);OsB()(fm);jsB()(fm);TsB.exports=fm});async function i70(){if(S81)return S81.default;if(wG())try{let B=await Promise.resolve().then(() => (ZoB(),GoB)),G=B.sharp||B.default;return S81={default:G},G}catch{console.warn("Native image processor not available, falling back to sharp")}let A=await Promise.resolve().then(() => c(l70(),1)),Q=A?.default||A;return S81={default:Q},Q}var S81=null;var PsB=()=>{};function Ca8(A){if(A instanceof Error){let B=A;if(B.code==="MODULE_NOT_FOUND"||B.code==="ERR_MODULE_NOT_FOUND"||B.code==="ERR_DLOPEN_FAILED")return SsB}let Q=A instanceof Error?A.message:String(A);if(Q.includes("Native image processor module not available"))return SsB;if(Q.includes("unsupported image format")||Q.includes("Input buffer")||Q.includes("Input file is missing")||Q.includes("Input file has corrupt header"))return Ea8;return za8}function hm(A){if(A<1024)return`${A} B`;if(A<1048576)return`${(A/1024).toFixed(1)} KB`;return`${(A/1048576).toFixed(1)} MB`}async function _DA(A,Q,B){try{let G=await i70(),Y=await G(A).metadata(),J=Y.format??B,X=J==="jpg"?"jpeg":J;if(!Y.width||!Y.height){if(Q>AP)return{buffer:await G(A).jpeg({quality:80}).toBuffer(),mediaType:"jpeg"};return{buffer:A,mediaType:X}}let{width:I,height:W}=Y,D=I,K=W;if(Q<=AP&&D<=OXA&&K<=MXA)return{buffer:A,mediaType:X,dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}};let V=D>OXA||K>MXA,F=X==="png";if(!V&&Q>AP){if(F){let E=await G(A).png({compressionLevel:9,palette:!0}).toBuffer();if(E.length<=AP)return{buffer:E,mediaType:"png",dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}}}for(let E of[80,60,40,20]){let z=await G(A).jpeg({quality:E}).toBuffer();if(z.length<=AP)return{buffer:z,mediaType:"jpeg",dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}}}}if(D>OXA)K=Math.round(K*OXA/D),D=OXA;if(K>MXA)D=Math.round(D*MXA/K),K=MXA;k(`Resizing to ${D}x${K}`);let H=await G(A).resize(D,K,{fit:"inside",withoutEnlargement:!0}).toBuffer();if(H.length>AP){if(F){let O=await G(A).resize(D,K,{fit:"inside",withoutEnlargement:!0}).png({compressionLevel:9,palette:!0}).toBuffer();if(O.length<=AP)return{buffer:O,mediaType:"png",dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}}}for(let O of[80,60,40,20]){let L=await G(A).resize(D,K,{fit:"inside",withoutEnlargement:!0}).jpeg({quality:O}).toBuffer();if(L.length<=AP)return{buffer:L,mediaType:"jpeg",dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}}}let E=Math.min(D,1000),z=Math.round(K*E/Math.max(D,1));k("Still too large, compressing with JPEG");let C=await G(A).resize(E,z,{fit:"inside",withoutEnlargement:!0}).jpeg({quality:20}).toBuffer();return k(`JPEG compressed buffer size: ${C.length}`),{buffer:C,mediaType:"jpeg",dimensions:{originalWidth:I,originalHeight:W,displayWidth:E,displayHeight:z}}}return{buffer:H,mediaType:X,dimensions:{originalWidth:I,originalHeight:W,displayWidth:D,displayHeight:K}}}catch(G){s(G);let Z=Ca8(G);p("tengu_image_resize_failed",{original_size_bytes:Q,error_type:Z});let Y=B==="jpg"?"jpeg":B,J=Math.ceil(Q*4/3);if(J<=LXA)return p("tengu_image_resize_fallback",{original_size_bytes:Q,base64_size_bytes:J,error_type:Z}),{buffer:A,mediaType:Y};throw new Z9A(`Unable to resize image (${hm(Q)} raw, ${hm(J)} base64). The image exceeds the 5MB API limit and compression failed. Please resize the image manually or use a smaller image.`)}}async function n70(A){if(A.source.type!=="base64")return{block:A};let Q=Buffer.from(A.source.data,"base64"),B=Q.length,Z=A.source.media_type?.split("/")[1]||"png",Y=await _DA(Q,B,Z);return{block:{type:"image",source:{type:"base64",media_type:`image/${Y.mediaType}`,data:Y.buffer.toString("base64")}},dimensions:Y.dimensions}}async function Y9A(A,Q=AP,B){let G=B?.split("/")[1]||"jpeg",Z=G==="jpg"?"jpeg":G;try{let Y=await i70(),J=await Y(A).metadata(),X=J.format||Z,I=A.length,W={imageBuffer:A,metadata:J,format:X,maxBytes:Q,originalSize:I};if(I<=Q)return oPA(A,X,I);let D=await $a8(W,Y);if(D)return D;if(X==="png"){let V=await qa8(W,Y);if(V)return V}let K=await Na8(W,50,Y);if(K)return K;return await wa8(W,Y)}catch(Y){if(s(Y),p("tengu_image_compress_failed",{original_size_bytes:A.length,max_bytes:Q}),A.length<=Q)return{base64:A.toString("base64"),mediaType:`image/${Z}`,originalSize:A.length};throw new Z9A(`Unable to compress image (${hm(A.length)}) to fit within ${hm(Q)}. Please use a smaller image.`)}}async function xsB(A,Q,B){let G=Math.floor(Q/0.125),Z=Math.floor(G*0.75);return Y9A(A,Z,B)}async function ysB(A,Q=AP){if(A.source.type!=="base64")return A;let B=Buffer.from(A.source.data,"base64");if(B.length<=Q)return A;let G=await Y9A(B,Q);return{type:"image",source:{type:"base64",media_type:G.mediaType,data:G.base64}}}function oPA(A,Q,B){let G=Q==="jpg"?"jpeg":Q;return{base64:A.toString("base64"),mediaType:`image/${G}`,originalSize:B}}async function $a8(A,Q){let B=[1,0.75,0.5,0.25];for(let G of B){let Z=Math.round((A.metadata.width||2000)*G),Y=Math.round((A.metadata.height||2000)*G),J=Q(A.imageBuffer).resize(Z,Y,{fit:"inside",withoutEnlargement:!0});J=Ua8(J,A.format);let X=await J.toBuffer();if(X.length<=A.maxBytes)return oPA(X,A.format,A.originalSize)}return null}function Ua8(A,Q){switch(Q){case"png":return A.png({compressionLevel:9,palette:!0});case"jpeg":case"jpg":return A.jpeg({quality:80});case"webp":return A.webp({quality:80});default:return A}}async function qa8(A,Q){let B=await Q(A.imageBuffer).resize(800,800,{fit:"inside",withoutEnlargement:!0}).png({compressionLevel:9,palette:!0,colors:64}).toBuffer();if(B.length<=A.maxBytes)return oPA(B,"png",A.originalSize);return null}async function Na8(A,Q,B){let G=await B(A.imageBuffer).resize(600,600,{fit:"inside",withoutEnlargement:!0}).jpeg({quality:Q}).toBuffer();if(G.length<=A.maxBytes)return oPA(G,"jpeg",A.originalSize);return null}async function wa8(A,Q){let B=await Q(A.imageBuffer).resize(400,400,{fit:"inside",withoutEnlargement:!0}).jpeg({quality:20}).toBuffer();return oPA(B,"jpeg",A.originalSize)}function jDA(A,Q){let{originalWidth:B,originalHeight:G,displayWidth:Z,displayHeight:Y}=A;if(!B||!G||!Z||!Y||Z<=0||Y<=0){if(Q)return`[Image source: ${Q}]`;return null}let J=B!==Z||G!==Y;if(!J&&!Q)return null;let X=[];if(Q)X.push(`source: ${Q}`);if(J){let I=B/Z;X.push(`original ${B}x${G}, displayed at ${Z}x${Y}. Multiply coordinates by ${I.toFixed(2)} to map to original image.`)}return`[Image: ${X.join(", ")}]`}var SsB=1,Ea8=2,za8=3,Z9A;var lk=w(()=>{f1();y1();Z0();PsB();n11();Z9A=class Z9A extends Error{constructor(A){super(A);this.name="ImageResizeError"}}});function La8(A){if(typeof A!=="object"||A===null)return!1;let Q=A;if(Q.type!=="image")return!1;if(typeof Q.source!=="object"||Q.source===null)return!1;let B=Q.source;return B.type==="base64"&&typeof B.data==="string"}function vsB(A){let Q=[],B=0;for(let G of A){if(typeof G!=="object"||G===null)continue;let Z=G;if(Z.type!=="user")continue;let Y=Z.message;if(!Y)continue;let J=Y.content;if(typeof J==="string"||!Array.isArray(J))continue;for(let X of J)if(La8(X)){B++;let I=X.source.data.length;if(I>LXA)p("tengu_image_api_validation_failed",{base64_size_bytes:I,max_bytes:LXA}),Q.push({index:B,size:I})}}if(Q.length>0)throw new TDA(Q,LXA)}var TDA;var x81=w(()=>{Z0();n11();lk();TDA=class TDA extends Error{constructor(A,Q){let B,G=A[0];if(A.length===1&&G)B=`Image base64 size (${hm(G.size)}) exceeds API limit (${hm(Q)}). Please resize the image before sending.`;else B=`${A.length} images exceed the API limit (${hm(Q)}): `+A.map((Z)=>`Image ${Z.index}: ${hm(Z.size)}`).join(", ")+". Please resize these images before sending.";super(B);this.name="ImageSizeError"}}});function Oa8(){return n2()?"PDF too large. Try reading the file a different way (e.g., extract text with a CLI tool).":"PDF too large. Please double press esc to edit your message and try again."}function Ma8(){return n2()?"PDF is password protected. Try using a CLI tool to extract or convert the PDF.":"PDF is password protected. Please double press esc to edit your message and try again."}function Ra8(){return n2()?"Image was too large. Try resizing the image or using a different approach.":"Image was too large. Double press esc to go back and try again with a smaller image."}function ja8(A,Q,B){try{let G=-1;for(let X=0;X<B.length;X++){let I=B[X];if(!I)continue;let W=I.message.content;if(Array.isArray(W)){for(let D of W)if(D.type==="tool_use"&&"id"in D&&D.id===A){G=X;break}}if(G!==-1)break}let Z=-1;for(let X=0;X<Q.length;X++){let I=Q[X];if(!I)continue;if(I.type==="assistant"&&"message"in I){let W=I.message.content;if(Array.isArray(W)){for(let D of W)if(D.type==="tool_use"&&"id"in D&&D.id===A){Z=X;break}}}if(Z!==-1)break}let Y=[];for(let X=G+1;X<B.length;X++){let I=B[X];if(!I)continue;let W=I.message.content;if(Array.isArray(W))for(let D of W){let K=I.message.role;if(D.type==="tool_use"&&"id"in D)Y.push(`${K}:tool_use:${D.id}`);else if(D.type==="tool_result"&&"tool_use_id"in D)Y.push(`${K}:tool_result:${D.tool_use_id}`);else if(D.type==="text")Y.push(`${K}:text`);else if(D.type==="thinking")Y.push(`${K}:thinking`);else if(D.type==="image")Y.push(`${K}:image`);else Y.push(`${K}:${D.type}`)}else if(typeof W==="string")Y.push(`${I.message.role}:string_content`)}let J=[];for(let X=Z+1;X<Q.length;X++){let I=Q[X];if(!I)continue;switch(I.type){case"user":case"assistant":{if("message"in I){let W=I.message.content;if(Array.isArray(W))for(let D of W){let K=I.message.role;if(D.type==="tool_use"&&"id"in D)J.push(`${K}:tool_use:${D.id}`);else if(D.type==="tool_result"&&"tool_use_id"in D)J.push(`${K}:tool_result:${D.tool_use_id}`);else if(D.type==="text")J.push(`${K}:text`);else if(D.type==="thinking")J.push(`${K}:thinking`);else if(D.type==="image")J.push(`${K}:image`);else J.push(`${K}:${D.type}`)}else if(typeof W==="string")J.push(`${I.message.role}:string_content`)}break}case"attachment":if("attachment"in I)J.push(`attachment:${I.attachment.type}`);break;case"system":if("subtype"in I)J.push(`system:${I.subtype}`);break;case"progress":if("progress"in I&&I.progress&&typeof I.progress==="object"&&"type"in I.progress)J.push(`progress:${I.progress.type??"unknown"}`);else J.push("progress:unknown");break}}p("tengu_tool_use_tool_result_mismatch_error",{toolUseId:A,normalizedSequence:Y.join(", "),preNormalizedSequence:J.join(", "),normalizedMessageCount:B.length,originalMessageCount:Q.length,normalizedToolUseIndex:G,originalToolUseIndex:Z})}catch(G){}}function o70(A,Q,B){if(A instanceof Bk||A instanceof X$&&A.message.toLowerCase().includes("timeout"))return yZ({content:f81,error:"unknown"});if(A instanceof TDA||A instanceof Z9A)return yZ({content:A.message});if(A instanceof Error&&A.message.includes(J9A))return yZ({content:J9A,error:"rate_limit"});if(A instanceof C9&&A.status===429&&HDA(OB())){let G=A.headers?.get?.("anthropic-ratelimit-unified-representative-claim"),Z=A.headers?.get?.("anthropic-ratelimit-unified-overage-status");if(G||Z){let Y={status:"rejected",unifiedRateLimitFallbackAvailable:!1,isUsingOverage:!1},J=A.headers?.get?.("anthropic-ratelimit-unified-reset");if(J)Y.resetsAt=Number(J);if(G)Y.rateLimitType=G;if(Z)Y.overageStatus=Z;let X=A.headers?.get?.("anthropic-ratelimit-unified-overage-reset");if(X)Y.overageResetsAt=Number(X);let I=A.headers?.get?.("anthropic-ratelimit-unified-overage-disabled-reason");if(I)Y.overageDisabledReason=I;let W=E70(Y,Q);if(W)return yZ({content:W,error:"rate_limit"});return yZ({content:X9A,error:"rate_limit"})}return yZ({content:`${sD}: Rate limit reached`,error:"rate_limit"})}if(A instanceof Error&&A.message.toLowerCase().includes("prompt is too long"))return yZ({content:_o,error:"invalid_request"});if(A instanceof Error&&/maximum of \d+ PDF pages/.test(A.message))return yZ({content:Oa8(),error:"invalid_request"});if(A instanceof Error&&A.message.includes("The PDF specified is password protected"))return yZ({content:Ma8(),error:"invalid_request"});if(A instanceof C9&&A.status===400&&A.message.includes("image exceeds")&&A.message.includes("maximum"))return yZ({content:Ra8()});if(A instanceof C9&&A.status===400&&A.message.includes("`tool_use` ids were found without `tool_result` blocks immediately after")){if(B?.messages&&B?.messagesForAPI){let G=A.message.match(/toolu_[a-zA-Z0-9]+/),Z=G?G[0]:null;if(Z)ja8(Z,B.messages,B.messagesForAPI)}{let Z=n2()?"":" Run /rewind to recover the conversation.";return yZ({content:"API Error: 400 due to tool use concurrency issues."+Z,error:"invalid_request"})}}if(A instanceof C9&&A.status===400&&A.message.includes("unexpected `tool_use_id` found in `tool_result`"))p("tengu_unexpected_tool_result",{});if(OB()&&A instanceof C9&&A.status===400&&A.message.toLowerCase().includes("invalid model name")&&(VJA(Q)||Q==="opus"))return yZ({content:"Claude Opus is not available with the Claude Pro plan. If you have updated your subscription plan recently, run /logout and /login for the plan to take effect.",error:"invalid_request"});if(A instanceof Error&&A.message.includes("Your credit balance is too low"))return yZ({content:y81,error:"billing_error"});if(A instanceof Error&&A.message.toLowerCase().includes("x-api-key")){let{source:G}=Rz();return yZ({error:"authentication_failed",content:G==="ANTHROPIC_API_KEY"||G==="apiKeyHelper"?k81:v81})}if(A instanceof C9&&A.status===403&&A.message.includes("OAuth token has been revoked"))return yZ({error:"authentication_failed",content:b81});if(A instanceof C9&&(A.status===401||A.status===403)&&A.message.includes("OAuth authentication is currently not allowed for this organization"))return yZ({error:"authentication_failed",content:_a8});if(A instanceof C9&&(A.status===401||A.status===403))return yZ({error:"authentication_failed",content:`${sD}: ${A.message} 路 Please run /login`});if(i1(process.env.CLAUDE_CODE_USE_BEDROCK)&&A instanceof Error&&A.message.toLowerCase().includes("model id"))return yZ({content:`${sD} (${Q}): ${A.message}`,error:"invalid_request"});if(A instanceof Error)return yZ({content:`${sD}: ${A.message}`,error:"unknown"});return yZ({content:sD,error:"unknown"})}function ksB(A){if(A instanceof Bk||A instanceof X$&&A.message.toLowerCase().includes("timeout"))return"api_timeout";if(A instanceof Error&&A.message.includes(a70))return"repeated_529";if(A instanceof Error&&A.message.includes(J9A))return"capacity_off_switch";if(A instanceof C9&&A.status===429)return"rate_limit";if(A instanceof C9&&(A.status===529||A.message?.includes('"type":"overloaded_error"')))return"server_overload";if(A instanceof Error&&A.message.toLowerCase().includes(_o.toLowerCase()))return"prompt_too_long";if(A instanceof Error&&/maximum of \d+ PDF pages/.test(A.message))return"pdf_too_large";if(A instanceof Error&&A.message.includes("The PDF specified is password protected"))return"pdf_password_protected";if(A instanceof C9&&A.status===400&&A.message.includes("image exceeds")&&A.message.includes("maximum"))return"image_too_large";if(A instanceof C9&&A.status===400&&A.message.includes("`tool_use` ids were found without `tool_result` blocks immediately after"))return"tool_use_mismatch";if(A instanceof C9&&A.status===400&&A.message.includes("unexpected `tool_use_id` found in `tool_result`"))return"unexpected_tool_result";if(A instanceof C9&&A.status===400&&A.message.toLowerCase().includes("invalid model name"))return"invalid_model";if(A instanceof Error&&A.message.toLowerCase().includes(y81.toLowerCase()))return"credit_balance_low";if(A instanceof Error&&A.message.toLowerCase().includes("x-api-key"))return"invalid_api_key";if(A instanceof C9&&A.status===403&&A.message.includes("OAuth token has been revoked"))return"token_revoked";if(A instanceof C9&&(A.status===401||A.status===403)&&A.message.includes("OAuth authentication is currently not allowed for this organization"))return"oauth_org_not_allowed";if(A instanceof C9&&(A.status===401||A.status===403))return"auth_error";if(i1(process.env.CLAUDE_CODE_USE_BEDROCK)&&A instanceof Error&&A.message.toLowerCase().includes("model id"))return"bedrock_model_access";if(A instanceof C9){let Q=A.status;if(Q>=500)return"server_error";if(Q>=400)return"client_error"}if(A instanceof X$){if(gPA(A)?.isSSLError)return"ssl_cert_error";return"connection_error"}return"unknown"}function bsB(A,Q){if(A!=="refusal")return;p("tengu_refusal_api_response",{});let B=n2()?`${sD}: Claude Code is unable to respond to this request, which appears to violate our Usage Policy (https://www.anthropic.com/legal/aup). Try rephrasing the request or attempting a different approach.`:`${sD}: Claude Code is unable to respond to this request, which appears to violate our Usage Policy (https://www.anthropic.com/legal/aup). Please double press esc to edit your last message or start a new session for Claude Code to assist with a different task.`;return yZ({content:B+(Q!=="claude-sonnet-4-20250514"?" If you are seeing this refusal repeatedly, try running /model claude-sonnet-4-20250514 to switch models.":""),error:"invalid_request"})}var sD="API Error",_o="Prompt is too long",y81="Credit balance is too low",v81="Invalid API key 路 Please run /login",k81="Invalid API key 路 Fix external API key",uL="(no content)",b81="OAuth token revoked 路 Please run /login",a70="Repeated 529 Overloaded errors",J9A="Opus is experiencing high load, please use /model to switch to Sonnet",f81="Request timed out",_a8="Your account does not have access to Claude Code. Please run /login.";var mL=w(()=>{zk();eB();eQ();m2();Z0();gk();hPA();bQ();q0();CDA();x81();lk()});async function*g81(A,Q,B){let G=ba8(B),Z={model:B.model,maxThinkingTokens:B.maxThinkingTokens},Y=null,J=0,X;for(let I=1;I<=G+1;I++){if(B.signal?.aborted)throw new BI;try{if(Y===null||X instanceof C9&&X.status===401||hsB(X)){if(X instanceof C9&&X.status===401){let W=f4()?.accessToken;if(W)await ueA(W)}Y=await A()}return await Q(Y,I,Z)}catch(W){if(X=W,ya8(W)&&(process.env.FALLBACK_FOR_ALL_PRIMARY_MODELS||!OB()&&VJA(B.model))){if(J++,J>=Pa8){if(B.fallbackModel)throw p("tengu_api_opus_fallback_triggered",{original_model:B.model,fallback_model:B.fallbackModel,provider:KT()}),new h81(B.model,B.fallbackModel);if(!process.env.IS_SANDBOX)throw p("tengu_api_custom_529_overloaded_error",{}),new jo(Error(a70),Z)}}if(I>G)throw new jo(W,Z);if(!va8(W)&&(!(W instanceof C9)||!ka8(W)))throw new jo(W,Z);if(W instanceof C9){let F=fsB(W);if(F){let{inputTokens:H,contextLimit:E}=F,z=1000,C=Math.max(0,E-H-1000);if(C<r70)throw s(Error(`availableContext ${C} is less than FLOOR_OUTPUT_TOKENS ${r70}`)),W;let O=(Z.maxThinkingTokens||0)+1,L=Math.max(r70,C,O);Z.maxTokensOverride=L,p("tengu_max_tokens_context_overflow_adjustment",{inputTokens:H,contextLimit:E,adjustedMaxTokens:L,attempt:I});continue}}let K=xa8(W),V=s70(I,K);if(W instanceof C9)yield gsB(W,V,I,G);p("tengu_api_retry",{attempt:I,delayMs:V,error:W.message,status:W.status,provider:KT()}),await W81(V,B.signal)}}throw new jo(X,Z)}function xa8(A){return(A.headers?.["retry-after"]||A.headers?.get?.("retry-after"))??null}function s70(A,Q){if(Q){let Z=parseInt(Q,10);if(!isNaN(Z))return Z*1000}let B=Math.min(Sa8*Math.pow(2,A-1),32000),G=Math.random()*0.25*B;return B+G}function fsB(A){if(A.status!==400||!A.message)return;if(!A.message.includes("input length and `max_tokens` exceed context limit"))return;let Q=/input length and `max_tokens` exceed context limit: (\d+) \+ (\d+) > (\d+)/,B=A.message.match(Q);if(!B||B.length!==4)return;if(!B[1]||!B[2]||!B[3]){s(Error("Unable to parse max_tokens from max_tokens exceed context limit error message"));return}let G=parseInt(B[1],10),Z=parseInt(B[2],10),Y=parseInt(B[3],10);if(isNaN(G)||isNaN(Z)||isNaN(Y))return;return{inputTokens:G,maxTokens:Z,contextLimit:Y}}function ya8(A){if(!(A instanceof C9))return!1;return A.status===529||(A.message?.includes('"type":"overloaded_error"')??!1)}function hsB(A){if(i1(process.env.CLAUDE_CODE_USE_BEDROCK)){if(y0B(A)||A instanceof C9&&A.status===403)return!0}return!1}function va8(A){if(hsB(A))return geA(),!0;return!1}function ka8(A){if(raB(A))return!1;if(A.message?.includes('"type":"overloaded_error"'))return!0;if(fsB(A))return!0;let Q=A.headers?.get("x-should-retry");if(Q==="true"&&!OB())return!0;if(Q==="false")return!1;if(A instanceof X$)return!0;if(!A.status)return!1;if(A.status===408)return!0;if(A.status===409)return!0;if(A.status===429)return!OB();if(A.status===401)return heA(),!0;if(A.status&&A.status>=500)return!0;return!1}function ba8(A){if(A.maxRetries)return A.maxRetries;if(process.env.CLAUDE_CODE_MAX_RETRIES)return parseInt(process.env.CLAUDE_CODE_MAX_RETRIES,10);return Ta8}var Ta8=10,r70=3000,Pa8=3,Sa8=500,jo,h81;var u81=w(()=>{zk();f1();m2();jD();eB();Z0();mL();Ll1();hPA();eQ();CDA();bQ();jo=class jo extends Error{originalError;retryContext;constructor(A,Q){let B=A instanceof Error?A.message:String(A);super(B);this.originalError=A;this.retryContext=Q;if(this.name="RetryError",A instanceof Error&&A.stack)this.stack=A.stack}};h81=class h81 extends Error{originalModel;fallbackModel;constructor(A,Q){super(`Model fallback triggered: ${A} -> ${Q}`);this.originalModel=A;this.fallbackModel=Q;this.name="FallbackTriggeredError"}}});import{createHash as dsB}from"crypto";import{dirname as m81,join as psB}from"path";import*as csB from"path";function t70(){return!1}async function fa8(A,Q,B){if(!t70())return await B();let G=dsB("sha1").update(Q1(A)).digest("hex").slice(0,12),Z=psB(process.env.CLAUDE_CODE_TEST_FIXTURES_ROOT??c1(),`fixtures/${Q}-${G}.json`);if(xA().existsSync(Z))return QQ(xA().readFileSync(Z,{encoding:"utf8"}));if(n0.isCI)throw Error(`Fixture missing: ${Z}. Re-run npm test locally, then commit the result.`);let Y=await B();if(!xA().existsSync(m81(Z)))xA().mkdirSync(m81(Z));return bB(Z,Q1(Y,null,2),{encoding:"utf8",flush:!1}),Y}async function e70(A,Q){if(!t70())return await Q();let B=XI(A.filter((J)=>{if(J.type!=="user")return!0;if(J.isMeta)return!1;return!0})),G=ga8(B.map((J)=>J.message.content),msB),Z=psB(process.env.CLAUDE_CODE_TEST_FIXTURES_ROOT??c1(),`fixtures/${G.map((J)=>dsB("sha1").update(Q1(J)).digest("hex").slice(0,6)).join("-")}.json`);if(xA().existsSync(Z)){let J=QQ(xA().readFileSync(Z,{encoding:"utf8"}));return J.output.forEach(ha8),J.output.map((X,I)=>usB(X,ma8,I))}if(n0.isCI)throw Error(`Anthropic API fixture missing: ${Z}. Re-run npm test locally, then commit the result. Input messages:
1184:`)}`}var gm="MCPSearch";var rsB={};U5(rsB,{modelSupportsToolReference:()=>asB,isToolSearchEnabledOptimistic:()=>um,isToolSearchEnabled:()=>GG0,isToolReferenceBlock:()=>To,isMcpSearchToolAvailable:()=>osB,getMcpMode:()=>pa8,getExternalMcpMode:()=>I9A,getAutoToolSearchCharThreshold:()=>nsB});function nsB(A){let Q=DeA(A),B=cC(A,Q);return Math.floor(B*isB*da8)}function pa8(){if(process.env.ENABLE_TOOL_SEARCH==="auto")return"tst-auto";if(i1(process.env.ENABLE_TOOL_SEARCH))return"tst";if(i1(process.env.ENABLE_MCP_CLI))return"mcp-cli";if(dX(process.env.ENABLE_MCP_CLI))return"standard";if(dX(process.env.ENABLE_TOOL_SEARCH))return"standard";return"tst-auto"}function I9A(){if(process.env.ENABLE_TOOL_SEARCH==="auto")return"tst-auto";if(i1(process.env.ENABLE_TOOL_SEARCH))return"tst";if(i1(process.env.ENABLE_EXPERIMENTAL_MCP_CLI))return"mcp-cli";if(dX(process.env.ENABLE_TOOL_SEARCH))return"standard";if(dX(process.env.ENABLE_EXPERIMENTAL_MCP_CLI))return"standard";if(!gD())try{if(_z("tengu_mcp_tool_search",!1))return"tst-auto"}catch{}return"standard"}function la8(){try{let A=_z("tengu_tool_search_unsupported_models",null);if(A&&Array.isArray(A)&&A.length>0)return A}catch{}return ca8}function asB(A){let Q=A.toLowerCase(),B=la8();for(let G of B)if(Q.includes(G.toLowerCase()))return!1;return!0}function um(){switch(I9A()){case"tst":case"tst-auto":return!0;case"mcp-cli":case"standard":return!1}}function osB(A){return A.some((Q)=>Q.name===gm)}async function ia8(A,Q,B){let G=A.filter((Y)=>Y.isMcp);if(G.length===0)return 0;return(await Promise.all(G.map((Y)=>Y.prompt({getToolPermissionContext:Q,tools:A,agents:B})))).reduce((Y,J)=>Y+J.length,0)}async function GG0(A,Q,B,G){let Z=Q.filter((X)=>X.isMcp).length;function Y(X,I,W,D){p("tengu_tool_search_mode_decision",{enabled:X,mode:I,reason:W,checkedModel:A,mcpToolCount:Z,userType:"external",...D})}if(!asB(A))return k(`Tool search disabled for model '${A}': model does not support tool_reference blocks. This feature is only available on Claude Sonnet 4+, Opus 4+, and newer models.`),Y(!1,"standard","model_unsupported"),!1;if(!osB(Q))return k("Tool search disabled: MCPSearchTool is not available (may have been disallowed via disallowedTools)."),Y(!1,"standard","mcp_search_unavailable"),!1;let J=I9A();switch(J){case"tst":return Y(!0,J,"tst_enabled"),!0;case"tst-auto":{let X=await ia8(Q,B,G),I=nsB(A),W=X>=I;return k(`Auto tool search ${W?"enabled":"disabled"}: ${X} chars (threshold: ${I}, ${Math.round(isB*100)}% of context)`),Y(W,J,W?"auto_above_threshold":"auto_below_threshold",{mcpToolDescriptionChars:X,threshold:I}),W}case"mcp-cli":return Y(!1,J,"mcp_cli_mode"),!1;case"standard":return Y(!1,J,"standard_mode"),!1}}function To(A){return typeof A==="object"&&A!==null&&"type"in A&&A.type==="tool_reference"}var isB=0.1,da8=2.5,ca8;var ik=w(()=>{M3();Yu();Z0();bQ();y1();oj();Mq();ca8=["haiku"]});function esB(A){for(let Q of A)if(Q.role==="assistant"&&Array.isArray(Q.content)){for(let B of Q.content)if(typeof B==="object"&&B!==null&&"type"in B&&(B.type==="thinking"||B.type==="redacted_thinking"))return!0}return!1}function na8(A){return A.map((Q)=>{if(!Array.isArray(Q.content))return Q;let B=Q.content.map((G)=>{if(G.type==="tool_use"){let Z=G;return{type:"tool_use",id:Z.id,name:Z.name,input:Z.input}}if(G.type==="tool_result"){let Z=G;if(Array.isArray(Z.content)){let Y=Z.content.filter((J)=>!To(J));if(Y.length===0)return{...Z,content:[{type:"text",text:"[tool references]"}]};if(Y.length!==Z.content.length)return{...Z,content:Y}}}return G});return{...Q,content:B}})}async function AtB(A){if(!A)return 0;return rPA([{role:"user",content:A}],[])}async function rPA(A,Q){return lsB(A,Q,async()=>{try{let B=d3(),G=TH(B),Z=esB(A);if(a4()==="bedrock")return oa8({model:Gu(B),messages:A,tools:Q,betas:G,containsThinking:Z});let Y=await nH({maxRetries:1,model:B}),J=a4()==="vertex"?G.filter((I)=>T$1.has(I)):G,X=await Y.beta.messages.countTokens({model:Gu(B),messages:A.length>0?A:[{role:"user",content:"foo"}],tools:Q,...J.length>0?{betas:J}:{},...Z?{thinking:{type:"enabled",budget_tokens:ZG0}}:{}});if(typeof X.input_tokens!=="number")return null;return X.input_tokens}catch(B){return s(B),null}})}function l7(A){return Math.round(A.length/4)}async function QtB(A,Q){let B=esB(A),G=i1(process.env.CLAUDE_CODE_USE_VERTEX)&&vmA(_W())==="global",Z=i1(process.env.CLAUDE_CODE_USE_BEDROCK)&&B,Y=i1(process.env.CLAUDE_CODE_USE_VERTEX)&&B,J=G||Z||Y?WR():_W(),X=await nH({maxRetries:1,model:J}),I=na8(A),W=I.length>0?I:[{role:"user",content:"count"}],D=TH(J),K=a4()==="vertex"?D.filter((C)=>T$1.has(C)):D,F=(await X.beta.messages.create({model:Gu(J),max_tokens:B?tsB:1,messages:W,tools:Q.length>0?Q:void 0,...K.length>0?{betas:K}:{},metadata:No(),...p81(),...B?{thinking:{type:"enabled",budget_tokens:ZG0}}:{}})).usage,H=F.input_tokens,E=F.cache_creation_input_tokens||0,z=F.cache_read_input_tokens||0;return H+E+z}function YG0(A){let Q=0;for(let B of A)Q+=JG0(B);return Q}function JG0(A){if(A.type!=="assistant"&&A.type!=="user"||!A.message?.content)return 0;return BtB(A.message?.content)}function BtB(A){if(!A)return 0;if(typeof A==="string")return l7(A);let Q=0;for(let B of A)Q+=aa8(B);return Q}function aa8(A){if(typeof A==="string")return l7(A);if(A.type==="text")return l7(A.text);if(A.type==="image")return 1334;if(A.type==="tool_result")return BtB(A.content);return 0}async function oa8({model:A,messages:Q,tools:B,betas:G,containsThinking:Z}){try{let Y=await YsQ(),J=Fp1(A)?A:await ltA(A);if(!J)return null;let X={anthropic_version:"bedrock-2023-05-31",messages:Q.length>0?Q:[{role:"user",content:"foo"}],max_tokens:Z?tsB:1,...B.length>0?{tools:B}:{},...G.length>0?{anthropic_beta:G}:{},...Z?{thinking:{type:"enabled",budget_tokens:ZG0}}:{}},I={modelId:J,input:{invokeModel:{body:new TextEncoder().encode(Q1(X))}}};return(await Y.send(new ssB.CountTokensCommand(I))).inputTokens??null}catch(Y){return s(Y),null}}var ssB,ZG0=1024,tsB=2048;var YN=w(()=>{qo();f1();m2();Mq();F5A();WY();bQ();QG0();jD();jLA();ik();e1();ssB=c(JsA(),1)});function mm(A){if(A?.type==="assistant"&&"usage"in A.message&&!(A.message.content[0]?.type==="text"&&XG0.has(A.message.content[0].text))&&A.message.model!==PDA)return A.message.usage;return}function sPA(A){return A.input_tokens+(A.cache_creation_input_tokens??0)+(A.cache_read_input_tokens??0)+A.output_tokens}function nK(A){let Q=A.length-1;while(Q>=0){let B=A[Q],G=B?mm(B):void 0;if(G)return sPA(G);Q--}return 0}function GtB(A){let Q=A.length-1;while(Q>=0){let B=A[Q],G=B?mm(B):void 0;if(G)return G.output_tokens;Q--}return 0}function ZtB(A){for(let Q=A.length-1;Q>=0;Q--){let B=A[Q],G=B?mm(B):void 0;if(G)return{input_tokens:G.input_tokens,output_tokens:G.output_tokens,cache_creation_input_tokens:G.cache_creation_input_tokens??0,cache_read_input_tokens:G.cache_read_input_tokens??0}}return null}function c81(A){for(let B=A.length-1;B>=0;B--){let G=A[B];if(G?.type==="assistant"){let Z=mm(G);if(Z)return sPA(Z)>200000;return!1}}return!1}function YtB(A){if(A<1000)return`~${A}`;return`~${(A/1000).toFixed(1)}k`}function l81(A){let Q=0;for(let B of A.message.content)if(B.type==="text")Q+=B.text.length;else if(B.type==="thinking")Q+=B.thinking.length;else if(B.type==="redacted_thinking")Q+=B.data.length;else if(B.type==="tool_use")Q+=Q1(B.input).length;return Q}function i81(A){let Q=A.length-1;while(Q>=0){let B=A[Q],G=B?mm(B):void 0;if(G)return sPA(G)+YG0(A.slice(Q+1));Q--}return YG0(A)}var S$=w(()=>{eQ();YN();e1()});function IG0(A){if(!A||A.trim()==="")return`Your task is to create a detailed summary of the conversation so far, paying close attention to the user's explicit requests and your previous actions.
1756:`)X()}return ZxA.trim(J)}Y92.exports=w45});var D92=U((yVZ,W92)=>{var CG1=LJ0(),L45=J92(),xVZ=OJ0();function X92(A){return A===void 0||A===null}function O45(A){var Q={};for(var B in A)Q[B]=A[B];return Q}function I92(A){A=O45(A||{}),A.whiteList=A.whiteList||CG1.whiteList,A.onAttr=A.onAttr||CG1.onAttr,A.onIgnoreAttr=A.onIgnoreAttr||CG1.onIgnoreAttr,A.safeAttrValue=A.safeAttrValue||CG1.safeAttrValue,this.options=A}I92.prototype.process=function(A){if(A=A||"",A=A.toString(),!A)return"";var Q=this,B=Q.options,G=B.whiteList,Z=B.onAttr,Y=B.onIgnoreAttr,J=B.safeAttrValue,X=L45(A,function(I,W,D,K,V){var F=G[D],H=!1;if(F===!0)H=F;else if(typeof F==="function")H=F(K);else if(F instanceof RegExp)H=F.test(K);if(H!==!0)H=!1;if(K=J(D,K),!K)return;var E={position:W,sourcePosition:I,source:V,isWhite:H};if(H){var z=Z(D,K,E);if(X92(z))return D+":"+K;else return z}else{var z=Y(D,K,E);if(!X92(z))return z}});return X};W92.exports=I92});var qG1=U((UG1,MJ0)=>{var K92=LJ0(),V92=D92();function M45(A,Q){var B=new V92(Q);return B.process(A)}UG1=MJ0.exports=M45;UG1.FilterCSS=V92;for($G1 in K92)UG1[$G1]=K92[$G1];var $G1;if(typeof window<"u")window.filterCSS=MJ0.exports});var NG1=U((vVZ,F92)=>{F92.exports={indexOf:function(A,Q){var B,G;if(Array.prototype.indexOf)return A.indexOf(Q);for(B=0,G=A.length;B<G;B++)if(A[B]===Q)return B;return-1},forEach:function(A,Q,B){var G,Z;if(Array.prototype.forEach)return A.forEach(Q,B);for(G=0,Z=A.length;G<Z;G++)Q.call(B,A[G],G,A)},trim:function(A){if(String.prototype.trim)return A.trim();return A.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(A){var Q=/\s|\n|\t/,B=Q.exec(A);return B?B.index:-1}}});var RJ0=U((c45)=>{var R45=qG1().FilterCSS,_45=qG1().getDefaultWhiteList,LG1=NG1();function z92(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height","loading"],ins:["datetime"],kbd:[],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var C92=new R45;function j45(A,Q,B){}function T45(A,Q,B){}function P45(A,Q,B){}function S45(A,Q,B){}function $92(A){return A.replace(y45,"&lt;").replace(v45,"&gt;")}function x45(A,Q,B,G){if(B=O92(B),Q==="href"||Q==="src"){if(B=LG1.trim(B),B==="#")return"#";if(!(B.substr(0,7)==="http://"||B.substr(0,8)==="https://"||B.substr(0,7)==="mailto:"||B.substr(0,4)==="tel:"||B.substr(0,11)==="data:image/"||B.substr(0,6)==="ftp://"||B.substr(0,2)==="./"||B.substr(0,3)==="../"||B[0]==="#"||B[0]==="/"))return""}else if(Q==="background"){if(wG1.lastIndex=0,wG1.test(B))return""}else if(Q==="style"){if(H92.lastIndex=0,H92.test(B))return"";if(E92.lastIndex=0,E92.test(B)){if(wG1.lastIndex=0,wG1.test(B))return""}if(G!==!1)G=G||C92,B=G.process(B)}return B=M92(B),B}var y45=/</g,v45=/>/g,k45=/"/g,b45=/&quot;/g,f45=/&#([a-zA-Z0-9]*);?/gim,h45=/&colon;?/gim,g45=/&newline;?/gim,wG1=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,H92=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,E92=/u\s*r\s*l\s*\(.*/gi;function U92(A){return A.replace(k45,"&quot;")}function q92(A){return A.replace(b45,'"')}function N92(A){return A.replace(f45,function(B,G){return G[0]==="x"||G[0]==="X"?String.fromCharCode(parseInt(G.substr(1),16)):String.fromCharCode(parseInt(G,10))})}function w92(A){return A.replace(h45,":").replace(g45," ")}function L92(A){var Q="";for(var B=0,G=A.length;B<G;B++)Q+=A.charCodeAt(B)<32?" ":A.charAt(B);return LG1.trim(Q)}function O92(A){return A=q92(A),A=N92(A),A=w92(A),A=L92(A),A}function M92(A){return A=U92(A),A=$92(A),A}function u45(){return""}function m45(A,Q){if(typeof Q!=="function")Q=function(){};var B=!Array.isArray(A);function G(J){if(B)return!0;return LG1.indexOf(A,J)!==-1}var Z=[],Y=!1;return{onIgnoreTag:function(J,X,I){if(G(J))if(I.isClosing){var W="[/removed]",D=I.position+W.length;return Z.push([Y!==!1?Y:I.position,D]),Y=!1,W}else{if(!Y)Y=I.position;return"[removed]"}else return Q(J,X,I)},remove:function(J){var X="",I=0;return LG1.forEach(Z,function(W){X+=J.slice(I,W[0]),I=W[1]}),X+=J.slice(I),X}}}function d45(A){var Q="",B=0;while(B<A.length){var G=A.indexOf("<!--",B);if(G===-1){Q+=A.slice(B);break}Q+=A.slice(B,G);var Z=A.indexOf("-->",G);if(Z===-1)break;B=Z+3}return Q}function p45(A){var Q=A.split("");return Q=Q.filter(function(B){var G=B.charCodeAt(0);if(G===127)return!1;if(G<=31){if(G===10||G===13)return!0;return!1}return!0}),Q.join("")}c45.whiteList=z92();c45.getDefaultWhiteList=z92;c45.onTag=j45;c45.onIgnoreTag=T45;c45.onTagAttr=P45;c45.onIgnoreTagAttr=S45;c45.safeAttrValue=x45;c45.escapeHtml=$92;c45.escapeQuote=U92;c45.unescapeQuote=q92;c45.escapeHtmlEntities=N92;c45.escapeDangerHtml5Entities=w92;c45.clearNonPrintableCharacter=L92;c45.friendlyAttrValue=O92;c45.escapeAttrValue=M92;c45.onIgnoreTagStripAll=u45;c45.StripTagBody=m45;c45.stripCommentTag=d45;c45.stripBlankChar=p45;c45.attributeWrapSign='"';c45.cssFilter=C92;c45.getDefaultCSSWhiteList=_45});var _J0=U((w65)=>{var to=NG1();function F65(A){var Q=to.spaceIndex(A),B;if(Q===-1)B=A.slice(1,-1);else B=A.slice(1,Q+1);if(B=to.trim(B).toLowerCase(),B.slice(0,1)==="/")B=B.slice(1);if(B.slice(-1)==="/")B=B.slice(0,-1);return B}function H65(A){return A.slice(0,2)==="</"}function E65(A,Q,B){var G="",Z=0,Y=!1,J=!1,X=0,I=A.length,W="",D="";A:for(X=0;X<I;X++){var K=A.charAt(X);if(Y===!1){if(K==="<"){Y=X;continue}}else if(J===!1){if(K==="<"){G+=B(A.slice(Z,X)),Y=X,Z=X;continue}if(K===">"||X===I-1){G+=B(A.slice(Z,Y)),D=A.slice(Y,X+1),W=F65(D),G+=Q(Y,G.length,W,D,H65(D)),Z=X+1,Y=!1;continue}if(K==='"'||K==="'"){var V=1,F=A.charAt(X-V);while(F.trim()===""||F==="="){if(F==="="){J=K;continue A}F=A.charAt(X-++V)}}}else if(K===J){J=!1;continue}}if(Z<I)G+=B(A.substr(Z));return G}var z65=/[^a-zA-Z0-9\\_:.-]/gim;function C65(A,Q){var B=0,G=0,Z=[],Y=!1,J=A.length;function X(V,F){if(V=to.trim(V),V=V.replace(z65,"").toLowerCase(),V.length<1)return;var H=Q(V,F||"");if(H)Z.push(H)}for(var I=0;I<J;I++){var W=A.charAt(I),D,K;if(Y===!1&&W==="="){Y=A.slice(B,I),B=I+1,G=A.charAt(B)==='"'||A.charAt(B)==="'"?B:U65(A,I+1);continue}if(Y!==!1){if(I===G)if(K=A.indexOf(W,I+1),K===-1)break;else{D=to.trim(A.slice(G+1,K)),X(Y,D),Y=!1,I=K,B=I+1;continue}}if(/\s|\n|\t/.test(W))if(A=A.replace(/\s|\n|\t/g," "),Y===!1)if(K=$65(A,I),K===-1){D=to.trim(A.slice(B,I)),X(D),Y=!1,B=I+1;continue}else{I=K-1;continue}else if(K=q65(A,I-1),K===-1){D=to.trim(A.slice(B,I)),D=R92(D),X(Y,D),Y=!1,B=I+1;continue}else continue}if(B<A.length)if(Y===!1)X(A.slice(B));else X(Y,R92(to.trim(A.slice(B))));return to.trim(Z.join(" "))}function $65(A,Q){for(;Q<A.length;Q++){var B=A[Q];if(B===" ")continue;if(B==="=")return Q;return-1}}function U65(A,Q){for(;Q<A.length;Q++){var B=A[Q];if(B===" ")continue;if(B==="'"||B==='"')return Q;return-1}}function q65(A,Q){for(;Q>0;Q--){var B=A[Q];if(B===" ")continue;if(B==="=")return Q;return-1}}function N65(A){if(A[0]==='"'&&A[A.length-1]==='"'||A[0]==="'"&&A[A.length-1]==="'")return!0;else return!1}function R92(A){if(N65(A))return A.substr(1,A.length-2);else return A}w65.parseTag=E65;w65.parseAttr=C65});var P92=U((fVZ,T92)=>{var M65=qG1().FilterCSS,U_=RJ0(),_92=_J0(),R65=_92.parseTag,_65=_92.parseAttr,MG1=NG1();function OG1(A){return A===void 0||A===null}function j65(A){var Q=MG1.spaceIndex(A);if(Q===-1)return{html:"",closing:A[A.length-2]==="/"};A=MG1.trim(A.slice(Q+1,-1));var B=A[A.length-1]==="/";if(B)A=MG1.trim(A.slice(0,-1));return{html:A,closing:B}}function T65(A){var Q={};for(var B in A)Q[B]=A[B];return Q}function P65(A){var Q={};for(var B in A)if(Array.isArray(A[B]))Q[B.toLowerCase()]=A[B].map(function(G){return G.toLowerCase()});else Q[B.toLowerCase()]=A[B];return Q}function j92(A){if(A=T65(A||{}),A.stripIgnoreTag){if(A.onIgnoreTag)console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time');A.onIgnoreTag=U_.onIgnoreTagStripAll}if(A.whiteList||A.allowList)A.whiteList=P65(A.whiteList||A.allowList);else A.whiteList=U_.whiteList;if(this.attributeWrapSign=A.singleQuotedAttributeValue===!0?"'":U_.attributeWrapSign,A.onTag=A.onTag||U_.onTag,A.onTagAttr=A.onTagAttr||U_.onTagAttr,A.onIgnoreTag=A.onIgnoreTag||U_.onIgnoreTag,A.onIgnoreTagAttr=A.onIgnoreTagAttr||U_.onIgnoreTagAttr,A.safeAttrValue=A.safeAttrValue||U_.safeAttrValue,A.escapeHtml=A.escapeHtml||U_.escapeHtml,this.options=A,A.css===!1)this.cssFilter=!1;else A.css=A.css||{},this.cssFilter=new M65(A.css)}j92.prototype.process=function(A){if(A=A||"",A=A.toString(),!A)return"";var Q=this,B=Q.options,G=B.whiteList,Z=B.onTag,Y=B.onIgnoreTag,J=B.onTagAttr,X=B.onIgnoreTagAttr,I=B.safeAttrValue,W=B.escapeHtml,D=Q.attributeWrapSign,K=Q.cssFilter;if(B.stripBlankChar)A=U_.stripBlankChar(A);if(!B.allowCommentTag)A=U_.stripCommentTag(A);var V=!1;if(B.stripIgnoreTagBody)V=U_.StripTagBody(B.stripIgnoreTagBody,Y),Y=V.onIgnoreTag;var F=R65(A,function(H,E,z,C,O){var L={sourcePosition:H,position:E,isClosing:O,isWhite:Object.prototype.hasOwnProperty.call(G,z)},M=Z(z,C,L);if(!OG1(M))return M;if(L.isWhite){if(L.isClosing)return"</"+z+">";var _=j65(C),j=G[z],P=_65(_.html,function(y,v){var m=MG1.indexOf(j,y)!==-1,h=J(z,y,v,m);if(!OG1(h))return h;if(m)if(v=I(z,y,v,K),v)return y+"="+D+v+D;else return y;else{if(h=X(z,y,v,m),!OG1(h))return h;return}});if(C="<"+z,P)C+=" "+P;if(_.closing)C+=" /";return C+=">",C}else{if(M=Y(z,C,L),!OG1(M))return M;return W(C)}},W);if(V)F=V.remove(F);return F};T92.exports=j92});var k92=U((EKA,RG1)=>{var S92=RJ0(),x92=_J0(),y92=P92();function v92(A,Q){var B=new y92(Q);return B.process(A)}EKA=RG1.exports=v92;EKA.filterXSS=v92;EKA.FilterXSS=y92;(function(){for(var A in S92)EKA[A]=S92[A];for(var Q in x92)EKA[Q]=x92[Q]})();if(typeof window<"u")window.filterXSS=RG1.exports;function S65(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}if(S65())self.filterXSS=RG1.exports});import{createServer as jJ0}from"http";import{parse as x65}from"url";import{createHash as y65,randomBytes as v65}from"crypto";function b92(A){try{let Q=new URL(A);for(let B of b65)if(Q.searchParams.has(B))Q.searchParams.set(B,"[REDACTED]");return Q.toString()}catch{return A}}function f65(){return async(A,Q)=>{let B=AbortSignal.timeout(k65);if(!Q?.signal)return fetch(A,{...Q,signal:B});let G=new AbortController,Z=()=>G.abort();Q.signal.addEventListener("abort",Z),B.addEventListener("abort",Z);let Y=()=>{Q.signal?.removeEventListener("abort",Z),B.removeEventListener("abort",Z)};if(Q.signal.aborted)G.abort();try{let J=await fetch(A,{...Q,signal:G.signal});return Y(),J}catch(J){throw Y(),J}}}function h92(A=PJ0){return`http://localhost:${A}/callback`}function g65(){let A=parseInt(process.env.MCP_OAUTH_CALLBACK_PORT||"",10);return A>0?A:void 0}async function u65(){let A=g65();if(A)return A;let{min:Q,max:B}=h65,G=B-Q+1,Z=Math.min(G,100);for(let Y=0;Y<Z;Y++){let J=Q+Math.floor(Math.random()*G);try{return await new Promise((X,I)=>{let W=jJ0();W.once("error",I),W.listen(J,()=>{W.close(()=>X())})}),J}catch{continue}}try{return await new Promise((Y,J)=>{let X=jJ0();X.once("error",J),X.listen(PJ0,()=>{X.close(()=>Y())})}),PJ0}catch{throw Error("No available ports for OAuth redirect")}}function x9A(A,Q){let B=Q1({type:Q.type,url:Q.url,headers:Q.headers||{}}),G=y65("sha256").update(B).digest("hex").substring(0,16);return`${A}|${G}`}async function f92({serverName:A,endpoint:Q,token:B,tokenTypeHint:G,clientId:Z,accessToken:Y}){let J=new URLSearchParams;if(J.set("token",B),J.set("token_type_hint",G),Z)J.set("client_id",Z);else a0(A,`No client_id available for ${G} revocation - server may reject`);let X={"Content-Type":"application/x-www-form-urlencoded"};try{await fQ.post(Q,J,{headers:X}),a0(A,`Successfully revoked ${G}`)}catch(I){if(fQ.isAxiosError(I)&&I.response?.status===401&&Y)a0(A,`Got 401, retrying ${G} revocation with Bearer auth`),await fQ.post(Q,J,{headers:{...X,Authorization:`Bearer ${Y}`}}),a0(A,`Successfully revoked ${G} with Bearer auth`);else throw I}}async function xJ0(A,Q){let G=gw().read();if(!G?.mcpOAuth)return;let Z=x9A(A,Q),Y=G.mcpOAuth[Z];if(!Y?.accessToken&&!Y?.refreshToken){a0(A,"No tokens to revoke");return}try{let J=await QxA(Q.url);if(!J){a0(A,"No OAuth metadata found");return}let X="revocation_endpoint"in J?J.revocation_endpoint:null;if(!X){a0(A,"Server does not support token revocation");return}let I=String(X);if(a0(A,`Revoking tokens via ${I}`),Y.refreshToken)try{await f92({serverName:A,endpoint:I,token:Y.refreshToken,tokenTypeHint:"refresh_token",clientId:Y.clientId,accessToken:Y.accessToken})}catch(W){a0(A,`Failed to revoke refresh token: ${W instanceof Error?W.message:String(W)}`)}if(Y.accessToken)try{await f92({serverName:A,endpoint:X,token:Y.accessToken,tokenTypeHint:"access_token",clientId:Y.clientId,accessToken:Y.accessToken})}catch(W){a0(A,`Failed to revoke access token: ${W instanceof Error?W.message:String(W)}`)}}catch(J){a0(A,`Failed to revoke tokens: ${J instanceof Error?J.message:String(J)}`)}g92(A,Q)}function g92(A,Q){let B=gw(),G=B.read();if(!G?.mcpOAuth)return;let Z=x9A(A,Q);if(G.mcpOAuth[Z])delete G.mcpOAuth[Z],B.update(G),a0(A,"Cleared stored tokens")}async function YxA(A,Q,B,G){g92(A,Q),p("tengu_mcp_oauth_flow_start",{isOAuthFlow:!0});let Z=await u65(),Y=h92(Z);a0(A,`Using redirect port: ${Z}`);let J=new v9A(A,Q,Y,!0,B);try{let V=await QxA(Q.url);if(V)J.setMetadata(V),a0(A,`Fetched OAuth metadata with scope: ${SJ0(V)||"NONE"}`)}catch(V){a0(A,`Failed to fetch OAuth metadata: ${V instanceof Error?V.message:String(V)}`)}let X=await J.state(),I=null,W=null,D=()=>{if(I)I.close(),I=null;if(W)clearTimeout(W),W=null;a0(A,"MCP OAuth server cleaned up")},K=await new Promise((V,F)=>{if(G){let H=()=>{D(),F(new y9A)};if(G.aborted){H();return}G.addEventListener("abort",H)}I=jJ0((H,E)=>{let z=x65(H.url||"",!0);if(z.pathname==="/callback"){let C=z.query.code,O=z.query.state,L=z.query.error,M=z.query.error_description,_=z.query.error_uri;if(!L&&O!==X){E.writeHead(400,{"Content-Type":"text/html"}),E.end("<h1>Authentication Error</h1><p>Invalid state parameter. Please try again.</p><p>You can close this window.</p>"),D(),F(Error("OAuth state mismatch - possible CSRF attack"));return}if(L){E.writeHead(200,{"Content-Type":"text/html"});let j=TJ0.default(String(L)),P=M?TJ0.default(String(M)):"";E.end(`<h1>Authentication Error</h1><p>${j}: ${P}</p><p>You can close this window.</p>`),D();let y=`OAuth error: ${L}`;if(M)y+=` - ${M}`;if(_)y+=` (See: ${_})`;F(Error(y));return}if(C)E.writeHead(200,{"Content-Type":"text/html"}),E.end("<h1>Authentication Successful</h1><p>You can close this window. Return to Claude Code.</p>"),D(),V(C)}}),I.listen(Z,async()=>{try{a0(A,"Starting SDK auth"),a0(A,`Server URL: ${Q.url}`);let H=await $_(J,{serverUrl:Q.url});if(a0(A,`Initial auth result: ${H}`),H!=="REDIRECT")a0(A,`Unexpected auth result, expected REDIRECT: ${H}`)}catch(H){a0(A,`SDK auth error: ${H}`),D(),F(H)}}),W=setTimeout(()=>{D(),F(Error("Authentication timeout"))},300000)});try{a0(A,"Completing auth flow with authorization code");let V=await $_(J,{serverUrl:Q.url,authorizationCode:K});if(a0(A,`Auth result: ${V}`),V==="AUTHORIZED"){let F=await J.tokens();if(a0(A,`Tokens after auth: ${F?"Present":"Missing"}`),F)a0(A,`Token access_token length: ${F.access_token?.length}`),a0(A,`Token expires_in: ${F.expires_in}`);p("tengu_mcp_oauth_flow_success",{})}else throw Error("Unexpected auth result: "+V)}catch(V){if(a0(A,`Error during auth completion: ${V}`),fQ.isAxiosError(V))try{let F=p71.parse(V.response?.data);if(F.error==="invalid_client"&&F.error_description?.includes("Client not found")){let H=gw(),E=H.read()||{},z=x9A(A,Q);if(E.mcpOAuth?.[z])delete E.mcpOAuth[z].clientId,delete E.mcpOAuth[z].clientSecret,H.update(E)}}catch{}throw p("tengu_mcp_oauth_flow_error",{}),V}}class v9A{serverName;serverConfig;redirectUri;handleRedirection;_codeVerifier;_authorizationUrl;_state;_scopes;_metadata;_refreshInProgress;onAuthorizationUrlCallback;constructor(A,Q,B=h92(),G=!1,Z){this.serverName=A,this.serverConfig=Q,this.redirectUri=B,this.handleRedirection=G,this.onAuthorizationUrlCallback=Z}get redirectUrl(){return this.redirectUri}get authorizationUrl(){return this._authorizationUrl}get clientMetadata(){let A={client_name:`Claude Code (${this.serverName})`,redirect_uris:[this.redirectUri],grant_types:["authorization_code","refresh_token"],response_types:["code"],token_endpoint_auth_method:"none"},Q=SJ0(this._metadata);if(Q)A.scope=Q,a0(this.serverName,`Using scope from metadata: ${A.scope}`);return A}setMetadata(A){this._metadata=A}async state(){if(!this._state)this._state=v65(32).toString("base64url"),a0(this.serverName,"Generated new OAuth state");return this._state}async clientInformation(){let Q=gw().read(),B=x9A(this.serverName,this.serverConfig),G=Q?.mcpOAuth?.[B];if(G?.clientId)return a0(this.serverName,"Found client info"),{client_id:G.clientId,client_secret:G.clientSecret};a0(this.serverName,"No client info found");return}async saveClientInformation(A){let Q=gw(),B=Q.read()||{},G=x9A(this.serverName,this.serverConfig),Z={...B,mcpOAuth:{...B.mcpOAuth,[G]:{...B.mcpOAuth?.[G],serverName:this.serverName,serverUrl:this.serverConfig.url,clientId:A.client_id,clientSecret:A.client_secret,accessToken:B.mcpOAuth?.[G]?.accessToken||"",expiresAt:B.mcpOAuth?.[G]?.expiresAt||0}}};Q.update(Z)}async tokens(){let Q=gw().read(),B=x9A(this.serverName,this.serverConfig),G=Q?.mcpOAuth?.[B];if(!G){a0(this.serverName,"No token data found");return}let Z=(G.expiresAt-Date.now())/1000;if(Z<=0&&!G.refreshToken){a0(this.serverName,"Token expired without refresh token");return}if(Z<=300&&G.refreshToken){if(!this._refreshInProgress)a0(this.serverName,`Token expires in ${Math.floor(Z)}s, attempting proactive refresh`),this._refreshInProgress=this.refreshAuthorization(G.refreshToken).finally(()=>{this._refreshInProgress=void 0});else a0(this.serverName,"Token refresh already in progress, reusing existing promise");try{let J=await this._refreshInProgress;if(J)return a0(this.serverName,"Token refreshed successfully"),J;a0(this.serverName,"Token refresh failed, returning current tokens")}catch(J){a0(this.serverName,`Token refresh error: ${J instanceof Error?J.message:String(J)}`)}}let Y={access_token:G.accessToken,refresh_token:G.refreshToken,expires_in:Z,scope:G.scope,token_type:"Bearer"};return a0(this.serverName,"Returning tokens"),a0(this.serverName,`Token length: ${Y.access_token?.length}`),a0(this.serverName,`Has refresh token: ${!!Y.refresh_token}`),a0(this.serverName,`Expires in: ${Math.floor(Z)}s`),Y}async saveTokens(A){let Q=gw(),B=Q.read()||{},G=x9A(this.serverName,this.serverConfig);a0(this.serverName,"Saving tokens"),a0(this.serverName,`Token expires in: ${A.expires_in}`),a0(this.serverName,`Has refresh token: ${!!A.refresh_token}`);let Z={...B,mcpOAuth:{...B.mcpOAuth,[G]:{...B.mcpOAuth?.[G],serverName:this.serverName,serverUrl:this.serverConfig.url,accessToken:A.access_token,refreshToken:A.refresh_token,expiresAt:Date.now()+(A.expires_in||3600)*1000,scope:A.scope}}};Q.update(Z)}async redirectToAuthorization(A){this._authorizationUrl=A.toString();let Q=A.searchParams.get("scope");if(a0(this.serverName,`Authorization URL: ${b92(A.toString())}`),a0(this.serverName,`Scopes in URL: ${Q||"NOT FOUND"}`),Q)this._scopes=Q,a0(this.serverName,`Captured scopes from authorization URL: ${Q}`);else{let Y=SJ0(this._metadata);if(Y)this._scopes=Y,a0(this.serverName,`Using scopes from metadata: ${Y}`);else a0(this.serverName,"No scopes available from URL or metadata")}if(!this.handleRedirection){a0(this.serverName,"Redirection handling is disabled, skipping redirect");return}let B=A.toString();if(!B.startsWith("http://")&&!B.startsWith("https://"))throw Error("Invalid authorization URL: must use http:// or https:// scheme");a0(this.serverName,"Redirecting to authorization URL");let G=b92(B);if(a0(this.serverName,`Authorization URL: ${G}`),this.onAuthorizationUrlCallback)this.onAuthorizationUrlCallback(B);if(a0(this.serverName,`Opening authorization URL: ${G}`),!await i7(B))a0(this.serverName,"Browser didn't open automatically. URL is shown in UI.")}async saveCodeVerifier(A){a0(this.serverName,"Saving code verifier"),this._codeVerifier=A}async codeVerifier(){if(!this._codeVerifier)throw a0(this.serverName,"No code verifier saved"),Error("No code verifier saved");return a0(this.serverName,"Returning code verifier"),this._codeVerifier}async refreshAuthorization(A){try{a0(this.serverName,"Starting token refresh");let Q=f65(),B=await QxA(new URL(this.serverConfig.url),{fetchFn:Q});if(!B){a0(this.serverName,"Failed to discover OAuth metadata");return}let G=await this.clientInformation();if(!G){a0(this.serverName,"No client information available for refresh");return}let Z=await IJ0(new URL(this.serverConfig.url),{metadata:B,clientInformation:G,refreshToken:A,resource:new URL(this.serverConfig.url),fetchFn:Q});if(Z)return a0(this.serverName,"Token refresh successful, saving new tokens"),await this.saveTokens(Z),Z;a0(this.serverName,"Token refresh returned no tokens");return}catch(Q){a0(this.serverName,`Token refresh failed: ${Q instanceof Error?Q.message:String(Q)}`);return}}}function SJ0(A){if(!A)return;if("scope"in A&&typeof A.scope==="string")return A.scope;if("default_scope"in A&&typeof A.default_scope==="string")return A.default_scope;if(A.scopes_supported&&Array.isArray(A.scopes_supported))return A.scopes_supported.join(" ");return}var TJ0,k65=30000,b65,y9A,h65,PJ0=3118;var zKA=w(()=>{ciA();Z0();c71();BxA();zN();f5();f1();f3();e1();TJ0=c(k92(),1),b65=["state","nonce","code_challenge","code_verifier","code"];y9A=class y9A extends Error{constructor(){super("Authentication was cancelled");this.name="AuthenticationCancelledError"}};h65=LQ()==="windows"?{min:39152,max:49151}:{min:49152,max:65535}});function CKA(A){let Q=[];return{expanded:A.replace(/\$\{([^}]+)\}/g,(G,Z)=>{let[Y,J]=Z.split(":-",2),X=process.env[Y];if(X!==void 0)return X;if(J!==void 0)return J;return Q.push(Y),G}),missingVars:Q}}var yJ0,eVZ,vJ0,m65,d65,p65,c65,l65,i65,n65,Xb,u92;var k9A=w(()=>{R9();yJ0=u.enum(["local","user","project","dynamic","enterprise","claudeai"]),eVZ=u.enum(["stdio","sse","sse-ide","http","ws","sdk"]),vJ0=u.object({type:u.literal("stdio").optional(),command:u.string().min(1,"Command cannot be empty"),args:u.array(u.string()).default([]),env:u.record(u.string(),u.string()).optional()}),m65=u.object({type:u.literal("sse"),url:u.string(),headers:u.record(u.string(),u.string()).optional(),headersHelper:u.string().optional()}),d65=u.object({type:u.literal("sse-ide"),url:u.string(),ideName:u.string(),ideRunningInWindows:u.boolean().optional()}),p65=u.object({type:u.literal("ws-ide"),url:u.string(),ideName:u.string(),authToken:u.string().optional(),ideRunningInWindows:u.boolean().optional()}),c65=u.object({type:u.literal("http"),url:u.string(),headers:u.record(u.string(),u.string()).optional(),headersHelper:u.string().optional()}),l65=u.object({type:u.literal("ws"),url:u.string(),headers:u.record(u.string(),u.string()).optional(),headersHelper:u.string().optional()}),i65=u.object({type:u.literal("sdk"),name:u.string()}),n65=u.object({type:u.literal("claudeai-proxy"),url:u.string(),id:u.string()}),Xb=u.union([vJ0,m65,d65,p65,c65,l65,i65,n65]),u92=u.object({mcpServers:u.record(u.string(),Xb)})});var Ib;var m92=w(()=>{Ib=["PreToolUse","PostToolUse","PostToolUseFailure","Notification","UserPromptSubmit","SessionStart","SessionEnd","Stop","SubagentStart","SubagentStop","PreCompact","PermissionRequest"]});var $KA=w(()=>{m92()});function d92(A){return kJ0.filePatternTools.includes(A)}function p92(A){return kJ0.bashPrefixTools.includes(A)}function c92(A){return kJ0.customValidation[A]}var kJ0;var l92=w(()=>{kJ0={filePatternTools:["Read","Write","Edit","Glob","NotebookRead","NotebookEdit"],bashPrefixTools:["Bash"],customValidation:{WebSearch:(A)=>{if(A.includes("*")||A.includes("?"))return{valid:!1,error:"WebSearch does not support wildcards",suggestion:"Use exact search terms without * or ?",examples:["WebSearch(claude ai)","WebSearch(typescript tutorial)"]};return{valid:!0}},WebFetch:(A)=>{if(A.includes("://")||A.startsWith("http"))return{valid:!1,error:"WebFetch permissions use domain format, not URLs",suggestion:'Use "domain:hostname" format',examples:["WebFetch(domain:example.com)","WebFetch(domain:github.com)"]};if(!A.startsWith("domain:"))return{valid:!1,error:'WebFetch permissions must use "domain:" prefix',suggestion:'Use "domain:hostname" format',examples:["WebFetch(domain:example.com)","WebFetch(domain:*.google.com)"]};return{valid:!0}}}}});function n92(A,Q){let B=0,G=Q-1;while(G>=0&&A[G]==="\\")B++,G--;return B%2!==0}function i92(A,Q){let B=0;for(let G=0;G<A.length;G++)if(A[G]===Q&&!n92(A,G))B++;return B}function a65(A){for(let Q=0;Q<A.length-1;Q++)if(A[Q]==="("&&A[Q+1]===")"){if(!n92(A,Q))return!0}return!1}function o65(A){if(!A||A.trim()==="")return{valid:!1,error:"Permission rule cannot be empty"};let Q=i92(A,"("),B=i92(A,")");if(Q!==B)return{valid:!1,error:"Mismatched parentheses",suggestion:"Ensure all opening parentheses have matching closing parentheses"};if(a65(A)){let J=A.substring(0,A.indexOf("("));if(!J)return{valid:!1,error:"Empty parentheses with no tool name",suggestion:"Specify a tool name before the parentheses"};return{valid:!1,error:"Empty parentheses",suggestion:`Either specify a pattern or use just "${J}" without parentheses`,examples:[`${J}`,`${J}(some-pattern)`]}}let G=MR(A),Z=UF(G.toolName);if(Z){if(G.ruleContent!==void 0)return{valid:!1,error:"MCP rules do not support patterns in parentheses",suggestion:`Use "${G.toolName}" without parentheses, or use "mcp__${Z.serverName}__*" for all tools`,examples:[`mcp__${Z.serverName}`,`mcp__${Z.serverName}__*`,Z.toolName&&Z.toolName!=="*"?`mcp__${Z.serverName}__${Z.toolName}`:void 0].filter(Boolean)};return{valid:!0}}if(!G.toolName||G.toolName.length===0)return{valid:!1,error:"Tool name cannot be empty"};if(G.toolName[0]!==G.toolName[0]?.toUpperCase())return{valid:!1,error:"Tool names must start with uppercase",suggestion:`Use "${String(G.toolName).charAt(0).toUpperCase()+String(G.toolName).slice(1)}"`};let Y=c92(G.toolName);if(Y&&G.ruleContent!==void 0){let J=Y(G.ruleContent);if(!J.valid)return J}if(p92(G.toolName)&&G.ruleContent!==void 0){let J=G.ruleContent;if(J.includes(":*")&&!J.endsWith(":*"))return{valid:!1,error:"The :* pattern must be at the end",suggestion:"Move :* to the end for prefix matching, or use * for wildcard matching",examples:["Bash(npm run:*) - prefix matching (legacy)","Bash(npm run *) - wildcard matching"]};if(J===":*")return{valid:!1,error:"Prefix cannot be empty before :*",suggestion:"Specify a command prefix before :*",examples:["Bash(npm:*)","Bash(git:*)"]};if(J==="*")return{valid:!1,error:'Use "Bash" without parentheses to allow all commands',suggestion:"Remove the parentheses or specify a command pattern",examples:["Bash","Bash(npm:*)","Bash(npm *)"]}}if(d92(G.toolName)&&G.ruleContent!==void 0){let J=G.ruleContent;if(J.includes(":*"))return{valid:!1,error:'The ":*" syntax is only for Bash prefix rules',suggestion:'Use glob patterns like "*" or "**" for file matching',examples:[`${G.toolName}(*.ts) - matches .ts files`,`${G.toolName}(src/**) - matches all files in src`,`${G.toolName}(**/*.test.ts) - matches test files`]};if(J.includes("*")&&!J.match(/^\*|\*$|\*\*|\/\*|\*\.|\*\)/)&&!J.includes("**"))return{valid:!1,error:"Wildcard placement might be incorrect",suggestion:"Wildcards are typically used at path boundaries",examples:[`${G.toolName}(*.js) - all .js files`,`${G.toolName}(src/*) - all files directly in src`,`${G.toolName}(src/**) - all files recursively in src`]}}return{valid:!0}}var _G1;var a92=w(()=>{R9();AZ();MJ();l92();_G1=u.string().superRefine((A,Q)=>{let B=o65(A);if(!B.valid){let G=B.error;if(B.suggestion)G+=`. ${B.suggestion}`;if(B.examples&&B.examples.length>0)G+=`. Examples: ${B.examples.join(", ")}`;Q.addIssue({code:u.ZodIssueCode.custom,message:G,params:{received:A}})}})});function JxA(A,Q){return Q.autoUpdate??f9A.has(A.toLowerCase())}function t65(A){if(f9A.has(A.toLowerCase()))return!1;if(s65.test(A))return!0;return r65.test(A)}function s92(A,Q){let B=A.toLowerCase();if(!f9A.has(B))return null;if(Q.source==="github"){if(!(Q.repo||"").toLowerCase().startsWith(`${jG1}/`))return`The name '${A}' is reserved for official Anthropic marketplaces. Only repositories from 'github.com/${jG1}/' can use this name.`;return null}if(Q.source==="git"&&Q.url){let G=Q.url.toLowerCase(),Z=G.includes("github.com/anthropics/"),Y=G.includes("git@github.com:anthropics/");if(Z||Y)return null;return`The name '${A}' is reserved for official Anthropic marketplaces. Only repositories from 'github.com/${jG1}/' can use this name.`}return`The name '${A}' is reserved for official Anthropic marketplaces and can only be used with GitHub sources from the '${jG1}' organization.`}function Db(A){return typeof A==="string"&&A.startsWith("./")}var f9A,r65,s65,jG1="anthropics",Bd,UKA,o92,bJ0,fJ0,t92,e65,e92,A35,Q35,B35,G35,Z35,Y35,J35,r92,X35,qKA,I35,h9A,A42,XxA,W35,D35,NKA,b9A,EFZ,K35,IxA,V35,F35,WxA,zFZ,H35,hJ0;var pz=w(()=>{R9();Gd();k9A();f9A=new Set(["claude-code-marketplace","claude-code-plugins","claude-plugins-official","anthropic-marketplace","anthropic-plugins","agent-skills","life-sciences"]);r65=/(?:official[^a-z0-9]*(anthropic|claude)|(?:anthropic|claude)[^a-z0-9]*official|^(?:anthropic|claude)[^a-z0-9]*(marketplace|plugins|official))/i,s65=/[^\u0020-\u007E]/;Bd=u.string().startsWith("./"),UKA=Bd.endsWith(".json"),o92=u.union([Bd.refine((A)=>A.endsWith(".mcpb")||A.endsWith(".dxt"),{message:"MCPB file path must end with .mcpb or .dxt"}).describe("Path to MCPB file relative to plugin root"),u.string().url().refine((A)=>A.endsWith(".mcpb")||A.endsWith(".dxt"),{message:"MCPB URL must end with .mcpb or .dxt"}).describe("URL to MCPB file")]),bJ0=Bd.endsWith(".md"),fJ0=u.union([bJ0,Bd]),t92=u.object({name:u.string().min(1,"Author name cannot be empty").describe("Display name of the plugin author or organization"),email:u.string().optional().describe("Contact email for support or feedback"),url:u.string().optional().describe("Website, GitHub profile, or organization URL")}),e65=u.object({name:u.string().min(1,"Plugin name cannot be empty").refine((A)=>!A.includes(" "),{message:'Plugin name cannot contain spaces. Use kebab-case (e.g., "my-plugin")'}).describe("Unique identifier for the plugin, used for namespacing (prefer kebab-case)"),version:u.string().optional().describe("Semantic version (e.g., 1.2.3) following semver.org specification"),description:u.string().optional().describe("Brief, user-facing explanation of what the plugin provides"),author:t92.optional().describe("Information about the plugin creator or maintainer"),homepage:u.string().url().optional().describe("Plugin homepage or documentation URL"),repository:u.string().optional().describe("Source code repository URL"),license:u.string().optional().describe("SPDX license identifier (e.g., MIT, Apache-2.0)"),keywords:u.array(u.string()).optional().describe("Tags for plugin discovery and categorization")}),e92=u.object({description:u.string().optional().describe("Brief, user-facing explanation of what these hooks provide"),hooks:u.lazy(()=>Wb).describe("The hooks provided by the plugin, in the same format as the one used for settings")}),A35=u.object({hooks:u.union([UKA.describe("Path to file with additional hooks (in addition to those in hooks/hooks.json, if it exists), relative to the plugin root"),u.lazy(()=>Wb).describe("Additional hooks (in addition to those in hooks/hooks.json, if it exists)"),u.array(u.union([UKA.describe("Path to file with additional hooks (in addition to those in hooks/hooks.json, if it exists), relative to the plugin root"),u.lazy(()=>Wb).describe("Additional hooks (in addition to those in hooks/hooks.json, if it exists)")]))])}),Q35=u.object({source:fJ0.optional().describe("Path to command markdown file, relative to plugin root"),content:u.string().optional().describe("Inline markdown content for the command"),description:u.string().optional().describe("Command description override"),argumentHint:u.string().optional().describe('Hint for command arguments (e.g., "[file]")'),model:u.string().optional().describe("Default model for this command"),allowedTools:u.array(u.string()).optional().describe("Tools allowed when command runs")}).refine((A)=>A.source&&!A.content||!A.source&&A.content,{message:'Command must have either "source" (file path) or "content" (inline markdown), but not both'}),B35=u.object({commands:u.union([fJ0.describe("Path to additional command file or skill directory (in addition to those in the commands/ directory, if it exists), relative to the plugin root"),u.array(fJ0.describe("Path to additional command file or skill directory (in addition to those in the commands/ directory, if it exists), relative to the plugin root")).describe("List of paths to additional command files or skill directories"),u.record(u.string(),Q35).describe('Object mapping of command names to their metadata and source files. Command name becomes the slash command name (e.g., "about"  "/plugin:about")')])}),G35=u.object({agents:u.union([bJ0.describe("Path to additional agent file (in addition to those in the agents/ directory, if it exists), relative to the plugin root"),u.array(bJ0.describe("Path to additional agent file (in addition to those in the agents/ directory, if it exists), relative to the plugin root")).describe("List of paths to additional agent files")])}),Z35=u.object({skills:u.union([Bd.describe("Path to additional skill directory (in addition to those in the skills/ directory, if it exists), relative to the plugin root"),u.array(Bd.describe("Path to additional skill directory (in addition to those in the skills/ directory, if it exists), relative to the plugin root")).describe("List of paths to additional skill directories")])}),Y35=u.object({outputStyles:u.union([Bd.describe("Path to additional output styles directory or file (in addition to those in the output-styles/ directory, if it exists), relative to the plugin root"),u.array(Bd.describe("Path to additional output styles directory or file (in addition to those in the output-styles/ directory, if it exists), relative to the plugin root")).describe("List of paths to additional output styles directories or files")])}),J35=u.object({mcpServers:u.union([UKA.describe("MCP servers to include in the plugin (in addition to those in the .mcp.json file, if it exists)"),o92.describe("Path or URL to MCPB file containing MCP server configuration"),u.record(u.string(),Xb).describe("MCP server configurations keyed by server name"),u.array(u.union([UKA.describe("Path to MCP servers configuration file"),o92.describe("Path or URL to MCPB file"),u.record(u.string(),Xb).describe("Inline MCP server configurations")])).describe("Array of MCP server configurations (paths, MCPB files, or inline definitions)")])}),r92=u.string().min(1),X35=u.string().min(2).refine((A)=>A.startsWith("."),{message:'File extensions must start with dot (e.g., ".ts", not "ts")'}),qKA=u.strictObject({command:u.string().min(1).refine((A)=>{if(A.includes(" ")&&!A.startsWith("/"))return!1;return!0},{message:"Command should not contain spaces. Use args array for arguments."}).describe('Command to execute the LSP server (e.g., "typescript-language-server")'),args:u.array(r92).optional().describe("Command-line arguments to pass to the server"),extensionToLanguage:u.record(X35,r92).refine((A)=>Object.keys(A).length>0,{message:"extensionToLanguage must have at least one mapping"}).describe("Mapping from file extension to LSP language ID. File extensions and languages are derived from this mapping."),transport:u.enum(["stdio","socket"]).default("stdio").describe("Communication transport mechanism"),env:u.record(u.string(),u.string()).optional().describe("Environment variables to set when starting the server"),initializationOptions:u.unknown().optional().describe("Initialization options passed to the server during initialization"),settings:u.unknown().optional().describe("Settings passed to the server via workspace/didChangeConfiguration"),workspaceFolder:u.string().optional().describe("Workspace folder path to use for the server"),startupTimeout:u.number().int().positive().optional().describe("Maximum time to wait for server startup (milliseconds)"),shutdownTimeout:u.number().int().positive().optional().describe("Maximum time to wait for graceful shutdown (milliseconds)"),restartOnCrash:u.boolean().optional().describe("Whether to restart the server if it crashes"),maxRestarts:u.number().int().nonnegative().optional().describe("Maximum number of restart attempts before giving up")}),I35=u.object({lspServers:u.union([UKA.describe("Path to .lsp.json configuration file relative to plugin root"),u.record(u.string(),qKA).describe("LSP server configurations keyed by server name"),u.array(u.union([UKA.describe("Path to LSP configuration file"),u.record(u.string(),qKA).describe("Inline LSP server configurations")])).describe("Array of LSP server configurations (paths or inline definitions)")])}),h9A=u.object({...e65.shape,...A35.partial().shape,...B35.partial().shape,...G35.partial().shape,...Z35.partial().shape,...Y35.partial().shape,...J35.partial().shape,...I35.partial().shape}).strict(),A42=u.string().refine((A)=>!A.includes("..")&&!A.includes("//"),"Package name cannot contain path traversal patterns").refine((A)=>{let Q=/^@[a-z0-9][a-z0-9-._]*\/[a-z0-9][a-z0-9-._]*$/,B=/^[a-z0-9][a-z0-9-._]*$/;return Q.test(A)||B.test(A)},"Invalid npm package name format"),XxA=u.discriminatedUnion("source",[u.object({source:u.literal("url"),url:u.string().url().describe("Direct URL to marketplace.json file"),headers:u.record(u.string(),u.string()).optional().describe("Custom HTTP headers (e.g., for authentication)")}),u.object({source:u.literal("github"),repo:u.string().describe("GitHub repository in owner/repo format"),ref:u.string().optional().describe('Git branch or tag to use (e.g., "main", "v1.0.0"). Defaults to repository default branch.'),path:u.string().optional().describe("Path to marketplace.json within repo (defaults to .claude-plugin/marketplace.json)")}),u.object({source:u.literal("git"),url:u.string().endsWith(".git").describe("Full git repository URL"),ref:u.string().optional().describe('Git branch or tag to use (e.g., "main", "v1.0.0"). Defaults to repository default branch.'),path:u.string().optional().describe("Path to marketplace.json within repo (defaults to .claude-plugin/marketplace.json)")}),u.object({source:u.literal("npm"),package:A42.describe("NPM package containing marketplace.json")}),u.object({source:u.literal("file"),path:u.string().describe("Local file path to marketplace.json")}),u.object({source:u.literal("directory"),path:u.string().describe("Local directory containing .claude-plugin/marketplace.json")})]),W35=u.union([Bd.describe("Path to the plugin root, relative to the marketplace directory"),u.object({source:u.literal("npm"),package:A42.or(u.string()).describe("Package name (or url, or local path, or anything else that can be passed to `npm` as a package)"),version:u.string().optional().describe("Specific version or version range (e.g., ^1.0.0, ~2.1.0)"),registry:u.string().url().optional().describe("Custom NPM registry URL (defaults to using system default, likely npmjs.org)")}).describe("NPM package as plugin source"),u.object({source:u.literal("pip"),package:u.string().describe("Python package name as it appears on PyPI"),version:u.string().optional().describe("Version specifier (e.g., ==1.0.0, >=2.0.0, <3.0.0)"),registry:u.string().url().optional().describe("Custom PyPI registry URL (defaults to using system default, likely pypi.org)")}).describe("Python package as plugin source"),u.object({source:u.literal("url"),url:u.string().endsWith(".git").describe("Full git repository URL (https:// or git@)"),ref:u.string().optional().describe('Git branch or tag to use (e.g., "main", "v1.0.0"). Defaults to repository default branch.')}),u.object({source:u.literal("github"),repo:u.string().describe("GitHub repository in owner/repo format"),ref:u.string().optional().describe('Git branch or tag to use (e.g., "main", "v1.0.0"). Defaults to repository default branch.')})]);D35=h9A.partial().extend({name:u.string().min(1,"Plugin name cannot be empty").refine((A)=>!A.includes(" "),{message:'Plugin name cannot contain spaces. Use kebab-case (e.g., "my-plugin")'}).describe("Unique identifier matching the plugin name"),source:W35.describe("Where to fetch the plugin from"),category:u.string().optional().describe('Category for organizing plugins (e.g., "productivity", "development")'),tags:u.array(u.string()).optional().describe("Tags for searchability and discovery"),strict:u.boolean().optional().default(!0).describe("Require the plugin manifest to be present in the plugin folder. If false, the marketplace entry provides the manifest.")}).strict(),NKA=u.object({name:u.string().min(1,"Marketplace must have a name").refine((A)=>!A.includes(" "),{message:'Marketplace name cannot contain spaces. Use kebab-case (e.g., "my-marketplace")'}).refine((A)=>!t65(A),{message:'Marketplace name cannot impersonate official Anthropic/Claude marketplaces. Names containing "official", "anthropic", or "claude" in official-sounding combinations are reserved.'}),owner:t92.describe("Marketplace maintainer or curator information"),plugins:u.array(D35).describe("Collection of available plugins in this marketplace"),metadata:u.object({pluginRoot:u.string().optional().describe("Base path for relative plugin sources"),version:u.string().optional().describe("Marketplace version"),description:u.string().optional().describe("Marketplace description")}).optional().describe("Optional marketplace metadata")}),b9A=u.string().regex(/^[a-z0-9][-a-z0-9._]*@[a-z0-9][-a-z0-9._]*$/i,"Plugin ID must be in format: plugin@marketplace"),EFZ=u.union([b9A,u.object({id:b9A.describe('Plugin identifier (e.g., "formatter@tools")'),version:u.string().optional().describe('Version constraint (e.g., "^2.0.0")'),required:u.boolean().optional().describe("If true, cannot be disabled"),config:u.record(u.string(),u.unknown()).optional().describe("Plugin-specific configuration")})]),K35=u.object({version:u.string().describe("Currently installed version"),installedAt:u.string().describe("ISO 8601 timestamp of installation"),lastUpdated:u.string().optional().describe("ISO 8601 timestamp of last update"),installPath:u.string().describe("Absolute path to the installed plugin directory"),gitCommitSha:u.string().optional().describe("Git commit SHA for git-based plugins (for version tracking)")}),IxA=u.object({version:u.literal(1).describe("Schema version 1"),plugins:u.record(b9A,K35).describe("Map of plugin IDs to their installation metadata")}),V35=u.enum(["managed","user","project","local"]),F35=u.object({scope:V35.describe("Installation scope"),projectPath:u.string().optional().describe("Project path (required for project/local scopes)"),installPath:u.string().describe("Absolute path to the versioned plugin directory"),version:u.string().optional().describe("Currently installed version"),installedAt:u.string().optional().describe("ISO 8601 timestamp of installation"),lastUpdated:u.string().optional().describe("ISO 8601 timestamp of last update"),gitCommitSha:u.string().optional().describe("Git commit SHA for git-based plugins")}),WxA=u.object({version:u.literal(2).describe("Schema version 2"),plugins:u.record(b9A,u.array(F35)).describe("Map of plugin IDs to arrays of installation entries")}),zFZ=u.union([IxA,WxA]),H35=u.object({source:XxA.describe("Where to fetch the marketplace from"),installLocation:u.string().describe("Local cache path where marketplace manifest is stored"),lastUpdated:u.string().describe("ISO 8601 timestamp of last marketplace refresh"),autoUpdate:u.boolean().optional().describe("Whether to automatically update this marketplace and its installed plugins on startup")}),hJ0=u.record(u.string(),H35)});var E35,Q42;var B42=w(()=>{R9();E35=u.object({allowedDomains:u.array(u.string()).optional(),allowUnixSockets:u.array(u.string()).optional(),allowAllUnixSockets:u.boolean().optional(),allowLocalBinding:u.boolean().optional(),httpProxyPort:u.number().optional(),socksProxyPort:u.number().optional()}).optional(),Q42=u.object({enabled:u.boolean().optional(),autoAllowBashIfSandboxed:u.boolean().optional(),allowUnsandboxedCommands:u.boolean().optional().describe("Allow commands to run outside the sandbox via the dangerouslyDisableSandbox parameter. When false, the dangerouslyDisableSandbox parameter is completely ignored and all commands must run sandboxed. Default: true."),network:E35,ignoreViolations:u.record(u.string(),u.array(u.string())).optional(),enableWeakerNestedSandbox:u.boolean().optional(),excludedCommands:u.array(u.string()).optional(),ripgrep:u.object({command:u.string(),args:u.array(u.string()).optional()}).optional().describe("Custom ripgrep configuration for bundled ripgrep support")}).passthrough()});function wKA(A){return"serverName"in A&&A.serverName!==void 0}function TG1(A){return"serverCommand"in A&&A.serverCommand!==void 0}function PG1(A){return"serverUrl"in A&&A.serverUrl!==void 0}var z35,C35,$35,U35,q35,N35,w35,Wb,L35,O35,M35,Zd;var Gd=w(()=>{R9();$KA();NL();a92();tX();pz();B42();z35=u.record(u.string(),u.coerce.string()),C35=u.object({allow:u.array(_G1).optional().describe("List of permission rules for allowed operations"),deny:u.array(_G1).optional().describe("List of permission rules for denied operations"),ask:u.array(_G1).optional().describe("List of permission rules that should always prompt for confirmation"),defaultMode:u.enum(QP).optional().describe("Default permission mode when Claude Code needs access"),disableBypassPermissionsMode:u.enum(["disable"]).optional().describe("Disable the ability to bypass permission prompts"),additionalDirectories:u.array(u.string()).optional().describe("Additional directories to include in the permission scope")}).passthrough(),$35=u.object({type:u.literal("command").describe("Bash command hook type"),command:u.string().describe("Shell command to execute"),timeout:u.number().positive().optional().describe("Timeout in seconds for this specific command"),statusMessage:u.string().optional().describe("Custom status message to display in spinner while hook runs"),once:u.boolean().optional().describe("If true, hook runs once and is removed after execution")}),U35=u.object({type:u.literal("prompt").describe("LLM prompt hook type"),prompt:u.string().describe("Prompt to evaluate with LLM. Use $ARGUMENTS placeholder for hook input JSON."),timeout:u.number().positive().optional().describe("Timeout in seconds for this specific prompt evaluation"),model:u.string().optional().describe('Model to use for this prompt hook (e.g., "claude-sonnet-4-5-20250929"). If not specified, uses the default small fast model.'),statusMessage:u.string().optional().describe("Custom status message to display in spinner while hook runs"),once:u.boolean().optional().describe("If true, hook runs once and is removed after execution")}),q35=u.object({type:u.literal("agent").describe("Agentic verifier hook type"),prompt:u.string().transform((A)=>(Q)=>A).describe('Prompt describing what to verify (e.g. "Verify that unit tests ran and passed."). Use $ARGUMENTS placeholder for hook input JSON.'),timeout:u.number().positive().optional().describe("Timeout in seconds for agent execution (default 60)"),model:u.string().optional().describe('Model to use for this agent hook (e.g., "claude-sonnet-4-5-20250929"). If not specified, uses Haiku.'),statusMessage:u.string().optional().describe("Custom status message to display in spinner while hook runs"),once:u.boolean().optional().describe("If true, hook runs once and is removed after execution")}),N35=u.discriminatedUnion("type",[$35,U35,q35]),w35=u.object({matcher:u.string().optional().describe('String pattern to match (e.g. tool names like "Write")'),hooks:u.array(N35).describe("List of hooks to execute when the matcher matches")}),Wb=u.partialRecord(u.enum(Ib),u.array(w35)),L35=u.object({source:XxA.describe("Where to fetch the marketplace from"),installLocation:u.string().optional().describe("Local cache path where marketplace manifest is stored (auto-generated if not provided)")}),O35=u.object({serverName:u.string().regex(/^[a-zA-Z0-9_-]+$/,"Server name can only contain letters, numbers, hyphens, and underscores").optional().describe("Name of the MCP server that users are allowed to configure"),serverCommand:u.array(u.string()).min(1,"Server command must have at least one element (the command)").optional().describe("Command array [command, ...args] to match exactly for allowed stdio servers"),serverUrl:u.string().optional().describe('URL pattern with wildcard support (e.g., "https://*.example.com/*") for allowed remote MCP servers')}).refine((A)=>{return[A.serverName!==void 0,A.serverCommand!==void 0,A.serverUrl!==void 0].filter(Boolean).length===1},{message:'Entry must have exactly one of "serverName", "serverCommand", or "serverUrl"'}),M35=u.object({serverName:u.string().regex(/^[a-zA-Z0-9_-]+$/,"Server name can only contain letters, numbers, hyphens, and underscores").optional().describe("Name of the MCP server that is explicitly blocked"),serverCommand:u.array(u.string()).min(1,"Server command must have at least one element (the command)").optional().describe("Command array [command, ...args] to match exactly for blocked stdio servers"),serverUrl:u.string().optional().describe('URL pattern with wildcard support (e.g., "https://*.example.com/*") for blocked remote MCP servers')}).refine((A)=>{return[A.serverName!==void 0,A.serverCommand!==void 0,A.serverUrl!==void 0].filter(Boolean).length===1},{message:'Entry must have exactly one of "serverName", "serverCommand", or "serverUrl"'}),Zd=u.object({$schema:u.literal(iKB).optional().describe("JSON Schema reference for Claude Code settings"),apiKeyHelper:u.string().optional().describe("Path to a script that outputs authentication values"),awsCredentialExport:u.string().optional().describe("Path to a script that exports AWS credentials"),awsAuthRefresh:u.string().optional().describe("Path to a script that refreshes AWS authentication"),fileSuggestion:u.object({type:u.literal("command"),command:u.string()}).optional().describe("Custom file suggestion configuration for @ mentions"),respectGitignore:u.boolean().optional().describe("Whether file picker should respect .gitignore files (default: true). Note: .ignore files are always respected."),cleanupPeriodDays:u.number().nonnegative().int().optional().describe("Number of days to retain chat transcripts (0 to disable cleanup)"),env:z35.optional().describe("Environment variables to set for Claude Code sessions"),attribution:u.object({commit:u.string().optional().describe("Attribution text for git commits, including any trailers. Empty string hides attribution."),pr:u.string().optional().describe("Attribution text for pull request descriptions. Empty string hides attribution.")}).optional().describe("Customize attribution text for commits and PRs. Each field defaults to the standard Claude Code attribution if not set."),includeCoAuthoredBy:u.boolean().optional().describe("Deprecated: Use attribution instead. Whether to include Claude's co-authored by attribution in commits and PRs (defaults to true)"),permissions:C35.optional().describe("Tool usage permissions configuration"),model:u.string().optional().describe("Override the default model used by Claude Code"),enableAllProjectMcpServers:u.boolean().optional().describe("Whether to automatically approve all MCP servers in the project"),enabledMcpjsonServers:u.array(u.string()).optional().describe("List of approved MCP servers from .mcp.json"),disabledMcpjsonServers:u.array(u.string()).optional().describe("List of rejected MCP servers from .mcp.json"),allowedMcpServers:u.array(O35).optional().describe("Enterprise allowlist of MCP servers that can be used. Applies to all scopes including enterprise servers from managed-mcp.json. If undefined, all servers are allowed. If empty array, no servers are allowed. Denylist takes precedence - if a server is on both lists, it is denied."),deniedMcpServers:u.array(M35).optional().describe("Enterprise denylist of MCP servers that are explicitly blocked. If a server is on the denylist, it will be blocked across all scopes including enterprise. Denylist takes precedence over allowlist - if a server is on both lists, it is denied."),hooks:Wb.optional().describe("Custom commands to run before/after tool executions"),disableAllHooks:u.boolean().optional().describe("Disable all hooks and statusLine execution"),allowManagedHooksOnly:u.boolean().optional().describe("When true (and set in managed settings), only hooks from managed settings run. User, project, and local hooks are ignored."),statusLine:u.object({type:u.literal("command"),command:u.string(),padding:u.number().optional()}).optional().describe("Custom status line display configuration"),enabledPlugins:u.record(u.string(),u.union([u.array(u.string()),u.boolean(),u.undefined()])).optional().describe('Enabled plugins using plugin-id@marketplace-id format. Example: { "formatter@anthropic-tools": true }. Also supports extended format with version constraints.'),extraKnownMarketplaces:u.record(u.string(),L35).optional().describe("Additional marketplaces to make available for this repository. Typically used in repository .claude/settings.json to ensure team members have required plugin sources."),skippedMarketplaces:u.array(u.string()).optional().describe("List of marketplace names the user has chosen not to install when prompted"),skippedPlugins:u.array(u.string()).optional().describe("List of plugin IDs (plugin@marketplace format) the user has chosen not to install when prompted"),strictKnownMarketplaces:u.array(XxA).optional().describe("Enterprise strict list of allowed marketplace sources. When set in managed settings, ONLY these exact sources can be added as marketplaces. The check happens BEFORE downloading, so blocked sources never touch the filesystem."),blockedMarketplaces:u.array(XxA).optional().describe("Enterprise blocklist of marketplace sources. When set in managed settings, these exact sources are blocked from being added as marketplaces. The check happens BEFORE downloading, so blocked sources never touch the filesystem."),forceLoginMethod:u.enum(["claudeai","console"]).optional().describe('Force a specific login method: "claudeai" for Claude Pro/Max, "console" for Console billing'),forceLoginOrgUUID:u.string().optional().describe("Organization UUID to use for OAuth login"),otelHeadersHelper:u.string().optional().describe("Path to a script that outputs OpenTelemetry headers"),outputStyle:u.string().optional().describe("Controls the output style for assistant responses"),language:u.string().optional().describe('Preferred language for Claude responses (e.g., "japanese", "spanish")'),skipWebFetchPreflight:u.boolean().optional().describe("Skip the WebFetch blocklist check for enterprise environments with restrictive security policies"),sandbox:Q42.optional(),spinnerTipsEnabled:u.boolean().optional().describe("Whether to show tips in the spinner"),syntaxHighlightingDisabled:u.boolean().optional().describe("Whether to disable syntax highlighting in diffs"),alwaysThinkingEnabled:u.boolean().optional().describe("When false, thinking is disabled. When absent or true, thinking is enabled automatically for supported models."),promptSuggestionEnabled:u.boolean().optional().describe("When false, prompt suggestions are disabled. When absent or true, prompt suggestions are enabled."),agent:u.string().optional().describe("Name of an agent (built-in or custom) to use for the main thread. Applies the agent's system prompt, tool restrictions, and model."),companyAnnouncements:u.array(u.string()).optional().describe("Company announcements to display at startup (one will be randomly selected if multiple are provided)"),pluginConfigs:u.record(u.string(),u.object({mcpServers:u.record(u.string(),u.record(u.string(),u.union([u.string(),u.number(),u.boolean(),u.array(u.string())]))).optional().describe("User configuration values for MCP servers keyed by server name")})).optional().describe("Per-plugin configuration including MCP server user configs, keyed by plugin ID (plugin@marketplace format)"),remote:u.object({defaultEnvironmentId:u.string().optional().describe("Default environment ID to use for remote sessions")}).optional().describe("Remote session configuration"),autoUpdatesChannel:u.enum(["latest","stable"]).optional().describe("Release channel for auto-updates (latest or stable)"),minimumVersion:u.string().optional().describe("Minimum version to stay on - prevents downgrades when switching to stable channel")}).passthrough()});import{accessSync as R35,constants as G42}from"fs";async function _35(A){try{let{cmd:Q}=Z42.findActualExecutable(A,[]);try{return R35(Q,G42.F_OK|G42.X_OK),!0}catch(B){return k(`Command '${A}' found at '${Q}' but not accessible: ${B}`),!1}}catch(Q){return k(`Command '${A}' not found in PATH: ${Q}`),!1}}var Z42,SG1;var gJ0=w(()=>{X9();y1();Z42=c(udA(),1);SG1=W0(async()=>{return _35("git")})});function LKA(A,Q){let G=A.slice(0,2).map((J)=>{let X=J.reason||J.error||"unknown error";return Q?`${J.name} (${X})`:J.name}).join(Q?"; ":", "),Z=A.length-2,Y=Z>0?` and ${Z} more`:"";return`${G}${Y}`}function DxA(A){switch(A.source){case"github":return A.repo;case"url":return A.url;case"git":return A.url;case"directory":return A.path;case"file":return A.path;default:return"Unknown source"}}function Ar(A,Q){return`${A}@${Q}`}async function g9A(A){let Q=[],B=[];for(let[G,Z]of Object.entries(A)){if(!u9A(Z.source))continue;let Y=null;try{Y=await m$(G)}catch(J){let X=J instanceof Error?J.message:String(J);B.push({name:G,error:X}),s(J instanceof Error?J:Error(`Failed to load marketplace ${G}: ${J}`))}Q.push({name:G,config:Z,data:Y})}return{marketplaces:Q,failures:B}}function OKA(A,Q){if(A.length===0)return null;if(Q>0)return{type:"warning",message:A.length===1?`Warning: Failed to load marketplace '${A[0].name}': ${A[0].error}`:`Warning: Failed to load ${A.length} marketplaces: ${j35(A)}`};return{type:"error",message:`Failed to load all marketplaces. Errors: ${T35(A)}`}}function j35(A){return A.map((Q)=>Q.name).join(", ")}function T35(A){return A.map((Q)=>`${Q.name}: ${Q.error}`).join("; ")}function MKA(){let A=dB("policySettings");if(!A?.strictKnownMarketplaces)return null;return A.strictKnownMarketplaces}function P35(){let A=dB("policySettings");if(!A?.blockedMarketplaces)return null;return A.blockedMarketplaces}function S35(A,Q){if(A.source!==Q.source)return!1;switch(A.source){case"url":return A.url===Q.url;case"github":return A.repo===Q.repo&&(A.ref||void 0)===(Q.ref||void 0)&&(A.path||void 0)===(Q.path||void 0);case"git":return A.url===Q.url&&(A.ref||void 0)===(Q.ref||void 0)&&(A.path||void 0)===(Q.path||void 0);case"npm":return A.package===Q.package;case"file":return A.path===Q.path;case"directory":return A.path===Q.path;default:return!1}}function Y42(A){let Q=A.match(/^git@github\.com:([^/]+\/[^/]+?)(?:\.git)?$/);if(Q&&Q[1])return Q[1];let B=A.match(/^https?:\/\/github\.com\/([^/]+\/[^/]+?)(?:\.git)?$/);if(B&&B[1])return B[1];return null}function eo(A,Q){if(!A)return!0;return(A||void 0)===(Q||void 0)}function x35(A,Q){if(A.source===Q.source)switch(A.source){case"github":{let B=Q;if(A.repo!==B.repo)return!1;return eo(B.ref,A.ref)&&eo(B.path,A.path)}case"git":{let B=Q;if(A.url!==B.url)return!1;return eo(B.ref,A.ref)&&eo(B.path,A.path)}case"url":return A.url===Q.url;case"npm":return A.package===Q.package;case"file":return A.path===Q.path;case"directory":return A.path===Q.path;default:return!1}if(A.source==="git"&&Q.source==="github"){if(Y42(A.url)===Q.repo)return eo(Q.ref,A.ref)&&eo(Q.path,A.path)}if(A.source==="github"&&Q.source==="git"){if(Y42(Q.url)===A.repo)return eo(Q.ref,A.ref)&&eo(Q.path,A.path)}return!1}function KxA(A){let Q=P35();if(Q===null)return!1;return Q.some((B)=>x35(A,B))}function u9A(A){if(KxA(A))return!1;let Q=MKA();if(Q===null)return!0;return Q.some((B)=>S35(A,B))}function RKA(A){switch(A.source){case"github":return`github:${A.repo}${A.ref?`@${A.ref}`:""}`;case"url":return A.url;case"git":return`git:${A.url}${A.ref?`@${A.ref}`:""}`;case"npm":return`npm:${A.package}`;case"file":return`file:${A.path}`;case"directory":return`dir:${A.path}`;default:return"unknown source"}}async function J42({configuredMarketplaceCount:A,failedMarketplaceCount:Q}){if(!await SG1())return"git-not-installed";let G=MKA();if(G!==null){if(G.length===0)return"all-blocked-by-policy";if(A===0)return"policy-restricts-sources"}if(A===0)return"no-marketplaces-configured";if(Q>0&&Q===A)return"all-marketplaces-failed";return"all-plugins-installed"}var m9A=w(()=>{II();f1();GB();gJ0()});import{join as d$,basename as X42,dirname as I42}from"path";function xG1(){return d$(zQ(),"plugins","known_marketplaces.json")}function D42(){return d$(zQ(),"plugins","marketplaces")}function yG1(){m$.cache?.clear?.()}async function G5(){let A=xA(),Q=xG1();if(!A.existsSync(Q))return{};try{let B=A.readFileSync(Q,{encoding:"utf-8"}),G=QQ(B),Z=hJ0.safeParse(G);if(!Z.success){let Y=`Marketplace configuration file is corrupted: ${Z.error.issues.map((J)=>`${J.path.join(".")}: ${J.message}`).join(", ")}`;throw k(Y,{level:"error"}),new sU(Y,Q,G)}return Z.data}catch(B){if(B instanceof sU)throw B;let G=`Failed to load marketplace configuration: ${B instanceof Error?B.message:String(B)}`;throw k(G,{level:"error"}),Error(G)}}async function jKA(A){let Q=hJ0.safeParse(A),B=xG1();if(!Q.success)throw new sU(`Invalid marketplace config: ${Q.error.message}`,B,A);let G=xA(),Z=d$(B,"..");G.mkdirSync(Z),bB(B,Q1(Q.data,null,2),{encoding:"utf-8",flush:!0})}async function y35(A,Q){if(Q){let G=await G9("git",["-c","credential.helper=","fetch","origin",Q],{cwd:A,timeout:30000,stdin:"ignore",env:{...process.env,...VxA}});if(G.code!==0)return G;let Z=await G9("git",["-c","credential.helper=","checkout",Q],{cwd:A,timeout:30000,stdin:"ignore",env:{...process.env,...VxA}});if(Z.code!==0)return Z;let Y=await G9("git",["-c","credential.helper=","pull","origin","HEAD"],{cwd:A,timeout:30000,stdin:"ignore",env:{...process.env,...VxA}});return W42(Y)}let B=await G9("git",["-c","credential.helper=","pull","origin","HEAD"],{cwd:A,timeout:30000,stdin:"ignore",env:{...process.env,...VxA}});return W42(B)}function W42(A){if(A.code!==0&&A.stderr){if(A.stderr.includes("Permission denied (publickey)")||A.stderr.includes("Could not read from remote repository"))return{...A,stderr:`SSH authentication failed while updating marketplace. Please ensure your SSH keys are configured.
1878:`))}var iZ1,zJ5=2,lZ1=3,CJ5="\x1B[1m",$J5="\x1B[22m";var k52=w(()=>{kA();j4();jI0();bq();vR();PQ1();iZ1=c(JA(),1)});function QV({children:A}){let[Q]=aB(),G=o$().syntaxHighlightingDisabled??!1;y52();let Z=n7.lexer(XVA(A)),Y=[],J="";function X(){if(J)Y.push(nZ1.default.createElement(C8,{key:Y.length},J.trim())),J=""}for(let I of Z)if(I.type==="table")X(),Y.push(nZ1.default.createElement(v52,{key:Y.length,token:I,syntaxHighlightingDisabled:G}));else J+=WE(I,Q,0,null,null,G);return X(),nZ1.default.createElement(T,{flexDirection:"column"},Y)}var nZ1;var Mb=w(()=>{LZ1();kA();jI0();Tr();eQ();k52();nZ1=c(JA(),1)});function b52(){return rxA.createElement(R0,{height:1},rxA.createElement(ok,null))}var rxA;var f52=w(()=>{bDA();m4();rxA=c(JA(),1)});function aZ1({plan:A}){return WS.createElement(R0,null,WS.createElement(T,{flexDirection:"column"},WS.createElement($,{color:"subtle"},"User rejected Claude's plan:"),WS.createElement(T,{borderStyle:"round",borderColor:"planMode",borderDimColor:!0,paddingX:1,overflow:"hidden"},WS.createElement(QV,null,A))))}var WS;var PI0=w(()=>{kA();Mb();m4();WS=c(JA(),1)});function h52({feedback:A}){return sxA.createElement(R0,null,sxA.createElement($,{color:"subtle"},"Tool use rejected with user message: ",A))}var sxA;var g52=w(()=>{kA();m4();sxA=c(JA(),1)});function u52({progressMessagesForMessage:A,tool:Q,tools:B,param:G,verbose:Z}){if(typeof G.content==="string"&&G.content.includes(T_))return DS.createElement(R0,{height:1},DS.createElement(ok,null));if(typeof G.content==="string"&&G.content.startsWith(SI0)){let Y=G.content.substring(SI0.length);return DS.createElement(aZ1,{plan:Y})}if(typeof G.content==="string"&&G.content.startsWith(txA)){let Y=G.content.substring(txA.length);return DS.createElement(h52,{feedback:Y})}if(!Q)return DS.createElement(Q5,{result:G.content,verbose:Z});return Q.renderToolUseErrorMessage(G.content,{progressMessagesForMessage:Ua(A),tools:B,verbose:Z})}var DS;var m52=w(()=>{eQ();bDA();m4();tD();PI0();g52();DS=c(JA(),1)});function d52({input:A,progressMessagesForMessage:Q,style:B,tool:G,tools:Z,messages:Y,verbose:J}){let{columns:X}=XB(),[I]=aB();if(!G)return exA.createElement(N7,null);let W=G.inputSchema.safeParse(A);if(!W.success)return exA.createElement(N7,null);return G.renderToolUseRejectedMessage(W.data,{columns:X,messages:Y,tools:Z,verbose:J,progressMessagesForMessage:Ua(Q),style:B,theme:I})}var exA;var p52=w(()=>{aH();j4();kA();exA=c(JA(),1)});var c52="\x1B[0m\x1B(B";function oZ1({hookEvent:A,messages:Q,toolUseID:B,verbose:G}){let Z=l52(Q,B,A),Y=i52(Q,B,A);if(Y===Z)return null;return mW.createElement(R0,null,mW.createElement(T,{flexDirection:"column"},mW.createElement(T,{flexDirection:"row"},mW.createElement($,{dimColor:!0},"Running "),mW.createElement($,{dimColor:!0,bold:!0},A),Z===1?mW.createElement($,{dimColor:!0}," hook"):mW.createElement($,{dimColor:!0}," ","hooks (",Y,"/",Z," done)")),G&&mW.createElement(UJ5,{messages:Q,toolUseID:B,hookEvent:A})))}function UJ5({messages:A,toolUseID:Q,hookEvent:B}){let G=A.filter((Z)=>Z.type==="progress"&&Z.data.type==="hook_progress"&&Z.data.hookEvent===B&&Z.parentToolUseID===Q);return mW.createElement(T,{flexDirection:"column",marginLeft:2},G.map((Z)=>mW.createElement($,{dimColor:!0,key:Z.uuid},"路 ",Z.data.hookName,": ",Z.data.command)))}var mW;var xI0=w(()=>{m4();kA();eQ();mW=c(JA(),1)});var n52,a52,J4A;var rZ1=w(()=>{n52=c(JA(),1),a52=c(hiA(),1);J4A=class J4A extends n52.Component{constructor(A){super(A);this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(A){try{a52.captureException(A)}catch{}}render(){if(this.state.hasError)return null;return this.props.children}}});function r52({message:A,messages:Q,toolUseID:B,progressMessagesForMessage:G,style:Z,tool:Y,tools:J,verbose:X,width:I}){let[W]=aB(),D=o52.useContext(mq);if(!A.toolUseResult||!Y)return null;let K=Y.renderToolResultMessage(A.toolUseResult,Ua(G),{style:Z,theme:W,tools:J,verbose:X});if(K===null)return null;return KS.createElement(T,{flexDirection:"column"},KS.createElement(T,{flexDirection:"row",width:I},K,!D&&KS.createElement($,null,c52)),KS.createElement(J4A,null,KS.createElement(oZ1,{hookEvent:"PostToolUse",messages:Q,toolUseID:B,verbose:X})))}var KS,o52;var s52=w(()=>{kA();Da();xI0();rZ1();KS=c(JA(),1),o52=c(JA(),1)});function qJ5(A,Q){let B=null;for(let G of Q){if(G.type!=="assistant"||!Array.isArray(G.message.content))continue;for(let Z of G.message.content)if(Z.type==="tool_use"&&Z.id===A)B=Z}return B}function e52(A,Q,B){return t52.useMemo(()=>{let G=qJ5(A,B);if(!G)return null;let Z=Q.find((Y)=>Y.name===G.name);if(!Z)return null;return{tool:Z,toolUse:G}},[A,B,Q])}var t52;var A72=w(()=>{t52=c(JA(),1)});function Q72({param:A,message:Q,messages:B,progressMessagesForMessage:G,style:Z,tools:Y,verbose:J,width:X}){let I=e52(A.tool_use_id,Y,B);if(!I)return null;if(A.content===IVA)return zd.createElement(b52,null);if(A.content===X4A||A.content===T_)return zd.createElement(d52,{input:I.toolUse.input,progressMessagesForMessage:G,tool:I.tool,tools:Y,messages:B,style:Z,verbose:J});if(A.is_error)return zd.createElement(u52,{progressMessagesForMessage:G,tool:I.tool,tools:Y,param:A,verbose:J});return zd.createElement(r52,{message:Q,messages:B,toolUseID:I.toolUse.id,progressMessagesForMessage:G,style:Z,tool:I.tool,tools:Y,verbose:J,width:X})}var zd;var B72=w(()=>{eQ();f52();m52();p52();s52();A72();zd=c(JA(),1)});var _J,G72="";var VS=w(()=>{h3();_J=n0.platform==="darwin"?"":""});function NJ5(){let A=new Xa;A.setMaxListeners(100);let Q=null,B=!0;return{subscribe(G){if(A.on("blink",G),A.listenerCount("blink")===1)Q=setInterval(()=>{B=!B,A.emit("blink")},600);return B},unsubscribe(G){if(A.off("blink",G),A.listenerCount("blink")===0&&Q)clearInterval(Q),Q=null},getCurrentState(){return B}}}function Y72(A){let Q=Z72(),[B,G]=sZ1.useState(Q.getCurrentState());return sZ1.useEffect(()=>{if(!A)return;let Z=Z72(),Y=()=>G(Z.getCurrentState()),J=Z.subscribe(Y);return G(J),()=>{Z.unsubscribe(Y)}},[A]),A?B:!0}var sZ1,Z72;var J72=w(()=>{kA();X9();sZ1=c(JA(),1);Z72=W0(NJ5)});function I4A({isError:A,isUnresolved:Q,shouldAnimate:B}){let G=Y72(B);return yI0.default.createElement(T,{minWidth:2},yI0.default.createElement($,{color:Q?void 0:A?"error":"success",dimColor:Q},!B||G||A||!Q?_J:" "))}var yI0;var tZ1=w(()=>{kA();VS();J72();yI0=c(JA(),1)});function X72({param:A,addMargin:Q,tools:B,commands:G,verbose:Z,erroredToolUseIDs:Y,inProgressToolUseIDs:J,resolvedToolUseIDs:X,progressMessagesForMessage:I,shouldAnimate:W,shouldShowDot:D,inProgressToolCallCount:K,messages:V}){let F=XB(),[H]=aB(),z=W72()?.[0]?.pendingWorkerRequest;if(!B)return s(Error(`Tools array is undefined for tool ${A.name}`)),null;let C=B.find((v)=>v.name===A.name);if(!C)return s(Error(`Tool ${A.name} not found`)),null;let O=X.has(A.id),L=!J.has(A.id)&&!O,M=z?.toolUseId===A.id,_=C.inputSchema.safeParse(A.input),j=C.userFacingName(_.success?_.data:void 0),P=C.userFacingNameBackgroundColor?.(_.success?_.data:void 0);if(j==="")return null;let y=_.success?wJ5(C,_.data,{theme:H,verbose:Z,commands:G}):null;if(y===null)return null;return DE.default.createElement(T,{flexDirection:"row",justifyContent:"space-between",marginTop:Q?1:0,width:"100%"},DE.default.createElement(T,{flexDirection:"column"},DE.default.createElement(T,{flexDirection:"row",flexWrap:"nowrap",minWidth:j.length+(D?2:0)},D&&(L?DE.default.createElement(T,{minWidth:2},DE.default.createElement($,{dimColor:L},_J)):DE.default.createElement(I4A,{shouldAnimate:W,isUnresolved:!O,isError:Y.has(A.id)})),DE.default.createElement(T,{flexShrink:0},DE.default.createElement($,{bold:!0,wrap:"truncate-end",backgroundColor:P,color:P?"inverseText":void 0},j)),y!==""&&DE.default.createElement(T,{flexWrap:"nowrap"},DE.default.createElement($,null,"(",y,")")),_.success&&C.renderToolUseTag&&C.renderToolUseTag(_.data)),!O&&!L&&(M?DE.default.createElement(R0,{height:1},DE.default.createElement($,{dimColor:!0},"Waiting for permission")):LJ5(C,B,V,A.id,I,{verbose:Z,inProgressToolCallCount:K},F)),!O&&L&&OJ5(C)))}function wJ5(A,Q,{theme:B,verbose:G,commands:Z}){try{let Y=A.inputSchema.safeParse(Q);if(!Y.success)return"";return A.renderToolUseMessage(Y.data,{theme:B,verbose:G,commands:Z})}catch(Y){return s(Error(`Error rendering tool use message for ${A.name}: ${Y}`)),""}}function LJ5(A,Q,B,G,Z,{verbose:Y,inProgressToolCallCount:J},X){let I=Z.filter((W)=>W.data.type!=="hook_progress");try{let W=A.renderToolUseProgressMessage(I,{tools:Q,verbose:Y,terminalSize:X,inProgressToolCallCount:J??1});return DE.default.createElement(DE.default.Fragment,null,DE.default.createElement(J4A,null,DE.default.createElement(oZ1,{hookEvent:"PreToolUse",messages:B,toolUseID:G,verbose:Y})),W)}catch(W){return s(Error(`Error rendering tool use progress message for ${A.name}: ${W}`)),null}}function OJ5(A){try{return A.renderToolUseQueuedMessage?.()}catch(Q){return s(Error(`Error rendering tool use queued message for ${A.name}: ${Q}`)),null}}var DE;var I72=w(()=>{kA();f1();tZ1();VS();j4();xI0();rZ1();uB();m4();DE=c(JA(),1)});function W4A({children:A}){let Q=eZ1.useContext(mq);return eZ1.default.createElement(T,{width:Q?void 0:1000,flexShrink:Q?void 0:0},A)}var eZ1;var AY1=w(()=>{kA();Da();eZ1=c(JA(),1)});function MJ5(){if(p0A()==="sonnet"){let{hasAccess:Q}=Vn();if(Q)return{alias:"sonnet[1m]",name:"Sonnet 1M",multiplier:5}}return null}function D4A(A){let Q=MJ5();if(!Q)return null;switch(A){case"warning":return`/model ${Q.alias} for more context`;case"tip":return`Tip: You have access to ${Q.name} with ${Q.multiplier}x more context`;default:return null}}var QY1=w(()=>{m2();AeA()});import*as D72 from"http";class vI0{localServer;port=0;promiseResolver=null;promiseRejecter=null;expectedState=null;pendingResponse=null;callbackPath;constructor(A="/callback"){this.localServer=D72.createServer(),this.callbackPath=A}async start(A){return new Promise((Q,B)=>{this.localServer.once("error",(G)=>{B(Error(`Failed to start OAuth callback server: ${G.message}`))}),this.localServer.listen(A??0,"localhost",()=>{let G=this.localServer.address();this.port=G.port,Q(this.port)})})}getPort(){return this.port}hasPendingResponse(){return this.pendingResponse!==null}async waitForAuthorization(A,Q){return new Promise((B,G)=>{this.promiseResolver=B,this.promiseRejecter=G,this.expectedState=A,this.startLocalListener(Q)})}handleSuccessRedirect(A,Q){if(!this.pendingResponse)return;if(Q){Q(this.pendingResponse,A),this.pendingResponse=null,p("tengu_oauth_automatic_redirect",{custom_handler:!0});return}let B=Vg(A)?b9().CLAUDEAI_SUCCESS_URL:b9().CONSOLE_SUCCESS_URL;this.pendingResponse.writeHead(302,{Location:B}),this.pendingResponse.end(),this.pendingResponse=null,p("tengu_oauth_automatic_redirect",{})}handleErrorRedirect(){if(!this.pendingResponse)return;let A=b9().CLAUDEAI_SUCCESS_URL;this.pendingResponse.writeHead(302,{Location:A}),this.pendingResponse.end(),this.pendingResponse=null,p("tengu_oauth_automatic_redirect_error",{})}startLocalListener(A){this.localServer.on("request",this.handleRedirect.bind(this)),this.localServer.on("error",this.handleError.bind(this)),A()}handleRedirect(A,Q){let B=new URL(A.url||"",`http://${A.headers.host||"localhost"}`);if(B.pathname!==this.callbackPath){Q.writeHead(404),Q.end();return}let G=B.searchParams.get("code")??void 0,Z=B.searchParams.get("state")??void 0;this.validateAndRespond(G,Z,Q)}validateAndRespond(A,Q,B){if(!A){B.writeHead(400),B.end("Authorization code not found"),this.reject(Error("No authorization code received"));return}if(Q!==this.expectedState){B.writeHead(400),B.end("Invalid state parameter"),this.reject(Error("Invalid state parameter"));return}this.pendingResponse=B,this.resolve(A)}handleError(A){s(A),this.close(),this.reject(A)}resolve(A){if(this.promiseResolver)this.promiseResolver(A),this.promiseResolver=null,this.promiseRejecter=null}reject(A){if(this.promiseRejecter)this.promiseRejecter(A),this.promiseResolver=null,this.promiseRejecter=null}close(){if(this.pendingResponse)this.handleErrorRedirect();if(this.localServer)this.localServer.removeAllListeners(),this.localServer.close()}}var K72=w(()=>{ZX();f1();Z0();mw()});import*as AyA from"crypto";function kI0(A){return A.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function V72(){return kI0(AyA.randomBytes(32))}function F72(A){let Q=AyA.createHash("sha256");return Q.update(A),kI0(Q.digest())}function H72(){return kI0(AyA.randomBytes(32))}var E72=()=>{};import{writeSync as BY1}from"fs";function bI0(){if(!process.stdout.isTTY)return;BY1(1,ZIA),BY1(1,wBA),BY1(1,$IA),BY1(1,DP)}function P6(A=0,Q="other",B){process.exitCode=A,i3(A,Q,B).catch((G)=>{k(`Graceful shutdown failed: ${G}`,{level:"error"}),bI0(),process.exit(A)})}async function i3(A=0,Q="other",B){process.exitCode=A;try{let{executeSessionEndHooks:G}=await Promise.resolve().then(() => (AO(),C72));await G(Q,B)}catch{}try{let G=(async()=>{try{await bk0()}catch{}})();await Promise.race([G,new Promise((Z,Y)=>setTimeout(()=>Y(Error("Cleanup timeout")),2000))]),await On1(),bI0(),process.exit(A)}catch{await On1(),bI0(),process.exit(A)}}var z72;var jJ=w(()=>{X9();y1();pX();NOA();LBA();Xk();z72=W0(()=>{process.on("SIGINT",()=>{i3(0)}),process.on("SIGTERM",()=>{i3(143)})})});async function GY1(A){try{return await A()}catch(Q){if(fQ.isAxiosError(Q)&&Q.response?.status===401){p("tengu_grove_oauth_401_received",{});let B=f4()?.accessToken;if(B)return await ueA(B),await A()}throw Q}}async function WVA(){try{return(await GY1(()=>{let Q=HJ();if(Q.error)throw Error(`Failed to get auth headers: ${Q.error}`);return fQ.get(`${b9().BASE_API_URL}/api/oauth/account/settings`,{headers:{...Q.headers,"User-Agent":RW()}})})).data}catch(A){return s(A),null}}async function fI0(){try{await GY1(()=>{let A=HJ();if(A.error)throw Error(`Failed to get auth headers: ${A.error}`);return fQ.post(`${b9().BASE_API_URL}/api/oauth/account/grove_notice_viewed`,{},{headers:{...A.headers,"User-Agent":RW()}})})}catch(A){s(A)}}async function ZY1(A){try{await GY1(()=>{let Q=HJ();if(Q.error)throw Error(`Failed to get auth headers: ${Q.error}`);return fQ.patch(`${b9().BASE_API_URL}/api/oauth/account/settings`,{grove_enabled:A},{headers:{...Q.headers,"User-Agent":RW()}})})}catch(Q){s(Q)}}async function DVA(){if(!meA())return!1;let A=O3()?.accountUuid;if(!A)return!1;let B=R1().groveConfigCache?.[A],G=Date.now();if(!B)return k("Grove: No cache, fetching config in background (dialog skipped this session)"),$72(A),!1;if(G-B.timestamp>_J5)return k("Grove: Cache stale, returning cached data and refreshing in background"),$72(A),B.grove_enabled;return k("Grove: Using fresh cached config"),B.grove_enabled}async function $72(A){try{let Q=await Pr();if(Q!==null)h0((B)=>({...B,groveConfigCache:{...B.groveConfigCache,[A]:{grove_enabled:Q.grove_enabled,timestamp:Date.now()}}}))}catch(Q){k(`Grove: Failed to fetch and store config: ${Q}`)}}var _J5=86400000,Pr;var KVA=w(()=>{f5();wz();f1();ZX();y1();Z0();eB();IQ();X9();Pr=W0(async()=>{try{let A=await GY1(()=>{let Y=HJ();if(Y.error)throw Error(`Failed to get auth headers: ${Y.error}`);return fQ.get(`${b9().BASE_API_URL}/api/claude_code_grove`,{headers:{...Y.headers,"User-Agent":Kn()},timeout:3000})}),{grove_enabled:Q,domain_excluded:B,notice_is_grace_period:G,notice_reminder_frequency:Z}=A.data;return{grove_enabled:Q,domain_excluded:B??!1,notice_is_grace_period:G??!0,notice_reminder_frequency:Z}}catch(A){return k(`Failed to fetch Grove notice config: ${A}`),null}})});var YY1=U((U72)=>{Object.defineProperty(U72,"__esModule",{value:!0});U72.AggregationTemporality=void 0;var jJ5;(function(A){A[A.DELTA=0]="DELTA",A[A.CUMULATIVE=1]="CUMULATIVE"})(jJ5=U72.AggregationTemporality||(U72.AggregationTemporality={}))});var Sr=U((N72)=>{Object.defineProperty(N72,"__esModule",{value:!0});N72.DataPointType=N72.InstrumentType=void 0;var TJ5;(function(A){A.COUNTER="COUNTER",A.GAUGE="GAUGE",A.HISTOGRAM="HISTOGRAM",A.UP_DOWN_COUNTER="UP_DOWN_COUNTER",A.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",A.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",A.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(TJ5=N72.InstrumentType||(N72.InstrumentType={}));var PJ5;(function(A){A[A.HISTOGRAM=0]="HISTOGRAM",A[A.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",A[A.GAUGE=2]="GAUGE",A[A.SUM=3]="SUM"})(PJ5=N72.DataPointType||(N72.DataPointType={}))});var FS=U((w72)=>{Object.defineProperty(w72,"__esModule",{value:!0});w72.equalsCaseInsensitive=w72.binarySearchUB=w72.setEquals=w72.FlatMap=w72.isPromiseAllSettledRejectionResult=w72.PromiseAllSettled=w72.callWithTimeout=w72.TimeoutError=w72.instrumentationScopeId=w72.hashAttributes=w72.isNotNullish=void 0;function SJ5(A){return A!==void 0&&A!==null}w72.isNotNullish=SJ5;function xJ5(A){let Q=Object.keys(A);if(Q.length===0)return"";return Q=Q.sort(),JSON.stringify(Q.map((B)=>[B,A[B]]))}w72.hashAttributes=xJ5;function yJ5(A){return`${A.name}:${A.version??""}:${A.schemaUrl??""}`}w72.instrumentationScopeId=yJ5;class JY1 extends Error{constructor(A){super(A);Object.setPrototypeOf(this,JY1.prototype)}}w72.TimeoutError=JY1;function vJ5(A,Q){let B,G=new Promise(function(Y,J){B=setTimeout(function(){J(new JY1("Operation timed out."))},Q)});return Promise.race([A,G]).then((Z)=>{return clearTimeout(B),Z},(Z)=>{throw clearTimeout(B),Z})}w72.callWithTimeout=vJ5;async function kJ5(A){return Promise.all(A.map(async(Q)=>{try{return{status:"fulfilled",value:await Q}}catch(B){return{status:"rejected",reason:B}}}))}w72.PromiseAllSettled=kJ5;function bJ5(A){return A.status==="rejected"}w72.isPromiseAllSettledRejectionResult=bJ5;function fJ5(A,Q){let B=[];return A.forEach((G)=>{B.push(...Q(G))}),B}w72.FlatMap=fJ5;function hJ5(A,Q){if(A.size!==Q.size)return!1;for(let B of A)if(!Q.has(B))return!1;return!0}w72.setEquals=hJ5;function gJ5(A,Q){let B=0,G=A.length-1,Z=A.length;while(G>=B){let Y=B+Math.trunc((G-B)/2);if(A[Y]<Q)B=Y+1;else Z=Y,G=Y-1}return Z}w72.binarySearchUB=gJ5;function uJ5(A,Q){return A.toLowerCase()===Q.toLowerCase()}w72.equalsCaseInsensitive=uJ5});var VVA=U((O72)=>{Object.defineProperty(O72,"__esModule",{value:!0});O72.AggregatorKind=void 0;var sJ5;(function(A){A[A.DROP=0]="DROP",A[A.SUM=1]="SUM",A[A.LAST_VALUE=2]="LAST_VALUE",A[A.HISTOGRAM=3]="HISTOGRAM",A[A.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"})(sJ5=O72.AggregatorKind||(O72.AggregatorKind={}))});var j72=U((R72)=>{Object.defineProperty(R72,"__esModule",{value:!0});R72.DropAggregator=void 0;var tJ5=VVA();class M72{kind=tJ5.AggregatorKind.DROP;createAccumulation(){return}merge(A,Q){return}diff(A,Q){return}toMetricData(A,Q,B,G){return}}R72.DropAggregator=M72});var x72=U((P72)=>{Object.defineProperty(P72,"__esModule",{value:!0});P72.HistogramAggregator=P72.HistogramAccumulation=void 0;var eJ5=VVA(),QyA=Sr(),AX5=FS();function QX5(A){let Q=A.map(()=>0);return Q.push(0),{buckets:{boundaries:A,counts:Q},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}class ByA{startTime;_boundaries;_recordMinMax;_current;constructor(A,Q,B=!0,G=QX5(Q)){this.startTime=A,this._boundaries=Q,this._recordMinMax=B,this._current=G}record(A){if(Number.isNaN(A))return;if(this._current.count+=1,this._current.sum+=A,this._recordMinMax)this._current.min=Math.min(A,this._current.min),this._current.max=Math.max(A,this._current.max),this._current.hasMinMax=!0;let Q=(0,AX5.binarySearchUB)(this._boundaries,A);this._current.buckets.counts[Q]+=1}setStartTime(A){this.startTime=A}toPointValue(){return this._current}}P72.HistogramAccumulation=ByA;class T72{_boundaries;_recordMinMax;kind=eJ5.AggregatorKind.HISTOGRAM;constructor(A,Q){this._boundaries=A,this._recordMinMax=Q}createAccumulation(A){return new ByA(A,this._boundaries,this._recordMinMax)}merge(A,Q){let B=A.toPointValue(),G=Q.toPointValue(),Z=B.buckets.counts,Y=G.buckets.counts,J=Array(Z.length);for(let W=0;W<Z.length;W++)J[W]=Z[W]+Y[W];let X=1/0,I=-1/0;if(this._recordMinMax){if(B.hasMinMax&&G.hasMinMax)X=Math.min(B.min,G.min),I=Math.max(B.max,G.max);else if(B.hasMinMax)X=B.min,I=B.max;else if(G.hasMinMax)X=G.min,I=G.max}return new ByA(A.startTime,B.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:B.buckets.boundaries,counts:J},count:B.count+G.count,sum:B.sum+G.sum,hasMinMax:this._recordMinMax&&(B.hasMinMax||G.hasMinMax),min:X,max:I})}diff(A,Q){let B=A.toPointValue(),G=Q.toPointValue(),Z=B.buckets.counts,Y=G.buckets.counts,J=Array(Z.length);for(let X=0;X<Z.length;X++)J[X]=Y[X]-Z[X];return new ByA(Q.startTime,B.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:B.buckets.boundaries,counts:J},count:G.count-B.count,sum:G.sum-B.sum,hasMinMax:!1,min:1/0,max:-1/0})}toMetricData(A,Q,B,G){return{descriptor:A,aggregationTemporality:Q,dataPointType:QyA.DataPointType.HISTOGRAM,dataPoints:B.map(([Z,Y])=>{let J=Y.toPointValue(),X=A.type===QyA.InstrumentType.GAUGE||A.type===QyA.InstrumentType.UP_DOWN_COUNTER||A.type===QyA.InstrumentType.OBSERVABLE_GAUGE||A.type===QyA.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:Z,startTime:Y.startTime,endTime:G,value:{min:J.hasMinMax?J.min:void 0,max:J.hasMinMax?J.max:void 0,sum:!X?J.sum:void 0,buckets:J.buckets,count:J.count}}})}}}P72.HistogramAggregator=T72});var k72=U((y72)=>{Object.defineProperty(y72,"__esModule",{value:!0});y72.Buckets=void 0;class mI0{backing;indexBase;indexStart;indexEnd;constructor(A=new dI0,Q=0,B=0,G=0){this.backing=A,this.indexBase=Q,this.indexStart=B,this.indexEnd=G}get offset(){return this.indexStart}get length(){if(this.backing.length===0)return 0;if(this.indexEnd===this.indexStart&&this.at(0)===0)return 0;return this.indexEnd-this.indexStart+1}counts(){return Array.from({length:this.length},(A,Q)=>this.at(Q))}at(A){let Q=this.indexBase-this.indexStart;if(A<Q)A+=this.backing.length;return A-=Q,this.backing.countAt(A)}incrementBucket(A,Q){this.backing.increment(A,Q)}decrementBucket(A,Q){this.backing.decrement(A,Q)}trim(){for(let A=0;A<this.length;A++)if(this.at(A)!==0){this.indexStart+=A;break}else if(A===this.length-1){this.indexStart=this.indexEnd=this.indexBase=0;return}for(let A=this.length-1;A>=0;A--)if(this.at(A)!==0){this.indexEnd-=this.length-A-1;break}this._rotate()}downscale(A){this._rotate();let Q=1+this.indexEnd-this.indexStart,B=1<<A,G=0,Z=0;for(let Y=this.indexStart;Y<=this.indexEnd;){let J=Y%B;if(J<0)J+=B;for(let X=J;X<B&&G<Q;X++)this._relocateBucket(Z,G),G++,Y++;Z++}this.indexStart>>=A,this.indexEnd>>=A,this.indexBase=this.indexStart}clone(){return new mI0(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)}_rotate(){let A=this.indexBase-this.indexStart;if(A===0)return;else if(A>0)this.backing.reverse(0,this.backing.length),this.backing.reverse(0,A),this.backing.reverse(A,this.backing.length);else this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+A);this.indexBase=this.indexStart}_relocateBucket(A,Q){if(A===Q)return;this.incrementBucket(A,this.backing.emptyBucket(Q))}}y72.Buckets=mI0;class dI0{_counts;constructor(A=[0]){this._counts=A}get length(){return this._counts.length}countAt(A){return this._counts[A]}growTo(A,Q,B){let G=Array(A).fill(0);G.splice(B,this._counts.length-Q,...this._counts.slice(Q)),G.splice(0,Q,...this._counts.slice(0,Q)),this._counts=G}reverse(A,Q){let B=Math.floor((A+Q)/2)-A;for(let G=0;G<B;G++){let Z=this._counts[A+G];this._counts[A+G]=this._counts[Q-G-1],this._counts[Q-G-1]=Z}}emptyBucket(A){let Q=this._counts[A];return this._counts[A]=0,Q}increment(A,Q){this._counts[A]+=Q}decrement(A,Q){if(this._counts[A]>=Q)this._counts[A]-=Q;else this._counts[A]=0}clone(){return new dI0([...this._counts])}}});var cI0=U((b72)=>{Object.defineProperty(b72,"__esModule",{value:!0});b72.getSignificand=b72.getNormalBase2=b72.MIN_VALUE=b72.MAX_NORMAL_EXPONENT=b72.MIN_NORMAL_EXPONENT=b72.SIGNIFICAND_WIDTH=void 0;b72.SIGNIFICAND_WIDTH=52;var GX5=2146435072,ZX5=1048575,pI0=1023;b72.MIN_NORMAL_EXPONENT=-pI0+1;b72.MAX_NORMAL_EXPONENT=pI0;b72.MIN_VALUE=Math.pow(2,-1022);function YX5(A){let Q=new DataView(new ArrayBuffer(8));return Q.setFloat64(0,A),((Q.getUint32(0)&GX5)>>20)-pI0}b72.getNormalBase2=YX5;function JX5(A){let Q=new DataView(new ArrayBuffer(8));Q.setFloat64(0,A);let B=Q.getUint32(0),G=Q.getUint32(4);return(B&ZX5)*Math.pow(2,32)+G}b72.getSignificand=JX5});var XY1=U((h72)=>{Object.defineProperty(h72,"__esModule",{value:!0});h72.nextGreaterSquare=h72.ldexp=void 0;function VX5(A,Q){if(A===0||A===Number.POSITIVE_INFINITY||A===Number.NEGATIVE_INFINITY||Number.isNaN(A))return A;return A*Math.pow(2,Q)}h72.ldexp=VX5;function FX5(A){return A--,A|=A>>1,A|=A>>2,A|=A>>4,A|=A>>8,A|=A>>16,A++,A}h72.nextGreaterSquare=FX5});var IY1=U((m72)=>{Object.defineProperty(m72,"__esModule",{value:!0});m72.MappingError=void 0;class u72 extends Error{}m72.MappingError=u72});var n72=U((l72)=>{Object.defineProperty(l72,"__esModule",{value:!0});l72.ExponentMapping=void 0;var FVA=cI0(),EX5=XY1(),p72=IY1();class c72{_shift;constructor(A){this._shift=-A}mapToIndex(A){if(A<FVA.MIN_VALUE)return this._minNormalLowerBoundaryIndex();let Q=FVA.getNormalBase2(A),B=this._rightShift(FVA.getSignificand(A)-1,FVA.SIGNIFICAND_WIDTH);return Q+B>>this._shift}lowerBoundary(A){let Q=this._minNormalLowerBoundaryIndex();if(A<Q)throw new p72.MappingError(`underflow: ${A} is < minimum lower boundary: ${Q}`);let B=this._maxNormalLowerBoundaryIndex();if(A>B)throw new p72.MappingError(`overflow: ${A} is > maximum lower boundary: ${B}`);return EX5.ldexp(1,A<<this._shift)}get scale(){if(this._shift===0)return 0;return-this._shift}_minNormalLowerBoundaryIndex(){let A=FVA.MIN_NORMAL_EXPONENT>>this._shift;if(this._shift<2)A--;return A}_maxNormalLowerBoundaryIndex(){return FVA.MAX_NORMAL_EXPONENT>>this._shift}_rightShift(A,Q){return Math.floor(A*Math.pow(2,-Q))}}l72.ExponentMapping=c72});var e72=U((s72)=>{Object.defineProperty(s72,"__esModule",{value:!0});s72.LogarithmMapping=void 0;var HVA=cI0(),a72=XY1(),o72=IY1();class r72{_scale;_scaleFactor;_inverseFactor;constructor(A){this._scale=A,this._scaleFactor=a72.ldexp(Math.LOG2E,A),this._inverseFactor=a72.ldexp(Math.LN2,-A)}mapToIndex(A){if(A<=HVA.MIN_VALUE)return this._minNormalLowerBoundaryIndex()-1;if(HVA.getSignificand(A)===0)return(HVA.getNormalBase2(A)<<this._scale)-1;let Q=Math.floor(Math.log(A)*this._scaleFactor),B=this._maxNormalLowerBoundaryIndex();if(Q>=B)return B;return Q}lowerBoundary(A){let Q=this._maxNormalLowerBoundaryIndex();if(A>=Q){if(A===Q)return 2*Math.exp((A-(1<<this._scale))/this._scaleFactor);throw new o72.MappingError(`overflow: ${A} is > maximum lower boundary: ${Q}`)}let B=this._minNormalLowerBoundaryIndex();if(A<=B){if(A===B)return HVA.MIN_VALUE;else if(A===B-1)return Math.exp((A+(1<<this._scale))/this._scaleFactor)/2;throw new o72.MappingError(`overflow: ${A} is < minimum lower boundary: ${B}`)}return Math.exp(A*this._inverseFactor)}get scale(){return this._scale}_minNormalLowerBoundaryIndex(){return HVA.MIN_NORMAL_EXPONENT<<this._scale}_maxNormalLowerBoundaryIndex(){return(HVA.MAX_NORMAL_EXPONENT+1<<this._scale)-1}}s72.LogarithmMapping=r72});var ZG2=U((BG2)=>{Object.defineProperty(BG2,"__esModule",{value:!0});BG2.getMapping=void 0;var zX5=n72(),CX5=e72(),$X5=IY1(),AG2=-10,QG2=20,UX5=Array.from({length:31},(A,Q)=>{if(Q>10)return new CX5.LogarithmMapping(Q-10);return new zX5.ExponentMapping(Q-10)});function qX5(A){if(A>QG2||A<AG2)throw new $X5.MappingError(`expected scale >= ${AG2} && <= ${QG2}, got: ${A}`);return UX5[A+10]}BG2.getMapping=qX5});var DG2=U((IG2)=>{Object.defineProperty(IG2,"__esModule",{value:!0});IG2.ExponentialHistogramAggregator=IG2.ExponentialHistogramAccumulation=void 0;var NX5=VVA(),GyA=Sr(),wX5=i9(),YG2=k72(),JG2=ZG2(),LX5=XY1();class EVA{low;high;static combine(A,Q){return new EVA(Math.min(A.low,Q.low),Math.max(A.high,Q.high))}constructor(A,Q){this.low=A,this.high=Q}}var OX5=20,MX5=160,lI0=2;class WY1{startTime;_maxSize;_recordMinMax;_sum;_count;_zeroCount;_min;_max;_positive;_negative;_mapping;constructor(A,Q=MX5,B=!0,G=0,Z=0,Y=0,J=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,I=new YG2.Buckets,W=new YG2.Buckets,D=(0,JG2.getMapping)(OX5)){if(this.startTime=A,this._maxSize=Q,this._recordMinMax=B,this._sum=G,this._count=Z,this._zeroCount=Y,this._min=J,this._max=X,this._positive=I,this._negative=W,this._mapping=D,this._maxSize<lI0)wX5.diag.warn(`Exponential Histogram Max Size set to ${this._maxSize},                 changing to the minimum size of: ${lI0}`),this._maxSize=lI0}record(A){this.updateByIncrement(A,1)}setStartTime(A){this.startTime=A}toPointValue(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}}get sum(){return this._sum}get min(){return this._min}get max(){return this._max}get count(){return this._count}get zeroCount(){return this._zeroCount}get scale(){if(this._count===this._zeroCount)return 0;return this._mapping.scale}get positive(){return this._positive}get negative(){return this._negative}updateByIncrement(A,Q){if(Number.isNaN(A))return;if(A>this._max)this._max=A;if(A<this._min)this._min=A;if(this._count+=Q,A===0){this._zeroCount+=Q;return}if(this._sum+=A*Q,A>0)this._updateBuckets(this._positive,A,Q);else this._updateBuckets(this._negative,-A,Q)}merge(A){if(this._count===0)this._min=A.min,this._max=A.max;else if(A.count!==0){if(A.min<this.min)this._min=A.min;if(A.max>this.max)this._max=A.max}this.startTime=A.startTime,this._sum+=A.sum,this._count+=A.count,this._zeroCount+=A.zeroCount;let Q=this._minScale(A);this._downscale(this.scale-Q),this._mergeBuckets(this.positive,A,A.positive,Q),this._mergeBuckets(this.negative,A,A.negative,Q)}diff(A){this._min=1/0,this._max=-1/0,this._sum-=A.sum,this._count-=A.count,this._zeroCount-=A.zeroCount;let Q=this._minScale(A);this._downscale(this.scale-Q),this._diffBuckets(this.positive,A,A.positive,Q),this._diffBuckets(this.negative,A,A.negative,Q)}clone(){return new WY1(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)}_updateBuckets(A,Q,B){let G=this._mapping.mapToIndex(Q),Z=!1,Y=0,J=0;if(A.length===0)A.indexStart=G,A.indexEnd=A.indexStart,A.indexBase=A.indexStart;else if(G<A.indexStart&&A.indexEnd-G>=this._maxSize)Z=!0,J=G,Y=A.indexEnd;else if(G>A.indexEnd&&G-A.indexStart>=this._maxSize)Z=!0,J=A.indexStart,Y=G;if(Z){let X=this._changeScale(Y,J);this._downscale(X),G=this._mapping.mapToIndex(Q)}this._incrementIndexBy(A,G,B)}_incrementIndexBy(A,Q,B){if(B===0)return;if(A.length===0)A.indexStart=A.indexEnd=A.indexBase=Q;if(Q<A.indexStart){let Z=A.indexEnd-Q;if(Z>=A.backing.length)this._grow(A,Z+1);A.indexStart=Q}else if(Q>A.indexEnd){let Z=Q-A.indexStart;if(Z>=A.backing.length)this._grow(A,Z+1);A.indexEnd=Q}let G=Q-A.indexBase;if(G<0)G+=A.backing.length;A.incrementBucket(G,B)}_grow(A,Q){let B=A.backing.length,G=A.indexBase-A.indexStart,Z=B-G,Y=(0,LX5.nextGreaterSquare)(Q);if(Y>this._maxSize)Y=this._maxSize;let J=Y-G;A.backing.growTo(Y,Z,J)}_changeScale(A,Q){let B=0;while(A-Q>=this._maxSize)A>>=1,Q>>=1,B++;return B}_downscale(A){if(A===0)return;if(A<0)throw Error(`impossible change of scale: ${this.scale}`);let Q=this._mapping.scale-A;this._positive.downscale(A),this._negative.downscale(A),this._mapping=(0,JG2.getMapping)(Q)}_minScale(A){let Q=Math.min(this.scale,A.scale),B=EVA.combine(this._highLowAtScale(this.positive,this.scale,Q),this._highLowAtScale(A.positive,A.scale,Q)),G=EVA.combine(this._highLowAtScale(this.negative,this.scale,Q),this._highLowAtScale(A.negative,A.scale,Q));return Math.min(Q-this._changeScale(B.high,B.low),Q-this._changeScale(G.high,G.low))}_highLowAtScale(A,Q,B){if(A.length===0)return new EVA(0,-1);let G=Q-B;return new EVA(A.indexStart>>G,A.indexEnd>>G)}_mergeBuckets(A,Q,B,G){let Z=B.offset,Y=Q.scale-G;for(let J=0;J<B.length;J++)this._incrementIndexBy(A,Z+J>>Y,B.at(J))}_diffBuckets(A,Q,B,G){let Z=B.offset,Y=Q.scale-G;for(let J=0;J<B.length;J++){let I=(Z+J>>Y)-A.indexBase;if(I<0)I+=A.backing.length;A.decrementBucket(I,B.at(J))}A.trim()}}IG2.ExponentialHistogramAccumulation=WY1;class XG2{_maxSize;_recordMinMax;kind=NX5.AggregatorKind.EXPONENTIAL_HISTOGRAM;constructor(A,Q){this._maxSize=A,this._recordMinMax=Q}createAccumulation(A){return new WY1(A,this._maxSize,this._recordMinMax)}merge(A,Q){let B=Q.clone();return B.merge(A),B}diff(A,Q){let B=Q.clone();return B.diff(A),B}toMetricData(A,Q,B,G){return{descriptor:A,aggregationTemporality:Q,dataPointType:GyA.DataPointType.EXPONENTIAL_HISTOGRAM,dataPoints:B.map(([Z,Y])=>{let J=Y.toPointValue(),X=A.type===GyA.InstrumentType.GAUGE||A.type===GyA.InstrumentType.UP_DOWN_COUNTER||A.type===GyA.InstrumentType.OBSERVABLE_GAUGE||A.type===GyA.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:Z,startTime:Y.startTime,endTime:G,value:{min:J.hasMinMax?J.min:void 0,max:J.hasMinMax?J.max:void 0,sum:!X?J.sum:void 0,positive:{offset:J.positive.offset,bucketCounts:J.positive.bucketCounts},negative:{offset:J.negative.offset,bucketCounts:J.negative.bucketCounts},count:J.count,scale:J.scale,zeroCount:J.zeroCount}}})}}}IG2.ExponentialHistogramAggregator=XG2});var HG2=U((VG2)=>{Object.defineProperty(VG2,"__esModule",{value:!0});VG2.LastValueAggregator=VG2.LastValueAccumulation=void 0;var _X5=VVA(),ZyA=v8(),jX5=Sr();class YyA{startTime;_current;sampleTime;constructor(A,Q=0,B=[0,0]){this.startTime=A,this._current=Q,this.sampleTime=B}record(A){this._current=A,this.sampleTime=(0,ZyA.millisToHrTime)(Date.now())}setStartTime(A){this.startTime=A}toPointValue(){return this._current}}VG2.LastValueAccumulation=YyA;class KG2{kind=_X5.AggregatorKind.LAST_VALUE;createAccumulation(A){return new YyA(A)}merge(A,Q){let B=(0,ZyA.hrTimeToMicroseconds)(Q.sampleTime)>=(0,ZyA.hrTimeToMicroseconds)(A.sampleTime)?Q:A;return new YyA(A.startTime,B.toPointValue(),B.sampleTime)}diff(A,Q){let B=(0,ZyA.hrTimeToMicroseconds)(Q.sampleTime)>=(0,ZyA.hrTimeToMicroseconds)(A.sampleTime)?Q:A;return new YyA(Q.startTime,B.toPointValue(),B.sampleTime)}toMetricData(A,Q,B,G){return{descriptor:A,aggregationTemporality:Q,dataPointType:jX5.DataPointType.GAUGE,dataPoints:B.map(([Z,Y])=>{return{attributes:Z,startTime:Y.startTime,endTime:G,value:Y.toPointValue()}})}}}VG2.LastValueAggregator=KG2});var $G2=U((zG2)=>{Object.defineProperty(zG2,"__esModule",{value:!0});zG2.SumAggregator=zG2.SumAccumulation=void 0;var PX5=VVA(),SX5=Sr();class K4A{startTime;monotonic;_current;reset;constructor(A,Q,B=0,G=!1){this.startTime=A,this.monotonic=Q,this._current=B,this.reset=G}record(A){if(this.monotonic&&A<0)return;this._current+=A}setStartTime(A){this.startTime=A}toPointValue(){return this._current}}zG2.SumAccumulation=K4A;class EG2{monotonic;kind=PX5.AggregatorKind.SUM;constructor(A){this.monotonic=A}createAccumulation(A){return new K4A(A,this.monotonic)}merge(A,Q){let B=A.toPointValue(),G=Q.toPointValue();if(Q.reset)return new K4A(Q.startTime,this.monotonic,G,Q.reset);return new K4A(A.startTime,this.monotonic,B+G)}diff(A,Q){let B=A.toPointValue(),G=Q.toPointValue();if(this.monotonic&&B>G)return new K4A(Q.startTime,this.monotonic,G,!0);return new K4A(Q.startTime,this.monotonic,G-B)}toMetricData(A,Q,B,G){return{descriptor:A,aggregationTemporality:Q,dataPointType:SX5.DataPointType.SUM,dataPoints:B.map(([Z,Y])=>{return{attributes:Z,startTime:Y.startTime,endTime:G,value:Y.toPointValue()}}),isMonotonic:this.monotonic}}}zG2.SumAggregator=EG2});var LG2=U((HS)=>{Object.defineProperty(HS,"__esModule",{value:!0});HS.SumAggregator=HS.SumAccumulation=HS.LastValueAggregator=HS.LastValueAccumulation=HS.ExponentialHistogramAggregator=HS.ExponentialHistogramAccumulation=HS.HistogramAggregator=HS.HistogramAccumulation=HS.DropAggregator=void 0;var yX5=j72();Object.defineProperty(HS,"DropAggregator",{enumerable:!0,get:function(){return yX5.DropAggregator}});var UG2=x72();Object.defineProperty(HS,"HistogramAccumulation",{enumerable:!0,get:function(){return UG2.HistogramAccumulation}});Object.defineProperty(HS,"HistogramAggregator",{enumerable:!0,get:function(){return UG2.HistogramAggregator}});var qG2=DG2();Object.defineProperty(HS,"ExponentialHistogramAccumulation",{enumerable:!0,get:function(){return qG2.ExponentialHistogramAccumulation}});Object.defineProperty(HS,"ExponentialHistogramAggregator",{enumerable:!0,get:function(){return qG2.ExponentialHistogramAggregator}});var NG2=HG2();Object.defineProperty(HS,"LastValueAccumulation",{enumerable:!0,get:function(){return NG2.LastValueAccumulation}});Object.defineProperty(HS,"LastValueAggregator",{enumerable:!0,get:function(){return NG2.LastValueAggregator}});var wG2=$G2();Object.defineProperty(HS,"SumAccumulation",{enumerable:!0,get:function(){return wG2.SumAccumulation}});Object.defineProperty(HS,"SumAggregator",{enumerable:!0,get:function(){return wG2.SumAggregator}})});var PG2=U((OG2)=>{Object.defineProperty(OG2,"__esModule",{value:!0});OG2.DEFAULT_AGGREGATION=OG2.EXPONENTIAL_HISTOGRAM_AGGREGATION=OG2.HISTOGRAM_AGGREGATION=OG2.LAST_VALUE_AGGREGATION=OG2.SUM_AGGREGATION=OG2.DROP_AGGREGATION=OG2.DefaultAggregation=OG2.ExponentialHistogramAggregation=OG2.ExplicitBucketHistogramAggregation=OG2.HistogramAggregation=OG2.LastValueAggregation=OG2.SumAggregation=OG2.DropAggregation=void 0;var kX5=i9(),V4A=LG2(),Rb=Sr();class DY1{static DEFAULT_INSTANCE=new V4A.DropAggregator;createAggregator(A){return DY1.DEFAULT_INSTANCE}}OG2.DropAggregation=DY1;class JyA{static MONOTONIC_INSTANCE=new V4A.SumAggregator(!0);static NON_MONOTONIC_INSTANCE=new V4A.SumAggregator(!1);createAggregator(A){switch(A.type){case Rb.InstrumentType.COUNTER:case Rb.InstrumentType.OBSERVABLE_COUNTER:case Rb.InstrumentType.HISTOGRAM:return JyA.MONOTONIC_INSTANCE;default:return JyA.NON_MONOTONIC_INSTANCE}}}OG2.SumAggregation=JyA;class KY1{static DEFAULT_INSTANCE=new V4A.LastValueAggregator;createAggregator(A){return KY1.DEFAULT_INSTANCE}}OG2.LastValueAggregation=KY1;class VY1{static DEFAULT_INSTANCE=new V4A.HistogramAggregator([0,5,10,25,50,75,100,250,500,750,1000,2500,5000,7500,1e4],!0);createAggregator(A){return VY1.DEFAULT_INSTANCE}}OG2.HistogramAggregation=VY1;class iI0{_recordMinMax;_boundaries;constructor(A,Q=!0){if(this._recordMinMax=Q,A==null)throw Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");A=A.concat(),A=A.sort((Z,Y)=>Z-Y);let B=A.lastIndexOf(-1/0),G=A.indexOf(1/0);if(G===-1)G=void 0;this._boundaries=A.slice(B+1,G)}createAggregator(A){return new V4A.HistogramAggregator(this._boundaries,this._recordMinMax)}}OG2.ExplicitBucketHistogramAggregation=iI0;class nI0{_maxSize;_recordMinMax;constructor(A=160,Q=!0){this._maxSize=A,this._recordMinMax=Q}createAggregator(A){return new V4A.ExponentialHistogramAggregator(this._maxSize,this._recordMinMax)}}OG2.ExponentialHistogramAggregation=nI0;class aI0{_resolve(A){switch(A.type){case Rb.InstrumentType.COUNTER:case Rb.InstrumentType.UP_DOWN_COUNTER:case Rb.InstrumentType.OBSERVABLE_COUNTER:case Rb.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER:return OG2.SUM_AGGREGATION;case Rb.InstrumentType.GAUGE:case Rb.InstrumentType.OBSERVABLE_GAUGE:return OG2.LAST_VALUE_AGGREGATION;case Rb.InstrumentType.HISTOGRAM:{if(A.advice.explicitBucketBoundaries)return new iI0(A.advice.explicitBucketBoundaries);return OG2.HISTOGRAM_AGGREGATION}}return kX5.diag.warn(`Unable to recognize instrument type: ${A.type}`),OG2.DROP_AGGREGATION}createAggregator(A){return this._resolve(A).createAggregator(A)}}OG2.DefaultAggregation=aI0;OG2.DROP_AGGREGATION=new DY1;OG2.SUM_AGGREGATION=new JyA;OG2.LAST_VALUE_AGGREGATION=new KY1;OG2.HISTOGRAM_AGGREGATION=new VY1;OG2.EXPONENTIAL_HISTOGRAM_AGGREGATION=new nI0;OG2.DEFAULT_AGGREGATION=new aI0});var XyA=U((xG2)=>{Object.defineProperty(xG2,"__esModule",{value:!0});xG2.toAggregation=xG2.AggregationType=void 0;var F4A=PG2(),H4A;(function(A){A[A.DEFAULT=0]="DEFAULT",A[A.DROP=1]="DROP",A[A.SUM=2]="SUM",A[A.LAST_VALUE=3]="LAST_VALUE",A[A.EXPLICIT_BUCKET_HISTOGRAM=4]="EXPLICIT_BUCKET_HISTOGRAM",A[A.EXPONENTIAL_HISTOGRAM=5]="EXPONENTIAL_HISTOGRAM"})(H4A=xG2.AggregationType||(xG2.AggregationType={}));function cX5(A){switch(A.type){case H4A.DEFAULT:return F4A.DEFAULT_AGGREGATION;case H4A.DROP:return F4A.DROP_AGGREGATION;case H4A.SUM:return F4A.SUM_AGGREGATION;case H4A.LAST_VALUE:return F4A.LAST_VALUE_AGGREGATION;case H4A.EXPONENTIAL_HISTOGRAM:{let Q=A;return new F4A.ExponentialHistogramAggregation(Q.options?.maxSize,Q.options?.recordMinMax)}case H4A.EXPLICIT_BUCKET_HISTOGRAM:{let Q=A;if(Q.options==null)return F4A.HISTOGRAM_AGGREGATION;else return new F4A.ExplicitBucketHistogramAggregation(Q.options?.boundaries,Q.options?.recordMinMax)}default:throw Error("Unsupported Aggregation")}}xG2.toAggregation=cX5});var oI0=U((vG2)=>{Object.defineProperty(vG2,"__esModule",{value:!0});vG2.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR=vG2.DEFAULT_AGGREGATION_SELECTOR=void 0;var lX5=YY1(),iX5=XyA(),nX5=(A)=>{return{type:iX5.AggregationType.DEFAULT}};vG2.DEFAULT_AGGREGATION_SELECTOR=nX5;var aX5=(A)=>lX5.AggregationTemporality.CUMULATIVE;vG2.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR=aX5});var rI0=U((gG2)=>{Object.defineProperty(gG2,"__esModule",{value:!0});gG2.MetricReader=void 0;var bG2=i9(),FY1=FS(),fG2=oI0();class hG2{_shutdown=!1;_metricProducers;_sdkMetricProducer;_aggregationTemporalitySelector;_aggregationSelector;_cardinalitySelector;constructor(A){this._aggregationSelector=A?.aggregationSelector??fG2.DEFAULT_AGGREGATION_SELECTOR,this._aggregationTemporalitySelector=A?.aggregationTemporalitySelector??fG2.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR,this._metricProducers=A?.metricProducers??[],this._cardinalitySelector=A?.cardinalitySelector}setMetricProducer(A){if(this._sdkMetricProducer)throw Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=A,this.onInitialized()}selectAggregation(A){return this._aggregationSelector(A)}selectAggregationTemporality(A){return this._aggregationTemporalitySelector(A)}selectCardinalityLimit(A){return this._cardinalitySelector?this._cardinalitySelector(A):2000}onInitialized(){}async collect(A){if(this._sdkMetricProducer===void 0)throw Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw Error("MetricReader is shutdown");let[Q,...B]=await Promise.all([this._sdkMetricProducer.collect({timeoutMillis:A?.timeoutMillis}),...this._metricProducers.map((J)=>J.collect({timeoutMillis:A?.timeoutMillis}))]),G=Q.errors.concat((0,FY1.FlatMap)(B,(J)=>J.errors)),Z=Q.resourceMetrics.resource,Y=Q.resourceMetrics.scopeMetrics.concat((0,FY1.FlatMap)(B,(J)=>J.resourceMetrics.scopeMetrics));return{resourceMetrics:{resource:Z,scopeMetrics:Y},errors:G}}async shutdown(A){if(this._shutdown){bG2.diag.error("Cannot call shutdown twice.");return}if(A?.timeoutMillis==null)await this.onShutdown();else await(0,FY1.callWithTimeout)(this.onShutdown(),A.timeoutMillis);this._shutdown=!0}async forceFlush(A){if(this._shutdown){bG2.diag.warn("Cannot forceFlush on already shutdown MetricReader.");return}if(A?.timeoutMillis==null){await this.onForceFlush();return}await(0,FY1.callWithTimeout)(this.onForceFlush(),A.timeoutMillis)}}gG2.MetricReader=hG2});var lG2=U((pG2)=>{Object.defineProperty(pG2,"__esModule",{value:!0});pG2.PeriodicExportingMetricReader=void 0;var sI0=i9(),HY1=v8(),rX5=rI0(),mG2=FS();class dG2 extends rX5.MetricReader{_interval;_exporter;_exportInterval;_exportTimeout;constructor(A){super({aggregationSelector:A.exporter.selectAggregation?.bind(A.exporter),aggregationTemporalitySelector:A.exporter.selectAggregationTemporality?.bind(A.exporter),metricProducers:A.metricProducers});if(A.exportIntervalMillis!==void 0&&A.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(A.exportTimeoutMillis!==void 0&&A.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(A.exportTimeoutMillis!==void 0&&A.exportIntervalMillis!==void 0&&A.exportIntervalMillis<A.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");this._exportInterval=A.exportIntervalMillis??60000,this._exportTimeout=A.exportTimeoutMillis??30000,this._exporter=A.exporter}async _runOnce(){try{await(0,mG2.callWithTimeout)(this._doRun(),this._exportTimeout)}catch(A){if(A instanceof mG2.TimeoutError){sI0.diag.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout);return}(0,HY1.globalErrorHandler)(A)}}async _doRun(){let{resourceMetrics:A,errors:Q}=await this.collect({timeoutMillis:this._exportTimeout});if(Q.length>0)sI0.diag.error("PeriodicExportingMetricReader: metrics collection errors",...Q);if(A.resource.asyncAttributesPending)try{await A.resource.waitForAsyncAttributes?.()}catch(G){sI0.diag.debug("Error while resolving async portion of resource: ",G),(0,HY1.globalErrorHandler)(G)}if(A.scopeMetrics.length===0)return;let B=await HY1.internal._export(this._exporter,A);if(B.code!==HY1.ExportResultCode.SUCCESS)throw Error(`PeriodicExportingMetricReader: metrics export failed (error ${B.error})`)}onInitialized(){if(this._interval=setInterval(()=>{this._runOnce()},this._exportInterval),typeof this._interval!=="number")this._interval.unref()}async onForceFlush(){await this._runOnce(),await this._exporter.forceFlush()}async onShutdown(){if(this._interval)clearInterval(this._interval);await this.onForceFlush(),await this._exporter.shutdown()}}pG2.PeriodicExportingMetricReader=dG2});var rG2=U((aG2)=>{Object.defineProperty(aG2,"__esModule",{value:!0});aG2.InMemoryMetricExporter=void 0;var iG2=v8();class nG2{_shutdown=!1;_aggregationTemporality;_metrics=[];constructor(A){this._aggregationTemporality=A}export(A,Q){if(this._shutdown){setTimeout(()=>Q({code:iG2.ExportResultCode.FAILED}),0);return}this._metrics.push(A),setTimeout(()=>Q({code:iG2.ExportResultCode.SUCCESS}),0)}getMetrics(){return this._metrics}forceFlush(){return Promise.resolve()}reset(){this._metrics=[]}selectAggregationTemporality(A){return this._aggregationTemporality}shutdown(){return this._shutdown=!0,Promise.resolve()}}aG2.InMemoryMetricExporter=nG2});var AZ2=U((tG2)=>{Object.defineProperty(tG2,"__esModule",{value:!0});tG2.ConsoleMetricExporter=void 0;var sG2=v8(),sX5=oI0();class tI0{_shutdown=!1;_temporalitySelector;constructor(A){this._temporalitySelector=A?.temporalitySelector??sX5.DEFAULT_AGGREGATION_TEMPORALITY_SELECTOR}export(A,Q){if(this._shutdown){setImmediate(Q,{code:sG2.ExportResultCode.FAILED});return}return tI0._sendMetrics(A,Q)}forceFlush(){return Promise.resolve()}selectAggregationTemporality(A){return this._temporalitySelector(A)}shutdown(){return this._shutdown=!0,Promise.resolve()}static _sendMetrics(A,Q){for(let B of A.scopeMetrics)for(let G of B.metrics)console.dir({descriptor:G.descriptor,dataPointType:G.dataPointType,dataPoints:G.dataPoints},{depth:null});Q({code:sG2.ExportResultCode.SUCCESS})}}tG2.ConsoleMetricExporter=tI0});var ZZ2=U((BZ2)=>{Object.defineProperty(BZ2,"__esModule",{value:!0});BZ2.ViewRegistry=void 0;class QZ2{_registeredViews=[];addView(A){this._registeredViews.push(A)}findViews(A,Q){return this._registeredViews.filter((G)=>{return this._matchInstrument(G.instrumentSelector,A)&&this._matchMeter(G.meterSelector,Q)})}_matchInstrument(A,Q){return(A.getType()===void 0||Q.type===A.getType())&&A.getNameFilter().match(Q.name)&&A.getUnitFilter().match(Q.unit)}_matchMeter(A,Q){return A.getNameFilter().match(Q.name)&&(Q.version===void 0||A.getVersionFilter().match(Q.version))&&(Q.schemaUrl===void 0||A.getSchemaUrlFilter().match(Q.schemaUrl))}}BZ2.ViewRegistry=QZ2});var IyA=U((XZ2)=>{Object.defineProperty(XZ2,"__esModule",{value:!0});XZ2.isValidName=XZ2.isDescriptorCompatibleWith=XZ2.createInstrumentDescriptorWithView=XZ2.createInstrumentDescriptor=void 0;var YZ2=i9(),tX5=FS();function eX5(A,Q,B){if(!JZ2(A))YZ2.diag.warn(`Invalid metric name: "${A}". The metric name should be a ASCII string with a length no greater than 255 characters.`);return{name:A,type:Q,description:B?.description??"",unit:B?.unit??"",valueType:B?.valueType??YZ2.ValueType.DOUBLE,advice:B?.advice??{}}}XZ2.createInstrumentDescriptor=eX5;function AI5(A,Q){return{name:A.name??Q.name,description:A.description??Q.description,type:Q.type,unit:Q.unit,valueType:Q.valueType,advice:Q.advice}}XZ2.createInstrumentDescriptorWithView=AI5;function QI5(A,Q){return(0,tX5.equalsCaseInsensitive)(A.name,Q.name)&&A.unit===Q.unit&&A.type===Q.type&&A.valueType===Q.valueType}XZ2.isDescriptorCompatibleWith=QI5;var BI5=/^[a-z][a-z0-9_.\-/]{0,254}$/i;function JZ2(A){return A.match(BI5)!=null}XZ2.isValidName=JZ2});var EY1=U((zZ2)=>{Object.defineProperty(zZ2,"__esModule",{value:!0});zZ2.isObservableInstrument=zZ2.ObservableUpDownCounterInstrument=zZ2.ObservableGaugeInstrument=zZ2.ObservableCounterInstrument=zZ2.ObservableInstrument=zZ2.HistogramInstrument=zZ2.GaugeInstrument=zZ2.CounterInstrument=zZ2.UpDownCounterInstrument=zZ2.SyncInstrument=void 0;var zVA=i9(),JI5=v8();class CVA{_writableMetricStorage;_descriptor;constructor(A,Q){this._writableMetricStorage=A,this._descriptor=Q}_record(A,Q={},B=zVA.context.active()){if(typeof A!=="number"){zVA.diag.warn(`non-number value provided to metric ${this._descriptor.name}: ${A}`);return}if(this._descriptor.valueType===zVA.ValueType.INT&&!Number.isInteger(A)){if(zVA.diag.warn(`INT value type cannot accept a floating-point value for ${this._descriptor.name}, ignoring the fractional digits.`),A=Math.trunc(A),!Number.isInteger(A))return}this._writableMetricStorage.record(A,Q,B,(0,JI5.millisToHrTime)(Date.now()))}}zZ2.SyncInstrument=CVA;class WZ2 extends CVA{add(A,Q,B){this._record(A,Q,B)}}zZ2.UpDownCounterInstrument=WZ2;class DZ2 extends CVA{add(A,Q,B){if(A<0){zVA.diag.warn(`negative value provided to counter ${this._descriptor.name}: ${A}`);return}this._record(A,Q,B)}}zZ2.CounterInstrument=DZ2;class KZ2 extends CVA{record(A,Q,B){this._record(A,Q,B)}}zZ2.GaugeInstrument=KZ2;class VZ2 extends CVA{record(A,Q,B){if(A<0){zVA.diag.warn(`negative value provided to histogram ${this._descriptor.name}: ${A}`);return}this._record(A,Q,B)}}zZ2.HistogramInstrument=VZ2;class $VA{_observableRegistry;_metricStorages;_descriptor;constructor(A,Q,B){this._observableRegistry=B,this._descriptor=A,this._metricStorages=Q}addCallback(A){this._observableRegistry.addCallback(A,this)}removeCallback(A){this._observableRegistry.removeCallback(A,this)}}zZ2.ObservableInstrument=$VA;class FZ2 extends $VA{}zZ2.ObservableCounterInstrument=FZ2;class HZ2 extends $VA{}zZ2.ObservableGaugeInstrument=HZ2;class EZ2 extends $VA{}zZ2.ObservableUpDownCounterInstrument=EZ2;function XI5(A){return A instanceof $VA}zZ2.isObservableInstrument=XI5});var NZ2=U((UZ2)=>{Object.defineProperty(UZ2,"__esModule",{value:!0});UZ2.Meter=void 0;var E4A=IyA(),z4A=EY1(),C4A=Sr();class $Z2{_meterSharedState;constructor(A){this._meterSharedState=A}createGauge(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.GAUGE,Q),G=this._meterSharedState.registerMetricStorage(B);return new z4A.GaugeInstrument(G,B)}createHistogram(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.HISTOGRAM,Q),G=this._meterSharedState.registerMetricStorage(B);return new z4A.HistogramInstrument(G,B)}createCounter(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.COUNTER,Q),G=this._meterSharedState.registerMetricStorage(B);return new z4A.CounterInstrument(G,B)}createUpDownCounter(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.UP_DOWN_COUNTER,Q),G=this._meterSharedState.registerMetricStorage(B);return new z4A.UpDownCounterInstrument(G,B)}createObservableGauge(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.OBSERVABLE_GAUGE,Q),G=this._meterSharedState.registerAsyncMetricStorage(B);return new z4A.ObservableGaugeInstrument(B,G,this._meterSharedState.observableRegistry)}createObservableCounter(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.OBSERVABLE_COUNTER,Q),G=this._meterSharedState.registerAsyncMetricStorage(B);return new z4A.ObservableCounterInstrument(B,G,this._meterSharedState.observableRegistry)}createObservableUpDownCounter(A,Q){let B=(0,E4A.createInstrumentDescriptor)(A,C4A.InstrumentType.OBSERVABLE_UP_DOWN_COUNTER,Q),G=this._meterSharedState.registerAsyncMetricStorage(B);return new z4A.ObservableUpDownCounterInstrument(B,G,this._meterSharedState.observableRegistry)}addBatchObservableCallback(A,Q){this._meterSharedState.observableRegistry.addBatchCallback(A,Q)}removeBatchObservableCallback(A,Q){this._meterSharedState.observableRegistry.removeBatchCallback(A,Q)}}UZ2.Meter=$Z2});var eI0=U((LZ2)=>{Object.defineProperty(LZ2,"__esModule",{value:!0});LZ2.MetricStorage=void 0;var CI5=IyA();class wZ2{_instrumentDescriptor;constructor(A){this._instrumentDescriptor=A}getInstrumentDescriptor(){return this._instrumentDescriptor}updateDescription(A){this._instrumentDescriptor=(0,CI5.createInstrumentDescriptor)(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:A,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})}}LZ2.MetricStorage=wZ2});var WyA=U((RZ2)=>{Object.defineProperty(RZ2,"__esModule",{value:!0});RZ2.AttributeHashMap=RZ2.HashMap=void 0;var $I5=FS();class AW0{_hash;_valueMap=new Map;_keyMap=new Map;constructor(A){this._hash=A}get(A,Q){return Q??=this._hash(A),this._valueMap.get(Q)}getOrDefault(A,Q){let B=this._hash(A);if(this._valueMap.has(B))return this._valueMap.get(B);let G=Q();if(!this._keyMap.has(B))this._keyMap.set(B,A);return this._valueMap.set(B,G),G}set(A,Q,B){if(B??=this._hash(A),!this._keyMap.has(B))this._keyMap.set(B,A);this._valueMap.set(B,Q)}has(A,Q){return Q??=this._hash(A),this._valueMap.has(Q)}*keys(){let A=this._keyMap.entries(),Q=A.next();while(Q.done!==!0)yield[Q.value[1],Q.value[0]],Q=A.next()}*entries(){let A=this._valueMap.entries(),Q=A.next();while(Q.done!==!0)yield[this._keyMap.get(Q.value[0]),Q.value[1],Q.value[0]],Q=A.next()}get size(){return this._valueMap.size}}RZ2.HashMap=AW0;class MZ2 extends AW0{constructor(){super($I5.hashAttributes)}}RZ2.AttributeHashMap=MZ2});var BW0=U((TZ2)=>{Object.defineProperty(TZ2,"__esModule",{value:!0});TZ2.DeltaMetricProcessor=void 0;var qI5=FS(),QW0=WyA();class jZ2{_aggregator;_activeCollectionStorage=new QW0.AttributeHashMap;_cumulativeMemoStorage=new QW0.AttributeHashMap;_cardinalityLimit;_overflowAttributes={"otel.metric.overflow":!0};_overflowHashCode;constructor(A,Q){this._aggregator=A,this._cardinalityLimit=(Q??2000)-1,this._overflowHashCode=(0,qI5.hashAttributes)(this._overflowAttributes)}record(A,Q,B,G){let Z=this._activeCollectionStorage.get(Q);if(!Z){if(this._activeCollectionStorage.size>=this._cardinalityLimit){this._activeCollectionStorage.getOrDefault(this._overflowAttributes,()=>this._aggregator.createAccumulation(G))?.record(A);return}Z=this._aggregator.createAccumulation(G),this._activeCollectionStorage.set(Q,Z)}Z?.record(A)}batchCumulate(A,Q){Array.from(A.entries()).forEach(([B,G,Z])=>{let Y=this._aggregator.createAccumulation(Q);Y?.record(G);let J=Y;if(this._cumulativeMemoStorage.has(B,Z)){let X=this._cumulativeMemoStorage.get(B,Z);J=this._aggregator.diff(X,Y)}else if(this._cumulativeMemoStorage.size>=this._cardinalityLimit){if(B=this._overflowAttributes,Z=this._overflowHashCode,this._cumulativeMemoStorage.has(B,Z)){let X=this._cumulativeMemoStorage.get(B,Z);J=this._aggregator.diff(X,Y)}}if(this._activeCollectionStorage.has(B,Z)){let X=this._activeCollectionStorage.get(B,Z);J=this._aggregator.merge(X,J)}this._cumulativeMemoStorage.set(B,Y,Z),this._activeCollectionStorage.set(B,J,Z)})}collect(){let A=this._activeCollectionStorage;return this._activeCollectionStorage=new QW0.AttributeHashMap,A}}TZ2.DeltaMetricProcessor=jZ2});var GW0=U((SZ2)=>{Object.defineProperty(SZ2,"__esModule",{value:!0});SZ2.TemporalMetricProcessor=void 0;var NI5=YY1(),wI5=WyA();class DyA{_aggregator;_unreportedAccumulations=new Map;_reportHistory=new Map;constructor(A,Q){this._aggregator=A,Q.forEach((B)=>{this._unreportedAccumulations.set(B,[])})}buildMetrics(A,Q,B,G){this._stashAccumulations(B);let Z=this._getMergedUnreportedAccumulations(A),Y=Z,J;if(this._reportHistory.has(A)){let I=this._reportHistory.get(A),W=I.collectionTime;if(J=I.aggregationTemporality,J===NI5.AggregationTemporality.CUMULATIVE)Y=DyA.merge(I.accumulations,Z,this._aggregator);else Y=DyA.calibrateStartTime(I.accumulations,Z,W)}else J=A.selectAggregationTemporality(Q.type);this._reportHistory.set(A,{accumulations:Y,collectionTime:G,aggregationTemporality:J});let X=LI5(Y);if(X.length===0)return;return this._aggregator.toMetricData(Q,J,X,G)}_stashAccumulations(A){let Q=this._unreportedAccumulations.keys();for(let B of Q){let G=this._unreportedAccumulations.get(B);if(G===void 0)G=[],this._unreportedAccumulations.set(B,G);G.push(A)}}_getMergedUnreportedAccumulations(A){let Q=new wI5.AttributeHashMap,B=this._unreportedAccumulations.get(A);if(this._unreportedAccumulations.set(A,[]),B===void 0)return Q;for(let G of B)Q=DyA.merge(Q,G,this._aggregator);return Q}static merge(A,Q,B){let G=A,Z=Q.entries(),Y=Z.next();while(Y.done!==!0){let[J,X,I]=Y.value;if(A.has(J,I)){let W=A.get(J,I),D=B.merge(W,X);G.set(J,D,I)}else G.set(J,X,I);Y=Z.next()}return G}static calibrateStartTime(A,Q,B){for(let[G,Z]of A.keys())Q.get(G,Z)?.setStartTime(B);return Q}}SZ2.TemporalMetricProcessor=DyA;function LI5(A){return Array.from(A.entries())}});var bZ2=U((vZ2)=>{Object.defineProperty(vZ2,"__esModule",{value:!0});vZ2.AsyncMetricStorage=void 0;var OI5=eI0(),MI5=BW0(),RI5=GW0(),_I5=WyA();class yZ2 extends OI5.MetricStorage{_attributesProcessor;_aggregationCardinalityLimit;_deltaMetricStorage;_temporalMetricStorage;constructor(A,Q,B,G,Z){super(A);this._attributesProcessor=B,this._aggregationCardinalityLimit=Z,this._deltaMetricStorage=new MI5.DeltaMetricProcessor(Q,this._aggregationCardinalityLimit),this._temporalMetricStorage=new RI5.TemporalMetricProcessor(Q,G)}record(A,Q){let B=new _I5.AttributeHashMap;Array.from(A.entries()).forEach(([G,Z])=>{B.set(this._attributesProcessor.process(G),Z)}),this._deltaMetricStorage.batchCumulate(B,Q)}collect(A,Q){let B=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(A,this._instrumentDescriptor,B,Q)}}vZ2.AsyncMetricStorage=yZ2});var pZ2=U((mZ2)=>{Object.defineProperty(mZ2,"__esModule",{value:!0});mZ2.getConflictResolutionRecipe=mZ2.getDescriptionResolutionRecipe=mZ2.getTypeConflictResolutionRecipe=mZ2.getUnitConflictResolutionRecipe=mZ2.getValueTypeConflictResolutionRecipe=mZ2.getIncompatibilityDetails=void 0;function jI5(A,Q){let B="";if(A.unit!==Q.unit)B+=`	- Unit '${A.unit}' does not match '${Q.unit}'
2558:       "display_name": "string"  // Display name (e.g., "Claude 3.5 Sonnet")
2881:`).slice(-10).map((F,H)=>FG.default.createElement($,{key:H,wrap:"truncate-end"},F))),FG.default.createElement($,{dimColor:!0,italic:!0},X.stdoutLines>10?`Showing last 10 lines of ${X.stdoutLines} total. Full output: ${j6(cY(A.id))}`:`Showing ${X.stdoutLines} lines`)):FG.default.createElement($,{dimColor:!0},"No output available")))),FG.default.createElement(T,{marginLeft:2},D.pending?FG.default.createElement($,{dimColor:!0},"Press ",D.keyName," again to exit"):FG.default.createElement($,{dimColor:!0},FG.default.createElement(YB,null,G&&FG.default.createElement(y0,{shortcut:"",action:"go back"}),FG.default.createElement(y0,{shortcut:"Esc/Enter/Space",action:"close"}),A.status==="running"&&B&&FG.default.createElement(y0,{shortcut:"k",action:"kill"})))))}var FG,xbA;var gp2=w(()=>{kA();_6();j4();U9();k$();L9();kDA();e4();T3();FG=c(JA(),1),xbA=c(JA(),1)});function sK1({session:A}){if(A.status==="completed")return ybA.default.createElement($,{bold:!0,color:"success",dimColor:!0},"done");if(A.status==="failed")return ybA.default.createElement($,{bold:!0,color:"error",dimColor:!0},"error");if(!A.todoList.length)return ybA.default.createElement($,{dimColor:!0},A.status,"");let Q=A.todoList.filter((G)=>G.status==="completed").length,B=A.todoList.length;return ybA.default.createElement($,{dimColor:!0},Q,"/",B)}var ybA;var Fq0=w(()=>{kA();ybA=c(JA(),1)});import{randomUUID as Wa5}from"crypto";function up2(A){return A.flatMap((Q)=>{switch(Q.type){case"assistant":return[{type:"assistant",message:Q.message,uuid:Q.uuid,requestId:void 0,timestamp:new Date().toISOString()}];case"user":return[{type:"user",message:Q.message,uuid:Q.uuid??Wa5(),timestamp:new Date().toISOString(),isMeta:Q.isSynthetic}];case"system":if(Q.subtype==="compact_boundary"){let B=Q;return[{type:"system",content:"Conversation compacted",level:"info",subtype:"compact_boundary",compactMetadata:{trigger:B.compact_metadata.trigger,preTokens:B.compact_metadata.pre_tokens},uuid:Q.uuid,timestamp:new Date().toISOString()}]}return[];default:return[]}})}function mp2(A){return A.flatMap((Q)=>{switch(Q.type){case"assistant":return[{type:"assistant",message:Da5(Q),session_id:E0(),parent_tool_use_id:null,uuid:Q.uuid,error:Q.error}];case"user":return[{type:"user",message:Q.message,session_id:E0(),parent_tool_use_id:null,uuid:Q.uuid,isSynthetic:Q.isMeta||Q.isVisibleInTranscriptOnly}];case"system":if(Q.subtype==="compact_boundary"&&Q.compactMetadata)return[{type:"system",subtype:"compact_boundary",session_id:E0(),uuid:Q.uuid,compact_metadata:{trigger:Q.compactMetadata.trigger,pre_tokens:Q.compactMetadata.preTokens}}];return[];case"attachment":if(tK1(Q.attachment))return[{type:"system",subtype:"hook_response",session_id:E0(),uuid:Q.uuid,hook_name:Q.attachment.hookName,hook_event:Q.attachment.hookEvent,stdout:Q.attachment.stdout||"",stderr:Q.attachment.stderr||"",exit_code:Q.attachment.exitCode}];return[];default:return[]}})}function Da5(A){let Q=A.message.content;if(!Array.isArray(Q))return A.message;let B=Q.map((G)=>{if(G.type!=="tool_use")return G;if(G.name===Jp){let Z=eD();if(Z)return{...G,input:{...G.input,plan:Z}}}return G});return{...A.message,content:B}}var Hq0=w(()=>{q0();n_();$F()});function dp2({session:A,toolUseContext:Q,onDone:B,onBack:G}){let[Z,Y]=vbA.useState(!1),[J,X]=vbA.useState(null),I=()=>B("Remote session details dismissed",{display:"system"});lD({"confirm:no":I,"confirm:yes":I},{context:"Confirmation"}),Y0((E,z)=>{if(E===" ")B("Remote session details dismissed",{display:"system"});else if(z.leftArrow&&G)G();else if(E==="t"&&!Z)D()});let W=_Q();async function D(){Y(!0),X(null);try{await es(A.sessionId)}catch(E){X(E instanceof Error?E.message:String(E)),Y(!1)}}let K=(E)=>{let z=Math.floor((Date.now()-E)/1000),C=Math.floor(z/3600),O=Math.floor((z-C*3600)/60),L=z-C*3600-O*60;return`${C>0?`${C}h `:""}${O>0||C>0?`${O}m `:""}${L}s`},V=vbA.useMemo(()=>{return a7(up2(A.log.slice(-3))).filter((E)=>E.type!=="progress")},[A]),F=A.title.length>50?A.title.substring(0,47)+"...":A.title,H=A.status==="pending"?"starting":A.status;return Y8.default.createElement(T,{width:"100%",flexDirection:"column"},Y8.default.createElement(T,{width:"100%"},Y8.default.createElement(T,{borderStyle:"round",borderColor:"background",flexDirection:"column",marginTop:1,paddingLeft:1,paddingRight:1,width:"100%"},Y8.default.createElement(T,null,Y8.default.createElement($,{color:"background",bold:!0},"Remote session details")),Y8.default.createElement(T,{flexDirection:"column",marginTop:1},Y8.default.createElement($,null,Y8.default.createElement($,{bold:!0},"Status"),":"," ",H==="running"||H==="starting"?Y8.default.createElement($,{color:"background"},H):H==="completed"?Y8.default.createElement($,{color:"success"},H):Y8.default.createElement($,{color:"error"},H)),Y8.default.createElement($,null,Y8.default.createElement($,{bold:!0},"Runtime"),": ",K(A.startTime)),Y8.default.createElement($,{wrap:"truncate-end"},Y8.default.createElement($,{bold:!0},"Title"),": ",F),Y8.default.createElement($,null,Y8.default.createElement($,{bold:!0},"Progress"),":"," ",Y8.default.createElement(sK1,{session:A})),Y8.default.createElement($,null,Y8.default.createElement($,{bold:!0},"Session URL"),":"," ",Y8.default.createElement($,{dimColor:!0},"https://claude.ai/code/",A.sessionId))),A.log.length>0&&Y8.default.createElement(T,{flexDirection:"column",marginTop:1},Y8.default.createElement($,null,Y8.default.createElement($,{bold:!0},"Recent messages"),":"),Y8.default.createElement(T,{flexDirection:"column",height:10,overflowY:"hidden"},V.map((E,z)=>Y8.default.createElement(VO,{key:z,message:E,messages:V,addMargin:z>0,tools:Q.options.tools,commands:Q.options.commands,verbose:Q.options.verbose,erroredToolUseIDs:new Set,inProgressToolUseIDs:new Set,resolvedToolUseIDs:new Set,progressMessagesForMessage:[],shouldAnimate:!1,shouldShowDot:!1,style:"condensed",isTranscriptMode:!1,isStatic:!0}))),Y8.default.createElement(T,{marginTop:1},Y8.default.createElement($,{dimColor:!0,italic:!0},"Showing last ",Math.min(3,A.log.length)," of"," ",A.log.length," messages"))),J&&Y8.default.createElement(T,{marginTop:1},Y8.default.createElement($,{color:"error"},"Teleport failed: ",J)),Z&&Y8.default.createElement(T,{marginTop:1},Y8.default.createElement($,{color:"background"},"Teleporting to session...")))),Y8.default.createElement(T,{marginLeft:2},W.pending?Y8.default.createElement($,{dimColor:!0},"Press ",W.keyName," again to exit"):Y8.default.createElement($,{dimColor:!0},Y8.default.createElement(YB,null,G&&Y8.default.createElement(y0,{shortcut:"",action:"go back"}),Y8.default.createElement(y0,{shortcut:"Esc/Enter/Space",action:"close"}),!Z&&Y8.default.createElement(y0,{shortcut:"t",action:"teleport"})))))}var Y8,vbA;var pp2=w(()=>{kA();_6();U9();Fq0();Ur();A6A();Hq0();eQ();e4();T3();Y8=c(JA(),1),vbA=c(JA(),1)});function Eq0(A,Q,B=1000){let G=()=>fD(Date.now()-A),Z=eK1.useCallback((Y)=>{if(!Q)return()=>{};let J=setInterval(Y,B);return()=>clearInterval(J)},[Q,B]);return eK1.useSyncExternalStore(Z,G,G)}var eK1;var zq0=w(()=>{eK1=c(JA(),1)});function Ka5(A){switch(A){case"running":case"pending":return tA.pointer;case"completed":return tA.tick;case"failed":case"killed":return tA.cross;default:return tA.bullet}}function Va5(A){switch(A){case"running":case"pending":return"background";case"completed":return"success";case"failed":case"killed":return"error";default:return"background"}}function Fa5(A,Q,B){let G=Q.find((Z)=>Z.name===A.toolName);if(!G)return A.toolName;try{let Z=G.inputSchema.safeParse(A.input),Y=Z.success?Z.data:{},J=G.userFacingName(Y);if(!J)return A.toolName;let X=G.renderToolUseMessage(Y,{theme:B,verbose:!1});if(X)return L8.default.createElement($,null,J,"(",X,")");return J}catch{return A.toolName}}function cp2({agent:A,onDone:Q,onKillAgent:B,onBack:G,onForeground:Z}){let[Y]=e0(),J=Y.todos[A.agentId]??[],X=J.filter((z)=>z.status==="completed").length,[I]=aB(),W=L8.useMemo(()=>IC(TL()),[]),D=Eq0(A.startTime,A.status==="running");lD({"confirm:no":Q,"confirm:yes":Q},{context:"Confirmation"}),Y0((z,C)=>{if(z===" ")Q();else if(C.leftArrow&&G)G();else if(z==="k"&&A.status==="running"&&B)B();else if(z==="f"&&A.status==="running"&&Z)Z()});let K=_Q(),V=K9(A.prompt,"plan"),F=A.prompt.length>300?A.prompt.substring(0,297)+"":A.prompt,H=A.result?.totalTokens??A.progress?.tokenCount,E=A.result?.totalToolUseCount??A.progress?.toolUseCount;return L8.default.createElement(T,{width:"100%",flexDirection:"column"},L8.default.createElement(T,{width:"100%"},L8.default.createElement(T,{borderStyle:"round",borderColor:"background",flexDirection:"column",marginTop:1,paddingLeft:1,paddingRight:1,width:"100%"},L8.default.createElement(T,null,L8.default.createElement($,{color:"background",bold:!0},A.selectedAgent?.agentType??"agent"," "," ",A.description||"Async agent")),L8.default.createElement(T,null,A.status!=="running"&&L8.default.createElement($,{color:Va5(A.status)},Ka5(A.status)," ",A.status==="completed"?"Completed":A.status==="failed"?"Failed":"Killed"," 路 "),L8.default.createElement($,{dimColor:!0},D,H!==void 0&&H>0&&L8.default.createElement(L8.default.Fragment,null," 路 ",x8(H)," tokens"),E!==void 0&&E>0&&L8.default.createElement(L8.default.Fragment,null," ","路 ",E," ",E===1?"tool":"tools"))),L8.default.createElement(T,{flexDirection:"column"},A.status==="running"&&A.progress?.recentActivities&&A.progress.recentActivities.length>0&&L8.default.createElement(T,{flexDirection:"column",marginTop:1},L8.default.createElement($,{bold:!0,dimColor:!0},"Progress"),A.progress.recentActivities.map((z,C)=>L8.default.createElement($,{key:C,dimColor:C<A.progress.recentActivities.length-1,wrap:"truncate-end"},C===A.progress.recentActivities.length-1?" ":"  ",Fa5(z,W,I)))),J.length>0&&L8.default.createElement(T,{flexDirection:"column",marginTop:1},L8.default.createElement($,{bold:!0,dimColor:!0},"Tasks (",X,"/",J.length,")"),L8.default.createElement(Er,{todos:J})),V?L8.default.createElement(T,{marginTop:1},L8.default.createElement(KI1,{addMargin:!1,planContent:V})):L8.default.createElement(T,{flexDirection:"column",marginTop:1},L8.default.createElement($,{bold:!0,dimColor:!0},"Prompt"),L8.default.createElement($,{wrap:"wrap"},F)),A.status==="failed"&&A.error&&L8.default.createElement(T,{flexDirection:"column",marginTop:1},L8.default.createElement($,{bold:!0,color:"error"},"Error"),L8.default.createElement($,{color:"error",wrap:"wrap"},A.error))))),L8.default.createElement(T,{marginLeft:2},K.pending?L8.default.createElement($,{dimColor:!0},"Press ",K.keyName," again to exit"):L8.default.createElement($,{dimColor:!0},L8.default.createElement(YB,null,G&&L8.default.createElement(y0,{shortcut:"",action:"go back"}),L8.default.createElement(y0,{shortcut:"Esc/Enter/Space",action:"close"}),A.status==="running"&&B&&L8.default.createElement(y0,{shortcut:"k",action:"kill"}),A.status==="running"&&Z&&L8.default.createElement(y0,{shortcut:"f",action:"foreground"})))))}var L8;var lp2=w(()=>{kA();_6();U9();uB();OxA();zq0();I2();ME();e4();T3();kH0();eQ();L8=c(JA(),1)});function kbA({state:A,percentage:Q}){if(!R1().terminalProgressBarEnabled)return null;return Cq0.createElement(G21,{state:A,percentage:Q})}var Cq0;var ip2=w(()=>{kA();IQ();Cq0=c(JA(),1)});function $q0(A){if(A.type==="assistant"&&A.message.content[0]?.type==="tool_use"){let Q=A.message.content[0];return{messageId:A.message.id,toolUseId:Q.id,toolName:Q.name}}return null}function np2(A,Q,B=!1){if(B)return{messages:A};let G=new Set(Q.filter((D)=>D.renderGroupedToolUse).map((D)=>D.name)),Z=new Map;for(let D of A){let K=$q0(D);if(K&&G.has(K.toolName)){let V=`${K.messageId}:${K.toolName}`,F=Z.get(V)??[];F.push(D),Z.set(V,F)}}let Y=new Map,J=new Set;for(let[D,K]of Z)if(K.length>=2){Y.set(D,K);for(let V of K){let F=$q0(V);if(F)J.add(F.toolUseId)}}let X=new Map;for(let D of A)if(D.type==="user"){for(let K of D.message.content)if(K.type==="tool_result"&&J.has(K.tool_use_id))X.set(K.tool_use_id,D)}let I=[],W=new Set;for(let D of A){let K=$q0(D);if(K){let V=`${K.messageId}:${K.toolName}`,F=Y.get(V);if(F){if(!W.has(V)){W.add(V);let H=F[0],E=[];for(let C of F){let O=C.message.content[0].id,L=X.get(O);if(L)E.push(L)}let z={type:"grouped_tool_use",toolName:K.toolName,messages:F,results:E,displayMessage:H,uuid:`grouped-${H.uuid}`,timestamp:H.timestamp,messageId:K.messageId};I.push(z)}continue}}if(D.type==="user"){let V=D.message.content.filter((F)=>F.type==="tool_result");if(V.length>0){if(V.every((H)=>J.has(H.tool_use_id)))continue}}I.push(D)}return{messages:I}}function bbA(A){if(!A)return 0;return A.activeAgents.filter((Q)=>Q.source!=="built-in").reduce((Q,B)=>{let G=`${B.agentType}: ${B.whenToUse}`;return Q+l7(G)},0)}var p6A=15000;var Uq0=w(()=>{YN()});import*as pF from"path";import*as fbA from"os";function Ea5(A){let Q=fbA.homedir(),B=[],G=op2[A.toLowerCase()];if(!G)return B;let Z=process.env.APPDATA||pF.join(Q,"AppData","Roaming"),Y=process.env.LOCALAPPDATA||pF.join(Q,"AppData","Local");switch(fbA.platform()){case"darwin":if(B.push(pF.join(Q,"Library","Application Support","JetBrains"),pF.join(Q,"Library","Application Support")),A.toLowerCase()==="androidstudio")B.push(pF.join(Q,"Library","Application Support","Google"));break;case"win32":if(B.push(pF.join(Z,"JetBrains"),pF.join(Y,"JetBrains"),pF.join(Z)),A.toLowerCase()==="androidstudio")B.push(pF.join(Y,"Google"));break;case"linux":B.push(pF.join(Q,".config","JetBrains"),pF.join(Q,".local","share","JetBrains"));for(let J of G)B.push(pF.join(Q,"."+J));if(A.toLowerCase()==="androidstudio")B.push(pF.join(Q,".config","Google"));break;default:break}return B}function za5(A){let Q=[],B=xA(),G=Ea5(A),Z=op2[A.toLowerCase()];if(!Z)return Q;for(let Y of G){if(!B.existsSync(Y))continue;for(let J of Z)try{let X=new RegExp("^"+J+".*$"),I=B.readdirSync(Y).filter((W)=>X.test(W.name)&&B.statSync(pF.join(Y,W.name)).isDirectory()).map((W)=>pF.join(Y,W.name));for(let W of I){let D=fbA.platform()==="linux"?W:pF.join(W,"plugins");if(B.existsSync(D))Q.push(D)}}catch{continue}}return Q.filter((Y,J)=>Q.indexOf(Y)===J)}function qq0(A){let Q=za5(A);for(let B of Q){let G=pF.join(B,Ha5);if(xA().existsSync(G))return!0}return!1}function rp2(A,Q=!1){if(Q)ap2.cache.delete(A);return ap2(A)}var Ha5="claude-code-jetbrains-plugin",op2,ap2;var Nq0=w(()=>{EQ();X9();op2={pycharm:["PyCharm"],intellij:["IntelliJIdea","IdeaIC"],webstorm:["WebStorm"],phpstorm:["PhpStorm"],rubymine:["RubyMine"],clion:["CLion"],goland:["GoLand"],rider:["Rider"],datagrip:["DataGrip"],appcode:["AppCode"],dataspell:["DataSpell"],aqua:["Aqua"],gateway:["Gateway"],fleet:["Fleet"],androidstudio:["AndroidStudio"]};ap2=W0(qq0)});import{join as AV1}from"path";import{readFile as QV1}from"fs/promises";function GV1(A){let Q=A.match(/^(\d+)\.(\d+)\.(\d+)(?:-canary\.(\d+))?/);if(!Q?.[1]||!Q[2]||!Q[3])return!1;let B=parseInt(Q[1],10),G=parseInt(Q[2],10),Z=parseInt(Q[3],10),Y=Q[4]?parseInt(Q[4],10):null;if(B<=13)return!1;if(B===14){if(Y!==null&&G===3&&Z===0)return Y>=77;return!1}if(B===15&&Y!==null){if(G===6&&Z===0)return Y<58;return!0}if(B===16&&Y!==null){if(G===1&&Z===0)return Y<12;return G===0}if(B>=17)return!1;let J=`${B}.${G}`,X=sp2[J];if(X===void 0){let I=Object.keys(sp2).filter((D)=>D.startsWith(`${B}.`)).map((D)=>parseInt(D.split(".")[1],10)),W=Math.max(...I,0);return G<=W}return Z<X}async function Ca5(){let A=c1(),Q=AV1(A,"package-lock.json");try{let Y=await QV1(Q,"utf-8"),J=h5(Y);if(J){let X=$a5(J,Q);if(X)return X}}catch{}let B=AV1(A,"yarn.lock");try{let Y=await QV1(B,"utf-8"),J=Ua5(Y,B);if(J)return J}catch{}let G=AV1(A,"pnpm-lock.yaml");try{let Y=await QV1(G,"utf-8"),J=qa5(Y,G);if(J)return J}catch{}let Z=AV1(A,"bun.lock");try{let Y=await QV1(Z,"utf-8"),J=h5(Y);if(J){let X=Na5(J,Z);if(X)return X}}catch{}return{detected:!1,package:null,packageName:null,version:null,packageManager:null,lockFilePath:null}}function $a5(A,Q){let B=A.packages?.["node_modules/next"]?.version,G=A.dependencies?.next?.version,Z=B||G;if(Z){if(GV1(Z))return{detected:!0,package:"next",packageName:"next",version:Z,packageManager:"npm",lockFilePath:Q};return null}for(let Y of BV1){let J=A.packages?.[`node_modules/${Y}`]?.version;if(J&&hbA.includes(J))return{detected:!0,package:"react-server-dom",packageName:Y,version:J,packageManager:"npm",lockFilePath:Q};let X=A.dependencies?.[Y]?.version;if(X&&hbA.includes(X))return{detected:!0,package:"react-server-dom",packageName:Y,version:X,packageManager:"npm",lockFilePath:Q}}return null}function Ua5(A,Q){let B=tp2(A,"next");if(B){if(GV1(B))return{detected:!0,package:"next",packageName:"next",version:B,packageManager:"yarn",lockFilePath:Q};return null}for(let G of BV1){let Z=tp2(A,G);if(Z&&hbA.includes(Z))return{detected:!0,package:"react-server-dom",packageName:G,version:Z,packageManager:"yarn",lockFilePath:Q}}return null}function qa5(A,Q){let B=ep2(A,"next");if(B){if(GV1(B))return{detected:!0,package:"next",packageName:"next",version:B,packageManager:"pnpm",lockFilePath:Q};return null}for(let G of BV1){let Z=ep2(A,G);if(Z&&hbA.includes(Z))return{detected:!0,package:"react-server-dom",packageName:G,version:Z,packageManager:"pnpm",lockFilePath:Q}}return null}function Na5(A,Q){if(!A.packages)return null;if("next"in A.packages){let B=A.packages.next;if(Array.isArray(B)&&B[0]){let G=B[0].match(/^next@(.+)$/);if(G?.[1]){if(GV1(G[1]))return{detected:!0,package:"next",packageName:"next",version:G[1],packageManager:"bun",lockFilePath:Q};return null}}}for(let B of BV1)if(B in A.packages){let G=A.packages[B];if(Array.isArray(G)&&G[0]){let Z=G[0].match(new RegExp(`^${B}@(.+)$`));if(Z?.[1]&&hbA.includes(Z[1]))return{detected:!0,package:"react-server-dom",packageName:B,version:Z[1],packageManager:"bun",lockFilePath:Q}}}return null}function tp2(A,Q){let B=new RegExp(`^"?${Q}@[^:]+:\\s*\\n\\s+version\\s+"([^"]+)"`,"m");return A.match(B)?.[1]??null}function ep2(A,Q){let B=new RegExp(`^\\s+${Q}:\\s*\\n\\s+specifier:[^\\n]*\\n\\s+version:\\s*([\\d.]+(?:-[\\w.]+)?)`,"m"),G=A.match(B);if(G?.[1])return G[1];let Z=new RegExp(`['"]?${Q}@([\\d.]+(?:-[\\w.]+)?)['"]?:`);return A.match(Z)?.[1]??null}function Ac2(A,Q){switch(A){case"npm":return`npm update ${Q}`;case"yarn":return`yarn upgrade ${Q}`;case"pnpm":return`pnpm update ${Q}`;case"bun":return`bun update ${Q}`}}function wq0(){let Q=JG().reactVulnerabilityCache;if(!Q)return null;return{detected:Q.detected,package:Q.package,packageName:Q.packageName,version:Q.version,packageManager:Q.packageManager,lockFilePath:null}}async function Qc2(){let A=await Ca5();return tG((Q)=>({...Q,reactVulnerabilityCache:{detected:A.detected,package:A.package,packageName:A.packageName,version:A.version,packageManager:A.packageManager}})),A}var hbA,BV1,sp2;var Lq0=w(()=>{G2();PI();eQ();IQ();hbA=["19.0.0","19.1.0","19.1.1","19.2.0"],BV1=["react-server-dom-webpack","react-server-dom-parcel","react-server-dom-turbopack"],sp2={"15.0":5,"15.1":9,"15.2":6,"15.3":6,"15.4":8,"15.5":7,"16.0":7}});import{relative as wa5}from"path";function Bc2(A){return ka5.filter((Q)=>Q.isActive(A))}var _B,La5,Oa5,Ma5,Ra5,_a5,ja5,Ta5,Pa5,Sa5,xa5=3,ya5="tengu_react_vulnerability_warning",va5,ka5;var Gc2=w(()=>{kA();tz();I2();G2();eB();jD();m2();Uq0();WI();Nq0();M3();Lq0();IQ();_B=c(JA(),1),La5={id:"large-memory-files",type:"warning",isActive:()=>{return Q6A().length>0},render:()=>{let A=Q6A();return _B.createElement(_B.Fragment,null,A.map((Q)=>{let B=Q.path.startsWith(c1())?wa5(c1(),Q.path):Q.path;return _B.createElement(T,{key:Q.path,flexDirection:"row"},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"Large ",_B.createElement($,{bold:!0},B)," will impact performance (",x8(Q.content.length)," chars >"," ",x8(id),")",_B.createElement($,{dimColor:!0},"  /memory to edit")))}))}},Oa5={id:"ultra-claude-md",type:"warning",isActive:()=>{let A=B6A();return A!==null&&A.content.length>wFA},render:()=>{let A=B6A();if(!A)return null;let Q=A.content.length;return _B.createElement(T,{flexDirection:"row",gap:1},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"CLAUDE.md entries marked as IMPORTANT exceed"," ",wFA," chars (",Q," chars)",_B.createElement($,{dimColor:!0},"  /memory to edit")))}},Ma5={id:"claude-ai-external-token",type:"warning",isActive:()=>{let A=Un();return OB()&&(A.source==="ANTHROPIC_AUTH_TOKEN"||A.source==="apiKeyHelper")},render:()=>{let A=Un();return _B.createElement(T,{flexDirection:"row",marginTop:1},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"Auth conflict: Using ",A.source," instead of Claude account subscription token. Either unset ",A.source,", or run `claude /logout`."))}},Ra5={id:"api-key-conflict",type:"warning",isActive:()=>{let{source:A}=Rz({skipRetrievingKeyFromApiKeyHelper:!0});return!!sLA()&&(A==="ANTHROPIC_API_KEY"||A==="apiKeyHelper")},render:()=>{let{source:A}=Rz({skipRetrievingKeyFromApiKeyHelper:!0});return _B.createElement(T,{flexDirection:"row",marginTop:1},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"Auth conflict: Using ",A," instead of Anthropic Console key. Either unset ",A,", or run `claude /logout`."))}},_a5={id:"both-auth-methods",type:"warning",isActive:()=>{let{source:A}=Rz({skipRetrievingKeyFromApiKeyHelper:!0}),Q=Un();return A!=="none"&&Q.source!=="none"&&!(A==="apiKeyHelper"&&Q.source==="apiKeyHelper")},render:()=>{let{source:A}=Rz({skipRetrievingKeyFromApiKeyHelper:!0}),Q=Un();return _B.createElement(T,{flexDirection:"column",marginTop:1},_B.createElement(T,{flexDirection:"row"},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"Auth conflict: Both a token (",Q.source,") and an API key (",A,") are set. This may lead to unexpected behavior.")),_B.createElement(T,{flexDirection:"column",marginLeft:3},_B.createElement($,{color:"warning"}," Trying to use"," ",Q.source==="claude.ai"?"claude.ai":Q.source,"?"," ",A==="ANTHROPIC_API_KEY"?'Unset the ANTHROPIC_API_KEY environment variable, or claude /logout then say "No" to the API key approval before login.':A==="apiKeyHelper"?"Unset the apiKeyHelper setting.":"claude /logout"),_B.createElement($,{color:"warning"}," Trying to use ",A,"?"," ",Q.source==="claude.ai"?"claude /logout to sign out of claude.ai.":`Unset the ${Q.source} environment variable.`)))}},ja5={id:"sonnet-1m-welcome",type:"info",isActive:(A)=>A.showSonnet1MNotice===!0,render:()=>{return _B.createElement(T,{flexDirection:"column",marginTop:1},_B.createElement($,{bold:!0},"You now have access to Sonnet 4.5 with 1M context (uses more rate limits than Sonnet on long requests)  Update in /model"))}},Ta5={id:"opus-4.5-available",type:"info",isActive:(A)=>A.showOpus45Notice===!0,render:()=>{let Q=a4()!=="firstParty",B=E6(),G=B==="max",Z=B==="team",Y=B==="pro",J=d3().includes("opus-4-5"),X;if(G||Z||J)X=_B.createElement($,{dimColor:!0},"Welcome to Opus 4.5");else if(Y)if(FJA())X=_B.createElement($,{dimColor:!0},"Welcome to Opus 4.5");else X=_B.createElement($,{dimColor:!0},"/model to try Opus 4.5");else if(Q)X=_B.createElement($,{dimColor:!0},"/model to try Opus 4.5. Note: you may need to request access from your cloud provider");else X=_B.createElement($,{dimColor:!0},"/model to try Opus 4.5");return _B.createElement(T,{marginLeft:1},X)}},Pa5={id:"large-agent-descriptions",type:"warning",isActive:(A)=>{return bbA(A.agentDefinitions)>p6A},render:(A)=>{let Q=bbA(A.agentDefinitions);return _B.createElement(T,{flexDirection:"row"},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},"Large cumulative agent descriptions will impact performance (~",x8(Q)," tokens >"," ",x8(p6A),")",_B.createElement($,{dimColor:!0},"  /agents to manage")))}},Sa5={id:"jetbrains-plugin-install",type:"info",isActive:(A)=>{if(!gbA())return!1;if(!(A.config.autoInstallIdeExtension??!0))return!1;let B=pHA();return B!==null&&!rp2(B)},render:()=>{let A=pHA(),Q=gF(A);return _B.createElement(T,{flexDirection:"row",gap:1,marginLeft:1},_B.createElement($,{color:"ide"},tA.arrowUp),_B.createElement($,null,"Install the ",_B.createElement($,{color:"ide"},Q)," plugin from the JetBrains Marketplace:"," ",_B.createElement($,{bold:!0},"https://docs.claude.com/s/claude-code-jetbrains")))}},va5={id:"react-vulnerability",type:"warning",isActive:()=>{if(!y8(ya5))return!1;if((JG().reactVulnerabilityWarningCount??0)>=xa5)return!1;return wq0()?.detected===!0},render:()=>{let A=wq0();if(!A?.detected||!A.packageManager||!A.packageName)return null;let Q=Ac2(A.packageManager,A.packageName),B=A.package==="next",G=B?"CVE-2025-66478":"CVE-2025-55182",Z=B?`Next.js ${A.version}`:`${A.packageName}@${A.version}`;return _B.createElement(T,{flexDirection:"row",gap:1},_B.createElement($,{color:"warning"},tA.warning),_B.createElement($,{color:"warning"},Z," has a critical vulnerability (",G,") that could allow attackers to execute arbitrary code on your server. Run `",Q,"` to update."))}},ka5=[va5,La5,Oa5,Pa5,Ma5,Ra5,_a5,ja5,Ta5,Sa5]});function Zc2({agentDefinitions:A}={}){let Q=a_.useRef(!1),B=R1(),G=O3()?.organizationUuid,Y=(G?B.s1mAccessCache?.[G]:void 0)?.hasAccessNotAsDefault,J=G&&B.hasShownS1MWelcomeV2?.[G],X=OB()&&Y&&!J,W=!(G&&B.hasShownOpus45Notice?.[G]),D={config:B,showSonnet1MNotice:X,showOpus45Notice:W,agentDefinitions:A},K=Bc2(D);if(a_.useEffect(()=>{if(!G)return;let V=K.some((H)=>H.id==="sonnet-1m-welcome"),F=K.some((H)=>H.id==="opus-4.5-available");if(V)p("tengu_sonnet_1m_notice_shown",{});if(F)p("tengu_opus_45_notice_shown",{});if(V||F)h0((H)=>({...H,...V&&{hasShownS1MWelcomeV2:{...H.hasShownS1MWelcomeV2,[G]:!0}},...F&&{hasShownOpus45Notice:{...H.hasShownOpus45Notice,[G]:!0}}}))},[K,B,G]),a_.useEffect(()=>{if(Q.current)return;if(K.some((F)=>F.id==="react-vulnerability"))Q.current=!0,p("tengu_react_vulnerability_notice_shown",{}),tG((F)=>({...F,reactVulnerabilityWarningCount:(F.reactVulnerabilityWarningCount??0)+1}))},[K]),K.length===0)return null;return a_.createElement(T,{flexDirection:"column",paddingLeft:1},K.map((V)=>a_.createElement(a_.Fragment,{key:V.id},V.render(D))))}var a_;var Yc2=w(()=>{kA();IQ();Gc2();Z0();eB();a_=c(JA(),1)});function Jc2(A,Q){let B=new Set;for(let G of A)if(!Q.has(G))B.add(G);return B}function Xc2(A,Q){for(let B of A)if(!Q.has(B))return!1;return!0}function Ic2({message:A,isTranscriptMode:Q}){if(!(Q&&A.timestamp&&A.type==="assistant"&&A.message.content.some((Z)=>Z.type==="text")))return null;let G=new Date(A.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return Oq0.default.createElement(T,{marginTop:1,minWidth:G.length},Oq0.default.createElement($,{dimColor:!0},G))}var Oq0;var Wc2=w(()=>{kA();Oq0=c(JA(),1)});function Dc2({message:A,isTranscriptMode:Q}){if(!(Q&&A.type==="assistant"&&A.message.model&&A.message.content.some((G)=>G.type==="text")))return null;return Mq0.default.createElement(T,{marginTop:1,marginLeft:1,minWidth:A.message.model.length+8},Mq0.default.createElement($,{dimColor:!0},A.message.model))}var Mq0;var Kc2=w(()=>{kA();Mq0=c(JA(),1)});function Vc2(A){let[Q,B]=cHA.useState(1),[G,Z]=cHA.useState(-1);return Y0((Y,J)=>{if(J.escape&&G===-1)Z(0)},{isActive:A}),cHA.useEffect(()=>{if(!A){Z(-1),B(0);return}},[A]),cHA.useEffect(()=>{if(G===-1)return;let Y=[1,0,1,2,2,1,0,0,0,1,2,2,1];if(G>=Y.length){Z(-1),B(1);return}B(Y[G]);let J=setTimeout(()=>{Z((X)=>X+1)},60);return()=>clearTimeout(J)},[G]),Q}var cHA;var Fc2=w(()=>{kA();cHA=c(JA(),1)});import{join as ba5,dirname as Hc2}from"path";import{readFileSync as fa5}from"fs";import{writeFile as Ec2,mkdir as zc2}from"fs/promises";function Rq0(){return ba5(zQ(),"cache","changelog.md")}async function $c2(){let A=R1();if(!A.cachedChangelog)return;let Q=Rq0();try{await zc2(Hc2(Q),{recursive:!0}),await Ec2(Q,A.cachedChangelog,{encoding:"utf-8",flag:"wx"})}catch{}h0(({cachedChangelog:B,...G})=>G)}async function _q0(){if(n2())return;if(process.env.CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC)return;let A=await fQ.get(ga5);if(A.status===200){let Q=A.data,B=Rq0();await zc2(Hc2(B),{recursive:!0}),await Ec2(B,Q,{encoding:"utf-8"});let G=Date.now();h0((Z)=>({...Z,changelogLastFetched:G}))}}function c6A(){let A=Rq0();try{return fa5(A,"utf-8")}catch{return""}}function ZV1(A){try{if(!A)return{};let Q={},B=A.split(/^## /gm).slice(1);for(let G of B){let Z=G.trim().split(`
3058:      ${Q("/passes")} to share`},cooldownSessions:3,isRelevant:async()=>{if(R1().hasVisitedPasses)return!1;let{eligible:Q}=VV1();return Q}}],Us5=[]});function qs5(A){if(A.length===0)return;if(A.length===1)return A[0];let Q=A.map((B)=>({tip:B,sessions:DF1(B.id)}));return Q.sort((B,G)=>G.sessions-B.sessions),Q[0]?.tip}async function oa2(A){if(NQ().spinnerTipsEnabled===!1)return;let Q=await KF1(A);if(Q.length===0)return;return qs5(Q)}function ra2(A){ca2(A.id),p("tengu_tip_shown",{tipIdLength:A.id,cooldownSessions:A.cooldownSessions})}var sa2=w(()=>{aN0();Z0();IQ();GB();l6A();oN0()});function ea2(){let[A,Q]=e0(),{toolPermissionContext:B}=A;ta2.useEffect(()=>{rN0(B,Q)},[])}var ta2,rN0;var Ao2=w(()=>{X9();uB();Ht();ta2=c(JA(),1),rN0=W0(async(A,Q)=>{if(!A.isBypassPermissionsModeAvailable)return;if(!await sN0())return;Q((G)=>{return{...G,toolPermissionContext:TfA(G.toolPermissionContext)}})})});function Qo2(A,Q,B){let G=FF1.useRef(!1);FF1.useEffect(()=>{if(!yG()||G.current)return;if(G.current=!0,A)kFA(A,B)},[Q,A,B])}var FF1;var Bo2=w(()=>{yN();FF1=c(JA(),1)});function tN0({hostPattern:{host:A},onUserResponse:Q}){function B(Z){switch(Z){case"yes":Q({allow:!0,persistToSettings:!1});break;case"yes-dont-ask-again":Q({allow:!0,persistToSettings:!0});break;case"no":Q({allow:!1,persistToSettings:!1});break}}return UY.createElement(EY,{title:"Network request outside of sandbox"},UY.createElement(T,{flexDirection:"column",paddingX:2,paddingY:1},UY.createElement(T,null,UY.createElement($,{dimColor:!0},"Host:"),UY.createElement($,null," ",A)),UY.createElement(T,{marginTop:1},UY.createElement($,null,"Do you want to allow this connection?")),UY.createElement(T,null,UY.createElement(x0,{options:[{label:"Yes",value:"yes"},{label:UY.createElement($,null,"Yes, and don't ask again for ",UY.createElement($,{bold:!0},A)),value:"yes-dont-ask-again"},{label:UY.createElement($,null,"No, and tell Claude what to do differently ",UY.createElement($,{bold:!0},"(esc)")),value:"no"}],onChange:B,onCancel:()=>{Q({allow:!1,persistToSettings:!1})}}))))}var UY;var Go2=w(()=>{kA();Q8();_N();Z0();UY=c(JA(),1)});var Ns5,EOY,HF1=604800000,Zo2=86400000,eN0;var PfA=w(()=>{Ns5=Math.pow(10,8)*24*60*60*1000,EOY=-Ns5,eN0=Symbol.for("constructDateFrom")});function lN(A,Q){if(typeof A==="function")return A(Q);if(A&&typeof A==="object"&&eN0 in A)return A[eN0](Q);if(A instanceof Date)return new A.constructor(Q);return new Date(Q)}var Et=w(()=>{PfA()});function JW(A,Q){return lN(Q||A,A)}var TO=w(()=>{Et()});var Yo2=()=>{};var Jo2=()=>{};var Xo2=()=>{};var Io2=()=>{};var Wo2=()=>{};var Do2=()=>{};var Ko2=()=>{};var Vo2=()=>{};var Fo2=()=>{};function zt(){return ws5}var ws5;var SfA=w(()=>{ws5={}});function fp(A,Q){let B=zt(),G=Q?.weekStartsOn??Q?.locale?.options?.weekStartsOn??B.weekStartsOn??B.locale?.options?.weekStartsOn??0,Z=JW(A,Q?.in),Y=Z.getDay(),J=(Y<G?7:0)+Y-G;return Z.setDate(Z.getDate()-J),Z.setHours(0,0,0,0),Z}var KEA=w(()=>{SfA();TO()});function Z3A(A,Q){return fp(A,{...Q,weekStartsOn:1})}var xfA=w(()=>{KEA()});function EF1(A,Q){let B=JW(A,Q?.in),G=B.getFullYear(),Z=lN(B,0);Z.setFullYear(G+1,0,4),Z.setHours(0,0,0,0);let Y=Z3A(Z),J=lN(B,0);J.setFullYear(G,0,4),J.setHours(0,0,0,0);let X=Z3A(J);if(B.getTime()>=Y.getTime())return G+1;else if(B.getTime()>=X.getTime())return G;else return G-1}var zF1=w(()=>{Et();xfA();TO()});function Aw0(A){let Q=JW(A),B=new Date(Date.UTC(Q.getFullYear(),Q.getMonth(),Q.getDate(),Q.getHours(),Q.getMinutes(),Q.getSeconds(),Q.getMilliseconds()));return B.setUTCFullYear(Q.getFullYear()),+A-+B}var Ho2=w(()=>{TO()});function Eo2(A,...Q){let B=lN.bind(null,A||Q.find((G)=>typeof G==="object"));return Q.map(B)}var zo2=w(()=>{Et()});function Qw0(A,Q){let B=JW(A,Q?.in);return B.setHours(0,0,0,0),B}var Bw0=w(()=>{TO()});function Co2(A,Q,B){let[G,Z]=Eo2(B?.in,A,Q),Y=Qw0(G),J=Qw0(Z),X=+Y-Aw0(Y),I=+J-Aw0(J);return Math.round((X-I)/Zo2)}var Gw0=w(()=>{Ho2();zo2();PfA();Bw0()});function $o2(A,Q){let B=EF1(A,Q),G=lN(Q?.in||A,0);return G.setFullYear(B,0,4),G.setHours(0,0,0,0),Z3A(G)}var Zw0=w(()=>{Et();zF1();xfA()});var Uo2=()=>{};var qo2=()=>{};var No2=()=>{};var wo2=()=>{};var Lo2=()=>{};var Oo2=()=>{};var Mo2=()=>{};var Ro2=()=>{};var _o2=()=>{};var jo2=()=>{};var To2=()=>{};var Po2=()=>{};var So2=()=>{};var xo2=()=>{};var yo2=()=>{};var vo2=()=>{};var ko2=()=>{};var bo2=()=>{};function fo2(A){return A instanceof Date||typeof A==="object"&&Object.prototype.toString.call(A)==="[object Date]"}var Yw0=()=>{};function ho2(A){return!(!fo2(A)&&typeof A!=="number"||isNaN(+JW(A)))}var Jw0=w(()=>{Yw0();TO()});var go2=()=>{};var uo2=()=>{};var mo2=()=>{};var do2=()=>{};var po2=()=>{};var co2=()=>{};var lo2=()=>{};var io2=()=>{};var no2=()=>{};var ao2=()=>{};var oo2=()=>{};var ro2=()=>{};var so2=()=>{};var to2=()=>{};var eo2=()=>{};var Ar2=()=>{};var Qr2=()=>{};var Br2=()=>{};var Gr2=()=>{};var Zr2=()=>{};var Yr2=()=>{};var Jr2=()=>{};var Xr2=()=>{};var Ir2=()=>{};var Wr2=()=>{};var Dr2=()=>{};var Kr2=()=>{};var Vr2=()=>{};var Fr2=()=>{};var Hr2=()=>{};var Er2=()=>{};var zr2=()=>{};var Cr2=()=>{};function $r2(A,Q){let B=JW(A,Q?.in);return B.setFullYear(B.getFullYear(),0,1),B.setHours(0,0,0,0),B}var Xw0=w(()=>{TO()});var Ur2=()=>{};var qr2=()=>{};var Nr2=()=>{};var wr2=()=>{};var Lr2=()=>{};var Or2=()=>{};var Mr2=()=>{};var Rr2=()=>{};var _r2=()=>{};var jr2=()=>{};var Tr2=()=>{};var Pr2=()=>{};var Sr2=()=>{};var Ls5,xr2=(A,Q,B)=>{let G,Z=Ls5[A];if(typeof Z==="string")G=Z;else if(Q===1)G=Z.one;else G=Z.other.replace("{{count}}",Q.toString());if(B?.addSuffix)if(B.comparison&&B.comparison>0)return"in "+G;else return G+" ago";return G};var yr2=w(()=>{Ls5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}}});function CF1(A){return(Q={})=>{let B=Q.width?String(Q.width):A.defaultWidth;return A.formats[B]||A.formats[A.defaultWidth]}}var Os5,Ms5,Rs5,vr2;var kr2=w(()=>{Os5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ms5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Rs5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vr2={date:CF1({formats:Os5,defaultWidth:"full"}),time:CF1({formats:Ms5,defaultWidth:"full"}),dateTime:CF1({formats:Rs5,defaultWidth:"full"})}});var _s5,br2=(A,Q,B,G)=>_s5[A];var fr2=w(()=>{_s5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"}});function VEA(A){return(Q,B)=>{let G=B?.context?String(B.context):"standalone",Z;if(G==="formatting"&&A.formattingValues){let J=A.defaultFormattingWidth||A.defaultWidth,X=B?.width?String(B.width):J;Z=A.formattingValues[X]||A.formattingValues[J]}else{let J=A.defaultWidth,X=B?.width?String(B.width):A.defaultWidth;Z=A.values[X]||A.values[J]}let Y=A.argumentCallback?A.argumentCallback(Q):Q;return Z[Y]}}var js5,Ts5,Ps5,Ss5,xs5,ys5,vs5=(A,Q)=>{let B=Number(A),G=B%100;if(G>20||G<10)switch(G%10){case 1:return B+"st";case 2:return B+"nd";case 3:return B+"rd"}return B+"th"},hr2;var gr2=w(()=>{js5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ts5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ps5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ss5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xs5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ys5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},hr2={ordinalNumber:vs5,era:VEA({values:js5,defaultWidth:"wide"}),quarter:VEA({values:Ts5,defaultWidth:"wide",argumentCallback:(A)=>A-1}),month:VEA({values:Ps5,defaultWidth:"wide"}),day:VEA({values:Ss5,defaultWidth:"wide"}),dayPeriod:VEA({values:xs5,defaultWidth:"wide",formattingValues:ys5,defaultFormattingWidth:"wide"})}});function FEA(A){return(Q,B={})=>{let G=B.width,Z=G&&A.matchPatterns[G]||A.matchPatterns[A.defaultMatchWidth],Y=Q.match(Z);if(!Y)return null;let J=Y[0],X=G&&A.parsePatterns[G]||A.parsePatterns[A.defaultParseWidth],I=Array.isArray(X)?bs5(X,(K)=>K.test(J)):ks5(X,(K)=>K.test(J)),W;W=A.valueCallback?A.valueCallback(I):I,W=B.valueCallback?B.valueCallback(W):W;let D=Q.slice(J.length);return{value:W,rest:D}}}function ks5(A,Q){for(let B in A)if(Object.prototype.hasOwnProperty.call(A,B)&&Q(A[B]))return B;return}function bs5(A,Q){for(let B=0;B<A.length;B++)if(Q(A[B]))return B;return}function ur2(A){return(Q,B={})=>{let G=Q.match(A.matchPattern);if(!G)return null;let Z=G[0],Y=Q.match(A.parsePattern);if(!Y)return null;let J=A.valueCallback?A.valueCallback(Y[0]):Y[0];J=B.valueCallback?B.valueCallback(J):J;let X=Q.slice(Z.length);return{value:J,rest:X}}}var fs5,hs5,gs5,us5,ms5,ds5,ps5,cs5,ls5,is5,ns5,as5,mr2;var dr2=w(()=>{fs5=/^(\d+)(th|st|nd|rd)?/i,hs5=/\d+/i,gs5={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},us5={any:[/^b/i,/^(a|c)/i]},ms5={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},ds5={any:[/1/i,/2/i,/3/i,/4/i]},ps5={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cs5={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ls5={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},is5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ns5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},as5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},mr2={ordinalNumber:ur2({matchPattern:fs5,parsePattern:hs5,valueCallback:(A)=>parseInt(A,10)}),era:FEA({matchPatterns:gs5,defaultMatchWidth:"wide",parsePatterns:us5,defaultParseWidth:"any"}),quarter:FEA({matchPatterns:ms5,defaultMatchWidth:"wide",parsePatterns:ds5,defaultParseWidth:"any",valueCallback:(A)=>A+1}),month:FEA({matchPatterns:ps5,defaultMatchWidth:"wide",parsePatterns:cs5,defaultParseWidth:"any"}),day:FEA({matchPatterns:ls5,defaultMatchWidth:"wide",parsePatterns:is5,defaultParseWidth:"any"}),dayPeriod:FEA({matchPatterns:ns5,defaultMatchWidth:"any",parsePatterns:as5,defaultParseWidth:"any"})}});var Iw0;var pr2=w(()=>{yr2();kr2();fr2();gr2();dr2();Iw0={code:"en-US",formatDistance:xr2,formatLong:vr2,formatRelative:br2,localize:hr2,match:mr2,options:{weekStartsOn:0,firstWeekContainsDate:1}}});var cr2=w(()=>{pr2()});function lr2(A,Q){let B=JW(A,Q?.in);return Co2(B,$r2(B))+1}var Ww0=w(()=>{Gw0();Xw0();TO()});function ir2(A,Q){let B=JW(A,Q?.in),G=+Z3A(B)-+$o2(B);return Math.round(G/HF1)+1}var Dw0=w(()=>{PfA();xfA();Zw0();TO()});function $F1(A,Q){let B=JW(A,Q?.in),G=B.getFullYear(),Z=zt(),Y=Q?.firstWeekContainsDate??Q?.locale?.options?.firstWeekContainsDate??Z.firstWeekContainsDate??Z.locale?.options?.firstWeekContainsDate??1,J=lN(Q?.in||A,0);J.setFullYear(G+1,0,Y),J.setHours(0,0,0,0);let X=fp(J,Q),I=lN(Q?.in||A,0);I.setFullYear(G,0,Y),I.setHours(0,0,0,0);let W=fp(I,Q);if(+B>=+X)return G+1;else if(+B>=+W)return G;else return G-1}var UF1=w(()=>{SfA();Et();KEA();TO()});function nr2(A,Q){let B=zt(),G=Q?.firstWeekContainsDate??Q?.locale?.options?.firstWeekContainsDate??B.firstWeekContainsDate??B.locale?.options?.firstWeekContainsDate??1,Z=$F1(A,Q),Y=lN(Q?.in||A,0);return Y.setFullYear(Z,0,G),Y.setHours(0,0,0,0),fp(Y,Q)}var Kw0=w(()=>{SfA();Et();UF1();KEA()});function ar2(A,Q){let B=JW(A,Q?.in),G=+fp(B,Q)-+nr2(B,Q);return Math.round(G/HF1)+1}var Vw0=w(()=>{PfA();KEA();Kw0();TO()});function HG(A,Q){let B=A<0?"-":"",G=Math.abs(A).toString().padStart(Q,"0");return B+G}var hp;var or2=w(()=>{hp={y(A,Q){let B=A.getFullYear(),G=B>0?B:1-B;return HG(Q==="yy"?G%100:G,Q.length)},M(A,Q){let B=A.getMonth();return Q==="M"?String(B+1):HG(B+1,2)},d(A,Q){return HG(A.getDate(),Q.length)},a(A,Q){let B=A.getHours()/12>=1?"pm":"am";switch(Q){case"a":case"aa":return B.toUpperCase();case"aaa":return B;case"aaaaa":return B[0];case"aaaa":default:return B==="am"?"a.m.":"p.m."}},h(A,Q){return HG(A.getHours()%12||12,Q.length)},H(A,Q){return HG(A.getHours(),Q.length)},m(A,Q){return HG(A.getMinutes(),Q.length)},s(A,Q){return HG(A.getSeconds(),Q.length)},S(A,Q){let B=Q.length,G=A.getMilliseconds(),Z=Math.trunc(G*Math.pow(10,B-3));return HG(Z,Q.length)}}});function rr2(A,Q=""){let B=A>0?"-":"+",G=Math.abs(A),Z=Math.trunc(G/60),Y=G%60;if(Y===0)return B+String(Z);return B+String(Z)+Q+HG(Y,2)}function sr2(A,Q){if(A%60===0)return(A>0?"-":"+")+HG(Math.abs(A)/60,2);return Y3A(A,Q)}function Y3A(A,Q=""){let B=A>0?"-":"+",G=Math.abs(A),Z=HG(Math.trunc(G/60),2),Y=HG(G%60,2);return B+Z+Q+Y}var HEA,Fw0;var tr2=w(()=>{Ww0();Dw0();zF1();Vw0();UF1();or2();HEA={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fw0={G:function(A,Q,B){let G=A.getFullYear()>0?1:0;switch(Q){case"G":case"GG":case"GGG":return B.era(G,{width:"abbreviated"});case"GGGGG":return B.era(G,{width:"narrow"});case"GGGG":default:return B.era(G,{width:"wide"})}},y:function(A,Q,B){if(Q==="yo"){let G=A.getFullYear(),Z=G>0?G:1-G;return B.ordinalNumber(Z,{unit:"year"})}return hp.y(A,Q)},Y:function(A,Q,B,G){let Z=$F1(A,G),Y=Z>0?Z:1-Z;if(Q==="YY"){let J=Y%100;return HG(J,2)}if(Q==="Yo")return B.ordinalNumber(Y,{unit:"year"});return HG(Y,Q.length)},R:function(A,Q){let B=EF1(A);return HG(B,Q.length)},u:function(A,Q){let B=A.getFullYear();return HG(B,Q.length)},Q:function(A,Q,B){let G=Math.ceil((A.getMonth()+1)/3);switch(Q){case"Q":return String(G);case"QQ":return HG(G,2);case"Qo":return B.ordinalNumber(G,{unit:"quarter"});case"QQQ":return B.quarter(G,{width:"abbreviated",context:"formatting"});case"QQQQQ":return B.quarter(G,{width:"narrow",context:"formatting"});case"QQQQ":default:return B.quarter(G,{width:"wide",context:"formatting"})}},q:function(A,Q,B){let G=Math.ceil((A.getMonth()+1)/3);switch(Q){case"q":return String(G);case"qq":return HG(G,2);case"qo":return B.ordinalNumber(G,{unit:"quarter"});case"qqq":return B.quarter(G,{width:"abbreviated",context:"standalone"});case"qqqqq":return B.quarter(G,{width:"narrow",context:"standalone"});case"qqqq":default:return B.quarter(G,{width:"wide",context:"standalone"})}},M:function(A,Q,B){let G=A.getMonth();switch(Q){case"M":case"MM":return hp.M(A,Q);case"Mo":return B.ordinalNumber(G+1,{unit:"month"});case"MMM":return B.month(G,{width:"abbreviated",context:"formatting"});case"MMMMM":return B.month(G,{width:"narrow",context:"formatting"});case"MMMM":default:return B.month(G,{width:"wide",context:"formatting"})}},L:function(A,Q,B){let G=A.getMonth();switch(Q){case"L":return String(G+1);case"LL":return HG(G+1,2);case"Lo":return B.ordinalNumber(G+1,{unit:"month"});case"LLL":return B.month(G,{width:"abbreviated",context:"standalone"});case"LLLLL":return B.month(G,{width:"narrow",context:"standalone"});case"LLLL":default:return B.month(G,{width:"wide",context:"standalone"})}},w:function(A,Q,B,G){let Z=ar2(A,G);if(Q==="wo")return B.ordinalNumber(Z,{unit:"week"});return HG(Z,Q.length)},I:function(A,Q,B){let G=ir2(A);if(Q==="Io")return B.ordinalNumber(G,{unit:"week"});return HG(G,Q.length)},d:function(A,Q,B){if(Q==="do")return B.ordinalNumber(A.getDate(),{unit:"date"});return hp.d(A,Q)},D:function(A,Q,B){let G=lr2(A);if(Q==="Do")return B.ordinalNumber(G,{unit:"dayOfYear"});return HG(G,Q.length)},E:function(A,Q,B){let G=A.getDay();switch(Q){case"E":case"EE":case"EEE":return B.day(G,{width:"abbreviated",context:"formatting"});case"EEEEE":return B.day(G,{width:"narrow",context:"formatting"});case"EEEEEE":return B.day(G,{width:"short",context:"formatting"});case"EEEE":default:return B.day(G,{width:"wide",context:"formatting"})}},e:function(A,Q,B,G){let Z=A.getDay(),Y=(Z-G.weekStartsOn+8)%7||7;switch(Q){case"e":return String(Y);case"ee":return HG(Y,2);case"eo":return B.ordinalNumber(Y,{unit:"day"});case"eee":return B.day(Z,{width:"abbreviated",context:"formatting"});case"eeeee":return B.day(Z,{width:"narrow",context:"formatting"});case"eeeeee":return B.day(Z,{width:"short",context:"formatting"});case"eeee":default:return B.day(Z,{width:"wide",context:"formatting"})}},c:function(A,Q,B,G){let Z=A.getDay(),Y=(Z-G.weekStartsOn+8)%7||7;switch(Q){case"c":return String(Y);case"cc":return HG(Y,Q.length);case"co":return B.ordinalNumber(Y,{unit:"day"});case"ccc":return B.day(Z,{width:"abbreviated",context:"standalone"});case"ccccc":return B.day(Z,{width:"narrow",context:"standalone"});case"cccccc":return B.day(Z,{width:"short",context:"standalone"});case"cccc":default:return B.day(Z,{width:"wide",context:"standalone"})}},i:function(A,Q,B){let G=A.getDay(),Z=G===0?7:G;switch(Q){case"i":return String(Z);case"ii":return HG(Z,Q.length);case"io":return B.ordinalNumber(Z,{unit:"day"});case"iii":return B.day(G,{width:"abbreviated",context:"formatting"});case"iiiii":return B.day(G,{width:"narrow",context:"formatting"});case"iiiiii":return B.day(G,{width:"short",context:"formatting"});case"iiii":default:return B.day(G,{width:"wide",context:"formatting"})}},a:function(A,Q,B){let Z=A.getHours()/12>=1?"pm":"am";switch(Q){case"a":case"aa":return B.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"aaa":return B.dayPeriod(Z,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return B.dayPeriod(Z,{width:"narrow",context:"formatting"});case"aaaa":default:return B.dayPeriod(Z,{width:"wide",context:"formatting"})}},b:function(A,Q,B){let G=A.getHours(),Z;if(G===12)Z=HEA.noon;else if(G===0)Z=HEA.midnight;else Z=G/12>=1?"pm":"am";switch(Q){case"b":case"bb":return B.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"bbb":return B.dayPeriod(Z,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return B.dayPeriod(Z,{width:"narrow",context:"formatting"});case"bbbb":default:return B.dayPeriod(Z,{width:"wide",context:"formatting"})}},B:function(A,Q,B){let G=A.getHours(),Z;if(G>=17)Z=HEA.evening;else if(G>=12)Z=HEA.afternoon;else if(G>=4)Z=HEA.morning;else Z=HEA.night;switch(Q){case"B":case"BB":case"BBB":return B.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"BBBBB":return B.dayPeriod(Z,{width:"narrow",context:"formatting"});case"BBBB":default:return B.dayPeriod(Z,{width:"wide",context:"formatting"})}},h:function(A,Q,B){if(Q==="ho"){let G=A.getHours()%12;if(G===0)G=12;return B.ordinalNumber(G,{unit:"hour"})}return hp.h(A,Q)},H:function(A,Q,B){if(Q==="Ho")return B.ordinalNumber(A.getHours(),{unit:"hour"});return hp.H(A,Q)},K:function(A,Q,B){let G=A.getHours()%12;if(Q==="Ko")return B.ordinalNumber(G,{unit:"hour"});return HG(G,Q.length)},k:function(A,Q,B){let G=A.getHours();if(G===0)G=24;if(Q==="ko")return B.ordinalNumber(G,{unit:"hour"});return HG(G,Q.length)},m:function(A,Q,B){if(Q==="mo")return B.ordinalNumber(A.getMinutes(),{unit:"minute"});return hp.m(A,Q)},s:function(A,Q,B){if(Q==="so")return B.ordinalNumber(A.getSeconds(),{unit:"second"});return hp.s(A,Q)},S:function(A,Q){return hp.S(A,Q)},X:function(A,Q,B){let G=A.getTimezoneOffset();if(G===0)return"Z";switch(Q){case"X":return sr2(G);case"XXXX":case"XX":return Y3A(G);case"XXXXX":case"XXX":default:return Y3A(G,":")}},x:function(A,Q,B){let G=A.getTimezoneOffset();switch(Q){case"x":return sr2(G);case"xxxx":case"xx":return Y3A(G);case"xxxxx":case"xxx":default:return Y3A(G,":")}},O:function(A,Q,B){let G=A.getTimezoneOffset();switch(Q){case"O":case"OO":case"OOO":return"GMT"+rr2(G,":");case"OOOO":default:return"GMT"+Y3A(G,":")}},z:function(A,Q,B){let G=A.getTimezoneOffset();switch(Q){case"z":case"zz":case"zzz":return"GMT"+rr2(G,":");case"zzzz":default:return"GMT"+Y3A(G,":")}},t:function(A,Q,B){let G=Math.trunc(+A/1000);return HG(G,Q.length)},T:function(A,Q,B){return HG(+A,Q.length)}}});var er2=(A,Q)=>{switch(A){case"P":return Q.date({width:"short"});case"PP":return Q.date({width:"medium"});case"PPP":return Q.date({width:"long"});case"PPPP":default:return Q.date({width:"full"})}},As2=(A,Q)=>{switch(A){case"p":return Q.time({width:"short"});case"pp":return Q.time({width:"medium"});case"ppp":return Q.time({width:"long"});case"pppp":default:return Q.time({width:"full"})}},os5=(A,Q)=>{let B=A.match(/(P+)(p+)?/)||[],G=B[1],Z=B[2];if(!Z)return er2(A,Q);let Y;switch(G){case"P":Y=Q.dateTime({width:"short"});break;case"PP":Y=Q.dateTime({width:"medium"});break;case"PPP":Y=Q.dateTime({width:"long"});break;case"PPPP":default:Y=Q.dateTime({width:"full"});break}return Y.replace("{{date}}",er2(G,Q)).replace("{{time}}",As2(Z,Q))},Qs2;var Bs2=w(()=>{Qs2={p:As2,P:os5}});function Gs2(A){return rs5.test(A)}function Zs2(A){return ss5.test(A)}function Ys2(A,Q,B){let G=es5(A,Q,B);if(console.warn(G),ts5.includes(A))throw RangeError(G)}function es5(A,Q,B){let G=A[0]==="Y"?"years":"days of the month";return`Use \`${A.toLowerCase()}\` instead of \`${A}\` (in \`${Q}\`) for formatting ${G} to the input \`${B}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}var rs5,ss5,ts5;var Js2=w(()=>{rs5=/^D+$/,ss5=/^Y+$/,ts5=["D","DD","YY","YYYY"]});function Xs2(A,Q,B){let G=zt(),Z=B?.locale??G.locale??Iw0,Y=B?.firstWeekContainsDate??B?.locale?.options?.firstWeekContainsDate??G.firstWeekContainsDate??G.locale?.options?.firstWeekContainsDate??1,J=B?.weekStartsOn??B?.locale?.options?.weekStartsOn??G.weekStartsOn??G.locale?.options?.weekStartsOn??0,X=JW(A,B?.in);if(!ho2(X))throw RangeError("Invalid time value");let I=Q.match(Qt5).map((D)=>{let K=D[0];if(K==="p"||K==="P"){let V=Qs2[K];return V(D,Z.formatLong)}return D}).join("").match(At5).map((D)=>{if(D==="''")return{isToken:!1,value:"'"};let K=D[0];if(K==="'")return{isToken:!1,value:Yt5(D)};if(Fw0[K])return{isToken:!0,value:D};if(K.match(Zt5))throw RangeError("Format string contains an unescaped latin alphabet character `"+K+"`");return{isToken:!1,value:D}});if(Z.localize.preprocessor)I=Z.localize.preprocessor(X,I);let W={firstWeekContainsDate:Y,weekStartsOn:J,locale:Z};return I.map((D)=>{if(!D.isToken)return D.value;let K=D.value;if(!B?.useAdditionalWeekYearTokens&&Zs2(K)||!B?.useAdditionalDayOfYearTokens&&Gs2(K))Ys2(K,Q,String(A));let V=Fw0[K[0]];return V(X,K,Z.localize,W)}).join("")}function Yt5(A){let Q=A.match(Bt5);if(!Q)return A;return Q[1].replace(Gt5,"'")}var At5,Qt5,Bt5,Gt5,Zt5;var Is2=w(()=>{cr2();SfA();tr2();Bs2();Js2();Jw0();TO();At5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Qt5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Bt5=/^'([^]*?)'?$/,Gt5=/''/g,Zt5=/[a-zA-Z]/});var Ws2=()=>{};var Ds2=()=>{};var Ks2=()=>{};var Vs2=()=>{};var Fs2=()=>{};var Hs2=()=>{};var Es2=()=>{};var zs2=()=>{};var Cs2=()=>{};var $s2=()=>{};var Us2=()=>{};var qs2=()=>{};var Ns2=()=>{};var ws2=()=>{};var Ls2=()=>{};var Os2=()=>{};var Ms2=()=>{};var Rs2=()=>{};var _s2=()=>{};var js2=()=>{};var Ts2=()=>{};var Ps2=()=>{};var Ss2=()=>{};var xs2=()=>{};var ys2=()=>{};var vs2=()=>{};var ks2=()=>{};var bs2=()=>{};var fs2=()=>{};var hs2=()=>{};var gs2=()=>{};var us2=()=>{};var ms2=()=>{};var ds2=()=>{};var ps2=()=>{};var cs2=()=>{};var ls2=()=>{};var is2=()=>{};var ns2=()=>{};var as2=()=>{};var os2=()=>{};var rs2=()=>{};var ss2=()=>{};var ts2=()=>{};var es2=()=>{};var At2=()=>{};var Qt2=()=>{};var Bt2=()=>{};var Gt2=()=>{};var Zt2=()=>{};var Yt2=()=>{};var Jt2=()=>{};var Xt2=()=>{};var It2=()=>{};var Wt2=()=>{};var Dt2=()=>{};var Kt2=()=>{};var Vt2=()=>{};var Ft2=()=>{};var Ht2=()=>{};var Et2=()=>{};var zt2=()=>{};var Ct2=()=>{};var $t2=()=>{};var Ut2=()=>{};var qt2=()=>{};var Nt2=()=>{};var wt2=()=>{};var Lt2=()=>{};var Ot2=()=>{};var Mt2=()=>{};var Rt2=()=>{};var _t2=()=>{};var jt2=()=>{};var Tt2=()=>{};var Pt2=()=>{};var St2=()=>{};var xt2=()=>{};var yt2=()=>{};var vt2=()=>{};var kt2=()=>{};var bt2=()=>{};var ft2=()=>{};var ht2=()=>{};var gt2=()=>{};var ut2=()=>{};var mt2=()=>{};var dt2=()=>{};var pt2=()=>{};var ct2=()=>{};var lt2=()=>{};var it2=()=>{};var nt2=()=>{};var at2=()=>{};var ot2=()=>{};var rt2=()=>{};var st2=()=>{};var tt2=()=>{};var et2=()=>{};var Ae2=()=>{};var Qe2=()=>{};var Be2=()=>{};var Ge2=()=>{};var Ze2=()=>{};var Ye2=()=>{};var Je2=()=>{};var Xe2=()=>{};var Ie2=()=>{};var We2=()=>{};var De2=()=>{};var Ke2=()=>{};var Ve2=()=>{};var Fe2=()=>{};var He2=()=>{};var Ee2=()=>{};var ze2=()=>{};var Ce2=()=>{};var $e2=()=>{};var Ue2=()=>{};var qe2=()=>{};var Ne2=()=>{};var we2=()=>{};var Le2=()=>{};var Oe2=()=>{};var Me2=()=>{};var Re2=()=>{};var _e2=()=>{};var je2=()=>{};var Te2=()=>{};var Pe2=()=>{};var Se2=()=>{};var xe2=()=>{};var ye2=()=>{};var ve2=()=>{};var ke2=()=>{};var be2=()=>{};var fe2=()=>{};var he2=()=>{};var ge2=()=>{};var ue2=()=>{};var me2=()=>{};var de2=()=>{};var pe2=()=>{};var ce2=()=>{};var le2=()=>{};var ie2=()=>{};var ne2=()=>{};var ae2=()=>{};var oe2=()=>{};var re2=()=>{};var se2=()=>{};var te2=()=>{};var ee2=()=>{};var AA9=()=>{};var QA9=()=>{};var BA9=w(()=>{Xo2();Ko2();Yo2();Fo2();qo2();Vo2();No2();Jo2();wo2();Lo2();Oo2();Mo2();Ro2();To2();Po2();So2();xo2();yo2();Et();vo2();ko2();go2();Gw0();uo2();mo2();do2();co2();lo2();io2();no2();ao2();ro2();so2();to2();Br2();Gr2();Zr2();Yr2();Jr2();Xr2();Ir2();Wr2();Dr2();Vr2();Fr2();Hr2();zr2();Ur2();qr2();eo2();Nr2();wr2();Or2();Mr2();Rr2();Ar2();_r2();jr2();Tr2();Pr2();Lr2();Cr2();Sr2();Is2();Ws2();Ds2();Ks2();Vs2();Fs2();Hs2();Es2();zs2();Cs2();$s2();Us2();qs2();Ns2();ws2();Ww0();Ls2();Ms2();Rs2();_s2();js2();Ts2();Dw0();zF1();Ps2();Ss2();xs2();ys2();vs2();po2();ks2();bs2();fs2();Vw0();hs2();UF1();us2();ms2();ds2();ps2();cs2();ls2();is2();ns2();as2();os2();rs2();Yw0();ss2();ts2();es2();At2();Qt2();Qr2();Os2();It2();Wt2();Dt2();bo2();Vt2();Ht2();Et2();Ct2();$t2();Ut2();Nt2();Ft2();wt2();Io2();Wo2();Lt2();Ot2();Mt2();Rt2();_t2();jt2();Tt2();Pt2();St2();xt2();yt2();vt2();Jw0();kt2();Do2();bt2();ht2();gt2();mt2();dt2();gs2();pt2();ut2();ct2();lt2();_o2();it2();nt2();at2();ot2();jo2();rt2();st2();tt2();et2();Ae2();Qe2();Be2();Ge2();Ze2();Ye2();Je2();Xe2();Ie2();Xt2();We2();De2();Ke2();Ve2();Fe2();He2();Ee2();ze2();Ce2();$e2();Ue2();qe2();Ne2();we2();Le2();Oe2();Me2();_e2();je2();Yt2();Te2();Pe2();Se2();Jt2();Zt2();Uo2();xe2();ye2();Re2();ve2();ke2();Gt2();be2();fe2();Bw0();he2();Kt2();xfA();Zw0();zt2();Er2();Kr2();qt2();ge2();ue2();KEA();Kw0();Xw0();me2();pe2();ce2();ft2();le2();oo2();ie2();ne2();de2();ae2();oe2();re2();se2();TO();Bt2();te2();ee2();AA9();QA9()});function GA9(){let[A,Q]=yfA.useState([]),[B,G]=yfA.useState(0);if(yfA.useEffect(()=>{let Z=JB.getSandboxViolationStore();return Z.subscribe((J)=>{Q(J.slice(-10)),G(Z.getTotalCount())})},[]),!JB.isSandboxingEnabled()||LQ()==="linux")return null;if(B===0)return null;return XU.createElement(T,{flexDirection:"column",marginTop:1},XU.createElement(T,{marginLeft:0},XU.createElement($,{color:"permission"},"猝 Sandbox blocked ",B," total"," ",B===1?"operation":"operations")),A.map((Z,Y)=>XU.createElement(T,{key:`${Z.timestamp.getTime()}-${Y}`,paddingLeft:2},XU.createElement($,{dimColor:!0},Xs2(Z.timestamp,"h:mm:ssa"),Z.command?` ${Z.command}:`:""," ",Z.line))),XU.createElement(T,{paddingLeft:2},XU.createElement($,{dimColor:!0}," showing last ",Math.min(10,A.length)," of ",B)))}var XU,yfA;var ZA9=w(()=>{kA();zJ();BA9();f3();XU=c(JA(),1),yfA=c(JA(),1)});function qF1(){let{addNotification:A,removeNotification:Q}=C6(),[B,G]=EEA.useState(()=>{let{errors:Y}=CP();return Y}),Z=EEA.useCallback(()=>{let{errors:Y}=CP();G(Y)},[]);return PIA(Z),EEA.useEffect(()=>{if(B.length>0){let Y=`Found ${B.length} invalid settings ${B.length===1?"file":"files"} 路 /doctor for details`;A({key:YA9,text:Y,color:"warning",priority:"high",timeoutMs:60000})}else Q(YA9)},[B,A,Q]),B}var EEA,YA9="settings-errors";var Hw0=w(()=>{GB();C21();PJ();EEA=c(JA(),1)});function XA9({mcpClients:A=[]}){let{addNotification:Q}=C6();JA9.useEffect(()=>{let B=A.filter((Z)=>Z.type==="failed"&&Z.config.type!=="sse-ide"&&Z.config.type!=="ws-ide"&&Z.config.type!=="claudeai-proxy"),G=A.filter((Z)=>Z.type==="needs-auth"&&Z.config.type!=="claudeai-proxy");if(B.length===0&&G.length===0)return;if(B.length>0)Q({key:"mcp-failed",jsx:cF.createElement(cF.Fragment,null,cF.createElement($,{color:"error"},B.length," MCP"," ",B.length===1?"server":"servers"," failed"),cF.createElement($,{dimColor:!0}," 路 /mcp")),priority:"medium"});if(G.length)Q({key:"mcp-needs-auth",jsx:cF.createElement(cF.Fragment,null,cF.createElement($,{color:"warning"},G.length," MCP"," ",G.length===1?"server needs":"servers need"," ","auth"),cF.createElement($,{dimColor:!0}," 路 /mcp")),priority:"medium"})},[Q,A])}var cF,JA9;var IA9=w(()=>{kA();PJ();cF=c(JA(),1),JA9=c(JA(),1)});function WA9(){let{addNotification:A}=C6(),[,Q]=e0(),[B,G]=KV.useState(!0),Z=KV.useRef(new Set),Y=KV.useCallback((X,I)=>{let W=`${X}:${I}`;if(Z.current.has(W))return;Z.current.add(W),k(`LSP error: ${X} - ${I}`),Q((K)=>{let V=new Set(K.plugins.errors.map((H)=>{if(H.type==="generic-error")return`generic-error:${H.source}:${H.error}`;return`${H.type}:${H.source}`})),F=`generic-error:${X}:${I}`;if(V.has(F))return K;return{...K,plugins:{...K.plugins,errors:[...K.plugins.errors,{type:"generic-error",source:X,error:I}]}}});let D=X.startsWith("plugin:")?X.split(":")[1]??X:X;A({key:`lsp-error-${X}`,jsx:KV.createElement(KV.Fragment,null,KV.createElement($,{color:"error"},"LSP for ",D," failed"),KV.createElement($,{dimColor:!0}," 路 /plugin for details")),priority:"medium",timeoutMs:8000})},[A,Q]),J=KV.useCallback(()=>{let X=Y6A();if(X.status==="failed"){Y("lsp-manager",X.error.message),G(!1);return}if(X.status==="pending"||X.status==="not-started")return;let I=ed();if(I){let W=I.getAllServers();for(let[D,K]of W)if(K.state==="error"&&K.lastError)Y(D,K.lastError.message)}},[Y]);BZ(J,B?Jt5:null),KV.useEffect(()=>{J()},[J])}var KV,Jt5=5000;var DA9=w(()=>{kA();PJ();uB();DF();zs();y1();KV=c(JA(),1)});async function VA9(A){if(!A||!A.trim())return k("[binaryCheck] Empty command provided, returning false"),!1;let Q=A.trim(),B=KA9.get(Q);if(B!==void 0)return k(`[binaryCheck] Cache hit for '${Q}': ${B}`),B;let G=LQ(),Z;if(G==="windows")Z="where";else if(Z="which",G==="unknown")k("[binaryCheck] Unknown platform, defaulting to 'which'");let Y=await PQ(Z,[Q],{timeout:5000,useCwd:!1}),J=Y.code===0;return KA9.set(Q,J),k(`[binaryCheck] Binary '${Q}' ${J?"found":"not found"} (exit code: ${Y.code})`),J}var KA9;var FA9=w(()=>{V6();f3();y1();KA9=new Map});import{extname as Xt5}from"path";function Wt5(A){return f9A.has(A.toLowerCase())}function Dt5(A){if(!A)return null;if(typeof A==="string")return k("[lspRecommendation] Skipping string path lspServers (not readable from marketplace)"),null;if(Array.isArray(A)){for(let Q of A){if(typeof Q==="string")continue;let B=EA9(Q);if(B)return B}return null}return EA9(A)}function HA9(A){return typeof A==="object"&&A!==null}function EA9(A){let Q=new Set,B=null;for(let[G,Z]of Object.entries(A)){if(!HA9(Z))continue;if(!B&&typeof Z.command==="string")B=Z.command;let Y=Z.extensionToLanguage;if(HA9(Y))for(let J of Object.keys(Y))Q.add(J.toLowerCase())}if(!B||Q.size===0)return null;return{extensions:Q,command:B}}async function Kt5(){let A=new Map;try{let Q=await G5();for(let B of Object.keys(Q))try{let G=await m$(B),Z=Wt5(B);for(let Y of G.plugins){if(!Y.lspServers)continue;let J=Dt5(Y.lspServers);if(!J)continue;let X=`${Y.name}@${B}`;A.set(X,{entry:Y,marketplaceName:B,extensions:J.extensions,command:J.command,isOfficial:Z})}}catch(G){k(`[lspRecommendation] Failed to load marketplace ${B}: ${G}`)}}catch(Q){k(`[lspRecommendation] Failed to load marketplaces config: ${Q}`)}return A}async function zA9(A){if(Vt5())return k("[lspRecommendation] Recommendations are disabled"),[];let Q=Xt5(A).toLowerCase();if(!Q)return k("[lspRecommendation] No file extension found"),[];k(`[lspRecommendation] Looking for LSP plugins for ${Q}`);let B=await Kt5(),Z=R1().lspRecommendationNeverPlugins??[],Y=[];for(let[X,I]of B){if(!I.extensions.has(Q))continue;if(Z.includes(X)){k(`[lspRecommendation] Skipping ${X} (in never suggest list)`);continue}if(p$(X)){k(`[lspRecommendation] Skipping ${X} (already installed)`);continue}Y.push({info:I,pluginId:X})}let J=[];for(let{info:X,pluginId:I}of Y)if(await VA9(X.command))J.push({info:X,pluginId:I}),k(`[lspRecommendation] Binary '${X.command}' found for ${I}`);else k(`[lspRecommendation] Skipping ${I} (binary '${X.command}' not found)`);return J.sort((X,I)=>{if(X.info.isOfficial&&!I.info.isOfficial)return-1;if(!X.info.isOfficial&&I.info.isOfficial)return 1;return 0}),J.map(({info:X,pluginId:I})=>({pluginId:I,pluginName:X.entry.name,marketplaceName:X.marketplaceName,description:X.entry.description,isOfficial:X.isOfficial,extensions:Array.from(X.extensions),command:X.command}))}function CA9(A){h0((Q)=>{let B=Q.lspRecommendationNeverPlugins??[];if(B.includes(A))return Q;return{...Q,lspRecommendationNeverPlugins:[...B,A]}}),k(`[lspRecommendation] Added ${A} to never suggest`)}function $A9(){h0((A)=>{let Q=(A.lspRecommendationIgnoredCount??0)+1;return{...A,lspRecommendationIgnoredCount:Q}}),k("[lspRecommendation] Incremented ignored count")}function Vt5(){let A=R1();return A.lspRecommendationDisabled===!0||(A.lspRecommendationIgnoredCount??0)>=It5}var It5=5;var UA9=w(()=>{II();pz();CN();FA9();IQ();y1()});import{extname as Ft5,join as Ht5}from"path";function qA9(){let[A]=e0(),{addNotification:Q}=C6(),[B,G]=iN.useState(null),Z=iN.useRef(new Set),Y=iN.useRef(!1);iN.useEffect(()=>{if(B)return;if(Y.current)return;if(Rk0())return;let X=A.fileHistory.trackedFiles,I=[];for(let D of X)if(!Z.current.has(D))Z.current.add(D),I.push(D);if(I.length===0)return;Y.current=!0,W(I).finally(()=>{Y.current=!1});async function W(D){for(let K of D)try{let F=(await zA9(K))[0];if(F){k(`[useLspPluginRecommendation] Found match: ${F.pluginName} for ${K}`),G({pluginId:F.pluginId,pluginName:F.pluginName,pluginDescription:F.description,fileExtension:Ft5(K),shownAt:Date.now()}),_k0(!0);return}}catch(V){s(V instanceof Error?V:Error(String(V)))}}},[A.fileHistory.trackedFiles,B]);let J=iN.useCallback((X)=>{if(!B)return;let{pluginId:I,pluginName:W,shownAt:D}=B;switch(k(`[useLspPluginRecommendation] User response: ${X} for ${W}`),X){case"yes":zt5(I,W,Q);break;case"no":{let K=Date.now()-D;if(K>=Et5)k(`[useLspPluginRecommendation] Timeout detected (${K}ms), incrementing ignored count`),$A9();break}case"never":CA9(I);break;case"disable":h0((K)=>{if(K.lspRecommendationDisabled)return K;return{...K,lspRecommendationDisabled:!0}});break}G(null)},[B,Q]);return{recommendation:B,handleResponse:J}}async function zt5(A,Q,B){try{k(`[useLspPluginRecommendation] Installing plugin: ${A}`);let G=await qF(A);if(!G)throw Error(`Plugin ${A} not found in marketplace`);let Z=typeof G.entry.source==="string"?Ht5(G.marketplaceInstallLocation,G.entry.source):void 0;await PO(A,G.entry,"user",void 0,Z);let Y=dB("userSettings");cB("userSettings",{enabledPlugins:{...Y?.enabledPlugins,[A]:!0}}),k(`[useLspPluginRecommendation] Plugin installed: ${A}`),B({key:"lsp-plugin-installed",jsx:iN.createElement($,{color:"success"},tA.tick," ",Q," installed 路 restart to apply"),priority:"immediate",timeoutMs:5000})}catch(G){s(G instanceof Error?G:Error(String(G))),B({key:"lsp-plugin-install-failed",jsx:iN.createElement($,{color:"error"},"Failed to install ",Q),priority:"immediate",timeoutMs:5000})}}var iN,Et5=28000;var NA9=w(()=>{I2();kA();uB();PJ();IQ();q0();f1();y1();UA9();gp();II();GB();iN=c(JA(),1)});function wA9(){}function LA9({pluginName:A,pluginDescription:Q,fileExtension:B,onResponse:G}){let Z=l6.useRef(G);Z.current=G,l6.useEffect(()=>{let X=setTimeout(()=>{Z.current("no")},Ct5);return()=>clearTimeout(X)},[]);function Y(X){switch(X){case"yes":G("yes");break;case"no":G("no");break;case"never":G("never");break;case"disable":G("disable");break}}return l6.createElement(EY,{title:"LSP Plugin Recommendation"},l6.createElement(T,{flexDirection:"column",paddingX:2,paddingY:1},l6.createElement(T,{marginBottom:1},l6.createElement($,{dimColor:!0},"LSP provides code intelligence like go-to-definition and error checking")),l6.createElement(T,null,l6.createElement($,{dimColor:!0},"Plugin:"),l6.createElement($,null," ",A)),Q&&l6.createElement(T,null,l6.createElement($,{dimColor:!0},Q)),l6.createElement(T,null,l6.createElement($,{dimColor:!0},"Triggered by:"),l6.createElement($,null," ",B," files")),l6.createElement(T,{marginTop:1},l6.createElement($,null,"Would you like to install this LSP plugin?")),l6.createElement(T,null,l6.createElement(x0,{options:[{label:l6.createElement($,null,"Yes, install ",l6.createElement($,{bold:!0},A)),value:"yes"},{label:"No, not now",value:"no"},{label:l6.createElement($,null,"Never for ",l6.createElement($,{bold:!0},A)),value:"never"},{label:"Disable all LSP recommendations",value:"disable"}],onChange:Y,onCancel:()=>G("no")}))))}var l6,Ct5=30000;var OA9=w(()=>{kA();Q8();_N();l6=c(JA(),1)});function MA9(){let{addNotification:A}=C6(),[Q]=e0(),{installationStatus:B}=Q.plugins,{totalFailed:G,failedMarketplacesCount:Z,failedPluginsCount:Y}=NF1.useMemo(()=>{if(!B)return{totalFailed:0,failedMarketplacesCount:0,failedPluginsCount:0};let J=B.marketplaces.filter((I)=>I.status==="failed"),X=B.plugins.filter((I)=>I.status==="failed");return{totalFailed:J.length+X.length,failedMarketplacesCount:J.length,failedPluginsCount:X.length}},[B]);NF1.useEffect(()=>{if(!B){k("No installation status to monitor");return}if(G===0)return;if(k(`Plugin installation status: ${Z} failed marketplaces, ${Y} failed plugins`),G===0)return;k(`Adding notification for ${G} failed installations`),A({key:"plugin-install-failed",jsx:Lf.createElement(Lf.Fragment,null,Lf.createElement($,{color:"error"},G," plugin",G===1?"":"s"," failed to install"),Lf.createElement($,{dimColor:!0}," 路 /plugin for details")),priority:"medium"})},[A,G,Z,Y])}var Lf,NF1;var RA9=w(()=>{kA();PJ();uB();y1();Lf=c(JA(),1),NF1=c(JA(),1)});import{join as Ew0,dirname as $t5}from"path";function wF1(A){if(!IU.includes(A))throw Error(`Invalid scope "${A}". Must be one of: ${IU.join(", ")}`)}function J3A(A){return IU.includes(A)}function $t(A){return A==="project"||A==="local"?HQ():void 0}function Ut5(A,Q,B){let G="";if(Object.keys(B?.enabledPlugins||{}).forEach((Z)=>{if(Z===A||Z===Q.name||Z.startsWith(`${Q.name}@`))G=Z}),!G)G=A.includes("@")?A:Q.name;return G}function _A9(A,Q){let{name:B,marketplace:G}=TKA(A);return Q.find((Z)=>{if(Z.name===A||Z.name===B)return!0;if(G&&Z.source)return Z.name===B&&Z.source.includes(`@${G}`);return!1})}function Ct(A){let B=N_().plugins[A];if(!B||B.length===0)return{scope:"user"};let G=HQ(),Z=B.find((X)=>X.scope==="local"&&X.projectPath===G);if(Z)return{scope:Z.scope,projectPath:Z.projectPath};let Y=B.find((X)=>X.scope==="project"&&X.projectPath===G);if(Y)return{scope:Y.scope,projectPath:Y.projectPath};let J=B.find((X)=>X.scope==="user");if(J)return{scope:J.scope};return{scope:B[0].scope,projectPath:B[0].projectPath}}function qt5(A,Q,B,G){let Z=G||Ct(A),{scope:Y}=Z,J=Kb(Y),I={...dB(J)?.enabledPlugins};if(Object.keys(I).forEach((D)=>{if(D===A||D===B.name||D.startsWith(`${B.name}@`))I[D]=Q}),!(A in I))I[A]=Q;let{error:W}=cB(J,{enabledPlugins:I});if(W)throw W;qY()}async function jA9(A,Q="user"){wF1(Q);let{name:B,marketplace:G}=TKA(A),Z,Y,J;if(G){let z=await qF(A);if(z)Z=z.entry,Y=G,J=z.marketplaceInstallLocation}else{let z=await G5();for(let[C,O]of Object.entries(z))try{let M=(await m$(C)).plugins.find((_)=>_.name===B);if(M){Z=M,Y=C,J=O.installLocation;break}}catch(L){s(L instanceof Error?L:Error(`Failed to load marketplace "${C}": ${L}`));continue}}if(!Z||!Y){let z=G?`marketplace "${G}"`:"any configured marketplace";return{success:!1,message:`Plugin "${B}" not found in ${z}`}}let X=Z,I=`${X.name}@${Y}`,W=$t(Q),D,{source:K}=X;if(Db(K)){if(!J)return{success:!1,message:`Cannot install local plugin "${B}" without marketplace install location`};D=Ew0(J,K)}await PO(I,X,Q,W,D);let V=Kb(Q),H={...dB(V)?.enabledPlugins,[I]:!0},{error:E}=cB(V,{enabledPlugins:H});if(E)return{success:!1,message:`Failed to update settings: ${E.message}`};return qY(),{success:!0,message:`Successfully installed plugin: ${I} (scope: ${Q})`,pluginId:I,pluginName:X.name,scope:Q}}async function LF1(A,Q="user"){wF1(Q);let{enabled:B,disabled:G}=await DG(),Z=[...B,...G],Y=_A9(A,Z);if(!Y)return{success:!1,message:`Plugin "${A}" not found in installed plugins`};let J=Kb(Q),X=dB(J),I=Ut5(A,Y,X),W=$t(Q),K=N_().plugins[I],V=K?.find((C)=>C.scope===Q&&C.projectPath===W);if(!V){let{scope:C}=Ct(I);if(C!==Q&&K&&K.length>0)return{success:!1,message:`Plugin "${A}" is installed in ${C} scope, not ${Q}. Use --scope ${C} to uninstall.`};return{success:!1,message:`Plugin "${A}" is not installed in ${Q} scope. Use --scope to specify the correct scope.`}}let F=V.installPath,H={...X?.enabledPlugins};H[I]=void 0,cB(J,{enabledPlugins:H}),qY(),U42(I,Q,W);let z=N_().plugins[I];if((!z||z.length===0)&&F)OF1(F);return{success:!0,message:`Successfully uninstalled plugin: ${Y.name} (scope: ${Q})`,pluginId:I,pluginName:Y.name,scope:Q}}async function TA9(A,Q,B){let G=Q?"enable":"disable";if(B)wF1(B);let{enabled:Z,disabled:Y}=await DG(),X=_A9(A,Q?Y:Z);if(!X)return{success:!1,message:`Plugin "${A}" not found in ${Q?"disabled":"enabled"} plugins`};let I=A.includes("@")?A:`${X.name}@${X.source?.split("@")[1]||"unknown"}`,W;if(B){let D=$t(B);W={scope:B,projectPath:D};let K=Ct(I);if(K.scope!==B)return{success:!1,message:`Plugin "${A}" is installed at ${K.scope} scope, not ${B}. Use --scope ${K.scope} or omit --scope to auto-detect.`}}else W=Ct(I);if(!J3A(W.scope))return{success:!1,message:`Managed plugins cannot be ${G}d. They can only be updated.`};try{qt5(I,Q,X,W)}catch(D){return{success:!1,message:D instanceof Error?D.message:`Failed to ${G} plugin`}}return{success:!0,message:`Successfully ${G}d plugin: ${X.name} (scope: ${W.scope})`,pluginId:I,pluginName:X.name,scope:W.scope}}async function X3A(A,Q){return TA9(A,!0,Q)}async function kfA(A,Q){return TA9(A,!1,Q)}async function zEA(A,Q){let{name:B,marketplace:G}=TKA(A),Z=G?`${B}@${G}`:A,Y=await qF(A);if(!Y)return{success:!1,message:`Plugin "${B}" not found`,pluginId:Z,scope:Q};let{entry:J,marketplaceInstallLocation:X}=Y,W=Gr().plugins[Z];if(!W||W.length===0)return{success:!1,message:`Plugin "${B}" is not installed`,pluginId:Z,scope:Q};let D=$t(Q),K=W.find((V)=>V.scope===Q&&V.projectPath===D);if(!K){let V=D?`${Q} (${D})`:Q;return{success:!1,message:`Plugin "${B}" is not installed at scope ${V}`,pluginId:Z,scope:Q}}return Nt5({pluginId:Z,pluginName:B,entry:J,marketplaceInstallLocation:X,installation:K,scope:Q,projectPath:D})}async function Nt5({pluginId:A,pluginName:Q,entry:B,marketplaceInstallLocation:G,installation:Z,scope:Y,projectPath:J}){let X=xA(),I=Z.version,W,D,K=!1;if(typeof B.source!=="string"){let V=await I3A(B.source,{manifest:{name:B.name}});W=V.path,K=!0,D=await d9A(A,B.source,V.manifest,V.path,B.version)}else{if(!X.existsSync(G))return{success:!1,message:`Marketplace directory not found at ${G}`,pluginId:A,scope:Y};let V=X.statSync(G).isDirectory()?G:$t5(G);if(W=Ew0(V,B.source),!X.existsSync(W))return{success:!1,message:`Plugin source not found at ${W}`,pluginId:A,scope:Y};let F,H=Ew0(W,".claude-plugin","plugin.json");try{F=RF1(H,B.name,B.source)}catch{}D=await d9A(A,B.source,F,W,B.version)}try{let V=Fb(A,D);if(Z.version===D||Z.installPath===V)return{success:!0,message:`${Q} is already at the latest version (${D}).`,pluginId:A,newVersion:D,oldVersion:I,alreadyUpToDate:!0,scope:Y};if(!X.existsSync(V))await MF1(W,A,D,B);let H=Z.installPath;if(q42(A,Y,J,V,D),H&&H!==V){let C=Gr();if(!Object.values(C.plugins).some((L)=>L.some((M)=>M.installPath===H))&&X.existsSync(H))OF1(H)}let E=J?`${Y} (${J})`:Y;return{success:!0,message:`Plugin "${Q}" updated from ${I||"unknown"} to ${D} for scope ${E}. Restart to apply changes.`,pluginId:A,newVersion:D,oldVersion:I,scope:Y}}finally{if(K&&W!==Fb(A,D))X.rmSync(W,{recursive:!0,force:!0})}}var IU,vfA;var CEA=w(()=>{BK();CN();gp();II();pz();GB();Yx();p9A();q0();pJ0();EQ();f1();IU=["user","project","local"],vfA=["user","project","local","managed"]});function PA9(A){if(_F1=A,bfA!==null&&bfA.length>0)A(bfA),bfA=null;return()=>{_F1=null}}async function wt5(){let A=await G5(),Q=new Set;for(let[B,G]of Object.entries(A))if(JxA(B,G))Q.add(B.toLowerCase());return Q}async function Lt5(A,Q){let B=!1;for(let{scope:G}of Q)try{let Z=await zEA(A,G);if(Z.success&&!Z.alreadyUpToDate)B=!0,k(`Plugin autoupdate: updated ${A} from ${Z.oldVersion} to ${Z.newVersion}`);else if(!Z.alreadyUpToDate)k(`Plugin autoupdate: failed to update ${A}: ${Z.message}`,{level:"warn"})}catch(Z){k(`Plugin autoupdate: error updating ${A}: ${Z instanceof Error?Z.message:String(Z)}`,{level:"warn"})}return B?A:null}async function Ot5(A){let Q=Gr(),B=Object.keys(Q.plugins),G=HQ();if(B.length===0)return[];return(await Promise.allSettled(B.map(async(Y)=>{let{marketplace:J}=TKA(Y);if(!J||!A.has(J.toLowerCase()))return null;let X=Q.plugins[Y];if(!X||X.length===0)return null;let I=X.filter((W)=>W.scope==="user"||W.scope==="managed"||W.projectPath===G);if(I.length===0)return null;return Lt5(Y,I)}))).filter((Y)=>Y.status==="fulfilled"&&Y.value!==null).map((Y)=>Y.value)}function SA9(){(async()=>{if(BOA()){k("Plugin autoupdate: skipped (auto-updater disabled)");return}try{let A=await wt5();if(A.size===0)return;let B=(await Promise.allSettled(Array.from(A).map(async(Z)=>{try{await Qr(Z)}catch(Y){k(`Plugin autoupdate: failed to refresh marketplace ${Z}: ${Y instanceof Error?Y.message:String(Y)}`,{level:"warn"})}}))).filter((Z)=>Z.status==="rejected");if(B.length>0)k(`Plugin autoupdate: ${B.length} marketplace refresh(es) failed`,{level:"warn"});k("Plugin autoupdate: checking installed plugins");let G=await Ot5(A);if(G.length>0)if(_F1)_F1(G);else bfA=G}catch(A){s(A instanceof Error?A:Error(String(A)))}})()}var _F1=null,bfA=null;var zw0=w(()=>{y1();f1();IQ();CN();II();CEA();p9A();q0();pz()});function xA9(){let{addNotification:A}=C6(),[Q,B]=ffA.useState([]);ffA.useEffect(()=>{return PA9((Z)=>{k(`Plugin autoupdate notification: ${Z.length} plugin(s) updated`),B(Z)})},[]),ffA.useEffect(()=>{if(Q.length===0)return;let G=Q.map((Y)=>{let J=Y.indexOf("@");return J>0?Y.substring(0,J):Y}),Z=G.length<=2?G.join(" and "):`${G.length} plugins`;A({key:"plugin-autoupdate-restart",jsx:Of.createElement(Of.Fragment,null,Of.createElement($,{color:"success"},G.length===1?"Plugin":"Plugins"," updated:"," ",Z),Of.createElement($,{dimColor:!0}," 路 Restart to apply")),priority:"low",timeoutMs:1e4}),k(`Showing plugin autoupdate notification for: ${G.join(", ")}`)},[Q,A])}var Of,ffA;var yA9=w(()=>{kA();PJ();zw0();y1();Of=c(JA(),1),ffA=c(JA(),1)});async function vA9(){let A=NQ(),Q=new Map;if(A.extraKnownMarketplaces)for(let[B,G]of Object.entries(A.extraKnownMarketplaces))Q.set(B,G);return Q}async function kA9(A){try{let Q=await G5(),B=[];for(let[G]of A)if(!Q[G])B.push(G);return B}catch(Q){return s(Q instanceof Error?Q:Error(String(Q))),[]}}var bA9=w(()=>{GB();II();f1();e1()});import{join as Mt5}from"path";async function Cw0(){let A=NQ(),Q=[];if(A.enabledPlugins){for(let[B,G]of Object.entries(A.enabledPlugins))if(B.includes("@")&&G)Q.push(B)}return Q}function fA9(){let A=new Map,Q=[{scope:"managed",source:"policySettings"},{scope:"user",source:"userSettings"},{scope:"project",source:"projectSettings"},{scope:"local",source:"localSettings"},{scope:"flag",source:"flagSettings"}];for(let{scope:B,source:G}of Q){let Z=dB(G);if(!Z?.enabledPlugins)continue;for(let[Y,J]of Object.entries(Z.enabledPlugins)){if(!Y.includes("@"))continue;if(J===!0)A.set(Y,B);else if(J===!1)A.delete(Y)}}return k(`Found ${A.size} enabled plugins with scopes: ${Array.from(A.entries()).map(([B,G])=>`${B}(${G})`).join(", ")}`),A}async function $w0(){sJ0().catch((B)=>{s(B instanceof Error?B:Error(String(B)))});let A=oJ0(),Q=Object.keys(A.plugins);return k(`Found ${Q.length} installed plugins (V2 format)`),Q}async function hA9(A){try{let Q=await $w0(),B=[];for(let G of A)if(!Q.includes(G))try{if(await qF(G))B.push(G)}catch(Z){k(`Failed to check plugin ${G} in marketplace: ${Z}`)}return B}catch(Q){return s(Q instanceof Error?Q:Error(String(Q))),[]}}async function gA9(A,Q,B="user"){let G=B!=="user"?c1():void 0,Z=Kb(B),Y=dB(Z),J={...Y?.enabledPlugins},X=[],I=[];for(let W=0;W<A.length;W++){let D=A[W];if(!D)continue;if(Q)Q(D,W+1,A.length);try{let K=await qF(D);if(!K){I.push({name:D,error:"Plugin not found in any marketplace"});continue}let{entry:V,marketplaceInstallLocation:F}=K;if(!Db(V.source))await PO(D,V,B,G);else uA9({pluginId:D,installPath:Mt5(F,V.source),version:V.version},B,G);J[D]=!0,X.push(D)}catch(K){let V=K instanceof Error?K.message:String(K);I.push({name:D,error:V}),s(K instanceof Error?K:Error(String(K)))}}return cB(Z,{...Y,enabledPlugins:J}),{installed:X,failed:I}}var Uw0=w(()=>{GB();II();f1();y1();BK();GB();EQ();pz();gp();p9A();G2();CN()});import{join as Rt5}from"path";function qw0(A,Q,B,G){A((Z)=>({...Z,plugins:{...Z.plugins,installationStatus:{...Z.plugins.installationStatus,marketplaces:Z.plugins.installationStatus.marketplaces.map((Y)=>Y.name===Q?{...Y,status:B,error:G}:Y)}}}))}function Nw0(A,Q,B,G){A((Z)=>({...Z,plugins:{...Z.plugins,installationStatus:{...Z.plugins.installationStatus,plugins:Z.plugins.installationStatus.plugins.map((Y)=>Y.id===Q?{...Y,status:B,error:G}:Y)}}}))}async function _t5(A,Q,B){let G=[],Z=[];for(let Y of A){let J=Q.get(Y);if(!J)continue;qw0(B,Y,"installing");try{await QS(J.source),G.push(Y),qw0(B,Y,"installed"),yG1(),Xt(),await jt5(Y,B)}catch(X){let I=X instanceof Error?X.message:String(X);Z.push({name:Y,error:I}),qw0(B,Y,"failed",I),s(X instanceof Error?X:Error(String(X)))}}return{installed:G,failed:Z}}async function jt5(A,Q){try{let G=(await Cw0()).filter((Z)=>Z.endsWith(`@${A}`));if(G.length>0){let Z=await hA9(G);if(Z.length>0)k(`Installing ${Z.length} plugins from newly installed marketplace ${A}`),await mA9(Z,Q)}}catch(B){s(B instanceof Error?B:Error(String(B)))}}async function mA9(A,Q){let B=[],G=[],Z=fA9(),Y=new Map;for(let J of A){Nw0(Q,J,"installing");try{let X=await qF(J);if(!X)throw Error("Plugin not found in any marketplace");let I=Z.get(J),{entry:W,marketplaceInstallLocation:D}=X,K=Db(W.source)?Rt5(D,W.source):void 0;if(I==="flag"){let V=K??W.source;await I3A(V,{manifest:W})}else{let V=I||"user",F=$t(V);if(await PO(J,W,V,F,K),V!=="managed"){if(NQ().enabledPlugins?.[J]!==!0){let z=Y.get(V)??{};z[J]=!0,Y.set(V,z)}}}B.push(J),Nw0(Q,J,"installed")}catch(X){let I=X instanceof Error?X.message:String(X);G.push({name:J,error:I}),Nw0(Q,J,"failed",I),s(X instanceof Error?X:Error(String(X)))}}for(let[J,X]of Y)if(Object.keys(X).length>0){let I=Kb(J),W=dB(I);cB(I,{...W,enabledPlugins:{...W?.enabledPlugins,...X}})}return{installed:B,failed:G}}async function jF1(A){k("performBackgroundPluginInstallations called");try{let Q=[],B=[],G=await G5(),Z=await vA9();if(Z.size>0){k(`Found ${Z.size} extra marketplaces in settings`);let X=await kA9(Z);if(X.length>0){k(`Installing ${X.length} marketplaces automatically`);for(let I of X){let W=Z.get(I);if(W)Q.push({name:I,marketplace:W})}}}let Y=await Cw0(),J=[];if(Y.length>0){k(`Found ${Y.length} enabled plugins`);let X=await $w0(),I=Y.filter((D)=>!X.includes(D));k(`Found ${I.length} missing plugins (not installed): ${I.join(", ")}`);let W=[];for(let D of I){let[,K]=D.split("@");if(!K)W.push(D);else if(K in G||Z.has(K)||Q.some((V)=>V.name===K))W.push(D);else J.push(D)}if(J.length>0){let D=[...new Set(J.map((K)=>K.split("@")[1]))];k(`Cannot install ${J.length} plugins because their marketplaces are not installed or configured: ${D.join(", ")}`),k(`Uninstallable plugins: ${J.join(", ")}`)}if(W.length>0)k(`Installing ${W.length} plugins automatically`),B.push(...W)}if(k(`Setting installation status: ${Q.length} marketplaces, ${B.length} installable plugins, ${J.length} uninstallable plugins`),A((X)=>({...X,plugins:{...X.plugins,installationStatus:{marketplaces:Q.map(({name:I})=>({name:I,status:"pending"})),plugins:[...B.map((I)=>{let[W]=I.split("@");return{id:I,name:W||I,status:"pending"}}),...J.map((I)=>{let[W,D]=I.split("@");return{id:I,name:W||I,status:"failed",error:`Marketplace '${D}' is not installed or configured`}})]}}})),Q.length>0)_t5(Q.map((X)=>X.name),Z,A).catch((X)=>{s(X instanceof Error?X:Error(String(X)))});if(B.length>0){let X=B.filter((I)=>{let[,W]=I.split("@");return!Q.some((D)=>D.name===W)});if(X.length>0)mA9(X,A).catch((I)=>{s(I instanceof Error?I:Error(String(I)))})}}catch(Q){s(Q instanceof Error?Q:Error(String(Q)))}}var ww0=w(()=>{y1();f1();bA9();Uw0();p9A();CEA();II();II();BK();gp();pz();GB()});async function dA9(A){if(k("performStartupChecks called"),!QY(!0)){k("Trust not accepted for current directory - skipping plugin installations");return}try{k("Starting background plugin installations"),await jF1(A)}catch(Q){k(`Error initiating background plugin installations: ${Q}`)}}var pA9=w(()=>{y1();ww0();IQ()});function cA9(A){let{addNotification:Q}=C6(),B=zDA(),G=z70(B,A),Z=C70(B),Y=W3A.useRef(null),J=gT(),X=E6(),I=nv(),W=X==="team"||X==="enterprise",[D,K]=W3A.useState(!1);W3A.useEffect(()=>{if(B.isUsingOverage&&!D&&(!J||!W||I))Q({key:"limit-reached",text:Z,priority:"immediate"}),K(!0);else if(!B.isUsingOverage&&D)K(!1)},[B.isUsingOverage,Z,D,Q,J,I,W]),W3A.useEffect(()=>{if(G&&G!==Y.current)Y.current=G,Q({key:"rate-limit-warning",jsx:hfA.createElement($,null,hfA.createElement($,{color:"warning"},G)),priority:"high"})},[G,Q])}var hfA,W3A;var lA9=w(()=>{PJ();gk();kA();IQ();eB();hfA=c(JA(),1),W3A=c(JA(),1)});function Pt5(A){let Q=A.toLowerCase(),B=a4();for(let[G,Z]of Object.entries(Tt5)){let Y=Z.retirementDates[B];if(!Q.includes(G)||!Y)continue;return{isDeprecated:!0,modelName:Z.modelName,retirementDate:Y}}return{isDeprecated:!1}}function TF1(A){if(!A)return null;let Q=Pt5(A);if(!Q.isDeprecated)return null;return` ${Q.modelName} will be retired on ${Q.retirementDate}. Consider switching to a newer model.`}var Tt5;var Lw0=w(()=>{jD();Tt5={"claude-3-opus":{modelName:"Claude 3 Opus",retirementDates:{firstParty:"January 5, 2026",bedrock:"January 15, 2026",vertex:"January 5, 2026",foundry:"January 5, 2026"}},"claude-3-7-sonnet":{modelName:"Claude 3.7 Sonnet",retirementDates:{firstParty:"February 10, 2026",bedrock:"April 28, 2026",vertex:"May 11, 2026",foundry:"February 10, 2026"}},"claude-3-5-haiku":{modelName:"Claude 3.5 Haiku",retirementDates:{firstParty:"February 19, 2026",bedrock:null,vertex:null,foundry:null}}}});function iA9(A){let{addNotification:Q}=C6(),B=PF1.useRef(null);PF1.useEffect(()=>{let G=TF1(A);if(G&&G!==B.current)B.current=G,Q({key:"model-deprecation-warning",text:G,color:"warning",priority:"high"});if(!G)B.current=null},[A,Q])}var PF1;var nA9=w(()=>{PJ();Lw0();PF1=c(JA(),1)});function aA9(){let{addNotification:A}=C6(),Q=SF1.useRef(!1);SF1.useEffect(()=>{if(Q.current)return;if(rA9())Q.current=!0,A({timeoutMs:15000,key:"programdata-deprecation-warning",text:St5,color:"warning",priority:"high"})},[A])}var SF1,St5="This device contains a C:\\ProgramData\\ClaudeCode\\managed-settings.json file. In a future version of Claude Code, managed settings at this location will no longer be applied. Contact your administrator to migrate this file to C:\\Program Files\\ClaudeCode\\managed-settings.json";var oA9=w(()=>{PJ();GB();SF1=c(JA(),1)});function sA9({ideSelection:A,mcpClients:Q,ideInstallationStatus:B}){let{addNotification:G}=C6(),Z=_HA(Q),Y=B?Bx(B?.ideType):!1,J=B?.error||Y,X=Z==="connected"&&(A?.filePath||A?.text&&A.lineCount>0),I=Z==="connected"&&!X,W=J&&!Y&&!I&&!X,D=J&&Y&&!I&&!X;gfA.useEffect(()=>{if(FK()||Z!==null||D)return;ufA(!0).then((K)=>{let V=K[0]?.name;if(V)G({key:"ide-status-hint",text:`${tA.circle} /ide for ${V}`,priority:"low"})})},[G,Z,D]),gfA.useEffect(()=>{if(W||D||Z!=="disconnected")return;G({key:"ide-status-disconnected",text:`${tA.circle} IDE disconnected`,color:"error",priority:"medium"})},[G,Z,W,D]),gfA.useEffect(()=>{if(!D)return;G({key:"ide-status-jetbrains-disconnected",text:"IDE plugin not connected 路 /status for info",priority:"medium"})},[G,D]),gfA.useEffect(()=>{if(!W)return;G({key:"ide-status-install-error",text:"IDE extension install failed (see /status for info)",color:"error",priority:"medium"})},[G,W])}var gfA;var tA9=w(()=>{PJ();WI();UK1();I2();gfA=c(JA(),1)});function A19(){let{addNotification:A}=C6();eA9.useEffect(()=>{let B=R1().sonnet45MigrationTimestamp;if(B){if(Date.now()-B<3000)A({key:"sonnet-4.5-update",text:"Model updated to Sonnet 4.5",color:"suggestion",priority:"high",timeoutMs:3000})}},[A])}var eA9;var Q19=w(()=>{PJ();IQ();eA9=c(JA(),1)});function G19(){let{addNotification:A}=C6();B19.useEffect(()=>{if(R1().subscriptionNoticeCount??0>=xt5)return;yt5().then((Q)=>{if(Q===null)return;h0((B)=>({...B,subscriptionNoticeCount:(B.subscriptionNoticeCount??0)+1})),p("tengu_switch_to_subscription_notice_shown",{}),A({key:"switch-to-subscription",jsx:mfA.createElement($,{color:"suggestion"},"Use your existing Claude ",Q," plan with Claude Code",mfA.createElement($,{color:"text",dimColor:!0}," ","路 /login to activate")),priority:"low"})})},[A])}async function yt5(){if(OB())return null;let A=await liA();if(!A)return null;if(A.account.has_claude_max)return"Max";if(A.account.has_claude_pro)return"Pro";return null}var mfA,B19,xt5=3;var Z19=w(()=>{kA();FqA();IQ();Z0();eB();PJ();mfA=c(JA(),1),B19=c(JA(),1)});function Y19(){let A=xF1.useRef(!1);xF1.useEffect(()=>{if(A.current)return;A.current=!0,Qc2()},[])}var xF1;var J19=w(()=>{Lq0();xF1=c(JA(),1)});function X19({onRun:A,onCancel:Q,reason:B}){let G=$EA.useRef(!1);return Y0($EA.useCallback((Z,Y)=>{if(Y.escape)Q()},[Q])),$EA.useEffect(()=>{if(!G.current)G.current=!0,A()},[A]),TE.createElement(T,{flexDirection:"column",marginTop:1},TE.createElement(T,null,TE.createElement($,{bold:!0},"Running /issue to capture feedback...")),TE.createElement(T,null,TE.createElement($,{dimColor:!0},"Press ",TE.createElement(y0,{shortcut:"Esc",action:"cancel"})," anytime")),TE.createElement(T,null,TE.createElement($,{dimColor:!0},"Reason: ",B)))}function Ow0(A){return!1;switch(A){case"feedback_survey_bad":return!0;case"feedback_survey_good":default:return!1}}function I19(A){switch(A){case"feedback_survey_bad":return'You responded "Bad" to the feedback survey';case"feedback_survey_good":return'You responded "Good" to the feedback survey';default:return"Unknown reason"}}var TE,$EA;var W19=w(()=>{kA();e4();TE=c(JA(),1),$EA=c(JA(),1)});var vt5,kt5;var D19=w(()=>{kA();q0();vt5=c(JA(),1),kt5=c(JA(),1)});import{randomUUID as _w0}from"crypto";function ht5(){let A=u4("app:toggleTranscript","Global","ctrl+o");return pB.createElement(T,{alignItems:"center",alignSelf:"center",borderTopDimColor:!0,borderBottom:!1,borderLeft:!1,borderRight:!1,borderStyle:"single",marginTop:1,paddingLeft:2,width:"100%"},pB.createElement($,{dimColor:!0},"Showing detailed transcript 路 ",A," to toggle"))}function UEA({commands:A,debug:Q,initialTools:B,initialMessages:G,initialFileHistorySnapshots:Z,mcpClients:Y,dynamicMcpConfig:J,mcpCliEndpoint:X,autoConnectIdeFlag:I,strictMcpConfig:W=!1,systemPrompt:D,appendSystemPrompt:K,onBeforeQuery:V,onTurnComplete:F,disabled:H=!1,mainThreadAgentDefinition:E,disableSlashCommands:z=!1,taskListId:C}){jQ.useEffect(()=>{return k(`[REPL:mount] REPL mounted, disabled=${H}`),()=>k("[REPL:unmount] REPL unmounting")},[H]);let[O,L]=e0(),M=Ka(),{toolPermissionContext:_,verbose:j,mcp:P,plugins:y,agentDefinitions:v}=O,m=Js(),[h,e]=jQ.useState(A);ni2(HQ(),e);let t=jQ.useMemo(()=>IC(_),[_]);ea2();let[,b]=jQ.useState(!1);jQ.useEffect(()=>{},[]);let[l,QA]=jQ.useState(J),WA=jQ.useCallback((B0)=>{QA(B0)},[QA]),[wA,_A]=jQ.useState("prompt"),[hA,jA]=jQ.useState(1),[yA,FA]=jQ.useState(!1),{addNotification:GA}=C6(),AA=bi2(Y,P.clients),[EA,$A]=jQ.useState(void 0),[MA,r]=jQ.useState(null),[VA,XA]=jQ.useState(null),[IA,NA]=jQ.useState(!1);A19(),G19(),sA9({ideSelection:EA,mcpClients:AA,ideInstallationStatus:VA}),XA9({mcpClients:AA}),MA9(),xA9(),qF1(),cA9(m),iA9(m),aA9(),Fa2(),va2(),ga2(),WA9();let{recommendation:RA,handleResponse:gA}=qA9();wA9();let mA=jQ.useMemo(()=>{return[...t,...B]},[t,B]);vV1();let Z1=FZ1();jQ.useEffect(()=>{dA9(L)},[L]),ma2(AA,L),jQ.useEffect(()=>{return},[L,G]);let F1=RV1(mA,P.tools,_),PA=jQ.useMemo(()=>{if(!E)return F1;let{resolvedTools:B0}=Ts(E,F1,!1);return B0},[E,F1]),eA=YN0(h,y.commands),s1=YN0(eA,P.commands),v1=jQ.useMemo(()=>z?[]:s1,[z,s1]);$h2(P.clients),si2(P.clients,$A);let[L0,TQ]=jQ.useState("responding"),[ZQ,$Q]=jQ.useState([]),[S1,WQ]=jQ.useState(null);jQ.useEffect(()=>{if(S1&&!S1.isStreaming&&S1.streamingEndedAt){let j0=30000-(Date.now()-S1.streamingEndedAt);if(j0>0){let YQ=setTimeout(()=>{WQ(null)},j0);return()=>clearTimeout(YQ)}else WQ(null)}},[S1]);let[J1,$1]=jQ.useState(null),[x1,_0]=jQ.useState(!1),[p0,l0]=jQ.useState(0),[CA,OA]=jQ.useState(void 0),I1=jQ.useRef(0),w1=jQ.useRef(0),H1=jQ.useRef(null),D1=jQ.useCallback((B0)=>{if(_0(B0),B0)I1.current=Date.now(),w1.current=0,H1.current=null,l0(0)},[]);BZ(()=>{if(!x1)return;if(H1.current!==null)return;let B0=Date.now()-I1.current;l0(B0-w1.current)},100);let[t1,Q0]=jQ.useState(null);jQ.useEffect(()=>{if(t1?.notifications)t1.notifications.forEach((B0)=>{GA({key:"auto-updater-notification",text:B0,priority:"low"})})},[t1,GA]);let[g0,DQ]=jQ.useState(null),[qB,BB]=jQ.useState([]),[d2,i0]=jQ.useState([]),F0=qB.length>0||O.pendingWorkerRequest;jQ.useEffect(()=>{return},[x1,F0]);let[r0,yB]=jQ.useState(G??[]),[p2,Y9]=jQ.useState(null);Y19();let[cQ,$2]=jQ.useState([]),[c4,a6]=jQ.useState(""),[w6,G3]=jQ.useState("prompt"),[SQ,u2]=jQ.useState(),{tip:V4,dismissTip:L6}=Gi2({inputValue:c4,isAssistantResponding:x1}),[T2,B9]=jQ.useState({}),[D7,K7]=jQ.useState(0),[FZ,mZ]=jQ.useState(0),[c5,HZ]=jQ.useState(0),[H5,RY]=jQ.useState(null),[V7,dZ]=jQ.useState(null),[y3,pZ]=jQ.useState(null),[Z3,CI]=jQ.useState(!1),[EZ,S5]=jQ.useState(!1),[x5,oA]=jQ.useState(_w0()),[KA,YA]=jQ.useState(R1().hasAcknowledgedCostThreshold),[vA,uA]=jQ.useState(new Set),[dA,C1]=jQ.useState("INSERT"),[T1,h1]=jQ.useState(!1),[n1,p1]=jQ.useState(!1),[N0,MQ]=jQ.useState(!1),[vB,a2]=jQ.useState(!1),[c2,Q4]=jQ.useState(!1),[q3,zZ]=jQ.useState(!1),[P7,BJ]=jQ.useState(null),[GJ,LK]=jQ.useState(!1),iJ=jQ.useRef(!1),DD=jQ.useRef(null),[S0]=aB(),KQ=jQ.useCallback(()=>{oa2({theme:S0,readFileState:aJ.current}).then(async(B0)=>{if(B0){let j0=await B0.content({theme:S0});L((YQ)=>({...YQ,spinnerTip:j0})),ra2(B0)}else L((j0)=>({...j0,spinnerTip:void 0}))})},[L,S0]),VB=jQ.useCallback(()=>{D1(!1),OA(void 0),mZ(0),$Q([]),RY(null),dZ(null),pZ(null),KQ(),UxA()},[D1,KQ]),{backgroundSignalRef:sB,handleBackgroundSession:d9,handleForegroundTask:M8}=xn2({setMessages:yB,setIsLoading:D1,resetLoadingState:VB,setAbortController:$1}),y5=Li2(c4),nJ=(!g0||g0.showSpinner===!0)&&qB.length===0&&(x1||CA)&&!O.pendingWorkerRequest,iO=bn2(r0,x1,D7),NV=jQ.useMemo(()=>({...iO,handleSelect:(B0)=>{if(iO.handleSelect(B0),B0==="bad"&&Ow0("feedback_survey_bad")||B0==="good"&&Ow0("feedback_survey_good"))$I(B0==="bad"?"feedback_survey_bad":"feedback_survey_good")}}),[iO]),E5=Xa2(r0,x1);$n2({autoConnectIdeFlag:I,ideToInstallExtension:MA,setDynamicMcpConfig:QA,setShowIdeOnboarding:NA,setIDEInstallationState:XA}),Qo2(Z,O.fileHistory,(B0)=>L((j0)=>({...j0,fileHistory:B0})));let v3=jQ.useCallback(async(B0,j0,YQ)=>{p("tengu_session_resumed",{entrypoint:YQ});let l2=pfA(j0.messages),T9=await YU("resume",B0,E?.agentType);if(l2.push(...T9),T51(j0),z51(j0,cz(B0)),j0.fileHistorySnapshots)kFA(j0.fileHistorySnapshots,(i2)=>{L((U2)=>({...U2,fileHistory:i2}))}),KW1(j0);if(aO(l2,j0.projectPath??HQ()),VB(),$1(null),!Sz())await oI();oA(B0);let Y4=zp1(B0);if(Cp1(),pCA(),Mw(cz(B0)),await s_(),Y4)MmA(Y4);yB(()=>l2),DQ(null),a6(""),$2([])},[VB,L]),wV=E0(),nO=jQ.useMemo(()=>bo(E0()),[]),aJ=jQ.useRef((()=>{let B0=pm(yF1);return B0.set(nO,{content:Q1(O.todos[wV]||[]),timestamp:0,offset:void 0,limit:void 0}),B0})()),aO=jQ.useCallback((B0,j0)=>{let YQ=uV1(B0,j0,yF1);aJ.current=R51(aJ.current,YQ)},[]);jQ.useEffect(()=>{if(G&&G.length>0)aO(G,HQ())},[]);let{status:_x,reverify:oO}=Wi2(),[gE,$I]=jQ.useState(null),[uG,uE]=jQ.useState(null),[LV,wj]=jQ.useState(!1),Jw=!x1&&EZ;function oJ(){if(LV||uG)return;if(Z3)return"message-selector";if(d2[0])return"sandbox-permission";let B0=!g0||g0.shouldContinueAnimation;if(B0&&qB[0])return"tool-permission";if(B0&&O.workerPermissions.queue[0])return"worker-permission";if(B0&&O.workerSandboxPermissions.queue[0])return"worker-sandbox-permission";if(B0&&O.elicitation.queue[0])return"elicitation";if(B0&&Jw)return"cost";if(B0&&IA)return"ide-onboarding";if(B0&&RA)return"lsp-recommendation";return}let l5=oJ();jQ.useEffect(()=>{if(!x1)return;let B0=l5==="tool-permission",j0=Date.now();if(B0&&H1.current===null)H1.current=j0;else if(!B0&&H1.current!==null)w1.current+=j0-H1.current,H1.current=null},[l5,x1]);function PU(){if(l5==="elicitation")return;if(VB(),l5==="tool-permission")qB[0]?.onAbort(),BB([]);else if(l5==="worker-permission"){let B0=O.workerPermissions.queue[0];if(B0)dfA?.sendPermissionResponseViaMailbox(B0.workerName,{decision:"rejected",resolvedBy:"leader"},B0.id,O.teamContext?.teamName),L((j0)=>({...j0,workerPermissions:{...j0.workerPermissions,queue:j0.workerPermissions.queue.slice(1)}}))}else J1?.abort()}let JH=jQ.useCallback(async()=>{let B0=await fG1(c4,0,async()=>new Promise((j0)=>L((YQ)=>{return j0(YQ),YQ})),L);if(!B0)return;if(a6(B0.text),G3("prompt"),B0.images.length>0)B9((j0)=>{let YQ={...j0};for(let l2 of B0.images)YQ[l2.id]=l2;return YQ})},[L,a6,G3,c4,B9]),mE={setToolUseConfirmQueue:BB,onCancel:PU,isMessageSelectorVisible:Z3||T1||n1,screen:wA,abortSignal:J1?.signal,popCommandFromQueue:JH,vimMode:dA,isLocalJSXCommand:g0?.isLocalJSXCommand,isSearchingHistory:c2,isHelpOpen:q3};jQ.useEffect(()=>{if(HH()>=5&&!EZ&&!KA){if(p("tengu_cost_threshold_reached",{}),otA())S5(!0)}},[r0,EZ,KA]);let F7=jQ.useCallback(async(B0)=>{return new Promise((j0)=>{i0((YQ)=>[...YQ,{hostPattern:B0,resolvePromise:j0}])})},[L]);if(JB.isSandboxingEnabled())JB.initialize(F7).catch((B0)=>{process.stderr.write(`