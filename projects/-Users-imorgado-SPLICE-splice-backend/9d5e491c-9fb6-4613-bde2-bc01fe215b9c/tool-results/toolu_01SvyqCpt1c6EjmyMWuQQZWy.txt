     1→<!DOCTYPE html>
     2→<html>
     3→<head>
     4→  <meta charset="utf-8">
     5→  <title>SPLICE</title>
     6→  <style>
     7→    body {
     8→      font-family: Adobe Clean, -apple-system, BlinkMacSystemFont, sans-serif;
     9→      background: #323232;
    10→      color: #e1e1e1;
    11→      margin: 0;
    12→      padding: 8px;
    13→      height: 100vh;
    14→      box-sizing: border-box;
    15→      overflow-y: auto;
    16→      overflow-x: hidden;
    17→    }
    18→
    19→    /* Header */
    20→    .header {
    21→      display: flex;
    22→      justify-content: space-between;
    23→      align-items: center;
    24→      margin-bottom: 8px;
    25→    }
    26→    .header h1 {
    27→      font-size: 14px;
    28→      font-weight: 600;
    29→      margin: 0;
    30→    }
    31→    .header-actions {
    32→      display: flex;
    33→      gap: 4px;
    34→    }
    35→    .icon-btn {
    36→      background: transparent;
    37→      border: 1px solid #555;
    38→      color: #aaa;
    39→      width: 24px;
    40→      height: 24px;
    41→      border-radius: 4px;
    42→      cursor: pointer;
    43→      font-size: 12px;
    44→      display: flex;
    45→      align-items: center;
    46→      justify-content: center;
    47→      padding: 0;
    48→      margin: 0;
    49→    }
    50→    .icon-btn:hover {
    51→      background: #444;
    52→      color: #fff;
    53→    }
    54→
    55→    /* Credit Badge */
    56→    .credit-badge {
    57→      display: none;
    58→      align-items: center;
    59→      font-size: 10px;
    60→      font-weight: 500;
    61→      padding: 3px 8px;
    62→      border-radius: 10px;
    63→      background: #1e1e1e;
    64→      border: 1px solid #444;
    65→      color: #aaa;
    66→      margin-right: 8px;
    67→    }
    68→    .credit-badge.ok {
    69→      color: #4a9eff;
    70→      border-color: #4a9eff33;
    71→    }
    72→    .credit-badge.low {
    73→      color: #dc3545;
    74→      border-color: #dc354533;
    75→      animation: pulse-low 2s infinite;
    76→    }
    77→    @keyframes pulse-low {
    78→      0%, 100% { opacity: 1; }
    79→      50% { opacity: 0.6; }
    80→    }
    81→
    82→    /* Status bar */
    83→    #status {
    84→      padding: 6px 10px;
    85→      background: #1e1e1e;
    86→      border-radius: 4px;
    87→      font-size: 11px;
    88→      margin-bottom: 10px;
    89→    }
    90→
    91→    /* Action Cards Container */
    92→    .action-cards {
    93→      display: flex;
    94→      gap: 8px;
    95→      margin-bottom: 10px;
    96→    }
    97→
    98→    /* Action Card */
    99→    .action-card {
   100→      flex: 1;
   101→      background: #2a2a2a;
   102→      border-radius: 6px;
   103→      padding: 12px;
   104→      border: 1px solid #444;
   105→    }
   106→    .action-card h2 {
   107→      font-size: 11px;
   108→      font-weight: 600;
   109→      margin: 0 0 10px 0;
   110→      color: #ccc;
   111→      text-transform: uppercase;
   112→      letter-spacing: 0.5px;
   113→    }
   114→
   115→    /* GO Button */
   116→    .go-btn {
   117→      width: 100%;
   118→      padding: 14px 12px;
   119→      font-size: 13px;
   120→      font-weight: 700;
   121→      background: linear-gradient(135deg, #4a9eff, #2d7dd2);
   122→      border: none;
   123→      border-radius: 6px;
   124→      color: white;
   125→      cursor: pointer;
   126→      margin-bottom: 8px;
   127→      letter-spacing: 1px;
   128→    }
   129→    .go-btn:hover {
   130→      background: linear-gradient(135deg, #5aa8ff, #3d8de2);
   131→    }
   132→    .go-btn:disabled {
   133→      opacity: 0.5;
   134→      cursor: not-allowed;
   135→    }
   136→    .go-btn.takes-btn {
   137→      background: linear-gradient(135deg, #28a745, #1e7e34);
   138→    }
   139→    .go-btn.takes-btn:hover {
   140→      background: linear-gradient(135deg, #34ce57, #28a745);
   141→    }
   142→
   143→    /* Options Toggle */
   144→    .options-toggle {
   145→      background: transparent;
   146→      border: none;
   147→      color: #888;
   148→      font-size: 10px;
   149→      cursor: pointer;
   150→      padding: 4px 0;
   151→      width: 100%;
   152→      text-align: left;
   153→      margin: 0;
   154→    }
   155→    .options-toggle:hover {
   156→      color: #aaa;
   157→    }
   158→    .options-toggle::before {
   159→      content: '+';
   160→      margin-right: 4px;
   161→      font-weight: bold;
   162→    }
   163→    .options-toggle.expanded::before {
   164→      content: '-';
   165→    }
   166→
   167→    /* Options Panel (collapsible) */
   168→    .options-panel {
   169→      margin-top: 8px;
   170→      padding-top: 8px;
   171→      border-top: 1px solid #444;
   172→    }
   173→    .options-panel.collapsed {
   174→      display: none;
   175→    }
   176→
   177→    /* Slider */
   178→    .slider-container {
   179→      margin-bottom: 10px;
   180→    }
   181→    .slider-container sp-slider {
   182→      width: 100%;
   183→    }
   184→    .slider-labels {
   185→      display: flex;
   186→      justify-content: space-between;
   187→      font-size: 9px;
   188→      color: #666;
   189→      margin-top: 2px;
   190→    }
   191→
   192→    /* Audio Source */
   193→    .audio-source-group {
   194→      margin-bottom: 8px;
   195→    }
   196→    .audio-source-group sp-label {
   197→      display: block;
   198→      font-size: 10px;
   199→      color: #888;
   200→      margin-bottom: 4px;
   201→    }
   202→    .audio-source-group sp-checkbox {
   203→      display: block;
   204→      margin: 4px 0;
   205→      font-size: 11px;
   206→    }
   207→    .tier-badge {
   208→      font-size: 8px;
   209→      background: #4a9eff;
   210→      color: white;
   211→      padding: 1px 4px;
   212→      border-radius: 2px;
   213→      margin-left: 4px;
   214→      vertical-align: middle;
   215→    }
   216→
   217→    /* Results Area */
   218→    .results-area {
   219→      background: #1e1e1e;
   220→      border-radius: 6px;
   221→      padding: 12px;
   222→      min-height: 60px;
   223→    }
   224→    .results-area.hidden {
   225→      display: none;
   226→    }
   227→    .results-header {
   228→      display: flex;
   229→      justify-content: space-between;
   230→      align-items: center;
   231→      margin-bottom: 8px;
   232→    }
   233→    .results-header h3 {
   234→      font-size: 11px;
   235→      font-weight: 600;
   236→      margin: 0;
   237→      color: #aaa;
   238→      text-transform: uppercase;
   239→    }
   240→    .undo-btn {
   241→      background: #dc3545;
   242→      color: white;
   243→      border: none;
   244→      padding: 4px 10px;
   245→      border-radius: 3px;
   246→      font-size: 10px;
   247→      cursor: pointer;
   248→    }
   249→    .undo-btn:hover {
   250→      background: #c82333;
   251→    }
   252→
   253→    /* Progress */
   254→    .progress-container {
   255→      text-align: center;
   256→      padding: 16px 0;
   257→    }
   258→    .progress-container sp-progressbar {
   259→      width: 100%;
   260→      margin-bottom: 8px;
   261→    }
   262→    .progress-text {
   263→      font-size: 11px;
   264→      color: #888;
   265→    }
   266→
   267→    /* Results Content */
   268→    .results-content {
   269→      font-size: 11px;
   270→    }
   271→    .results-stat {
   272→      display: flex;
   273→      justify-content: space-between;
   274→      padding: 4px 0;
   275→      border-bottom: 1px solid #333;
   276→    }
   277→    .results-stat:last-child {
   278→      border-bottom: none;
   279→    }
   280→    .results-stat-label {
   281→      color: #888;
   282→    }
   283→    .results-stat-value {
   284→      font-weight: 600;
   285→      color: #4a9eff;
   286→    }
   287→
   288→    /* Preview Section */
   289→    .preview-section {
   290→      display: none;
   291→    }
   292→    .preview-header {
   293→      display: flex;
   294→      justify-content: space-between;
   295→      align-items: center;
   296→      margin-bottom: 10px;
   297→    }
   298→    .preview-header h3 {
   299→      font-size: 11px;
   300→      font-weight: 600;
   301→      margin: 0;
   302→      color: #aaa;
   303→      text-transform: uppercase;
   304→    }
   305→    .preview-header-actions {
   306→      display: flex;
   307→      gap: 4px;
   308→    }
   309→    .preview-summary {
   310→      font-size: 10px;
   311→      color: #888;
   312→      margin-bottom: 10px;
   313→      padding: 8px;
   314→      background: #252525;
   315→      border-radius: 4px;
   316→    }
   317→    .preview-summary strong {
   318→      color: #4a9eff;
   319→    }
   320→    .preview-list {
   321→      max-height: 180px;
   322→      overflow-y: auto;
   323→      margin-bottom: 10px;
   324→      contain: layout style paint;
   325→      will-change: scroll-position;
   326→    }
   327→    .preview-item {
   328→      display: flex;
   329→      align-items: center;
   330→      padding: 8px 10px;
   331→      min-height: 44px;
   332→      margin-bottom: 4px;
   333→      background: #2a2a2a;
   334→      border-radius: 4px;
   335→      border-left: 3px solid #4a9eff;
   336→      cursor: pointer;
   337→      transition: background-color 0.15s ease, border-left-color 0.15s ease;
   338→      contain: layout style;
   339→      box-sizing: border-box;
   340→    }
   341→    .preview-item:hover {
   342→      background: #333;
   343→    }
   344→    .preview-item:focus-within {
   345→      outline: 2px solid #4a9eff;
   346→      outline-offset: -2px;
   347→    }
   348→    .preview-item.excluded {
   349→      opacity: 0.65;
   350→      border-left-color: #666;
   351→    }
   352→    .preview-item-check {
   353→      min-width: 20px;
   354→      min-height: 20px;
   355→      margin-right: 10px;
   356→      accent-color: #4a9eff;
   357→      cursor: pointer;
   358→    }
   359→    .preview-item-info {
   360→      flex: 1;
   361→      min-width: 0;
   362→      overflow: hidden;
   363→    }
   364→    .preview-item-time {
   365→      font-size: 11px;
   366→      font-weight: 500;
   367→      color: #e1e1e1;
   368→      white-space: nowrap;
   369→      overflow: hidden;
   370→      text-overflow: ellipsis;
   371→    }
   372→    .preview-item-duration {
   373→      font-size: 9px;
   374→      color: #999;
   375→      margin-top: 2px;
   376→    }
   377→    .preview-item-seek {
   378→      background: transparent;
   379→      border: 1px solid #555;
   380→      color: #888;
   381→      min-width: 32px;
   382→      min-height: 32px;
   383→      border-radius: 4px;
   384→      cursor: pointer;
   385→      font-size: 12px;
   386→      display: flex;
   387→      align-items: center;
   388→      justify-content: center;
   389→      flex-shrink: 0;
   390→    }
   391→    .preview-item-seek:hover {
   392→      background: #444;
   393→      color: #fff;
   394→    }
   395→    .preview-item-seek:focus-visible {
   396→      outline: 2px solid #4a9eff;
   397→      outline-offset: 2px;
   398→    }
   399→    .preview-item-seek.loading {
   400→      pointer-events: none;
   401→      opacity: 0.6;
   402→    }
   403→    .preview-actions {
   404→      display: flex;
   405→      gap: 8px;
   406→      margin-top: 10px;
   407→    }
   408→    .preview-actions button {
   409→      flex: 1;
   410→      padding: 12px 10px;
   411→      min-height: 44px;
   412→      font-size: 11px;
   413→      font-weight: 600;
   414→      border-radius: 4px;
   415→      cursor: pointer;
   416→    }
   417→    .apply-btn {
   418→      background: linear-gradient(135deg, #28a745, #1e7e34);
   419→      color: white;
   420→      border: none;
   421→    }
   422→    .apply-btn:hover {
   423→      background: linear-gradient(135deg, #34ce57, #28a745);
   424→    }
   425→    .apply-btn:disabled {
   426→      opacity: 0.5;
   427→      cursor: not-allowed;
   428→    }
   429→    .apply-btn:focus-visible {
   430→      outline: 2px solid #28a745;
   431→      outline-offset: 2px;
   432→    }
   433→    .cancel-btn {
   434→      background: transparent;
   435→      color: #888;
   436→      border: 1px solid #555;
   437→    }
   438→    .cancel-btn:hover {
   439→      background: #333;
   440→      color: #e1e1e1;
   441→    }
   442→    .cancel-btn:focus-visible {
   443→      outline: 2px solid #888;
   444→      outline-offset: 2px;
   445→    }
   446→    .select-all-row {
   447→      display: flex;
   448→      justify-content: space-between;
   449→      align-items: center;
   450→      padding: 6px 0;
   451→      margin-bottom: 8px;
   452→      border-bottom: 1px solid #333;
   453→    }
   454→    .select-all-row label {
   455→      font-size: 10px;
   456→      color: #888;
   457→      display: flex;
   458→      align-items: center;
   459→      cursor: pointer;
   460→    }
   461→    .select-all-row input {
   462→      margin-right: 6px;
   463→      min-width: 16px;
   464→      min-height: 16px;
   465→      accent-color: #4a9eff;
   466→    }
   467→    .preview-filters {
   468→      display: flex;
   469→      gap: 4px;
   470→      flex-wrap: wrap;
   471→      margin-bottom: 8px;
   472→    }
   473→    .filter-btn {
   474→      background: #1e1e1e;
   475→      border: 1px solid #444;
   476→      color: #888;
   477→      padding: 4px 8px;
   478→      font-size: 9px;
   479→      border-radius: 3px;
   480→      cursor: pointer;
   481→    }
   482→    .filter-btn:hover {
   483→      background: #333;
   484→      color: #e1e1e1;
   485→    }
   486→    .filter-btn.active {
   487→      background: #4a9eff22;
   488→      border-color: #4a9eff;
   489→      color: #4a9eff;
   490→    }
   491→
   492→    /* Legend dots */
   493→    .legend-item {
   494→      display: inline-flex;
   495→      align-items: center;
   496→      margin-right: 12px;
   497→    }
   498→    .legend-dot {
   499→      display: inline-block;
   500→      width: 8px;
   501→      height: 8px;
   502→      border-radius: 50%;
   503→      margin-right: 4px;
   504→    }
   505→    .legend-dot.silence {
   506→      background: #dc3545;
   507→    }
   508→    .legend-dot.take {
   509→      background: #4a9eff;
   510→    }
   511→
   512→    /* Colored markers for preview items */
   513→    .preview-item.silence-marker {
   514→      border-left-color: #dc3545;
   515→    }
   516→    .preview-item.take-marker {
   517→      border-left-color: #4a9eff;
   518→    }
   519→    .preview-item.protected-silence {
   520→      border-left-color: #ffc107;
   521→      opacity: 0.6;
   522→    }
   523→    .preview-item.protected-silence::after {
   524→      content: 'Protected';
   525→      font-size: 8px;
   526→      color: #ffc107;
   527→      margin-left: 8px;
   528→    }
   529→
   530→    /* Take Items */
   531→    .takes-list {
   532→      max-height: 200px;
   533→      overflow-y: auto;
   534→    }
   535→    .take-item {
   536→      padding: 8px;
   537→      margin-bottom: 4px;
   538→      background: #2a2a2a;
   539→      border-radius: 4px;
   540→      border-left: 3px solid #555;
   541→      cursor: pointer;
   542→      transition: all 0.15s ease;
   543→    }
   544→    .take-item:hover {
   545→      background: #333;
   546→    }
   547→    .take-item.best {
   548→      border-left-color: #28a745;
   549→      background: #1a2e1a;
   550→    }
   551→    .take-header {
   552→      display: flex;
   553→      justify-content: space-between;
   554→      align-items: center;
   555→    }
   556→    .take-label {
   557→      font-weight: 500;
   558→      font-size: 11px;
   559→    }
   560→    .take-star {
   561→      font-size: 14px;
   562→      color: #555;
   563→    }
   564→    .take-item.best .take-star {
   565→      color: #28a745;
   566→    }
   567→    .take-time {
   568→      color: #888;
   569→      font-size: 9px;
   570→      margin-top: 2px;
   571→    }
   572→    .take-text {
   573→      color: #aaa;
   574→      font-size: 10px;
   575→      margin-top: 4px;
   576→    }
   577→    .take-actions {
   578→      display: flex;
   579→      gap: 6px;
   580→      margin-top: 10px;
   581→    }
   582→    .take-actions button {
   583→      flex: 1;
   584→      padding: 8px;
   585→      font-size: 10px;
   586→      border-radius: 4px;
   587→    }
   588→    .keep-best-btn {
   589→      background: #28a745;
   590→      color: white;
   591→      border: none;
   592→      cursor: pointer;
   593→    }
   594→    .keep-best-btn:hover {
   595→      background: #218838;
   596→    }
   597→    .label-all-btn {
   598→      background: #6c757d;
   599→      color: white;
   600→      border: none;
   601→      cursor: pointer;
   602→    }
   603→    .label-all-btn:hover {
   604→      background: #5a6268;
   605→    }
   606→
   607→    /* Empty State */
   608→    .empty-state {
   609→      text-align: center;
   610→      color: #666;
   611→      font-size: 11px;
   612→      padding: 20px 0;
   613→    }
   614→
   615→    /* Razor Section (Advanced - hidden by default) */
   616→    .advanced-section {
   617→      margin-top: 10px;
   618→      padding: 10px;
   619→      background: #252525;
   620→      border-radius: 4px;
   621→      border: 1px dashed #444;
   622→    }
   623→    .advanced-section.hidden {
   624→      display: none;
   625→    }
   626→    .advanced-section h4 {
   627→      font-size: 10px;
   628→      color: #888;
   629→      margin: 0 0 8px 0;
   630→      text-transform: uppercase;
   631→    }
   632→    .advanced-section p {
   633→      font-size: 9px;
   634→      color: #666;
   635→      margin: 0 0 8px 0;
   636→    }
   637→    .advanced-section button {
   638→      font-size: 10px;
   639→      padding: 6px 10px;
   640→      margin-right: 6px;
   641→    }
   642→    button.razor-btn {
   643→      background: #6f42c1;
   644→      color: white;
   645→      border: none;
   646→      border-radius: 3px;
   647→      cursor: pointer;
   648→    }
   649→    button.razor-btn:hover {
   650→      background: #5a32a3;
   651→    }
   652→    button.export-xml-btn {
   653→      background: #17a2b8;
   654→      color: white;
   655→      border: none;
   656→      border-radius: 3px;
   657→      cursor: pointer;
   658→    }
   659→    button.export-xml-btn:hover {
   660→      background: #138496;
   661→    }
   662→
   663→    /* Settings Modal */
   664→    .modal {
   665→      position: fixed;
   666→      top: 0;
   667→      left: 0;
   668→      right: 0;
   669→      bottom: 0;
   670→      background: rgba(0,0,0,0.7);
   671→      display: flex;
   672→      align-items: center;
   673→      justify-content: center;
   674→      z-index: 100;
   675→    }
   676→    .modal.hidden {
   677→      display: none;
   678→    }
   679→    .modal-content {
   680→      background: #2a2a2a;
   681→      border-radius: 8px;
   682→      padding: 16px;
   683→      width: 90%;
   684→      max-width: 280px;
   685→      border: 1px solid #444;
   686→    }
   687→    .modal-header {
   688→      display: flex;
   689→      justify-content: space-between;
   690→      align-items: center;
   691→      margin-bottom: 12px;
   692→    }
   693→    .modal-header h3 {
   694→      font-size: 12px;
   695→      margin: 0;
   696→    }
   697→    .modal-close {
   698→      background: transparent;
   699→      border: none;
   700→      color: #888;
   701→      font-size: 18px;
   702→      cursor: pointer;
   703→      padding: 0;
   704→      width: 24px;
   705→      height: 24px;
   706→    }
   707→    .modal-close:hover {
   708→      color: #fff;
   709→    }
   710→    .setting-group {
   711→      margin-bottom: 12px;
   712→    }
   713→    .setting-group label {
   714→      display: block;
   715→      font-size: 10px;
   716→      color: #888;
   717→      margin-bottom: 4px;
   718→    }
   719→
   720→    /* Preset Modal Styles */
   721→    .preset-icon-option {
   722→      color: #888;
   723→      transition: all 0.15s ease;
   724→    }
   725→    .preset-icon-option:hover {
   726→      background: #333 !important;
   727→      color: #e1e1e1;
   728→    }
   729→    .preset-icon-option.selected {
   730→      border-color: #4a9eff !important;
   731→      background: #4a9eff22 !important;
   732→      color: #4a9eff;
   733→    }
   734→
   735→    /* Preset List Item Styles */
   736→    .preset-list-item {
   737→      display: flex;
   738→      align-items: center;
   739→      padding: 8px 10px;
   740→      margin-bottom: 4px;
   741→      background: #2a2a2a;
   742→      border-radius: 4px;
   743→      border-left: 3px solid #444;
   744→    }
   745→    .preset-list-item:hover {
   746→      background: #333;
   747→    }
   748→    .preset-list-item.built-in {
   749→      border-left-color: #4a9eff;
   750→      opacity: 0.7;
   751→    }
   752→    .preset-list-item.custom {
   753→      border-left-color: #28a745;
   754→    }
   755→    .preset-list-item-icon {
   756→      width: 24px;
   757→      height: 24px;
   758→      display: flex;
   759→      align-items: center;
   760→      justify-content: center;
   761→      background: #1e1e1e;
   762→      border-radius: 4px;
   763→      font-size: 12px;
   764→      margin-right: 10px;
   765→      color: #888;
   766→    }
   767→    .preset-list-item-info {
   768→      flex: 1;
   769→      min-width: 0;
   770→      overflow: hidden;
   771→    }
   772→    .preset-list-item-name {
   773→      font-size: 11px;
   774→      font-weight: 500;
   775→      color: #e1e1e1;
   776→      white-space: nowrap;
   777→      overflow: hidden;
   778→      text-overflow: ellipsis;
   779→    }
   780→    .preset-list-item-desc {
   781→      font-size: 9px;
   782→      color: #888;
   783→      white-space: nowrap;
   784→      overflow: hidden;
   785→      text-overflow: ellipsis;
   786→    }
   787→    .preset-list-item-actions {
   788→      display: flex;
   789→      gap: 4px;
   790→    }
   791→    .preset-list-item-actions button {
   792→      background: transparent;
   793→      border: 1px solid #555;
   794→      color: #888;
   795→      width: 24px;
   796→      height: 24px;
   797→      border-radius: 4px;
   798→      cursor: pointer;
   799→      font-size: 10px;
   800→      display: flex;
   801→      align-items: center;
   802→      justify-content: center;
   803→    }
   804→    .preset-list-item-actions button:hover {
   805→      background: #444;
   806→      color: #e1e1e1;
   807→    }
   808→    .preset-list-item-actions button.delete:hover {
   809→      background: #dc3545;
   810→      border-color: #dc3545;
   811→      color: white;
   812→    }
   813→  </style>
   814→</head>
   815→<body>
   816→  <!-- Header -->
   817→  <header class="header">
   818→    <h1>SPLICE</h1>
   819→    <div class="header-actions">
   820→      <span id="creditBadge" class="credit-badge" title="Hours remaining">-- hrs</span>
   821→      <button id="helpBtn" class="icon-btn" title="Help">?</button>
   822→      <button id="settingsBtn" class="icon-btn" title="Settings">*</button>
   823→    </div>
   824→  </header>
   825→
   826→  <!-- Status Bar -->
   827→  <div id="status">Ready</div>
   828→
   829→  <!-- Main Action Card -->
   830→  <div class="action-cards">
   831→    <div class="action-card">
   832→      <h2>SPLICE</h2>
   833→      <button id="goBtn" class="go-btn">GO</button>
   834→      <button id="optionsToggle" class="options-toggle">More options</button>
   835→      <div id="optionsPanel" class="options-panel collapsed">
   836→        <div class="preset-group" style="margin-bottom: 10px;">
   837→          <label style="display: block; font-size: 10px; color: #888; margin-bottom: 4px;">Preset</label>
   838→          <div style="display: flex; gap: 4px; align-items: center;">
   839→            <select id="presetSelector" style="flex: 1; padding: 6px 8px; background: #1e1e1e; border: 1px solid #444; border-radius: 4px; color: #e1e1e1; font-size: 11px;">
   840→              <option value="custom">Custom</option>
   841→              <option value="podcast">Podcast - Natural pauses</option>
   842→              <option value="interview">Interview - Balanced Q&A</option>
   843→              <option value="reaction">Reaction - Fast paced</option>
   844→              <option value="tutorial">Tutorial - Teaching pace</option>
   845→              <option value="vlog">Vlog - Punchy edits</option>
   846→            </select>
   847→            <button id="savePresetBtn" class="icon-btn" title="Save current settings as preset" style="min-width: 24px;">+</button>
   848→            <button id="managePresetsBtn" class="icon-btn" title="Manage presets" style="min-width: 24px; font-size: 10px;">...</button>
   849→          </div>
   850→        </div>
   851→        <div class="slider-container">
   852→          <sp-slider id="sensitivitySlider" min="0" max="100" step="5" value="50" variant="filled">
   853→            <sp-label slot="label">Sensitivity</sp-label>
   854→          </sp-slider>
   855→          <div class="slider-labels">
   856→            <span>Less</span>
   857→            <span>More</span>
   858→          </div>
   859→        </div>
   860→        <div class="audio-source-group">
   861→          <sp-label>Audio Source</sp-label>
   862→          <sp-checkbox id="sourceOriginal" checked>Original</sp-checkbox>
   863→          <sp-checkbox id="sourceIsolated">Isolated <span class="tier-badge">Pro+</span></sp-checkbox>
   864→        </div>
   865→        <div class="takes-detection-group" style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #444;">
   866→          <sp-checkbox id="enableTakesDetection" checked>Detect takes (protects speech)</sp-checkbox>
   867→        </div>
   868→      </div>
   869→    </div>
   870→  </div>
   871→
   872→  <!-- Results Area -->
   873→  <div id="resultsArea" class="results-area">
   874→    <div id="resultsEmpty" class="empty-state">
   875→      Click GO to get started
   876→    </div>
   877→
   878→    <!-- Progress (hidden by default) -->
   879→    <div id="progressContainer" class="progress-container" style="display: none;">
   880→      <sp-progressbar id="progressBar" indeterminate></sp-progressbar>
   881→      <div id="progressText" class="progress-text">Processing...</div>
   882→    </div>
   883→
   884→    <!-- Combined Preview (hidden by default) -->
   885→    <div id="combinedPreview" class="preview-section">
   886→      <div class="preview-header">
   887→        <h3>Preview</h3>
   888→        <div class="preview-header-actions">
   889→          <button id="reRunDetectionBtn" class="icon-btn" title="Re-run with different sensitivity">R</button>
   890→        </div>
   891→      </div>
   892→      <div id="previewSummary" class="preview-summary">
   893→        <span class="legend-item"><span class="legend-dot silence"></span> <strong id="silenceCount">0</strong> silences</span>
   894→        <span class="legend-item"><span class="legend-dot take"></span> <strong id="takeCount">0</strong> takes</span>
   895→      </div>
   896→      <div class="preview-filters">
   897→        <button class="filter-btn" data-min="0" data-max="0.5" title="Select breaths only">&lt;0.5s</button>
   898→        <button class="filter-btn" data-min="0.5" data-max="1.0" title="Select short pauses">0.5-1s</button>
   899→        <button class="filter-btn" data-min="1.0" data-max="999" title="Select long pauses">&gt;1s</button>
   900→        <button id="invertSelectionBtn" class="filter-btn" title="Invert selection">Invert</button>
   901→      </div>
   902→      <div class="select-all-row">
   903→        <label>
   904→          <input type="checkbox" id="selectAllSilences" checked>
   905→          Select silences (<span id="selectedCount">0</span>)
   906→        </label>
   907→      </div>
   908→      <div id="previewList" class="preview-list"></div>
   909→      <div class="preview-actions">
   910→        <button id="cancelPreviewBtn" class="cancel-btn">Cancel</button>
   911→        <button id="applyPreviewBtn" class="apply-btn">Apply Selected</button>
   912→      </div>
   913→      <div class="preview-actions" style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #444;">
   914→        <button id="buildSequenceBtn" class="go-btn" style="background: linear-gradient(135deg, #6f42c1, #5a32a3);">Build New Sequence (v3.5)</button>
   915→      </div>
   916→    </div>
   917→
   918→    <!-- Silence Results (hidden by default) -->
   919→    <div id="silenceResults" style="display: none;">
   920→      <div class="results-header">
   921→        <h3>Silences Removed</h3>
   922→        <button id="undoBtn" class="undo-btn">UNDO</button>
   923→      </div>
   924→      <div class="results-content">
   925→        <div class="results-stat">
   926→          <span class="results-stat-label">Silences removed</span>
   927→          <span id="resultsCount" class="results-stat-value">0</span>
   928→        </div>
   929→        <div class="results-stat">
   930→          <span class="results-stat-label">Time saved</span>
   931→          <span id="timeSaved" class="results-stat-value">0s</span>
   932→        </div>
   933→        <div class="results-stat">
   934→          <span class="results-stat-label">Clips modified</span>
   935→          <span id="clipsModified" class="results-stat-value">0</span>
   936→        </div>
   937→      </div>
   938→    </div>
   939→
   940→  </div>
   941→
   942→  <!-- Batch Processing Section -->
   943→  <div id="batchSection" class="advanced-section hidden">
   944→    <h4>Batch Processing</h4>
   945→    <p>Process multiple files at once</p>
   946→    <div id="batchQueue" style="max-height: 120px; overflow-y: auto; margin-bottom: 8px;">
   947→      <div id="batchEmpty" style="font-size: 10px; color: #666; text-align: center; padding: 10px;">
   948→        No files in queue
   949→      </div>
   950→      <div id="batchList"></div>
   951→    </div>
   952→    <div style="display: flex; gap: 6px;">
   953→      <button id="addToBatchBtn" style="flex: 1; background: #4a9eff; color: white; border: none; padding: 6px 10px; border-radius: 3px; font-size: 10px; cursor: pointer;">
   954→        Add Files
   955→      </button>
   956→      <button id="startBatchBtn" style="flex: 1; background: #28a745; color: white; border: none; padding: 6px 10px; border-radius: 3px; font-size: 10px; cursor: pointer;" disabled>
   957→        Start Batch
   958→      </button>
   959→      <button id="clearBatchBtn" style="background: #666; color: white; border: none; padding: 6px 10px; border-radius: 3px; font-size: 10px; cursor: pointer;">
   960→        Clear
   961→      </button>
   962→    </div>
   963→    <div id="batchProgress" style="display: none; margin-top: 8px;">
   964→      <sp-progressbar id="batchProgressBar" value="0" max="100"></sp-progressbar>
   965→      <div id="batchProgressText" style="font-size: 9px; color: #888; text-align: center; margin-top: 4px;">0 / 0 files</div>
   966→    </div>
   967→  </div>
   968→
   969→  <!-- Advanced Section (Razor) - shown after silence detection -->
   970→  <div id="advancedSection" class="advanced-section hidden">
   971→    <h4>Advanced: Razor Split</h4>
   972→    <p>Cut clips at silence boundaries using XML</p>
   973→    <button id="exportXMLBtn" class="export-xml-btn">Export XML</button>
   974→    <button id="razorSilencesBtn" class="razor-btn">Razor & Remove</button>
   975→  </div>
   976→
   977→  <!-- Login Modal -->
   978→  <div id="loginModal" class="modal hidden">
   979→    <div class="modal-content">
   980→      <div class="modal-header">
   981→        <h3>Activate License</h3>
   982→        <button id="closeLoginBtn" class="modal-close">x</button>
   983→      </div>
   984→      <div class="setting-group">
   985→        <label>License Key</label>
   986→        <input type="text" id="licenseKeyInput" placeholder="SPLICE-XXXX-XXXX-XXXX" style="width: 100%; padding: 8px; background: #1e1e1e; border: 1px solid #444; border-radius: 4px; color: #e1e1e1; font-size: 11px; box-sizing: border-box; text-transform: uppercase;">
   987→        <p style="font-size: 9px; color: #666; margin-top: 4px;">Find this in your SPLICE subscription email</p>
   988→      </div>
   989→      <div class="setting-group" style="margin-top: 12px;">
   990→        <button id="saveLoginBtn" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #4a9eff, #2d7dd2); color: white; border: none; border-radius: 4px; font-size: 11px; font-weight: 600; cursor: pointer;">Activate</button>
   991→      </div>
   992→      <div id="loginError" style="display: none; font-size: 10px; color: #dc3545; margin-top: 8px; text-align: center;"></div>
   993→    </div>
   994→  </div>
   995→
   996→  <!-- Settings Modal -->
   997→  <div id="settingsModal" class="modal hidden">
   998→    <div class="modal-content">
   999→      <div class="modal-header">
  1000→        <h3>Settings</h3>
  1001→        <button id="closeSettingsBtn" class="modal-close">x</button>
  1002→      </div>
  1003→      <div class="setting-group">
  1004→        <label>Default Sensitivity</label>
  1005→        <sp-slider id="defaultSensitivity" min="0" max="100" step="5" value="50" variant="filled">
  1006→        </sp-slider>
  1007→      </div>
  1008→      <div class="setting-group">
  1009→        <label>Takes Detection</label>
  1010→        <sp-checkbox id="autoMarkBest">Auto-mark best takes</sp-checkbox>
  1011→      </div>
  1012→      <div class="setting-group">
  1013→        <sp-checkbox id="rememberOptions">Remember expanded options</sp-checkbox>
  1014→      </div>
  1015→      <div class="setting-group" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #444;">
  1016→        <label>Media Folder (v3.5)</label>
  1017→        <div id="mediaFolderDisplay" style="font-size: 10px; color: #888; margin: 4px 0; word-break: break-all;">
  1018→          Not configured
  1019→        </div>
  1020→        <div style="display: flex; gap: 6px;">
  1021→          <button id="setMediaFolderBtn" style="flex: 1; background: #4a9eff; color: white; border: none; padding: 6px 10px; border-radius: 3px; font-size: 10px; cursor: pointer;">
  1022→            Set Folder
  1023→          </button>
  1024→          <button id="clearMediaFolderBtn" style="background: #666; color: white; border: none; padding: 6px 10px; border-radius: 3px; font-size: 10px; cursor: pointer;">
  1025→            Clear
  1026→          </button>
  1027→        </div>
  1028→      </div>
  1029→    </div>
  1030→  </div>
  1031→
  1032→  <!-- Save/Edit Preset Modal -->
  1033→  <div id="presetModal" class="modal hidden">
  1034→    <div class="modal-content">
  1035→      <div class="modal-header">
  1036→        <h3 id="presetModalTitle">Save Preset</h3>
  1037→        <button id="closePresetModalBtn" class="modal-close">x</button>
  1038→      </div>
  1039→      <div class="setting-group">
  1040→        <label>Preset Name *</label>
  1041→        <input type="text" id="presetNameInput" placeholder="My Custom Preset" maxlength="50" style="width: 100%; padding: 8px; background: #1e1e1e; border: 1px solid #444; border-radius: 4px; color: #e1e1e1; font-size: 11px; box-sizing: border-box;">
  1042→      </div>
  1043→      <div class="setting-group">
  1044→        <label>Description</label>
  1045→        <input type="text" id="presetDescInput" placeholder="Optional description" maxlength="100" style="width: 100%; padding: 8px; background: #1e1e1e; border: 1px solid #444; border-radius: 4px; color: #e1e1e1; font-size: 11px; box-sizing: border-box;">
  1046→      </div>
  1047→      <div class="setting-group">
  1048→        <label>Icon</label>
  1049→        <div id="presetIconPicker" style="display: flex; gap: 6px; flex-wrap: wrap; margin-top: 4px;">
  1050→          <button type="button" class="preset-icon-option" data-icon="settings" title="Settings" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">*</button>
  1051→          <button type="button" class="preset-icon-option" data-icon="mic" title="Microphone" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">M</button>
  1052→          <button type="button" class="preset-icon-option" data-icon="people" title="People" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">P</button>
  1053→          <button type="button" class="preset-icon-option" data-icon="bolt" title="Fast" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">!</button>
  1054→          <button type="button" class="preset-icon-option" data-icon="school" title="Education" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">E</button>
  1055→          <button type="button" class="preset-icon-option" data-icon="videocam" title="Video" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">V</button>
  1056→          <button type="button" class="preset-icon-option" data-icon="star" title="Star" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">S</button>
  1057→          <button type="button" class="preset-icon-option" data-icon="heart" title="Heart" style="width: 32px; height: 32px; background: #1e1e1e; border: 2px solid #444; border-radius: 4px; cursor: pointer; font-size: 14px;">H</button>
  1058→        </div>
  1059→      </div>
  1060→      <div class="setting-group" style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #444;">
  1061→        <label>Settings</label>
  1062→        <div style="margin-top: 8px;">
  1063→          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
  1064→            <span style="font-size: 10px; color: #888;">Sensitivity</span>
  1065→            <input type="range" id="presetSensitivity" min="0" max="100" step="5" value="50" style="width: 120px; accent-color: #4a9eff;">
  1066→            <span id="presetSensitivityValue" style="font-size: 10px; color: #4a9eff; width: 30px; text-align: right;">50</span>
  1067→          </div>
  1068→          <div style="display: flex; justify-content: space-between; align-items: center;">
  1069→            <span style="font-size: 10px; color: #888;">Threshold (dB)</span>
  1070→            <input type="number" id="presetThreshold" min="-60" max="0" step="1" value="-32" style="width: 60px; padding: 4px 6px; background: #1e1e1e; border: 1px solid #444; border-radius: 3px; color: #e1e1e1; font-size: 10px; text-align: center;">
  1071→          </div>
  1072→        </div>
  1073→      </div>
  1074→      <input type="hidden" id="presetEditId" value="">
  1075→      <input type="hidden" id="presetSelectedIcon" value="settings">
  1076→      <div class="setting-group" style="margin-top: 12px;">
  1077→        <button id="savePresetConfirmBtn" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #28a745, #1e7e34); color: white; border: none; border-radius: 4px; font-size: 11px; font-weight: 600; cursor: pointer;">Save Preset</button>
  1078→      </div>
  1079→      <div id="presetModalError" style="display: none; font-size: 10px; color: #dc3545; margin-top: 8px; text-align: center;"></div>
  1080→    </div>
  1081→  </div>
  1082→
  1083→  <!-- Manage Presets Modal -->
  1084→  <div id="managePresetsModal" class="modal hidden">
  1085→    <div class="modal-content" style="max-width: 320px;">
  1086→      <div class="modal-header">
  1087→        <h3>Manage Presets</h3>
  1088→        <button id="closeManagePresetsBtn" class="modal-close">x</button>
  1089→      </div>
  1090→      <div id="presetsListContainer" style="max-height: 250px; overflow-y: auto;">
  1091→        <div id="presetsList"></div>
  1092→      </div>
  1093→      <div id="noCustomPresets" style="display: none; text-align: center; color: #666; font-size: 11px; padding: 20px 0;">
  1094→        No custom presets yet.<br>Click + to save your current settings.
  1095→      </div>
  1096→      <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #444; display: flex; gap: 8px;">
  1097→        <button id="exportPresetsBtn" style="flex: 1; padding: 8px 10px; background: #17a2b8; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Export presets to file">Export</button>
  1098→        <button id="importPresetsBtn" style="flex: 1; padding: 8px 10px; background: #6c757d; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Import presets from file">Import</button>
  1099→      </div>
  1100→    </div>
  1101→  </div>
  1102→
  1103→  <!-- Confirmation Modal (UXP-compatible replacement for confirm()) -->
  1104→  <div id="confirmModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="confirmModalTitle">
  1105→    <div class="modal-content" style="max-width: 280px;">
  1106→      <div class="modal-header">
  1107→        <h3 id="confirmModalTitle">Confirm</h3>
  1108→        <button id="closeConfirmModalBtn" class="modal-close" aria-label="Close">x</button>
  1109→      </div>
  1110→      <p id="confirmModalMessage" style="font-size: 11px; color: #ccc; margin: 12px 0; line-height: 1.4;"></p>
  1111→      <div style="display: flex; gap: 8px; margin-top: 16px;">
  1112→        <button id="confirmModalCancelBtn" style="flex: 1; padding: 8px 12px; background: #555; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer;">Cancel</button>
  1113→        <button id="confirmModalConfirmBtn" style="flex: 1; padding: 8px 12px; background: #dc3545; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer;">Confirm</button>
  1114→      </div>
  1115→    </div>
  1116→  </div>
  1117→
  1118→  <!-- Load JS modules in order (dependencies first) -->
  1119→  <script src="js/config.js"></script>
  1120→  <script src="js/utils.js"></script>
  1121→  <script src="js/settings.js"></script>
  1122→  <script src="js/credits.js"></script>
  1123→  <script src="js/slice1-timeline.js"></script>
  1124→  <script src="js/slice3-export.js"></script>
  1125→  <script src="js/slice6-analyze.js"></script>
  1126→  <script src="js/slice7-apply.js"></script>
  1127→  <script src="js/slice8-silence.js"></script>
  1128→  <script src="js/slice9-razor.js"></script>
  1129→  <script src="js/builder.js"></script>
  1130→  <script src="js/main.js"></script>
  1131→</body>
  1132→</html>
  1133→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
