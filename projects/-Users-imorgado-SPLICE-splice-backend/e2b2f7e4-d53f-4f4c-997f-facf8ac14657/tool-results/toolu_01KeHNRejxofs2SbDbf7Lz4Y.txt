     1→/**
     2→ * Captions Routes
     3→ *
     4→ * Animated captions endpoints
     5→ */
     6→
     7→const express = require('express');
     8→
     9→/**
    10→ * Create captions routes
    11→ * @param {Object} options - Route configuration options
    12→ * @param {Object} options.middleware - Shared middleware (requireCredits)
    13→ * @returns {express.Router}
    14→ */
    15→function createCaptionsRoutes(options = {}) {
    16→  const router = express.Router();
    17→  const { requireCredits } = options.middleware || {};
    18→
    19→  /**
    20→   * POST /animate - Generate animated captions from transcript
    21→   *
    22→   * Creates word-by-word animated captions with template styling.
    23→   */
    24→  router.post('/animate', requireCredits({ endpoint: 'captions' }), async (req, res) => {
    25→    const { transcript, template = 'mrbeast', settings = {} } = req.body;
    26→
    27→    if (!transcript) {
    28→      return res.status(400).json({ error: 'transcript is required' });
    29→    }
    30→
    31→    try {
    32→      const { generateAnimatedCaptions } = require('../services/animatedCaptions');
    33→      const result = await generateAnimatedCaptions(transcript, template, settings);
    34→
    35→      if (!result.success) {
    36→        return res.status(400).json({ error: result.error });
    37→      }
    38→
    39→      // Deduct usage
    40→      if (req.deductUsage) {
    41→        await req.deductUsage(0.5); // 0.5 credits per caption generation
    42→      }
    43→
    44→      res.json(result);
    45→    } catch (err) {
    46→      console.error('[SPLICE] Animated captions error:', err);
    47→      res.status(500).json({ error: err.message });
    48→    }
    49→  });
    50→

</system-reminder>
