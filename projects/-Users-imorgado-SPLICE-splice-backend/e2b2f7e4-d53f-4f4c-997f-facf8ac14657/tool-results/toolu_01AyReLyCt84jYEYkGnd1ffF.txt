     1→/**
     2→ * SPLICE Plugin Main Entry Point
     3→ *
     4→ * Initializes all functionality when the plugin loads.
     5→ * v3.4 - Timeline Markers + Unified Take-Aware Workflow.
     6→ */
     7→
     8→// Initialize Premiere Pro API
     9→console.log('[SPLICE] Top-level script start');
    10→const ppro = (typeof require !== 'undefined') ? require('premierepro') : {};
    11→
    12→// ============================================================================
    13→// CACHED DOM ELEMENTS (Performance: avoid repeated getElementById calls)
    14→// ============================================================================
    15→const ui = {};
    16→
    17→function cacheUIElements() {
    18→  ui.status = document.getElementById('status');
    19→
    20→  // Main GO button (unified workflow)
    21→  ui.goBtn = document.getElementById('goBtn');
    22→  ui.optionsToggle = document.getElementById('optionsToggle');
    23→  ui.optionsPanel = document.getElementById('optionsPanel');
    24→
    25→  // Sliders and options
    26→  ui.sensitivitySlider = document.getElementById('sensitivitySlider');
    27→  ui.sourceOriginal = document.getElementById('sourceOriginal');
    28→  ui.sourceIsolated = document.getElementById('sourceIsolated');
    29→
    30→  // Settings checkboxes
    31→  ui.enableTakesDetection = document.getElementById('enableTakesDetection');
    32→  ui.autoMarkBest = document.getElementById('autoMarkBest');
    33→
    34→  // J-Cut UI elements (Phase 1)
    35→  ui.enableJCut = document.getElementById('enableJCut');
    36→  ui.jcutSettings = document.getElementById('jcutSettings');
    37→  ui.jcutLeadIn = document.getElementById('jcutLeadIn');
    38→  ui.jcutLeadInValue = document.getElementById('jcutLeadInValue');
    39→  ui.jcutLeadOut = document.getElementById('jcutLeadOut');
    40→  ui.jcutLeadOutValue = document.getElementById('jcutLeadOutValue');
    41→
    42→  // Progress
    43→  ui.progressContainer = document.getElementById('progressContainer');
    44→  ui.progressText = document.getElementById('progressText');
    45→  ui.resultsEmpty = document.getElementById('resultsEmpty');
    46→
    47→  // Combined Preview
    48→  ui.combinedPreview = document.getElementById('combinedPreview');
    49→  ui.previewList = document.getElementById('previewList');
    50→  ui.silenceCountDisplay = document.getElementById('silenceCount');
    51→  ui.takeCountDisplay = document.getElementById('takeCount');
    52→  ui.selectedCount = document.getElementById('selectedCount');
    53→  ui.selectAllSilences = document.getElementById('selectAllSilences');
    54→  ui.applyPreviewBtn = document.getElementById('applyPreviewBtn');
    55→  ui.cancelPreviewBtn = document.getElementById('cancelPreviewBtn');
    56→  ui.invertSelectionBtn = document.getElementById('invertSelectionBtn');
    57→  ui.reRunDetectionBtn = document.getElementById('reRunDetectionBtn');
    58→
    59→  // Results
    60→  ui.silenceResults = document.getElementById('silenceResults');
    61→  ui.resultsCount = document.getElementById('resultsCount');
    62→  ui.timeSaved = document.getElementById('timeSaved');
    63→  ui.clipsModified = document.getElementById('clipsModified');
    64→
    65→  // Build Sequence button (v3.5)
    66→  ui.buildSequenceBtn = document.getElementById('buildSequenceBtn');
    67→
    68→  // Buttons
    69→  ui.undoBtn = document.getElementById('undoBtn');
    70→  ui.advancedSection = document.getElementById('advancedSection');
    71→
    72→  // Settings modal
    73→  ui.settingsBtn = document.getElementById('settingsBtn');
    74→  ui.settingsModal = document.getElementById('settingsModal');
    75→  ui.closeSettingsBtn = document.getElementById('closeSettingsBtn');
    76→
    77→  // Media folder (v3.5)
    78→  ui.mediaFolderDisplay = document.getElementById('mediaFolderDisplay');
    79→  ui.setMediaFolderBtn = document.getElementById('setMediaFolderBtn');
    80→  ui.clearMediaFolderBtn = document.getElementById('clearMediaFolderBtn');
    81→
    82→  // Custom Presets (v3.5)
    83→  ui.savePresetBtn = document.getElementById('savePresetBtn');
    84→  ui.managePresetsBtn = document.getElementById('managePresetsBtn');
    85→  ui.presetModal = document.getElementById('presetModal');
    86→  ui.presetModalTitle = document.getElementById('presetModalTitle');
    87→  ui.closePresetModalBtn = document.getElementById('closePresetModalBtn');
    88→  ui.presetNameInput = document.getElementById('presetNameInput');
    89→  ui.presetDescInput = document.getElementById('presetDescInput');
    90→  ui.presetIconPicker = document.getElementById('presetIconPicker');
    91→  ui.presetEditId = document.getElementById('presetEditId');
    92→  ui.presetSelectedIcon = document.getElementById('presetSelectedIcon');
    93→  ui.savePresetConfirmBtn = document.getElementById('savePresetConfirmBtn');
    94→  ui.presetModalError = document.getElementById('presetModalError');
    95→  ui.managePresetsModal = document.getElementById('managePresetsModal');
    96→  ui.closeManagePresetsBtn = document.getElementById('closeManagePresetsBtn');
    97→  ui.presetsList = document.getElementById('presetsList');
    98→  ui.noCustomPresets = document.getElementById('noCustomPresets');
    99→  ui.presetSelector = document.getElementById('presetSelector');
   100→

</system-reminder>
