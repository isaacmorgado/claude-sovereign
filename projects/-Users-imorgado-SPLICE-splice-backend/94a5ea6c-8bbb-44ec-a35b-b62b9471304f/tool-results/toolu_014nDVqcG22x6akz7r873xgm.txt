     1→# SPLICE
     2→
     3→AI-powered Premiere Pro plugin for detecting takes, removing silences, and accelerating video editing workflows.
     4→
     5→## Key Constraints
     6→- **CEP version**: Premiere Pro 14.0-25.9 (wider compatibility)
     7→- **UXP version**: Premiere Pro 25.6+ (modern architecture)
     8→- Use `127.0.0.1` not `localhost` in fetch URLs
     9→- Backend (prod): https://splice-api-production.up.railway.app
    10→- Backend (dev): https://127.0.0.1:3847
    11→
    12→## Current Status
    13→**v5.6.1** | Production ready | E2E tests passing
    14→
    15→### Recent Bug Fixes (v5.6.1)
    16→- **Fixed**: `/music/moods` and `/music/instruments` endpoints timing out when Redis not configured
    17→  - Root cause: Route ordering issue - `/:jobId` catch-all was matching before specific routes
    18→  - Solution: Moved specific routes (`/moods`, `/instruments`, `/credits`, `/queue-stats`, `/alignment-options`, `/timeline-options`) before `/:jobId` catch-all
    19→- **Fixed**: Lazy loading of music services to prevent Redis dependency from blocking startup
    20→  - `loadMusicGenerationOnly()` for endpoints that don't need Redis
    21→  - `loadMusicServices()` loads Redis-dependent services with error handling
    22→
    23→## Project Structure
    24→```
    25→splice-backend/          # Node.js API server
    26→  server.js              # Main entry (3,700 LOC)
    27→  services/              # 30 service files
    28→  tests/                 # 55 test files
    29→
    30→splice-plugin/           # UXP Plugin (Premiere 25.6+)
    31→  index.html             # Plugin entry
    32→  js/main.js             # Workflow orchestration
    33→  js/builder.js          # Sequence building
    34→  js/config.js           # Backend URL, fetch utilities
    35→
    36→splice-cep/              # CEP Plugin (Premiere 14.0-25.9)
    37→  panel/index.html       # Panel entry
    38→  panel/js/              # Panel JavaScript
    39→  jsx/hostScript.jsx     # ExtendScript host (800+ LOC)
    40→
    41→splice-website/          # Next.js 16 marketing site
    42→  src/app/               # Pages and API routes
    43→  src/components/        # React components
    44→```
    45→
    46→## Pricing Tiers
    47→| Tier | Price | Hours | Music Credits |
    48→|------|-------|-------|---------------|
    49→| Starter | $19/mo | 12 hrs | 5 songs |
    50→| Pro | $49/mo | 30 hrs | 20 songs |
    51→| Team | $149/mo | 100 hrs | 100 songs |
    52→
    53→## Key Services
    54→| Service | Purpose |
    55→|---------|---------|
    56→| `transcription.js` | Whisper API, LRU cache |
    57→| `cutListGenerator.js` | v3.5 JSON cut list |
    58→| `usageTracking.js` | Billing, credits, webhooks |
    59→| `rmsSilenceDetection.js` | RMS audio analysis |
    60→| `musicGeneration.js` | Mureka API integration |
    61→| `chapterDetection.js` | AI chapter detection |
    62→| `animatedCaptions.js` | Caption templates |
    63→
    64→## Core API Endpoints
    65→```
    66→# Core Analysis
    67→POST /analyze           # Transcription + take detection
    68→POST /silences-rms      # Silence detection (RMS)
    69→POST /cut-list          # Generate cut list
    70→POST /chapters          # Chapter detection
    71→POST /isolate-vocals    # Vocal isolation
    72→
    73→# Music (No Auth Required)
    74→GET  /music/moods       # Available mood presets
    75→GET  /music/instruments # Available instrument presets
    76→GET  /music/alignment-options   # Beat alignment config
    77→GET  /music/timeline-options    # Timeline generation options
    78→
    79→# Music (Auth Required)
    80→POST /music/generate    # AI music generation
    81→POST /music/generate-timeline   # Per-chapter music
    82→GET  /music/library     # User's generated music
    83→
    84→# Captions & Export
    85→GET  /captions/templates        # Caption style templates
    86→GET  /export/formats            # Available export formats
    87→POST /export/captions           # Export captions (SRT/VTT/JSON)
    88→
    89→# Social Reframe
    90→GET  /reframe/platforms         # Supported platforms (TikTok, Reels, etc.)
    91→POST /reframe/analyze           # Face detection analysis
    92→
    93→# Billing
    94→GET  /credits           # Credit balance
    95→GET  /health            # Health check
    96→```
    97→
    98→## Quick Commands
    99→```bash
   100→# Start server
   101→cd splice-backend && node server.js
   102→
   103→# Health check
   104→curl -sk https://127.0.0.1:3847/health
   105→
   106→# Run tests
   107→node splice-backend/tests/phase5-e2e.test.js
   108→
   109→# Install CEP extension (macOS)
   110→ln -s /Users/imorgado/SPLICE/splice-cep ~/Library/Application\ Support/Adobe/CEP/extensions/com.splice.panel
   111→
   112→# Website dev
   113→cd splice-website && npm run dev
   114→```
   115→
   116→## Environment Variables
   117→| Variable | Purpose |
   118→|----------|---------|
   119→| `OPENAI_API_KEY` | GPT-4o-mini + Whisper |
   120→| `REPLICATE_API_TOKEN` | Vocal isolation |
   121→| `STRIPE_SECRET_KEY` | Billing |
   122→| `DATABASE_URL` | PostgreSQL |
   123→| `MUREKA_API_KEY` | Music generation |
   124→| `R2_*` | Cloudflare R2 storage |
   125→| `ACRCLOUD_*` | Song identification |
   126→
   127→## Cut List Format (v3.5)
   128→```json
   129→{
   130→  "version": "3.5",
   131→  "source": { "name": "...", "path": "...", "duration": 300 },
   132→  "segments": [{
   133→    "type": "speech|silence|best_take|take",
   134→    "inPoint": 0.0,
   135→    "outPoint": 10.5,
   136→    "takeNumber": 1,
   137→    "colorHint": "cerulean"
   138→  }]
   139→}
   140→```
   141→
   142→## Preset Profiles
   143→| Preset | Sensitivity | Min Silence | Use Case |
   144→|--------|-------------|-------------|----------|
   145→| podcast | 35 | 0.8s | Conversational |
   146→| interview | 50 | 0.5s | Q&A rhythm |
   147→| reaction | 70 | 0.3s | Fast-paced |
   148→| tutorial | 30 | 1.0s | Teaching pace |
   149→| vlog | 65 | 0.35s | YouTube edits |
   150→
   151→## Key Features
   152→- Silence detection (RMS, FFprobe, Whisper)
   153→- Take detection and labeling
   154→- J-Cut/L-Cut support
   155→- Multitrack/multicam analysis
   156→- AI music generation (Mureka)
   157→- Caption export (SRT/VTT)
   158→- Vocal isolation (Replicate)
   159→- Chapter detection (GPT-4o-mini)
   160→- Social reframe (face tracking)
   161→- Text-based editing
   162→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
