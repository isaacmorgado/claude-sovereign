     1→# Music V2 Features - Continuation
     2→
     3→## Completed
     4→- Feature 1: 3 Song Variations (100 tests passing)
     5→
     6→## Next: Feature 2 - Scene-Aware Music
     7→Create `splice-backend/services/sceneAnalysis.js`:
     8→- GPT-4o-mini sentiment analysis on transcript segments
     9→- Energy timeline extraction (0-100 scale per segment)
    10→- Enhanced prompt building with scene context
    11→
    12→Key files:
    13→- `services/sceneAnalysis.js` (new)
    14→- `services/musicGeneration.js` (add scene-aware prompt building)
    15→- `server.js` (add `/music/generate-scene-aware` endpoint)
    16→- `splice-plugin/js/music.js` (add scene-aware UI toggle)
    17→
    18→Pricing: 1.5 credits (75% margin)
    19→
    20→## Then: Feature 3 - Music-to-Cut Alignment
    21→Create `splice-backend/services/musicAlignment.js`:
    22→- FFmpeg `aubio` beat detection
    23→- Trim audio at nearest beat boundary
    24→- Fade out generation
    25→
    26→## Then: Feature 4 - Mood Timeline
    27→Create `splice-backend/services/musicTimeline.js`:
    28→- Per-chapter mood assignment using `chapterDetection.js`
    29→- FFmpeg crossfade assembly between segments
    30→- `POST /music/generate-timeline` endpoint
    31→
    32→## Testing
    33→After each feature: E2E test → fix bugs → verify → next feature
    34→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
